/*!
 * CTM-Platform v0.8.3
 * Copyright 2015 Compare The Market Pty Ltd
 * http://www.comparethemarket.com.au/
 */


function ISODateString(a){function b(a){return 10>a?"0"+a:a}return a.getUTCFullYear()+"-"+b(a.getUTCMonth()+1)+"-"+b(a.getUTCDate())+"T"+b(a.getUTCHours())+":"+b(a.getUTCMinutes())+":"+b(a.getUTCSeconds())+"Z"}function printStackTrace(a){a=a||{guess:!0};var b=a.e||null;a=!!a.guess;var c=new printStackTrace.implementation,b=c.run(b);return a?c.guessAnonymousFunctions(b):b}function initializeNewLogging(){wrapMethod=function(a){return a._wrapped||(a._wrapped=function(){try{a.apply(this,arguments)}catch(b){if(b.message&&b.fileName&&b.lineNumber&&b.columnNumber&&b.stack)window.onerror(b.message,b.fileName,b.lineNumber,b.columnNumber,b);else{if(!(b.message&&b.sourceURL&&b.line))throw b;window.onerror(b.message,b.sourceURL,b.line,null,b)}}}),a._wrapped},polyFill=function(a,b,c){var d=a[b],e=c(d);a[b]=e,window.undo&&window.undo.push(function(){a[b]=d})},hijackTimeFunctions=function(a){return function(b,c){if("function"==typeof b){b=wrapMethod(b);var d=Array.prototype.slice.call(arguments,2);return a(function(){b.apply(this,d)},c)}return a(b,c)}},window.onerror=function(a,b,c,d,e){var f,d=d||window.event&&window.event.errorCharacter,g=b.substring(b.lastIndexOf("/ctm"),b.length);if(g=b.substring(b.lastIndexOf("/app"),b.length),e)f=e.stack;else{f=[];for(var h=arguments.callee.caller;h;)f.push(h.name),h=h.caller;f=f.join("")}f=f.replace(/(\r\n|\n|\r)/gm,""),Driftwood.exception(a,{url:window.location.pathname+window.location.hash,file:g,line:parseInt(c),column:parseInt(d),stack:f})},polyFill(window,"setTimeout",hijackTimeFunctions),polyFill(window,"setInterval",hijackTimeFunctions),window.requestAnimationFrame&&polyFill(window,"requestAnimationFrame",hijackTimeFunctions),window.setImmediate&&polyFill(window,"setImmediate",function(a){return function(b){var c=Array.prototype.slice.call(arguments);return c[0]=wrapMethod(c[0]),a.apply(this,c)}}),"EventTarget Window Node ApplicationCache AudioTrackList ChannelMergerNode CryptoOperation EventSource FileReader HTMLUnknownElement IDBDatabase IDBRequest IDBTransaction KeyOperation MediaController MessagePort ModalWindow Notification SVGElementInstance Screen TextTrack TextTrackCue TextTrackList WebSocket WebSocketWorker Worker XMLHttpRequest XMLHttpRequestEventTarget XMLHttpRequestUpload".replace(/\w+/g,function(a){var b=window[a]&&window[a].prototype;b&&b.hasOwnProperty&&b.hasOwnProperty("addEventListener")&&(polyFill(b,"addEventListener",function(a){return function(b,c,d,e){return c&&c.handleEvent&&(c.handleEvent=wrapMethod(c.handleEvent,{eventHandler:!0})),a.call(this,b,wrapMethod(c,{eventHandler:!0}),d,e)}}),polyFill(b,"removeEventListener",function(a){return function(b,c,d,e){return a.call(this,b,c,d,e),a.call(this,b,wrapMethod(c),d,e)}}))})}!function(a,b){var c,d;c=window.meerkat=window.meerkat||{},d={},c.messaging={},c.messaging.channels={},c.messaging.subscribe=function(a,b,d){return handler={callback:b,context:d||window},c.messaging.channels[a]||(c.messaging.channels[a]=[]),c.messaging.channels[a].push(handler),handler},c.messaging.unsubscribe=function(a,b){var d=c.messaging.channels[a];if(c.messaging.channels[a]){var e=d.indexOf(b);if(e>-1)return d.splice(e,1),!0}return!1},c.messaging.publish=function(a){var b;if(!c.messaging.channels[a])return!1;b=Array.prototype.slice.call(arguments,1);for(var d=0;d<c.messaging.channels[a].length;d++){var e=c.messaging.channels[a][d];e.callback.apply(e.context,b)}return this},c.site={},c.site.init=function(b){a.extend(c,{site:b})},c.getModule=function(b,c,d){var e=a(b).closest("[data-module]"),f=function(){var a=!0;return e.length&&e.data("module")?(c&&(a=a&&e.data("module").type===c),d&&(a=a&&e.data("module").subtype===d),a):!1};for(f(e);!f(e)&&e.length;)e=e.parent().closest("[data-module]");return f(e)&&e},c.init=function(b,e){a.extend(d,e||{}),c.site.init(b),c.logging.init(),c.modules.init()}}(jQuery),meerkat.logging={};var Driftwood=new function(){this.logger=function(){function a(a){for(var b=0;b<f.length;b++)if(f[b]===a)return!0;return!1}function b(b,c,g){var h=e(c),i=new Date,j=b[0];if(h>=d.consoleLevelId&&(b[0]=c+":["+ISODateString(i)+"] "+b[0]),h>=d.exceptionLevelId){var k="Sorry, we have encountered an error. Please try again.";"development"==d.mode&&(k+="["+j+"]");var l={errorLevel:"silent",page:"meerkat.logging.js",message:k,description:j},m={message:l.message,page:l.page};meerkat.site.useNewLogging&&(l.data={},"undefined"!=typeof b[1]?(l.data.stack=b[1],l.data.stack.error=b[0],m.stack=l.data.stack.stack):l.data.stack=b[0],l.data.browser={userAgent:navigator.userAgent||"",referrer:document.referrer||"",cookiesEnabled:navigator.cookieEnabled||""});var n=JSON.stringify(m).replace(/\s{1,}/g," ");a(n)||(meerkat.modules.errorHandling.error(l),f.push(n))}"production"!==d.mode&&"Microsoft Internet Explorer"!=navigator.appName&&"undefined"!=typeof g&&"function"==typeof g.apply&&g.apply(console,Array.prototype.slice.call(b))}var c=["NONE","DEBUG","INFO","ERROR","EXCEPTION","NONE"],d={consoleLevel:"DEBUG",consoleLevelId:0,exceptionLevel:"NONE",exceptionLevelId:99,mode:"development",serverPath:"/exceptions/notify?payload=",applicationName:"js_client",cors:!0},e=function(a){return c.indexOf(a.toUpperCase())},f=[];return{setServerPath:function(a){d.serverPath=a},env:function(a){a=a.toLowerCase(),"development"==a?(d.consoleLevel="DEBUG",d.exceptionLevel="none",d.consoleLevelId=0,d.exceptionLevelId=4,d.mode=a):"production"==a?(d.consoleLevel="ERROR",d.exceptionLevel="none",d.consoleLevelId=2,d.exceptionLevelId=3,d.mode=a):console.log("Unknown environment level")},applicationName:function(a){d.applicationName=a},logLevel:function(a){var b=e(a);b>-1?(d.consoleLevel=a.toUpperCase(),d.consoleLevelId=b):console.log("Setting an invalid log level: "+a)},exceptionLevel:function(a){var b=e(a);b>-1?(d.exceptionLevel=a.toUpperCase(),d.exceptionLevelId=b):console.log("Setting an invalid log level: "+a)},debug:function(){b(arguments,"DEBUG",console.debug)},info:function(){b(arguments,"INFO",console.info)},error:function(){b(arguments,"ERROR",console.error)},exception:function(a){b(a,"EXCEPTION",console.error)}}},defaultLogger=new this.logger,this.exception=function(){defaultLogger.exception(arguments)},this.applicationName=function(a){defaultLogger.applicationName(a)},this.debug=defaultLogger.debug,this.info=defaultLogger.info,this.error=defaultLogger.error,this.env=function(a){defaultLogger.env(a)},this.setServerPath=function(a){defaultLogger.setServerPath(a)},this.exceptionLevel=function(a){"NONE"!=a?defaultLogger.exceptionLevel(a):(this.debug=_.bind(console.debug,console),this.info=_.bind(console.info,console),this.error=_.bind(console.error,console),this.log=_.bind(console.log,console))},this.logLevel=function(a){defaultLogger.logLevel(a)}};Array.prototype.indexOf||(Array.prototype.indexOf=function(a){"use strict";if(void 0===this||null===this)throw new TypeError;var b=Object(this),c=b.length>>>0;if(0===c)return-1;var d=0;if(arguments.length>0&&(d=Number(arguments[1]),d!==d?d=0:0!==d&&d!==1/0&&d!==-(1/0)&&(d=(d>0||-1)*Math.floor(Math.abs(d)))),d>=c)return-1;for(var e=d>=0?d:Math.max(c-Math.abs(d),0);c>e;e++)if(e in b&&b[e]===a)return e;return-1});var JSON;if(JSON||(JSON={}),function(){function f(a){return 10>a?"0"+a:a}function quote(a){return escapable.lastIndex=0,escapable.test(a)?'"'+a.replace(escapable,function(a){var b=meta[a];return"string"==typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function str(a,b){var c,d,e,f,g,h=gap,i=b[a];switch(i&&"object"==typeof i&&"function"==typeof i.toJSON&&(i=i.toJSON(a)),"function"==typeof rep&&(i=rep.call(b,a,i)),typeof i){case"string":return quote(i);case"number":return isFinite(i)?String(i):"null";case"boolean":case"null":return String(i);case"object":if(!i)return"null";if(gap+=indent,g=[],"[object Array]"===Object.prototype.toString.apply(i)){for(f=i.length,c=0;f>c;c+=1)g[c]=str(c,i)||"null";return e=0===g.length?"[]":gap?"[\n"+gap+g.join(",\n"+gap)+"\n"+h+"]":"["+g.join(",")+"]",gap=h,e}if(rep&&"object"==typeof rep)for(f=rep.length,c=0;f>c;c+=1)"string"==typeof rep[c]&&(d=rep[c],e=str(d,i),e&&g.push(quote(d)+(gap?": ":":")+e));else for(d in i)Object.prototype.hasOwnProperty.call(i,d)&&(e=str(d,i),e&&g.push(quote(d)+(gap?": ":":")+e));return e=0===g.length?"{}":gap?"{\n"+gap+g.join(",\n"+gap)+"\n"+h+"}":"{"+g.join(",")+"}",gap=h,e}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(a){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(a){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;"function"!=typeof JSON.stringify&&(JSON.stringify=function(a,b,c){var d;if(gap="",indent="","number"==typeof c)for(d=0;c>d;d+=1)indent+=" ";else"string"==typeof c&&(indent=c);if(rep=b,!b||"function"==typeof b||"object"==typeof b&&"number"==typeof b.length)return str("",{"":a});throw new Error("JSON.stringify")}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){function walk(a,b){var c,d,e=a[b];if(e&&"object"==typeof e)for(c in e)Object.prototype.hasOwnProperty.call(e,c)&&(d=walk(e,c),void 0!==d?e[c]=d:delete e[c]);return reviver.call(a,b,e)}var j;if(text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),printStackTrace.implementation=function(){},printStackTrace.implementation.prototype={run:function(a,b){return a=a||this.createException(),b=b||this.mode(a),"other"===b?this.other(arguments.callee):this[b](a)},createException:function(){try{this.undef()}catch(a){return a}},mode:function(a){return a.arguments&&a.stack?"chrome":a.stack&&a.sourceURL?"safari":a.stack&&a.number?"ie":a.stack&&a.fileName?"firefox":a.message&&a["opera#sourceloc"]?!a.stacktrace||-1<a.message.indexOf("\n")&&a.message.split("\n").length>a.stacktrace.split("\n").length?"opera9":"opera10a":a.message&&a.stack&&a.stacktrace?0>a.stacktrace.indexOf("called from line")?"opera10b":"opera11":a.stack&&!a.fileName?"chrome":"other"},instrumentFunction:function(a,b,c){a=a||window;var d=a[b];a[b]=function(){return c.call(this,printStackTrace().slice(4)),a[b]._instrumented.apply(this,arguments)},a[b]._instrumented=d},deinstrumentFunction:function(a,b){a[b].constructor===Function&&a[b]._instrumented&&a[b]._instrumented.constructor===Function&&(a[b]=a[b]._instrumented)},chrome:function(a){return(a.stack+"\n").replace(/^[\s\S]+?\s+at\s+/," at ").replace(/^\s+(at eval )?at\s+/gm,"").replace(/^([^\(]+?)([\n$])/gm,"{anonymous}() ($1)$2").replace(/^Object.<anonymous>\s*\(([^\)]+)\)/gm,"{anonymous}() ($1)").replace(/^(.+) \((.+)\)$/gm,"$1@$2").split("\n").slice(0,-1)},safari:function(a){return a.stack.replace(/\[native code\]\n/m,"").replace(/^(?=\w+Error\:).*$\n/m,"").replace(/^@/gm,"{anonymous}()@").split("\n")},ie:function(a){return a.stack.replace(/^\s*at\s+(.*)$/gm,"$1").replace(/^Anonymous function\s+/gm,"{anonymous}() ").replace(/^(.+)\s+\((.+)\)$/gm,"$1@$2").split("\n").slice(1)},firefox:function(a){return a.stack.replace(/(?:\n@:0)?\s+$/m,"").replace(/^(?:\((\S*)\))?@/gm,"{anonymous}($1)@").split("\n")},opera11:function(a){var b=/^.*line (\d+), column (\d+)(?: in (.+))? in (\S+):$/;a=a.stacktrace.split("\n");for(var c=[],d=0,e=a.length;e>d;d+=2){var f=b.exec(a[d]);if(f){var g=f[4]+":"+f[1]+":"+f[2],f=f[3]||"global code",f=f.replace(/<anonymous function: (\S+)>/,"$1").replace(/<anonymous function>/,"{anonymous}");c.push(f+"@"+g+" -- "+a[d+1].replace(/^\s+/,""))}}return c},opera10b:function(a){var b=/^(.*)@(.+):(\d+)$/;a=a.stacktrace.split("\n");for(var c=[],d=0,e=a.length;e>d;d++){var f=b.exec(a[d]);f&&c.push((f[1]?f[1]+"()":"global code")+"@"+f[2]+":"+f[3])}return c},opera10a:function(a){var b=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i;a=a.stacktrace.split("\n");for(var c=[],d=0,e=a.length;e>d;d+=2){var f=b.exec(a[d]);f&&c.push((f[3]||"{anonymous}")+"()@"+f[2]+":"+f[1]+" -- "+a[d+1].replace(/^\s+/,""))}return c},opera9:function(a){var b=/Line (\d+).*script (?:in )?(\S+)/i;a=a.message.split("\n");for(var c=[],d=2,e=a.length;e>d;d+=2){var f=b.exec(a[d]);f&&c.push("{anonymous}()@"+f[2]+":"+f[1]+" -- "+a[d+1].replace(/^\s+/,""))}return c},other:function(a){for(var b,c,d=/function\s*([\w\-$]+)?\s*\(/i,e=[],f=Array.prototype.slice;a&&a.arguments&&10>e.length;){b=d.test(a.toString())?RegExp.$1||"{anonymous}":"{anonymous}",c=f.call(a.arguments||[]),e[e.length]=b+"("+this.stringifyArguments(c)+")";try{a=a.caller}catch(g){e[e.length]=""+g;break}}return e},stringifyArguments:function(a){for(var b=[],c=Array.prototype.slice,d=0;d<a.length;++d){var e=a[d];void 0===e?b[d]="undefined":null===e?b[d]="null":e.constructor&&(b[d]=e.constructor===Array?3>e.length?"["+this.stringifyArguments(e)+"]":"["+this.stringifyArguments(c.call(e,0,1))+"..."+this.stringifyArguments(c.call(e,-1))+"]":e.constructor===Object?"#object":e.constructor===Function?"#function":e.constructor===String?'"'+e+'"':e.constructor===Number?e:"?")}return b.join(",")},sourceCache:{},ajax:function(a){var b=this.createXMLHTTPObject();if(b)try{return b.open("GET",a,!1),b.send(null),b.responseText}catch(c){}return""},createXMLHTTPObject:function(){for(var a,b=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}],c=0;c<b.length;c++)try{return a=b[c](),this.createXMLHTTPObject=b[c],a}catch(d){}},isSameDomain:function(a){return"undefined"!=typeof location&&-1!==a.indexOf(location.hostname)},getSource:function(a){return a in this.sourceCache||(this.sourceCache[a]=this.ajax(a).split("\n")),this.sourceCache[a]},guessAnonymousFunctions:function(a){for(var b=0;b<a.length;++b){var c=/^(.*?)(?::(\d+))(?::(\d+))?(?: -- .+)?$/,d=a[b],e=/\{anonymous\}\(.*\)@(.*)/.exec(d);if(e){var f=c.exec(e[1]);f&&(c=f[1],e=f[2],f=f[3]||0,c&&this.isSameDomain(c)&&e&&(c=this.guessAnonymousFunction(c,e,f),a[b]=d.replace("{anonymous}",c)))}}return a},guessAnonymousFunction:function(a,b,c){var d;try{d=this.findFunctionName(this.getSource(a),b)}catch(e){d="getSource failed with url: "+a+", exception: "+e.toString()}return d},findFunctionName:function(a,b){for(var c,d,e=/function\s+([^(]*?)\s*\(([^)]*)\)/,f=/['"]?([$_A-Za-z][$_A-Za-z0-9]*)['"]?\s*[:=]\s*function\b/,g=/['"]?([$_A-Za-z][$_A-Za-z0-9]*)['"]?\s*[:=]\s*(?:eval|new Function)\b/,h="",i=Math.min(b,20),j=0;i>j;++j)if(c=a[b-j-1],d=c.indexOf("//"),d>=0&&(c=c.substr(0,d)),c&&(h=c+h,(c=f.exec(h))&&c[1]||(c=e.exec(h))&&c[1]||(c=g.exec(h))&&c[1]))return c[1];return"(?)"}},"undefined"==typeof console)var console={log:function(){}};Function.prototype.bind&&console&&"object"==typeof console.log&&["log","info","warn","error","assert","dir","clear","profile","profileEnd"].forEach(function(a){console[a]=this.bind(console[a],console)},Function.prototype.call),"undefined"==typeof console.debug&&(console.debug=console.log),meerkat.logging.logger=Driftwood,meerkat.logging.debug=meerkat.logging.logger.debug,meerkat.logging.info=meerkat.logging.logger.info,meerkat.logging.error=meerkat.logging.logger.error,meerkat.logging.exception=meerkat.logging.logger.exception,window.onerror=function(a,b,c){Driftwood.exception(a,{url:b,line:c})};var wrapMethod,polyFill,hijackTimeFunctions;meerkat.logging.init=function(){meerkat.site.useNewLogging&&initializeNewLogging();var a="";a=""!==meerkat.site.vertical?"["+meerkat.site.vertical+"]":"",meerkat.logging.logger.applicationName(a);var b=meerkat.site.showLogging?"development":"production";meerkat.logging.logger.env(b),meerkat.logging.info("[logging]","Sergei sees you runnings on "+meerkat.site.environment+" ("+b+"s mode).")},function(a,b){function c(b,c){if(f[b])throw"A module is already defined with the key: "+b;f[b]=c,f[b].moduleName=b,"function"==typeof c.init&&h.push(b),"function"==typeof c.events?a.extend(!0,g,f[b].events()):"object"==typeof f.events&&a.extend(!0,g,f[b].events)}function d(){for(h=h.reverse();h.length;){var a=h.pop();f[a].init()}}var e=window.meerkat,f=(e.logging.info,{}),g={},h=[];f=e.modules={register:c,init:d},e.modules.events=g}(jQuery);var Results=new Object;Results={view:new Object,model:new Object,moduleEvents:{RESULTS_INITIALISED:"RESULTS_INITIALISED",RESULTS_ERROR:"RESULTS_ERROR"},init:function(a){Results.view=ResultsView,Results.model=ResultsModel,Results.pagination=ResultsPagination;var b={url:"ajax/json/results.jsp",formSelector:"#mainform",runShowResultsPage:!0,paths:{results:{rootElement:"results",list:"results.result",general:"results.info",errors:"error"},price:{annually:"price.annual.total",quarterly:"price.quarterly.total",monthly:"price.monthly.total",fortnightly:"price.fortnightly.total",weekly:"price.weekly.total",daily:"price.daily.total"},availability:{price:{annually:"price.annual.available",quarterly:"price.quarterly.available",monthly:"price.monthly.available",fortnightly:"price.fortnightly.available",weekly:"price.weekly.available",daily:"price.daily.available"},product:"productAvailable"},productId:"productId",features:"compareFeatures.features"},sort:{sortBy:"price.annually",sortByMethod:Results.model.defaultSortMethod,sortDir:"asc"},frequency:"annually",displayMode:"price",pagination:{mode:"slide",touchEnabled:!1,emptyContainerFunction:!1,afterPaginationRefreshFunction:!1},availability:{product:["equals","Y"],price:["equals","Y"]},animation:{results:{individual:{active:!0,delay:-50,acceleration:25},delay:100,options:{effect:"slide",direction:"right",easing:"easeInOutQuart",duration:400}},shuffle:{active:!0,options:{duration:400,easing:"easeInOutQuart",queue:"shuffle"}},filter:{active:!0,queue:"filter",reposition:{options:{duration:1e3,easing:"easeInOutQuart"}},appear:{options:{duration:1200}},disappear:{options:{duration:1e3}}},features:{scroll:{active:!0,duration:1e3,percentage:1}}},elements:{frequency:".frequency",reviseButton:".reviseButton",page:"#resultsPage",container:".results-table",rows:".result-row",productHeaders:".result",templates:{result:"#result-template",unavailable:"#unavailable-template",unavailableCombined:"#unavailable-combined-template",error:"#error-template",currentProduct:"#current-product-template",feature:"#feature-template"},noResults:".noResults",resultsFetchError:".resultsFetchError",resultsContainer:".resultsContainer",resultsOverflow:".resultsOverflow",features:{headers:".featuresHeaders",list:".featuresList",allElements:".featuresElements",expandable:".expandable",expandableHover:".expandableHover",values:".featuresValues",extras:".featuresExtras"}},render:{templateEngine:"microTemplate",features:{mode:"build",headers:!0,expandRowsOnComparison:!0,numberOfXSColumns:2},dockCompareBar:!0},templates:{pagination:{pageItem:'<li><a class="btn-pagination" data-results-pagination-control="{{= pageNumber}}">{{= label}}</a></li>',pageText:"Page {{=currentPage}} of {{=totalPages}}"}},show:{featuresCategories:!0,topResult:!0,currentProduct:!0,nonAvailableProducts:!0,nonAvailablePrices:!0,savings:!0,unavailableCombined:!1},dictionary:{loadingMessage:"Loading Your Quotes...",valueMap:[]},rankings:{filterUnavailableProducts:!0},incrementTransactionId:!0};$.extend(!0,b,a),Results.settings=b,Results.view.$containerElement=$(Results.settings.elements.resultsContainer+" "+Results.settings.elements.container),Results.pagination.init(),Results.view.setDisplayMode(Results.settings.displayMode,!0),"undefined"!=typeof meerkat&&meerkat.messaging.publish(Results.moduleEvents.RESULTS_INITIALISED)},get:function(a,b){Results.model.fetch(a,b)},render:function(){Results.view.show(),Results.pagination.refresh()},reset:function(){$(Results.settings.elements.resultsContainer).trigger("resultsReset"),Results.model.flush(),Results.pagination.reset(),"undefined"!=typeof QuoteEngine&&QuoteEngine.updateAddress()},reviseDetails:function(){"undefined"!=typeof QuoteEngine&&QuoteEngine.setOnResults(!1),"undefined"!=typeof Track&&"undefined"!=typeof Track.quoteLoadRefresh&&Track.quoteLoadRefresh("Refresh"),Results.view.toggleResultsPage(),Results.reset()},sortBy:function(a,b){return Results.setSortBy(a)?(b&&Results.setSortDir(b),Results.model.sort(),!0):!1},getSortBy:function(){return Results.settings.sort.sortBy},getSortByMethod:function(){return Results.settings.sort.sortByMethod},getSortDir:function(){return Results.settings.sort.sortDir},setSortBy:function(a){return"undefined"!=typeof Object.byString(Results.settings.paths,a)?(Results.settings.sort.sortBy=a,!0):(console.log("Results.setSortBy() has been called but it could not find the path to the property it should be sorted by: sortBy=",a),!1)},setSortByMethod:function(a){return"function"==typeof a?(Results.settings.sort.sortByMethod=a,!0):(null===a&&(Results.settings.sort.sortByMethod=Results.model.defaultSortMethod),console.log("Results.setSortByMethod() has been called but the parameter is not a function.",a),!1)},setSortDir:function(a){return a&&a.length>0&&-1!=$.inArray(a,["asc","desc"])?(Results.settings.sort.sortDir=a,!0):(console.log("Results.setSortDir() has been called but it was provided an invalid argument: sortDir=",a),!1)},filterBy:function(a,b,c,d){"undefined"!=typeof Object.byString(Results.settings.paths,a)?(Results.model.addFilter(a,b,c),Results.model.filter(d)):console.log("This filter could not find the path to the property it should be filtered by: filterBy= filterBy=",a,"| condition=",b,"| options=",c)},unfilterBy:function(a,b,c){"undefined"!=typeof Object.byString(Results.settings.paths,a)?(Results.model.removeFilter(a,b),c&&Results.model.filter(c)):console.log("This filter could not find the path to the property it should be unfiltered by: filterBy=",a,"| condition=",b)},applyFiltersAndSorts:function(){Results.model.filterAndSort(!0),Results.view.toggleFrequency(Results.settings.frequency)},getFrequency:function(){return Results.settings.frequency},setFrequency:function(a,b){if("undefined"==typeof b&&(b=!0),!Results.settings.show.nonAvailablePrices){$.each(Results.settings.paths.price,function(a,b){Results.unfilterBy("availability.price."+a,"value",!1)});var c={};c[Results.settings.availability.price[0]]=Results.settings.availability.price[1],Results.filterBy("availability.price."+a,"value",c,b)}Results.model.setFrequency(a,b),b!==!1&&Results.sortBy("price."+a)},addCurrentProduct:function(a,b){Results.model.addCurrentProduct(b),Results.setCurrentProduct(a,Object.byString(b,a))},removeCurrentProduct:function(){Results.model.currentProduct=!1},setCurrentProduct:function(a,b){"undefined"!=typeof Object.byString(Results.settings.paths,a)?Results.model.setCurrentProduct(a,b):console.log("You have been trying to set the current product but the path to the identifier does not seem to exists: identifierPathName=",a,"| currentProduct=",b)},getResult:function(a,b){return"undefined"!=typeof Object.byString(Results.settings.paths,a)?Results.model.getResult(a,b):void console.log("You have been trying to retrieve a result through an identifier, but the path to that identifier does not seem to exist in the results objects: identifierPathName=",a,"| value=",b)},getResultIndex:function(a,b){return"undefined"!=typeof Object.byString(Results.settings.paths,a)?Results.model.getResultIndex(a,b):void console.log("You have been trying to retrieve a result through an identifier, but the path to that identifier does not seem to exist in the results objects: identifierPathName=",a,"| value=",b)},getResultByIndex:function(a){return Results.model.returnedProducts[a]},getResultByProductId:function(a){return Results.getResult(Results.settings.paths.productId,a)},getTopResult:function(){return Results.model.sortedProducts&&Results.model.sortedProducts.length>0?Results.model.sortedProducts[0]:!1},getReturnedGeneral:function(){return Results.model.returnedGeneral},getReturnedResults:function(){return Results.model.returnedProducts},getAjaxRequest:function(){return Results.model.ajaxRequest},getSortedResults:function(){return Results.model.sortedProducts},getFilteredResults:function(){return Results.model.filteredProducts},getSelectedProduct:function(){return Results.model.selectedProduct},setSelectedProduct:function(a){return Results.model.setSelectedProduct(a)},removeSelectedProduct:function(){Results.model.removeSelectedProduct()},getDisplayMode:function(){return"undefined"==typeof Results.settings||Results.settings.hasOwnProperty("displayMode")!==!0?null:Results.settings.displayMode},setDisplayMode:function(a,b){Results.view.setDisplayMode(a,b)},isResultDisplayed:function(a){return-1==$.inArray(a,Results.model.filteredProducts)?!1:!0},setPerformanceMode:function(a){var b=meerkat.modules.performanceProfiling.PERFORMANCE;switch(a){case b.LOW:Results.settings.animation.filter.active=!1,Results.settings.animation.shuffle.active=!1,Results.settings.animation.features.scroll.active=!1,Results.settings.render.features.expandRowsOnComparison=!1;break;case b.MEDIUM:Results.settings.animation.filter.active=!1,Results.settings.animation.shuffle.active=!1,Results.settings.animation.features.scroll.active=!0,Results.settings.render.features.expandRowsOnComparison=!0;break;case b.HIGH:Results.settings.animation.filter.active=!0,Results.settings.animation.shuffle.active=!0,Results.settings.animation.features.scroll.active=!0,Results.settings.render.features.expandRowsOnComparison=!0}},onError:function(a,b,c,d){"undefined"!=typeof meerkat?(meerkat.messaging.publish(Results.moduleEvents.RESULTS_ERROR),meerkat.modules.errorHandling.error({errorLevel:"warning",message:a,page:b,description:c,data:d})):"undefined"!=typeof FatalErrorDialog&&FatalErrorDialog.exec({message:a,page:b,description:c,data:d})},startResultsFetch:function(){Results.model.startResultsFetch()},finishResultsFetch:function(){Results.model.finishResultsFetch()},publishResultsDataReady:function(){Results.model.publishResultsDataReady()}};var ResultsModel=new Object;ResultsModel={ajaxRequest:!1,returnedGeneral:!1,isBlockedQuote:!1,returnedProducts:!1,filteredProducts:!1,sortedProducts:!1,hasValidationErrors:!1,currentProduct:!1,selectedProduct:!1,filters:new Array,resultsLoadedOnce:!1,moduleEvents:{WEBAPP_LOCK:"WEBAPP_LOCK",WEBAPP_UNLOCK:"WEBAPP_UNLOCK",RESULTS_DATA_READY:"RESULTS_DATA_READY",RESULTS_BEFORE_DATA_READY:"RESULTS_BEFORE_DATA_READY",RESULTS_MODEL_UPDATE_BEFORE_FILTERSHOW:"RESULTS_MODEL_UPDATE_BEFORE_FILTERSHOW",RESULTS_UPDATED_INFO_RECEIVED:"RESULTS_UPDATED_INFO_RECEIVED"},fetch:function(a,b){Results.model.startResultsFetch();try{Results.model.flush(),"undefined"!=typeof Loading&&Loading.show(Results.settings.dictionary.loadingMessage),"undefined"!=typeof Compare&&Compare.reset(),Results.settings.runShowResultsPage===!0&&Results.view.showResultsPage();try{$.address.parameter("stage","results",!1)}catch(c){}if("undefined"==typeof a&&(a=Results.settings.url),"undefined"==typeof b){var b;"undefined"!=typeof meerkat?(b=meerkat.modules.form.getData($(Results.settings.formSelector)),b.push({name:"transactionId",value:meerkat.modules.transactionId.get()}),meerkat.site.isCallCentreUser&&b.push({name:meerkat.modules.comms.getCheckAuthenticatedLabel(),value:!0})):(b=Results.model.getFormData($(Results.settings.formSelector)),b.push({name:"transactionId",value:referenceNo.getTransactionID()}))}}catch(c){Results.onError("Sorry, an error occurred fetching results","Results.js","Results.model.fetch(); "+c.message,c)}if(1==Results.model.resultsLoadedOnce){var d=Results.settings.hasOwnProperty("incrementTransactionId");(!d||d&&Results.settings.incrementTransactionId===!0)&&(a+=(-1==a.indexOf("?")?"?":"&")+"id_handler=increment_tranId")}Results.model.ajaxRequest=$.ajax({url:a,data:b,type:"POST",async:!0,dataType:"json",cache:!1,success:function(c){Results.model.updateTransactionIdFromResult(c),"undefined"!=typeof meerkat&&c.hasOwnProperty("results")&&c.results.hasOwnProperty("info")&&(Results.model.isBlockedQuote="undefined"!=typeof c.results.info&&"boolean"==typeof c.results.info.blocked&&c.results.info.blocked===!0,meerkat.messaging.publish(Results.model.moduleEvents.RESULTS_UPDATED_INFO_RECEIVED,c.results.info));try{c&&c.messages&&c.messages.length>0,"undefined"!=typeof meerkat&&"undefined"!=typeof c.error&&c.error==meerkat.modules.comms.getCheckAuthenticatedLabel()?("undefined"!=typeof Loading&&Loading.hide(),_.defer(function(){meerkat.modules.journeyEngine.gotoPath("previous")}),meerkat.modules.dialogs.isDialogOpen(c.error)||meerkat.modules.errorHandling.error({errorLevel:"warning",id:c.error,message:"Your Simples login session has been lost. Please open Simples in a separate tab, login, then you can continue with this quote.",page:"ResultsModel.js",description:"Error loading url: "+a+" : "+c.error,data:b})):"undefined"!=typeof c.error&&"validation"==c.error.type?("undefined"!=typeof Loading&&Loading.hide(),Results.model.hasValidationErrors="object"==typeof Object.byString(c,Results.settings.paths.results.errors),Results.reviseDetails(),ServerSideValidation.outputValidationErrors({validationErrors:c.error.errorDetails.validationErrors,startStage:0})):c&&"undefined"!=typeof Object.byString(c,Results.settings.paths.results.rootElement)?Results.model.update(c):Results.model.handleFetchError(c,"Returned results did not have the expected format"),Results.model.triggerEventsFromResult(c)}catch(d){Results.model.handleFetchError(b,"Try/Catch fail on success: "+d.message)}},error:function(a,c,d){Results.model.ajaxRequest=!1,429===a.status?Results.model.isBlockedQuote=!0:(0!==a.status&&0!==a.readyState||"timeout"==c)&&Results.model.handleFetchError(b,"AJAX request failed: "+c+" "+d)},complete:function(){Results.model.ajaxRequest=!1,Results.model.finishResultsFetch()}})},triggerEventsFromResult:function(a){if("undefined"!=typeof meerkat&&"object"==typeof a&&a.hasOwnProperty("results")&&a.results.hasOwnProperty("events"))for(var b in a.results.events)a.results.events.hasOwnProperty(b)&&meerkat.messaging.publish(b,a.results.events[b])},updateTransactionIdFromResult:function(a){var b=0;a.hasOwnProperty("info")&&a.info.hasOwnProperty("transactionId")?b=a.info.transactionId:a.hasOwnProperty("error")&&a.error.hasOwnProperty("transactionId")?b=a.error.transactionId:a.hasOwnProperty("results")&&(a.results.hasOwnProperty("transactionId")?b=a.results.transactionId:a.results.hasOwnProperty("info")&&a.results.info.hasOwnProperty("transactionId")?b=a.results.info.transactionId:a.results.hasOwnProperty("noresults")&&a.results.noresults.hasOwnProperty("transactionId")&&(b=a.results.noresults.transactionId)),0!==b&&("undefined"!=typeof meerkat?meerkat.modules.transactionId.set(b):"undefined"!=typeof referenceNo&&referenceNo.setTransactionId(b))},handleFetchError:function(a,b){"undefined"!=typeof Loading&&Loading.hide(),Results.reviseDetails();var c="";"undefined"!=typeof meerkat&&"undefined"!=typeof meerkat.site&&"undefined"!=typeof meerkat.site.content&&"undefined"!=typeof meerkat.site.content.callCentreHelpNumber&&meerkat.site.content.callCentreHelpNumber.length>0&&(c="If the problem persists, please feel free to discuss your comparison needs with our call centre on "+meerkat.site.content.callCentreHelpNumber+"."),Results.onError("Sorry, an error occurred while retrieving your results.<br />Please close this message and try again. "+c,"common/js/Results.js for "+Results.model.getVertical(),"Results.model.fetch(). "+b,a);
},getVertical:function(){var a="unknown";return Results.settings.hasOwnProperty("vertical")?a=Results.settings.vertical:"object"==typeof meerkat&&meerkat.site.hasOwnProperty("vertical")&&(a=meerkat.site.vertical),a},reset:function(){Results.model.flush(),Results.model.currentProduct=!1,Results.settings.frequency="annual",Results.model.filters=[]},flush:function(){Results.model.returnedGeneral=[],Results.model.returnedProducts=[],Results.model.sortedProducts=[],Results.model.filteredProducts=[],Results.view.flush()},getFormData:function(a){return a.find(":input:visible, input[type=hidden], :input[data-visible=true]").filter(function(){return""!=$(this).val()&&"Please choose..."!=$(this).val()}).serializeArray()},update:function(a){try{if(""!=Object.byString(a,Results.settings.paths.results.rootElement)&&Object.byString(a,Results.settings.paths.results.list)&&(Object.byString(a,Results.settings.paths.results.list).length>0||"object"==typeof Object.byString(a,Results.settings.paths.results.list))){Object.byString(a,Results.settings.paths.results.general)&&""!=Object.byString(a,Results.settings.paths.results.general)&&(Results.model.returnedGeneral=Object.byString(a,Results.settings.paths.results.general),$(Results.settings.elements.resultsContainer).trigger("generalReturned")),Object.byString(a,Results.settings.paths.results.list).length?Results.model.returnedProducts=Object.byString(a,Results.settings.paths.results.list):Results.model.returnedProducts=[Object.byString(a,Results.settings.paths.results.list)],Results.model.currentProduct&&Results.model.currentProduct.product&&Results.model.returnedProducts.push(Results.model.currentProduct.product),"undefined"!=typeof meerkat&&meerkat.messaging.publish(Results.model.moduleEvents.RESULTS_MODEL_UPDATE_BEFORE_FILTERSHOW),$(Results.settings.elements.resultsContainer).trigger("resultsReturned");var b={};Results.settings.show.nonAvailableProducts||(b[Results.settings.availability.product[0]]=Results.settings.availability.product[1],Results.model.addFilter("availability.product","value",b)),b={},Results.settings.show.nonAvailablePrices||(b[Results.settings.availability.price[0]]=Results.settings.availability.price[1],Results.model.addFilter("availability.price."+Results.settings.frequency,"value",b)),Results.model.filterAndSort(!1),Results.view.show()}else Results.view.showNoResults(),$(Results.settings.elements.resultsContainer).trigger("noResults")}catch(c){Results.onError("Sorry, an error occurred updating results","Results.js","Results.model.update(); "+c.message,c)}Results.model.resultsLoadedOnce=!0},filterAndSort:function(a){Results.model.sort(a),Results.model.filter(a),$(Results.settings.elements.resultsContainer).trigger("resultsDataReady"),"undefined"!=typeof meerkat&&(meerkat.messaging.publish(Results.model.moduleEvents.RESULTS_BEFORE_DATA_READY),_.defer(function(){meerkat.messaging.publish(Results.model.moduleEvents.RESULTS_DATA_READY)}))},sort:function(a){if(Results.settings.sort.sortBy===!1)return!1;if(Results.model.returnedProducts.length>0){if(Results.model.sortedProducts.length>0)var b=Results.model.sortedProducts.slice();var c=Results.model.returnedProducts.slice(),d="function"==typeof Results.getSortByMethod()?Results.getSortByMethod():Results.model.defaultSortMethod();Results.model.sortedProducts=c.sort(d),"undefined"!=typeof b&&a!==!1&&Results.view.shuffle(b),Results.pagination.gotoStart(!0)}},defaultSortMethod:function(a,b){var c=Object.byString(a,Object.byString(Results.settings.paths,Results.settings.sort.sortBy)),d=Object.byString(b,Object.byString(Results.settings.paths,Results.settings.sort.sortBy));(isNaN(c)||isNaN(d))&&(c=String(c).toLowerCase(),d=String(d).toLowerCase());var e=Results.settings.paths.availability.price[Results.settings.frequency];if(e&&""!=e){var f=Object.byString(a,e),g=Object.byString(b,e);if("N"==g||!d||""==d)return-1;if("N"==f||!c||""==c)return 1}if(d>c)returnValue=-1;else if(c>d)returnValue=1;else{if(-1==Results.settings.sort.sortBy.indexOf("price.")){var h=Object.byString(Results.settings.paths,"price."+Results.settings.frequency);return c=Object.byString(a,h),d=Object.byString(b,h),null==c||null==d?0:c-d}returnValue=c-d}return"desc"==Results.settings.sort.sortDir&&(returnValue*=-1),returnValue},addFilter:function(a,b,c){if("undefined"!=typeof a&&"undefined"!=typeof b&&"undefined"!=typeof c&&""!==a&&""!==b){var d=Object.byString(Results.settings.paths,a);if("undefined"!=typeof d){var e=Results.model.findFilter(d,b);e!==!1?Results.model.filters[e].options=c:Results.model.filters.push({path:d,condition:b,options:c})}else console.log("This filter could not find the path to the property it should be filtered by: filterBy=",a,"| condition=",b,"| options=",c)}},removeFilter:function(a,b){if("undefined"!=typeof a&&"undefined"!=typeof b){var c=Object.byString(Results.settings.paths,a);if("undefined"!=typeof c){var d=Results.model.findFilter(c,b);d!==!1&&Results.model.filters.splice(d,1)}else console.log("This filter could not find the path to the property it should be unfiltered by: filterBy=",a,"| condition=",b)}},findFilter:function(a,b){if("undefined"!=typeof a&&"undefined"!=typeof b){var c=!1;return $.each(Results.model.filters,function(d,e){return e.path==a&&e.condition==b?(c=d,!1):void 0}),c}return!1},filter:function(a){var b,c,d=Results.model.sortedProducts.slice(),e=new Array;$.each(d,function(a,d){b=!0,$.each(Results.model.filters,function(a,e){if(c=Object.byString(d,e.path),"undefined"!=typeof c)switch(e.condition){case"value":b=Results.model.filterByValue(c,e.options);break;case"range":b=Results.model.filterByRange(c,e.options);break;default:console.log("The filter condition type seems to be erroneous")}return b?void 0:!1}),b&&e.push(d)}),Results.model.filteredProducts=e,"undefined"!=typeof Compare&&Compare.applyFilters(),a!==!1&&(0===Results.getFilteredResults().length?(Results.view.showNoFilteredResults(),$(Results.settings.elements.resultsContainer).trigger("noFilteredResults")):(Results.view.filter(),Results.pagination.gotoStart(!0)))},filterByValue:function(a,b){return b&&"undefined"!=typeof b?b.hasOwnProperty("equals")?a==b.equals:b.hasOwnProperty("notEquals")?a!=b.notEquals:b.hasOwnProperty("inArray")&&$.isArray(b.inArray)?-1!=$.inArray(String(a),b.inArray):(console.log("Options from this value filter are incorrect and has not been applied: ",a,b),!0):(console.log("Check the parameters passed to Results.model.filterByValue()"),!0)},filterByRange:function(a,b){return b&&"undefined"!=typeof b?b.hasOwnProperty("min")||b.hasOwnProperty("max")?b.hasOwnProperty("min")&&a<b.min||b.hasOwnProperty("max")&&a>b.max?!1:!0:(console.log("Options from this range filter are incorrect and have not been applied: ",a,b),!0):(console.log("Check the parameters passed to Results.model.filterByRange()"),!0)},filterByDateRange:function(a,b){},addCurrentProduct:function(a){Results.model.currentProduct?$.extend(Results.model.currentProduct,{product:a}):(Results.model.currentProduct=new Object,Results.model.currentProduct={product:a})},setCurrentProduct:function(a,b){Results.model.currentProduct?$.extend(Results.model.currentProduct,{path:Object.byString(Results.settings.paths,a),value:b}):(Results.model.currentProduct=new Object,Results.model.currentProduct={path:Object.byString(Results.settings.paths,a),value:b})},setSelectedProduct:function(a){return Results.model.selectedProduct=Results.model.getResult("productId",a)},removeSelectedProduct:function(){Results.model.selectedProduct=!1},getResult:function(a,b,c){var d=!1,e=!1;return $.each(Results.model.returnedProducts,function(c,f){var g=Object.byString(f,Object.byString(Results.settings.paths,a));return g==b?(d=f,e=c,!1):void 0}),c?e:d},getResultIndex:function(a,b){return Results.model.getResult(a,b,!0)},setFrequency:function(a,b){Results.settings.frequency=a,b!==!1&&Results.view.toggleFrequency(a)},startResultsFetch:function(){"undefined"!=typeof meerkat&&meerkat.messaging.publish(Results.model.moduleEvents.WEBAPP_LOCK,{source:"resultsModel"}),$(Results.settings.elements.resultsContainer).trigger("resultsFetchStart")},finishResultsFetch:function(){"undefined"!=typeof Loading&&Loading.hide(),"undefined"!=typeof meerkat&&_.defer(function(){meerkat.messaging.publish(Results.model.moduleEvents.WEBAPP_UNLOCK,{source:"resultsModel"})}),$(Results.settings.elements.resultsContainer).trigger("resultsFetchFinish")},publishResultsDataReady:function(){"undefined"!=typeof meerkat&&($(Results.settings.elements.resultsContainer).trigger("resultsReturned"),meerkat.messaging.publish(Results.model.moduleEvents.RESULTS_DATA_READY))}};var ResultsPagination=new Object;ResultsPagination={NEXT:"next",PREVIOUS:"previous",$pagesContainer:null,$nextButton:null,$previousButton:null,$pageText:null,invalidated:!0,currentPageNumber:null,currentPageMeasurements:null,scrollMode:null,previousScrollPosition:0,isLocked:!1,isHidden:!1,isTouching:!1,isScrolling:!1,touchendSnapTimeout:!1,scrollCheckTimeout:!1,init:function(){$(document).on("click","[data-results-pagination-control]",function(a){Results.pagination.controlListener(a)}),Results.pagination.$pagesContainer=$("[data-results-pagination-pages-cell]"),Results.pagination.$nextButton=$('[data-results-pagination-control="next"]'),Results.pagination.$previousButton=$('[data-results-pagination-control="previous"]'),Results.pagination.$pageText=$('[data-results-pagination-pagetext="true"]').removeClass("hidden"),Results.pagination.setScrollMode(),"undefined"!=typeof meerkat&&meerkat.messaging.subscribe(meerkat.modules.events.device.STATE_CHANGE,function(a){"xs"!==a.state&&Results.pagination.resync()})},resync:function(){return Results.pagination.isHidden===!0?!1:(Results.pagination.invalidate(),Results.pagination.gotoPage(Results.pagination.getCurrentPageNumber(),!0,!0),void Results.pagination.refresh())},reposition:function(){Results.pagination.gotoPage(Results.pagination.getCurrentPageNumber(),!1,!0)},isSlideMode:function(){return"slide"===Results.settings.pagination.mode},isPageMode:function(){return"page"===Results.settings.pagination.mode},getCurrentHorizontalPosition:function(){return ResultsUtilities.getScroll("x",Results.view.$containerElement)},invalidate:function(){Results.pagination.isLocked=!1,Results.pagination.invalidated=!0,Results.pagination.currentPageMeasurements=null,Results.pagination.isHidden=!1},reset:function(){Results.pagination.invalidate(),Results.pagination.$nextButton.addClass("inactive"),Results.pagination.$previousButton.addClass("inactive"),Results.pagination.$pageText.empty(),Results.pagination.isSlideMode()||Results.pagination.isPageMode()&&Results.pagination.empty(Results.pagination.$pagesContainer)},refresh:function(){if(Results.pagination.isHidden!==!0)if(Results.pagination.isPageMode()){var a=Results.pagination.getPageMeasurements();if(null===a)return!1;if(Results.pagination.invalidated===!0){Results.pagination.invalidated=!1;var b=_.template(Results.settings.templates.pagination.pageItem);if(Results.pagination.empty(Results.pagination.$pagesContainer),a.numberOfPages>1&&a.numberOfPages!=Number.POSITIVE_INFINITY)for(var c=0;c<a.numberOfPages;c++){var d=c+1,e=b({pageNumber:d,label:d});Results.pagination.$pagesContainer.append(e)}}if(null!=Results.pagination.$pageText&&Results.pagination.$pageText.length>0){var f=_.template(Results.settings.templates.pagination.pageText),e=f({currentPage:Results.pagination.getCurrentPageNumber(),totalPages:a.numberOfPages});Results.pagination.$pageText.html(e)}var g=Results.pagination.getCurrentPageNumber();$("[data-results-pagination-control].active").removeClass("active"),$('[data-results-pagination-control="'+g+'"]').addClass("active"),Results.pagination.addCurrentPageClasses(g,a),1==Results.pagination.getCurrentPageNumber()?Results.pagination.$previousButton.addClass("inactive"):Results.pagination.$previousButton.removeClass("inactive"),Results.pagination.getCurrentPageNumber()===a.numberOfPages?Results.pagination.$nextButton.addClass("inactive"):Results.pagination.$nextButton.removeClass("inactive"),"function"==typeof Results.settings.pagination.afterPaginationRefreshFunction&&Results.settings.pagination.afterPaginationRefreshFunction(Results.pagination.$pagesContainer)}else Results.pagination.toggleScrollButtons(Results.pagination.previousScrollPosition)},controlListener:function(a){Results.pagination.isSlideMode()?Results.pagination.scrollResults($(a.currentTarget)):Results.pagination.isPageMode()&&Results.pagination.gotoPage($(a.currentTarget).attr("data-results-pagination-control"))},empty:function(a){"function"==typeof Results.settings.pagination.emptyContainerFunction?Results.settings.pagination.emptyContainerFunction(a):a.empty()},gotoPage:function(a,b,c){if(Results.pagination.isLocked)return!1;if(b!==!0&&(b=!1),c!==!0&&(c=!1),a===ResultsPagination.NEXT?a=Results.pagination.getCurrentPageNumber()+1:a===ResultsPagination.PREVIOUS&&(a=ResultsPagination.getCurrentPageNumber()-1),isNaN(a)===!0)return!1;1>a&&(a=1),a=Number(a);var d=Results.pagination.getPageMeasurements(),e=0;if(1!==a){var f=d.pageWidth;a>d.numberOfPages&&(a=d.numberOfPages);var g=a-1;e=0-f*g}var h=Results.pagination.getCurrentPageNumber();if(a===h&&0==c)return!1;Results.pagination.setCurrentPageNumber(a),Results.pagination.removeCurrentPageClasses(),b||c?Results.pagination.scroll(e):Results.pagination.animateScroll(e);var i=jQuery.Event("resultPageChange");i.pageData={pageNumber:a,measurements:d},$(Results.settings.elements.resultsContainer).trigger(i)},gotoPosition:function(a,b,c){if(Results.pagination.isLocked)return!1;var d=Results.pagination.getPageMeasurements(),e=Math.ceil(a/d.columnsPerPage);Results.pagination.gotoPage(e,b,c)},getCurrentPageNumber:function(){return null===Results.pagination.currentPageNumber?Results.pagination.calculateCurrentPageNumber():Results.pagination.currentPageNumber},setCurrentPageNumber:function(a){Results.pagination.currentPageNumber=a},calculateCurrentPageNumber:function(){var a=Results.pagination.getPageMeasurements();if(null===a)return!1;var b=a.pageWidth,c=0-Results.pagination.getCurrentHorizontalPosition(),d=Math.round(c/b)+1;return d},getPageMeasurements:function(){return null===Results.pagination.currentPageMeasurements||Results.view.currentlyColumnWidthTracking===!0?Results.pagination.calculatePageMeasurements():Results.pagination.currentPageMeasurements},calculatePageMeasurements:function(){var a=Results.view.$containerElement,b=a.parent().width(),c=a.find(Results.settings.elements.rows+".notfiltered");if(0==c.length)return null;var d=c.length,e=0,f=0,g="undefined"!=typeof meerkat?meerkat.modules.deviceMediaState.get().toLowerCase():!1;g!==!1&&"xs"!==g&&Results.pagination.hasLessDrivenColumns(g)?(f=Results.pagination.getColumnCountFromContainer(g),e=Math.round(b/f)):(e=c.outerWidth(!0),f=Math.round(b/e));var h=e*f,i={pageWidth:h,columnsPerPage:f,numberOfColumns:d,numberOfPages:Math.ceil(d/f)};return Results.pagination.currentPageMeasurements=i,i},hasLessDrivenColumns:function(a){return $('.resultsContainer[class*="results-columns-'+a+'-"]').length>0},getColumnCountFromContainer:function(a){var b=0,c=$(".resultsContainer");if(c.length)for(var d=c[0].className.split(" "),e=0;e<d.length;e++)_.isEmpty(d[e])||0!==d[e].indexOf("results-columns-"+a+"-")||(b=Number(d[e].replace(/^\D+/g,"")));return b},gotoStart:function(a){if(a&&Results.pagination.invalidate(),Results.pagination.isSlideMode()){var b=0;Results.pagination.animateScroll(b)}else Results.pagination.isPageMode()&&(Results.pagination.gotoPage(1),a&&Results.pagination.refresh())},setScrollMode:function(){var a=!1;"undefined"!=typeof meerkat&&(a=meerkat.modules.performanceProfiling.isIos6()),Results.settings.pagination.touchEnabled===!0?Results.pagination.scrollMode="scrollto":Modernizr.csstransforms3d&&0==a?Results.pagination.scrollMode="csstransforms3d":Modernizr.csstransitions?Results.pagination.scrollMode="csstransitions":Results.pagination.scrollMode="jquery"},animateScroll:function(a){if(a===Results.pagination.previousScrollPosition)return _.defer(function(){Results.pagination.refresh()}),!1;if(Results.settings.animation.features.scroll.active===!1)Results.pagination.scroll(a),Results.pagination._afterPaginationMotion(!1);else{switch(Results.pagination.lock(),$(Results.settings.elements.resultsContainer).trigger("pagination.scrolling.start"),Results.pagination.scrollMode){case"scrollto":var b=(Results.pagination.getCurrentPageNumber()-1)*Results.pagination.currentPageMeasurements.columnsPerPage;$(Results.settings.elements.resultsOverflow).scrollTo($(Results.settings.elements.rows).not(".filtered").eq(b),500,{onAfter:function(){Results.pagination._afterPaginationMotion(!0)}});break;case"csstransforms3d":var c={marginLeft:0};c[Modernizr.prefixed("transform")]="translate3d("+ResultsPagination.previousScrollPosition+"px,0,0)",Results.view.$containerElement.css(c),_.delay(function(){Results.view.$containerElement.addClass("resultsTransformTransition"),Results.view.$containerElement.css(Modernizr.prefixed("transform"),"translate3d("+a+"px,0,0)"),_.delay(function(){Results.view.$containerElement.removeClass("resultsTransformTransition");var b={marginLeft:a+"px"};b[Modernizr.prefixed("transform")]="",Results.view.$containerElement.css(b),Results.pagination._afterPaginationMotion(!0)},Results.view.$containerElement.transitionDuration()+10)},25);break;case"csstransitions":Results.view.$containerElement.hasClass("resultsTableLeftMarginTransition")||Results.view.$containerElement.addClass("resultsTableLeftMarginTransition"),_.defer(function(){var b=Results.view.$containerElement.transitionDuration();Results.view.$containerElement.css("margin-left",a),_.delay(function(){Results.pagination._afterPaginationMotion(!0),Results.view.$containerElement.removeClass("resultsTableLeftMarginTransition")},b)});break;default:var d=Results.settings.animation.features.scroll.duration;Results.view.$containerElement.animate({"margin-left":a},d,function(){Results.pagination._afterPaginationMotion(!0)})}ResultsPagination.previousScrollPosition=a}},_afterPaginationMotion:function(a){Results.pagination.unlock(),Results.pagination.refresh(),a&&$(Results.settings.elements.resultsContainer).trigger("pagination.scrolling.end")},scroll:function(a){ResultsPagination.previousScrollPosition=a;var b=function(){Results.pagination.currentPageMeasurements=Results.pagination.calculatePageMeasurements(),$(Results.settings.elements.resultsContainer).trigger(" pagination.instantScroll")};if(Results.settings.pagination.touchEnabled===!0&&!_.isNull(Results.pagination.currentPageMeasurements)&&Results.pagination.currentPageMeasurements.hasOwnProperty("pageWidth")){var c=150,d=Results.pagination.currentPageMeasurements.pageWidth,e=$(Results.settings.elements.resultsOverflow).scrollLeft(),f=Math.abs(a),g=Math.abs(e-f),h=Math.floor(g/d*c),i=d*(Results.pagination.currentPageMeasurements.numberOfColumns-1);e>0||i>e?$(Results.settings.elements.resultsOverflow).stop(!0,!0).animate({scrollLeft:Math.abs(a)},{duration:h,step:function(){(Results.pagination.isTouching===!0||Results.pagination.isScrolling===!0)&&$(Results.settings.elements.resultsOverflow).stop(!0,!0)},complete:function(){_.defer(b)}}):_.defer(b)}else Results.view.$containerElement.css("margin-left",a),b()},scrollResults:function(a){if(0==a.hasClass("inactive")&&Results.pagination.isLocked===!1){Results.pagination.lock();var b,c=Results.view.$containerElement.parent().width(),d=$(Results.settings.elements.resultsContainer+" "+Results.settings.elements.rows).first().outerWidth(!0)*$(Results.settings.elements.resultsContainer+" "+Results.settings.elements.rows+".notfiltered").length,e=c*Results.settings.animation.features.scroll.percentage,f=ResultsUtilities.getScroll("x",Results.view.$containerElement);"previous"==a.attr("data-results-pagination-control")?(b=f+e,b>=0&&(b=0)):(b=f-e,c>=d?b=0:Math.abs(b)>=d-c&&d>c&&(b=-1*d+c)),Results.pagination.animateScroll(b)}},toggleScrollButtons:function(a){var b=$(Results.settings.elements.resultsContainer+" "+Results.settings.elements.container),c=ResultsUtilities.getScroll("x",Results.view.$containerElement);if(a!=c)window.setTimeout(function(){Results.pagination.toggleScrollButtons(a,e,d)},100);else{var d,e,f=$(Results.settings.elements.resultsContainer+" "+Results.settings.elements.resultsOverflow).width(),g=b.width();d=f>=g?"inactive":g>0-c+f?"active":"inactive",e=c>=0?"inactive":"active","active"==d?Results.pagination.$nextButton.removeClass("inactive"):Results.pagination.$nextButton.addClass("inactive"),"active"==e?Results.pagination.$previousButton.removeClass("inactive"):Results.pagination.$previousButton.addClass("inactive")}},lock:function(){Results.pagination.isLocked=!0,Results.pagination.$nextButton.addClass("inactive"),Results.pagination.$previousButton.addClass("inactive"),Results.pagination.$pagesContainer.find("a").addClass("inactive")},unlock:function(){Results.pagination.isLocked=!1,Results.pagination.$pagesContainer.find("a").removeClass("inactive")},hide:function(){Results.pagination.isHidden=!0,Results.pagination.$pagesContainer.addClass("hidden"),Results.pagination.$nextButton.addClass("hidden"),Results.pagination.$previousButton.addClass("hidden"),Results.pagination.$pageText.addClass("hidden")},show:function(a){Results.pagination.isHidden=!1,Results.pagination.$pagesContainer.removeClass("hidden"),Results.pagination.$nextButton.removeClass("hidden"),Results.pagination.$previousButton.removeClass("hidden"),Results.pagination.$pageText.removeClass("hidden"),a===!0&&Results.pagination.resync()},addCurrentPageClasses:function(a,b){if(Results.pagination.removeCurrentPageClasses(),!isNaN(b.columnsPerPage))for(var c=(a-1)*b.columnsPerPage,d=(a*b.columnsPerPage,!0),e=c,f=0;d;){var g=e;$("[data-position='"+g+"']").hasClass("notfiltered")&&($("[data-position='"+g+"']").addClass("currentPage"),f++),e++,(f===b.columnsPerPage||e===Results.getReturnedResults().length||e>1e3)&&(d=!1)}},removeCurrentPageClasses:function(){$(Results.settings.elements.rows+".currentPage").removeClass("currentPage")},setupNativeScroll:function(){if(Results.settings.pagination.touchEnabled===!0){var a=$(Results.settings.elements.resultsContainer+".featuresMode"),b=Results.getFilteredResults().length;a.find(".result-row.result_unavailable_combined").length&&b++;var c=Math.ceil(b/Results.pagination.currentPageMeasurements.columnsPerPage),d=Results.pagination.currentPageMeasurements.pageWidth*c;$(Results.settings.elements.container,a).width(d),$(Results.settings.elements.resultsOverflow).off("scroll.results").on("scroll.results",Results.pagination.nativePaginationOnScroll),Modernizr.touch&&$(Results.settings.elements.resultsOverflow,a).off("touchstart.results").on("touchstart.results",function(){Results.pagination.isTouching=!0,Results.pagination.cancelExistingSnapTo()}).off("touchend.results").on("touchend.results",function(){Results.pagination.isTouching=!1,Results.pagination.isScrolling=!1,Results.pagination.cancelExistingSnapTo(),setTimeout(function(){Results.pagination.isScrolling===!1&&Results.pagination.nativeScrollSnapTo()},250)})}},nativePaginationOnScroll:_.debounce(function(a){if(!Results.pagination.isLocked){Results.pagination.isScrolling=!0;var b=3,c=Results.pagination.currentPageMeasurements.pageWidth,d=Math.floor(c/b),e=$(a.target).scrollLeft()+d,f=Math.floor(e/Results.pagination.currentPageMeasurements.pageWidth)+1,g=$(a.target).scrollLeft()%Results.pagination.currentPageMeasurements.pageWidth!=0,h=Results.pagination.getCurrentPageNumber()!=f;if((h===!0||g===!0)&&f<=Results.pagination.currentPageMeasurements.numberOfPages){Results.pagination.invalidate(),Results.pagination.setCurrentPageNumber(f),Results.pagination.refresh(),"xs"==meerkat.modules.deviceMediaState.get()&&Results.pagination.isTouching===!1&&h===!0&&(Results.pagination.isScrolling=!1,Results.pagination.nativeScrollSnapTo());var i=$.Event("resultPageChange");i.pageData={pageNumber:f,measurements:Results.pagination.getPageMeasurements()},$(Results.settings.elements.resultsContainer).trigger(i)}}},25),nativeScrollSnapTo:function(){Results.pagination.cancelExistingSnapTo(),Results.pagination.touchendSnapTimeout=setTimeout(function(){if(Results.pagination.isTouching===!1&&Results.pagination.isScrolling===!1){var a=Results.pagination.currentPageNumber,b=Results.pagination.currentPageMeasurements.pageWidth;Results.pagination.scroll(b*(a-1))}},750)},cancelExistingSnapTo:function(){$(Results.settings.elements.resultsOverflow).stop(!0,!0),clearTimeout(Results.pagination.touchendSnapTimeout)}};var ResultsUtilities=new Object;ResultsUtilities={setContainerWidth:function(a,b){var c=$(a).first().outerWidth(!0)*$(a).length;$(b).css("width",c+"px")},makeElementSticky:function(a,b,c,d){if("true"!=b.attr("data-fixed")){var e="msie"==$.browser&&$.browser.version<7;if(!e){var f=$(window),g=b.height(),h=f.scrollTop(),i=f.height();f.smartscroll(function(e){h=f.scrollTop(),i=f.height(),"top"==a?h>=d?b.addClass(c):(b.removeClass(c),8==$.browser.version&&b.is(":visible")&&0==h&&b.delay(5).hide(0).show(0)):"bottom"==a&&(g+d>h+i?b.addClass(c):b.removeClass(c))})}b.attr("data-fixed","true")}},position:function(a,b,c){switch(a){case"absolute":ResultsUtilities.positionAbsolute(b,c);break;case"relative":case"static":ResultsUtilities.positionStaticOrRelative(a,b)}},positionAbsolute:function(a,b){a.parent().hasClass("absoluteContainer")||a.wrapAll('<div class="absoluteContainer" />');var c=a.parent();c.css("position","relative");var d,e=a.first();if("vertical"===b){d=e.outerWidth(!0)*a.length;var f=0;a.each(function(){var a=$(this).outerHeight(!0);a>f&&(f=a)}),c.css("height",f),c.css("width",d)}else d=e.outerHeight(!0)*a.length,c.css("height",d);a.each(function(a,c){var d=$(c),e=d.position();"horizontal"===b&&d.css("top",e.top),d.css("left",e.left)}),a.css("position","absolute")},positionStaticOrRelative:function(a,b){var c=b.parent();c.hasClass("absoluteContainer")?b.unwrap():(c.children(".absoluteContainer").length>0&&c.children(".absoluteContainer").remove(),c.css({position:a,height:"auto"})),b.css({top:"auto",left:"auto",position:a})},getScroll:function(a,b){if(!("x"!=a&"y"!=a&&"z"!=a))switch(a){case"x":return parseInt(b.css("margin-left"));case"y":return parseInt(b.css("margin-top"));case"z":return 0}}};var deBouncer=function(a,b,c,d){var e=function(a,b,c){var e;return function(){function f(){c||a.apply(g,h),e=null}var g=this,h=arguments;e?clearTimeout(e):c&&a.apply(g,h),e=setTimeout(f,b||d)}};jQuery.fn[b]=function(a){return a?this.bind(c,e(a)):this.trigger(b)}};deBouncer(jQuery,"smartscroll","scroll",50),function(a){a.fn.transitionDuration=function(){for(var b,c=["transition-duration","-webkit-transition-duration","-ms-transition-duration","-moz-transition-duration","-o-transition-duration"];b=c.shift();){var d=a(this);if(d.css(b))return Math.round(1e3*parseFloat(d.css(b)))}return 0}}(jQuery);var ResultsView=new Object;ResultsView={rowHeight:!1,rowWidth:!1,orientation:"horizontal",shuffleTransitionDuration:!1,filterTransitionDuration:!1,$containerElement:!1,currentlyColumnWidthTracking:!1,noResultsMode:!1,moduleEvents:{RESULTS_SORTED:"RESULTS_SORTED",RESULTS_TOGGLE_MODE:"RESULTS_TOGGLE_MODE"},show:function(){try{$.address.parameter("stage","results",!1)}catch(a){}"undefined"!=typeof Filters&&$(Filters.settings.elements.filtersBar).length>0&&Results.view.toggleFilters("show"),"undefined"!=typeof Compare&&$(Compare.settings.elements.bar).length>0&&(Results.view.toggleCompare("show"),Results.settings.render.dockCompareBar===!0&&(ResultsUtilities.makeElementSticky("top",$(Compare.settings.elements.bar),"fixed-top",$(Compare.settings.elements.bar).offset().top),ResultsUtilities.makeElementSticky("top",$(Results.settings.elements.page),"fixedThree",$(Compare.settings.elements.bar).offset().top))),Results.view.showResults(),Results.view.flush(),$(Results.settings.elements.resultsContainer).find(".noResults.clone").remove(),Results.view.buildHtml(),Results.view.setDisplayMode(Results.settings.displayMode,!0);var b;if(Results.settings.animation.results.individual.active?(Results.view.animateIndividualResults(),b=$(Results.settings.elements.rows).last()):(Results.view.animateAllResults(),b=$(Results.settings.elements.resultsContainer)),Results.settings.show.savings&&Results.model.currentProduct&&Results.model.currentProduct.product){var c=Results.settings.paths.price[Results.settings.frequency],d=Object.byString(Results.model.currentProduct.product,c);if(d&&"undefined"!=typeof d){var e=Results.getTopResult(),f=Object.byString(e,c),g=d-f;"undefined"!=typeof Compare&&Compare.setSavings(g)}}$(b).queue("fx",function(a){$(Results.settings.elements.resultsContainer).trigger("resultsAnimated"),a()})},setDisplayMode:function(a,b){(a!=Results.settings.displayMode||b)&&($(Results.settings.elements.resultsContainer).removeClass(Results.settings.displayMode+"Mode"),$(Results.settings.elements.resultsContainer).addClass(a+"Mode"),Results.settings.displayMode=a,"features"==a?(Results.view.orientation="vertical",$(Results.settings.elements.resultsContainer+" "+Results.settings.elements.features.allElements).css("display","block"),Results.view.calculateResultsContainerWidth()):(Results.view.$containerElement.css("margin-left","0px"),Results.view.$containerElement.css("width","auto"),$(Results.settings.elements.resultsContainer+" "+Results.settings.elements.features.allElements).css("display","none")),"price"==a&&(Results.view.orientation="horizontal"),b===!0&&$(Results.settings.elements.resultsContainer).trigger(a+"DisplayMode"),"undefined"!=typeof meerkat&&meerkat.messaging.publish(Results.view.moduleEvents.RESULTS_TOGGLE_MODE))},calculateResultsContainerWidth:function(){ResultsUtilities.setContainerWidth(Results.settings.elements.resultsContainer+" "+Results.settings.elements.rows+".notfiltered",Results.settings.elements.resultsContainer+" "+Results.settings.elements.container)},setColumnWidth:function(a,b,c){"undefined"==typeof c&&(c=!0);var d=parseInt($(Results.settings.elements.rows).first().css("margin-right")),e=2*b;c||(e-=2);var f=(a.width()-e*d)/b;$(Results.settings.elements.rows).width(f),"undefined"!=typeof Features&&Features&&Features.balanceVisibleRowsHeight(),Results.settings.pagination.touchEnabled===!0?ResultsUtilities.setContainerWidth($(Results.settings.elements.rows).not(".filtered"),$(Results.settings.elements.container)):ResultsUtilities.setContainerWidth($(Results.settings.elements.rows),$(Results.settings.elements.container)),Results.pagination.reposition()},setOverflowWidthToWindowWidth:function(){$(Results.settings.elements.resultsOverflow).width($(window).width())},startColumnWidthTracking:function(a,b,c){Results.view.currentlyColumnWidthTracking===!0&&$(window).off("resize.ResultsView.columnWidthTracking"),Results.view.currentlyColumnWidthTracking=!0,Results.view.setColumnWidth(a,b,c),Results.view.setOverflowWidthToWindowWidth(),"undefined"!=typeof Features&&Features.balanceVisibleRowsHeight(),$(window).on("resize.ResultsView.columnWidthTracking",_.debounce(function(){Results.view.setColumnWidth(a,b,c),Results.view.setOverflowWidthToWindowWidth()}))},stopColumnWidthTracking:function(){Results.view.currentlyColumnWidthTracking=!1,$(window).off("resize.ResultsView.columnWidthTracking"),_.defer(function(){$(Results.settings.elements.rows).width(""),$(Results.settings.elements.resultsOverflow).width(""),"undefined"!=typeof Features&&"features"===Results.getDisplayMode()&&Features.balanceVisibleRowsHeight(),Results.pagination.resync()})},buildHtml:function(){var a,b="",c="",d=$(Results.settings.elements.templates.result).html();if(""==d&&console.log("The result template could not be found: templateSelector=",Results.settings.elements.templates.result,"This template is mandatory, make sure to pass the correct selector to the Results.settings.elements.templates.result user setting when calling Results.init()"),Results.settings.elements.templates.unavailable){var e=$(Results.settings.elements.templates.unavailable).html();""==e&&console.log("The unavailable template could not be found: templateSelector=",Results.settings.elements.templates.unavailable,"If you don't want to use this template, pass 'false' to the Results.settings.elements.templates.unavailable user setting when calling Results.init()");
}if(Results.settings.elements.templates.unavailableCombined){var f=$(Results.settings.elements.templates.unavailableCombined).html();""==f&&console.log("The unavailable combined template could not be found: templateSelector=",Results.settings.elements.templates.unavailableCombinedTemplate,"If you don't want to use this template, pass 'false' to the Results.settings.elements.templates.unavailableCombinedTemplate user setting when calling Results.init()")}if(Results.settings.elements.templates.error){var g=$(Results.settings.elements.templates.error).html();""==g&&console.log("The error template could not be found: templateSelector=",Results.settings.elements.templates.error,"If you don't want to use this template, pass 'false' to the Results.settings.elements.templates.error user setting when calling Results.init()")}if(Results.settings.elements.templates.currentProduct){var h=$(Results.settings.elements.templates.currentProduct).html();""==h&&console.log("The current Product template could not be found: templateSelector=",Results.settings.elements.templates.currentProduct,"If you don't want to use this template, pass 'false' to the Results.settings.elements.templates.currentProduct user setting when calling Results.init()")}var i=Results.model.sortedProducts[0],j=!1,k=0,l=0;a=Results.model.sortedProducts,$.each(a,function(a,f){var m=null;if(Results.settings.paths.availability.product&&""!=Results.settings.paths.availability.product)var m=Object.byString(f,Results.settings.paths.availability.product);"undefined"==typeof m||"Y"===m||e?"undefined"!=typeof m&&"E"===m?(l++,b=$(Results.view.parseTemplate(g,f))):"undefined"!=typeof m&&"Y"!==m?(l++,b=$(Results.view.parseTemplate(e,f))):b=Results.model.currentProduct&&Results.model.currentProduct.value==Object.byString(f,Results.model.currentProduct.path)?$(Results.view.parseTemplate(h,f)):$(Results.view.parseTemplate(d,f)):(l++,b=$(Results.view.parseTemplate("<div></div>",f))),-1==$.inArray(f,Results.model.filteredProducts)?($row=$(b),$row.addClass("filtered"),$row.hide(),$row.attr("data-position","undefined")):($(b).addClass("notfiltered").attr("data-position",k),k++),$(b).attr("id","result-row-"+a).attr("data-sort",a),f==i&&(j="#result-row-"+a),c+=$(b)[0].outerHTML||(new XMLSerializer).serializeToString($(b)[0])}),Results.settings.show.hasOwnProperty("unavailableCombined")&&Results.settings.show.unavailableCombined===!0&&l>0&&(b=$(Results.view.parseTemplate(f,a)),c+=$(b)[0].outerHTML),$(Results.settings.elements.resultsContainer+" "+Results.settings.elements.container).append(c),Results.view.setTopResult($(j)),Results.view.toggleFrequency(Results.settings.frequency),$(Results.settings.elements.resultsContainer).trigger("resultsLoaded"),Results.pagination.refresh()},parseTemplate:function(a,b){return"microTemplate"==Results.settings.render.templateEngine?htmlString=parseTemplate(a,b):(htmlTemplate=_.template(a),htmlString=htmlTemplate(b)),htmlString},getRowHeight:function(){return"horizontal"!=Results.view.orientation||Results.view.rowHeight||(Results.view.rowHeight=$(Results.settings.elements.resultsContainer+" "+Results.settings.elements.rows+".notfiltered").first().outerHeight(!0)),Results.view.rowHeight},getRowWidth:function(){return"vertical"!=Results.view.orientation||Results.view.rowWidth||(Results.view.rowWidth=$(Results.settings.elements.resultsContainer+" "+Results.settings.elements.rows+".notfiltered").first().outerWidth(!0)),Results.view.rowWidth},setTopResult:function(a){Results.settings.show.topResult&&($(Results.settings.elements.rows).find(".topResult").remove(),$(a).prepend('<div class="topResult"></div>'),$(Results.settings.elements.resultsContainer).trigger("topResultSet"))},animateIndividualResults:function(){var a=Results.settings.animation.results.delay,b=Results.settings.animation.results.options.duration+Results.settings.animation.results.individual.delay;$(Results.settings.elements.rows).each(function(){a+=b,$(this).stop(!0,!0).delay(a).show(Results.settings.animation.results.options),b-Results.settings.animation.results.individual.acceleration>=0&&(b-=Results.settings.animation.results.individual.acceleration)})},animateAllResults:function(){$(Results.settings.elements.rows+".notFiltered").show(),$(Results.settings.elements.resultsContainer).css("opacity",0),$(Results.settings.elements.resultsContainer).stop(!0,!0).delay(Results.settings.animation.results.delay).animate({opacity:1},Results.settings.animation.results.options)},showResults:function(){Results.view.noResultsMode===!0&&(Results.view.noResultsMode=!1,Results.view.toggleFilters("show"),Results.view.toggleCompare("show"),$(Results.settings.elements.features.headers+", "+Results.settings.elements.resultsOverflow).show(),$(Results.settings.elements.resultsContainer).find(".noResults.clone").remove())},showNoFilteredResults:function(){Results.view.noResultsMode=!0,Results.view.toggleFilters("hide"),Results.view.toggleCompare("hide"),$(Results.settings.elements.features.headers+", "+Results.settings.elements.resultsOverflow).hide(),$(Results.settings.elements.resultsContainer).find(".noResults.clone").remove().end().append($(Results.settings.elements.noResults).clone().addClass("clone").stop(!0,!0).delay(500).fadeIn(800)),Results.pagination.reset()},showNoResults:function(){Results.view.noResultsMode=!0,Results.view.toggleFilters("hide"),Results.view.toggleCompare("hide"),Results.view.flush(),$(Results.settings.elements.features.headers).hide(),$(Results.settings.elements.resultsOverflow).hide(),$(Results.settings.elements.resultsContainer).find(".noResults.clone").remove(),$(Results.settings.elements.resultsContainer).append($(Results.settings.elements.noResults).clone().addClass("clone").stop(!0,!0).delay(500).fadeIn(800)),Results.pagination.reset()},shuffle:function(a){var b=$(Results.settings.elements.resultsContainer+" "+Results.settings.elements.rows);Results.settings.animation.shuffle.active===!0&&ResultsUtilities.position("absolute",b,Results.view.orientation),setTimeout(function(){"undefined"==typeof a&&(a=Results.model.returnedProducts.slice());var b=0,c=0,d=0,e=Results.view.getRowHeight(),f=Results.view.getRowWidth();$(Results.settings.elements.resultsContainer).trigger("results.view.animation.start"),$.each(Results.model.sortedProducts,function(g,h){var i;$.each(a,function(a,b){return h==b?(i=a,!1):void 0});var j=$(Results.settings.elements.resultsContainer+" "+Results.settings.elements.rows+"[data-productId='"+Object.byString(h,"productId")+"']"),k=g-i,l=!1;Results.settings.animation.shuffle.active===!0&&(l=Results.settings.animation.shuffle.options),Results.view.moveResult(j,g,k,b,c,l),Results.view.shuffleTransitionDuration||(Results.view.shuffleTransitionDuration=j.transitionDuration()),j.attr("data-sort",g),j.hasClass("notfiltered")?(g==d&&Results.view.setTopResult(j),b+=e,c+=f):d++});var g=0!=Results.view.shuffleTransitionDuration?Results.view.shuffleTransitionDuration:Results.settings.animation.shuffle.options.duration+50;$(Results.settings.elements.rows).clearQueue(Results.settings.animation.filter.queue).dequeue(Results.settings.animation.shuffle.options.queue),Results.view.afterAnimation(g,function(){$(Results.settings.elements.resultsContainer).trigger("resultsSorted"),"undefined"!=typeof meerkat&&meerkat.messaging.publish(Results.view.moduleEvents.RESULTS_SORTED),Results.pagination.invalidate(),Results.pagination.refresh(),$(Results.settings.elements.resultsContainer).trigger("results.view.animation.end")})},0)},filter:function(){Results.view.showResults(),Results.settings.animation.filter.active===!0&&Results.view.beforeAnimation();var a=!1,b=0,c=0,d=0,e=0,f=0,g=0,h=!1;if(Results.settings.animation.filter.active===!0&&(h=$.extend(Results.settings.animation.filter.reposition.options,{queue:Results.settings.animation.filter.queue})),"undefined"!=typeof Features&&Features.target!==!1){for(var i=[],j=0;j<Results.model.filteredProducts.length;j++){var k=Results.model.filteredProducts[j],l=Object.byString(k,Results.settings.paths.productId);i.push(Results.settings.elements.rows+"[data-productId='"+l+"'].filtered")}i.length>0&&($items=$(i.join(",")),$items.length>0&&($items.show(),Features.balanceVisibleRowsHeight(),$(Results.settings.elements.rows+".filtered").hide()))}if($.each(Results.model.sortedProducts,function(i,j){var k=Object.byString(j,Results.settings.paths.productId),l=$(Results.settings.elements.rows+"[data-productId='"+k+"']");if(-1==$.inArray(j,Results.model.filteredProducts))Results.view.fadeResultOut(l,Results.settings.animation.filter.active),g++;else{if(a||(a=!0,Results.view.setTopResult(l)),l.hasClass("filtered"))Results.view.fadeResultIn(l,b,Results.settings.animation.filter.active),f++;else{var m=l.attr("data-position");if(b!=m){var n=b-m;Results.view.moveResult(l,b,n,c,d,h),e++}}b++,c+=Results.view.getRowHeight(),d+=Results.view.getRowWidth()}Results.settings.animation.filter.active===!0&&(!Results.view.filterTransitionDuration||l.transitionDuration()>Results.view.filterTransitionDuration)&&(Results.view.filterTransitionDuration=l.transitionDuration())}),setTimeout(function(){Results.view.setDisplayMode(Results.settings.displayMode,"partial")},0),Results.settings.animation.filter.active===!0){$(Results.settings.elements.rows).clearQueue(Results.settings.animation.shuffle.options.queue).dequeue(Results.settings.animation.filter.queue);var m=0;if(0==e&&0==f&&0==g)m=1;else if(0!=Results.view.filterTransitionDuration)m=Results.view.filterTransitionDuration,m+=200;else{var n=new Array;0!=e&&n.push(Results.settings.animation.filter.reposition.options.duration),0!=f&&n.push(Results.settings.animation.filter.appear.options.duration),0!=g&&n.push(Results.settings.animation.filter.disappear.options.duration),$.each(n,function(a,b){b>m&&(m=b)}),m+=50}}else m=0;Results.view.afterAnimation(m,function(){$(Results.settings.elements.resultsContainer).trigger("resultsFiltered"),$(Results.settings.elements.resultsContainer+" "+Results.settings.elements.rows+".filtered").css("display","none"),Results.view.setDisplayMode(Results.settings.displayMode,"partial"),_.defer(function(){Results.pagination.invalidate(),Results.pagination.refresh(),$(Results.settings.elements.resultsContainer).trigger("results.view.animation.end")})})},beforeAnimation:function(){var a=$(Results.settings.elements.resultsContainer+" "+Results.settings.elements.rows);ResultsUtilities.position("absolute",a,Results.view.orientation),$(Results.settings.elements.resultsContainer).trigger("results.view.animation.start"),Results.view.disableDuringAnimation()},afterAnimation:function(a,b){var c=$(Results.settings.elements.resultsContainer+" "+Results.settings.elements.rows);setTimeout(function(){ResultsUtilities.position("relative",c),c.sort(function(a,b){var c=parseInt($(a).attr("data-sort")),d=parseInt($(b).attr("data-sort"));return d>c?-1:c>d?1:0}).each(function(){$(this).appendTo(Results.settings.elements.resultsContainer+" "+Results.settings.elements.container)}),0!==a&&(Modernizr.csstransforms3d?(c.removeClass("transformTransition").removeClass("opacityTransition").addClass("noTransformTransition").css(Modernizr.prefixed("transform"),""),setTimeout(function(){c.removeClass("noTransformTransition")},0)):Modernizr.csstransitions&&c.removeClass("leftTransition").removeClass("topTransition").removeClass("opacityTransition")),Results.view.enableAfterAnimation(),"function"==typeof b&&b()},a)},disableDuringAnimation:function(){"undefined"!=typeof Compare&&Compare.view.toggleButton("disable")},enableAfterAnimation:function(){"undefined"!=typeof Compare&&Compare.view.toggleButton("enable")},moveResult:function(a,b,c,d,e,f){var g=a.attr("data-position");if(g==b)return!0;if(a.attr("data-position",b),f!==!1)if(Modernizr.csstransitions)a.addClass("hardwareAcceleration"),_.defer(function(){"horizontal"==Results.view.orientation?(a.addClass("topTransition"),a.css("top",d)):(a.addClass("leftTransition"),a.css("left",e))}),_.delay(function(){a.removeClass("hardwareAcceleration")},f.duration+100);else{var h=new Object;h="horizontal"==Results.view.orientation?{top:d}:{left:e},a.animate(h,f)}else"horizontal"==Results.view.orientation?a.css("top",d):a.css("left",e)},fadeResultIn:function(a,b,c){if("vertical"==Results.view.orientation?a.css("left",b*Results.view.getRowWidth()):a.css("top",b*Results.view.getRowHeight()),c===!0)if(Modernizr.csstransitions)a.addClass("hardwareAcceleration"),a.addClass("opacityTransition").css("display","block"),setTimeout(function(){a.removeClass("filtered").addClass("notfiltered")},0),_.delay(function(){a.removeClass("hardwareAcceleration")},1e3);else{a.removeClass("filtered").addClass("notfiltered");var d=$.extend(Results.settings.animation.filter.appear.options,{queue:Results.settings.animation.filter.queue});a.fadeIn(d)}else a.removeClass("filtered").addClass("notfiltered"),a.css("display","block");a.attr("data-position",b)},fadeResultOut:function(a,b){if(b===!0)if(Modernizr.csstransitions)a.addClass("hardwareAcceleration"),a.addClass("opacityTransition").addClass("filtered").removeClass("notfiltered"),_.delay(function(){a.removeClass("hardwareAcceleration")},1e3);else{var c=$.extend(Results.settings.animation.filter.disappear.options,{queue:Results.settings.animation.filter.queue,complete:function(){$(this).addClass("filtered").removeClass("notfiltered")}});a.fadeOut(c)}else a.addClass("filtered").removeClass("notfiltered");a.attr("data-position","undefined")},showResultsPage:function(){Results.settings.runShowResultsPage!==!1&&($(Results.settings.elements.page).is(":visible")||($("body, html").animate({scrollTop:0},500),Results.view.toggleReferenceNo(),$(Results.settings.formSelector).find(":input").removeAttr("data-visible"),$(Results.settings.formSelector).find(":input:visible, .ui-dialog :input, .force-invisible-select :input").attr("data-visible","true"),$("#page").length>0&&$("#page").slideUp("fast",function(){$(Results.settings.elements.page).show(),Results.view.toggleHeaderSize(),Results.view.toggleProgressBar(),Results.view.toggleResultsSummary()}),"undefined"!=typeof btnInit&&btnInit._show()))},hideResultsPage:function(){$(Results.settings.elements.page).is(":visible")&&($("body, html").scrollTop(0),Results.view.toggleHeaderSize(),Results.view.toggleProgressBar(),Results.view.toggleReferenceNo(),Results.view.toggleFilters("hide"),Results.view.toggleCompare("hide"),Results.view.toggleResultsSummary(),$("#page").length>0&&($("#page").slideDown(300),$(Results.settings.elements.page).hide()),$(Results.settings.elements.resultsContainer+" "+Results.settings.elements.container).css("margin-left",0),Results.pagination.reset(),$(Results.settings.elements.page+" .resultsOverlay").hide(0))},toggleResultsPage:function(){$(Results.settings.elements.page).is(":visible")?Results.view.hideResultsPage():Results.view.showResultsPage()},toggleProgressBar:function(){$("#steps").toggle(0)},toggleReferenceNo:function(){"undefined"!=typeof referenceNo&&referenceNo.showReferenceNumber&&$(referenceNo.elements.root).slideToggle(200)},toggleCompare:function(a){"undefined"!=typeof Compare&&(a&&"hide"==a?$(Compare.settings.elements.bar).hide():a&&"show"==a?$(Compare.settings.elements.bar).fadeIn(400,function(){Compare.topPosition=$(Compare.settings.elements.bar).offset().top}):($(Compare.settings.elements.bar).toggle(0),Compare.topPosition=$(Compare.settings.elements.bar).offset().top))},toggleFilters:function(a){"undefined"!=typeof Filters&&(a&&"hide"==a?$(Filters.settings.elements.filtersBar).hide():a&&"show"==a?$(Filters.settings.elements.filtersBar).fadeIn():$(Filters.settings.elements.filtersBar).toggle(0))},toggleHeaderSize:function(){$("#header").hasClass("normal-header")?($("#header").removeClass("normal-header"),$("#header").addClass("narrow-header")):($("#header").removeClass("narrow-header"),$("#header").addClass("normal-header"))},toggleResultsSummary:function(){$("#resultsDes").hide(),0===$("#navContainer #summary-header").length?($("#summary-header").prependTo("#navContainer"),$("#summary-header").show()):$("#summary-header").toggle()},toggleFrequency:function(a){try{$(Results.settings.elements.frequency).hide(),$("."+a+Results.settings.elements.frequency).show()}catch(b){Results.onError("Sorry, an error occurred toggling frequencies","ResultsView.js","Results.view.toggleFrequency(); "+b.message,b)}},flush:function(){$(Results.settings.elements.rows).empty().remove()}},Features=new Object,Features={template:!1,target:!1,results:!1,featuresIds:!1,emptyAdditionalInfoCategory:!0,init:function(a){"undefined"==typeof a?Features.target=Results.settings.elements.resultsContainer:Features.target=a,"undefined"!=typeof meerkat&&meerkat.messaging.subscribe(meerkat.modules.events.device.STATE_CHANGE,function(a){"features"===Results.getDisplayMode()&&$(Results.settings.elements.resultsContainer+" :visible").length>0&&(Results.view.calculateResultsContainerWidth(),Features.clearSetHeights(),Features.balanceVisibleRowsHeight())}),Features.applyExpandableEvents()},buildHtml:function(a){"undefined"==typeof a?Features.results=Results.model.sortedProducts:Features.results=a,Features.template=$(Results.settings.elements.templates.feature).html(),""==Features.template?console.log("The comparison feature template could not be found: templateSelector=",Compare.settings.elements.templates.feature,"This template is mandatory, make sure to pass the correct selector to the Compare.settings.elements.templates.feature user setting when calling Compare.init()"):($(Results.settings.elements.resultsContainer).trigger("populateFeaturesStart"),Features.populateHeaders(),Features.populateFeatures(),Features.setExpandableRows(),_.defer(function(){Features.clearSetHeights(),Features.balanceVisibleRowsHeight(),$(Results.settings.elements.resultsContainer).trigger("populateFeaturesEnd")}),Features.hideEmptyRows(),$(Features.target).trigger("FeaturesRendered"))},populateHeaders:function(){if(Results.settings.render.features.headers===!0){Features.emptyAdditionalInfoCategory=!0;var a=new Array,b="";$.each(Features.results,function(c,d){var e=null;if(Results.settings.paths.availability.product&&""!=Results.settings.paths.availability.product)var e=Object.byString(d,Results.settings.paths.availability.product);if("Y"==e||"undefined"==typeof e){var f=Object.byString(d,Results.settings.paths.features);if("undefined"!=typeof f&&f.length>0){var g="";$.each(f,function(c,d){if(Features.emptyAdditionalInfoCategory&&9==d.categoryId&&""!=d.extra&&(Features.emptyAdditionalInfoCategory=!1),-1==$.inArray(d.featureId,a)){a.push(d.featureId),Results.settings.show.featuresCategories&&g!=d.categoryId&&(parsedCategory=Results.view.parseTemplate(Features.template,{value:d.categoryName,featureId:"category-"+d.categoryId,extra:"",cellType:"category"}),b+=parsedCategory,g=d.categoryId),isNaN(d.desc)||(d.desc="");var e=Results.view.parseTemplate(Features.template,{featureId:d.featureId,value:d.desc,extra:"&nbsp;",cellType:"feature"});b+=e}})}}}),$(Features.target+" "+Results.settings.elements.features.headers+" "+Results.settings.elements.features.list).html(b),Features.featuresIds=a}},populateFeatures:function(){$.each(Features.results,function(a,b){var c=null;if(Results.settings.paths.availability.product&&""!=Results.settings.paths.availability.product)var c=Object.byString(b,Results.settings.paths.availability.product);if(!("Y"!=c&&"undefined"!=typeof c||Results.model.currentProduct&&Results.model.currentProduct.value==Object.byString(b,Results.model.currentProduct.path))){var d=Object.byString(b,Results.settings.paths.productId),e=$(Features.target+" "+Results.settings.elements.rows+"[data-productId='"+d+"']").find(Results.settings.elements.features.list),f="";f="populate"==Results.settings.render.features.mode?Features.populateTemplate(b):Features.buildAndPopulateTemplate(b),e.html(f)}}),Features.emptyAdditionalInfoCategory&&$(Features.target+" [data-featureId=category-9]").next().remove().end().remove()},populateTemplate:function(a){var b=$(Results.settings.elements.templates.feature).html();return Results.view.parseTemplate(b,a)},buildAndPopulateTemplate:function(a){var b="",c="";return $.each(Features.featuresIds,function(d,e){var f=Object.byString(a,Results.settings.paths.features),g=!1,h="";if($.each(f,function(a,b){return b.featureId==e?(g=b,b.value=Features.parseFeatureValue(b.value),""==b.extra&&(b.extra="&nbsp;"),""==b.value&&""!=b.extra&&(b.value=b.extra,b.extra="&nbsp;"),h=Results.view.parseTemplate(Features.template,$.extend(b,{cellType:"feature"})),!1):void 0}),g)Results.settings.show.featuresCategories&&c!=g.categoryId&&(parsedCategory=Results.view.parseTemplate(Features.template,{value:"&nbsp;",featureId:"category-"+g.categoryId,extra:"",cellType:"category"}),b+=parsedCategory,c=g.categoryId);else var h=Results.view.parseTemplate(Features.template,{value:"&nbsp;",featureId:e,extra:"",cellType:"feature"});b+=h}),b},parseFeatureValue:function(a){if("undefined"==typeof a||""===a)a="&nbsp;";else{var b=_.findWhere(Results.settings.dictionary.valueMap,{key:a});"undefined"!=typeof b&&(a=b.value)}return a},setExpandableRows:function(){0==$(Features.target+" .expandable").length&&$(Features.target+" "+Results.settings.elements.rows+".notfiltered "+Results.settings.elements.features.extras+" "+Results.settings.elements.features.values).filter(function(){return"&nbsp;"!=$(this).html()&&""!=$(this).html()}).parent().parent().addClass(Results.settings.elements.features.expandable.replace(/[#\.]/g,""))},applyExpandableEvents:function(){var a=Features.target+" .expandable > "+Results.settings.elements.features.values;$(document.body).off("click",a).on("click",a,function(a){var b=$(this).attr("data-featureId"),c=$(Features.target+' .children[data-fid="'+b+'"]'),d=c.parent();d.hasClass("expanded")===!1?Features.toggleOpen(c,d):Features.toggleClose(d)}).on("click",".expandAllFeatures, .collapseAllFeatures",function(a){a.preventDefault(),$(this).parent().find(".active").removeClass("active"),$(this).addClass("active");var b=$(Features.target+" .children[data-fid]"),c=b.parent();$(this).hasClass("expandAllFeatures")?Features.toggleOpen(b,c):Features.toggleClose(c)})},toggleClose:function(a){a.removeClass("expanded").addClass("collapsed")},toggleOpen:function(a,b){_.defer(function(){b.removeClass("collapsed").addClass("expanding"),_.defer(function(){Features.sameHeightRows(a.find(Results.settings.elements.features.values)),b.removeClass("expanding").addClass("expanded")})})},clearSetHeights:function(){$(Features.target+" "+Results.settings.elements.features.values).removeClass(function(a,b){return(b.match(/\height\S+/g)||[]).join(" ")}),$(Features.target+" "+Results.settings.elements.features.values).css("height","")},balanceVisibleRowsHeight:function(){if(Features.target!==!1&&("function"!=typeof Results.getDisplayMode||"price"!=Results.getDisplayMode())){var a=$(Features.target+" "+Results.settings.elements.features.values+":visible");Features.sameHeightRows(a)}},sameHeightRows:function(a){function b(a){return a.hasClass("isMultiRow")||a.hasClass("h")?a.innerHeight():0}var c=[];a.each(function(a,d){var e=$(d),f=e.attr("data-featureId"),g=_.findWhere(c,{featureId:f});if("undefined"!=typeof g)g.height=Math.max(b(e),g.height),g.elements.push(e);else{var h={};h.featureId=f,h.height=b(e),h.elements=[],h.elements.push(e),c.push(h)}});for(var d=0;d<c.length;d++)for(var e=c[d],f=0;f<e.elements.length;f++){var g=e.elements[f],h=10*Math.ceil(e.height/10);"undefined"!=typeof meerkat&&("car"==meerkat.site.vertical||"home"==meerkat.site.vertical)&&(h-=5),270>=h?g.addClass("height"+h):g.height(e.height)}},hideEmptyRows:function(){var a=$(Features.target);$.each(Features.featuresIds,function(b,c){var d=!1,e=$('[data-featureId="'+c+'"]',a);e.each(function(){var a=$.trim($(this).text());return d||""==a||"&nbsp;"==a?void 0:void(d=!0)}),d||e.parent().hide()})},removeEmptyDropdowns:function(){var a=$(Features.target);$.each(Features.featuresIds,function(b,c){var d=!1,e=$('.children[data-fid="'+c+'"]',a);e.each(function(){var a=$.trim($(this).text());return d||""==a||"&nbsp;"==a?void 0:void(d=!0)}),d||e.closest(".cell").off("mousenter mousemove").removeClass("expandable").end().remove()})},flush:function(){$(Features.target).find(Results.settings.elements.features.list).html("")}},function(a,b){function c(a){window.location.hash=a,l=a}function d(a){o.defaultHash=a,l=a}function e(a){-1==_.indexOf(i(),a)&&(window.location.hash=k()+"/"+a,l=window.location.hash)}function f(){return l}function g(a){for(var b=m.modules.address.getWindowHashAsArray(),c=b.length-1;c>=0;c--)b[c]==a&&b.splice(c,1);window.location.hash=b.join("/")}function h(){a(window).on("hashchange",function(a){m.messaging.publish(n.ADDRESS_CHANGE,{previousHash:m.modules.address.getPreviousHash(),hash:m.modules.address.getWindowHash(),hashArray:m.modules.address.getWindowHashAsArray()})})}function i(){return k().split("/")}function j(a){var b=i();return a>=b.length?"":b[a]}function k(){var a=window.location.hash;return null!=a?a.replace("#",""):""}var l,m=window.meerkat,n=(m.logging.info,{ADDRESS_CHANGE:"ADDRESS_CHANGE"}),o={defaultHash:""};m.modules.register("address",{init:h,events:n,getWindowHashAsArray:i,getWindowHash:k,getPreviousHash:f,setHash:c,appendToHash:e,removeFromHash:g,setStartHash:d,getWindowHashAt:j})}(jQuery),function(a,b){function c(){g.messaging.subscribe(h.autocomplete.ELASTIC_SEARCH_COMPLETE,function(a){d(a)})}function d(b){if(f=b.addressFieldId,dpId=b.dpid,k&&(k.abort(),k=null),l.hasOwnProperty(dpId))e(l[dpId]);else{var c=a(".journeyNavButton");"home"!=g.site.vertical&&(g.modules.loadingAnimation.showInside(c),g.messaging.publish(g.modules.events.WEBAPP_LOCK,{source:"address_lookup"})),"undefined"!=typeof dpId&&""!==dpId&&(k=g.modules.comms.post({url:"address/get.json",errorLevel:"mandatory",data:{dpId:dpId},onSuccess:function(a){l[dpId]=a,e(a),"undefined"==typeof a.dpId||""===a.dpId?g.modules.errorHandling.error({page:"elastic_search.js",errorLevel:"slient",description:"Could not find address with dpId of "+dpId,data:a}):g.messaging.publish(j.HIDDEN_FIELDS_POPULATED,{addressData:a})},onError:function(b,c){"abort"!==c&&(g.modules.errorHandling.error({page:"elastic_search.js",errorLevel:"warning",description:"Something went wrong and the elastic address lookup failed for "+dpId,message:"Sorry, there was a problem loading your address details, please try again.",data:b}),"home"==g.site.vertical&&g.modules.journeyEngine.gotoPath("start"),a("#"+f+"_nonStd").trigger("click").prop("checked",!0))},onComplete:function(){g.messaging.publish(g.modules.events.WEBAPP_UNLOCK,{source:"address_lookup"}),g.modules.loadingAnimation.hide(c)}}))}}function e(b){for(var c in b){var d=a("#"+f+"_"+c);d.val(b[c]).trigger("change")}}var f,g=window.meerkat,h=g.modules.events,i=(g.logging.info,{address_lookup:{HIDDEN_FIELDS_POPULATED:"HIDDEN_FIELDS_POPULATED"}}),j=i.address_lookup,k=null,l={};g.modules.register("address_lookup",{init:c,events:i})}(jQuery),function(a,b){function c(b){b.each(function(b,c){$item=a(c),$item.affix({offset:{top:function(){var b=$item.offset().top,c=$item.attr("data-affix-after");return c&&a(c).length?(b=a(c).offset().top,$item.is(":visible")&&(this.top=b)):this.top=b,b}}}),$item.on("affixed.bs.affix",function(a){e.messaging.publish(h.AFFIXED,$item)}),$item.on("affixed-top.bs.affix",function(a){e.messaging.publish(h.UNAFFIXED,$item)})})}function d(){e.messaging.subscribe(f.journeyProgressBar.INIT,function(b){if("xs"===e.modules.deviceMediaState.get())var d=e.messaging.subscribe(f.device.STATE_LEAVE_XS,function(){e.messaging.unsubscribe(d),c(a(".navbar-affix"))});else c(a(".navbar-affix"))})}var e=window.meerkat,f=e.modules.events,g=(window.meerkat.logging.info,{affix:{AFFIXED:"CORE_AFFIX_AFFIXED",UNAFFIXED:"CORE_AFFIX_UNAFFIXED"}}),h=g.affix;e.modules.register("affix",{init:d,events:g})}(jQuery),function(a,b){function c(){i=a("#health_searchDate").val();var b=i.split("/"),c=b[2]+"-"+b[1]+"-"+b[0];k.applicationDateOverrideValue=""!==i?c+" 00:00:01":null,j.modules.comms.post({url:"ajax/write/setApplicationDate.jsp",data:k,cache:!1,errorLevel:"warning",onSuccess:function(a){f(a),g()}})}function d(){j.modules.comms.post({url:"ajax/load/getApplicationDate.jsp",cache:!1,errorLevel:"warning",onSuccess:function(a){e(a)}})}function e(b){if(null!==b&&""!==b){var c=new Date(b.replace(/ [A]?EST/,"")),d=j.modules.utils.returnDateValueFormFormat(c);a("#health_searchDate").val(d)}}function f(a){l.applicationDate.html(a)}function g(){""===l.applicationDate.html()?l.applicationDateContainer.hide():l.applicationDateContainer.show()}function h(){jQuery(document).ready(function(a){0===a(".simples").length&&d(),a("#health_searchDate").on("change",function(){c()}),g()})}var i,j=window.meerkat,k=(j.modules.events,j.logging.info,{}),l={applicationDate:a(".applicationDate"),applicationDateContainer:a(".applicationDateContainer")},m={};j.modules.register("application_date",{init:h,events:m,changeApplicationDate:c,setApplicationDateCalendar:d})}(jQuery),function(a,b){function c(){a(document).ready(function(){e()})}function d(b){return"Y"===a("#"+b+"_elasticSearch").val()}function e(){var b=a("input.typeahead"),c=null;b.each(function(){var b,e=a(this),i=e.attr("id"),k=i.match(/(_)[a-zA-Z]{1,}$/g),l=i.replace(k,""),m=d(l);e.data("addressfieldid",l),m?(b="address/search.json",c={name:e.attr("name"),remote:{beforeSend:function(c,d){f(e),c.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),d.type="POST",d.hasContent=!0,d.url=b;var g=a("#"+l+"_autofilllessSearch"),h=g.val();d.data=a.param({query:decodeURI(h)})},filter:function(a){return g(e),a},url:b,error:function(b,c){j.modules.errorHandling.error({page:"autocomplete.js",errorLevel:"warning",title:"Address lookup failed",message:"<p>Sorry, we are having troubles connecting to our address servers.</p><p>Please manually enter your address.</p>",description:"Could not connect to the elastic search.json",data:b}),a("#"+l+"_nonStd").trigger("click").prop("checked",!0),g(e)}},limit:150}):"countrySelectionList"==e.attr("data-varname")?c=j.modules.travelCountrySelector.getCountrySelectorParams(e):(b=e.attr("data-source-url"),c={name:e.attr("name"),remote:{beforeSend:function(){f(e)},filter:function(a){return g(e),a},url:e.attr("data-source-url")+"%QUERY"},limit:150}),c=h(e,c),e.typeahead(c),e.hasClass("input-lg")&&e.prev(".tt-hint").addClass("hint-lg"),e.hasClass("input-sm")&&e.prev(".tt-hint").addClass("hint-sm"),e.hasClass("blur-on-select")&&e.bind("typeahead:selected",function(a,b,c){b.hasOwnProperty("value")&&"Type your address..."===b.value||a&&a.target&&a.target.blur&&a.target.blur()})})}function f(a){a.hasClass("show-loading")&&j.modules.loadingAnimation.showInside(a.parent(".twitter-typeahead"))}function g(a){a.hasClass("show-loading")&&j.modules.loadingAnimation.hide(a.parent(".twitter-typeahead"))}function h(b,c){if(b&&b.hasClass("typeahead-address")){var e=b.data("addressfieldid"),f=d(e);c.remote.url=b.attr("id"),c.remote.replace=i,c.valueKey="value",c.template=_.template("<p>{{= highlight }}</p>"),(b.hasClass("typeahead-autofilllessSearch")||b.hasClass("typeahead-streetSearch"))&&(c.remote.filter=function(c){return g(b),f&&a.each(c,function(a,b){b.hasOwnProperty("text")&&b.hasOwnProperty("payload")&&(b.value=b.text,b.highlight=b.text,b.dpId=b.payload)}),c.push({value:"Type your address...",highlight:"Can't find your address? <u>Click here.</u>"}),c},b.bind("typeahead:selected",function(a,c,d){if(c.hasOwnProperty("value")&&"Type your address..."===c.value){var g="";f||a.target&&a.target.id&&(g=a.target.id.replace("_streetSearch","")),j.messaging.publish(l.CANT_FIND_ADDRESS,{fieldgroup:g})}else f&&(j.messaging.publish(l.ELASTIC_SEARCH_COMPLETE,{dpid:c.dpId,addressFieldId:e}),b.valid())}))}return c}function i(b,c){var d=a("#"+b);return b="",d.trigger("getSearchURL"),d.data("source-url")&&(b=d.data("source-url")),b}var j=window.meerkat,k=(j.modules.events,j.logging.info,{autocomplete:{CANT_FIND_ADDRESS:"EVENT_CANT_FIND_ADDRESS",
ELASTIC_SEARCH_COMPLETE:"ELASTIC_SEARCH_COMPLETE",INIT:"INIT"}}),l=k.autocomplete;j.modules.register("autocomplete",{init:c,events:k,autocompleteBeforeSend:f,autocompleteComplete:g})}(jQuery),function(a,b){function c(){jQuery(document).ready(function(a){d()}),s.subscribe(r.modules.events.contactDetails.name.FIELD_CHANGED,function(b){I="undefined"!=typeof b.$otherField?1===b.fieldIndex?a.trim(b.$field.val()+" "+b.$otherField.val()):a.trim(b.$otherField.val()+" "+b.$field.val()):b.$field.val()}),s.subscribe(r.modules.events.contactDetails.mobile.FIELD_CHANGED,function(a){J=a.$field.val()}),s.subscribe(r.modules.events.contactDetails.otherPhone.FIELD_CHANGED,function(a){K=a.$field.val()}),s.subscribe(u.VALID,p),s.subscribe(u.INVALID,q)}function d(){v=a(w),x=a(y),z=a(A),B=a(C),v.off("keyup").on("keyup",f),x.off("keyup").on("keyup",f),x.off("focusout").on("focusout",function(){a(this).siblings("[type=hidden]").val(a(this).val().replace(/[^0-9]+/g,""))}),z.off("change").on("change",f),D=a(".call-me-back-submit"),F=a(".call-me-back-form"),D.off("click").on("click",function(){g(a(this).parents("form").first())}),o()}function e(a){null!==I&&a.find(w).val(I),null!==J?a.find(y).val(J):null!==K&&a.find(y).val(K)}function f(){n(a(this).parents("form").first());var b=""!==E.find(v).val(),c=""!==E.find(x).val(),d=""!==E.find(z).val();b&&c&&d&&E.valid()?s.publish(u.VALID):s.publish(u.INVALID)}function g(b){if(n(b),(!G||"pending"!==G.state())&&E.valid()&&!H){E.find(C).val("Y");var c=[],d=r.modules.form.getData(E),e=r.modules.journeyEngine.getFormData();c=d.concat(e),c.push({name:"quoteType",value:r.site.vertical}),s.publish(u.INVALID),r.modules.loadingAnimation.showAfter(D),G=r.modules.comms.post({url:"ajax/write/request_callback.jsp",data:c,dataType:"json",cache:!1,errorLevel:"silent",onSuccess:function(b){H=!0,r.messaging.publish(u.REQUESTED,{phone:E.find(x).val(),name:E.find(v).val()}),i(),j();var c=a("#mainform");E.find(":input").each(function(){$this=a(this),r.modules.form.appendHiddenField(c,$this.attr("name"),$this.val())}),r.modules.form.appendHiddenField(c,r.site.vertical+"_callmeback_time",b.time),r.modules.form.appendHiddenField(c,r.site.vertical+"_callmeback_date",b.date),0===a("#requested_callmeback_time").length&&r.modules.form.appendHiddenField(c,"requested_callmeback_time",b.time),0===a("#requested_callmeback_date").length&&r.modules.form.appendHiddenField(c,"requested_callmeback_date",b.date)},onError:function(){i(),k(),s.publish(u.VALID)},onComplete:function(){r.modules.loadingAnimation.hide(D)}})}}function h(){return H}function i(){F.each(function(){a(this).hide()})}function j(){F.each(function(){a(this).after(l())})}function k(){F.each(function(){a(this).after('<form class="callmeback-feedback"><h5>Call back service offline</h5><p>Sadly our call back service is offline - Please try again later.</p></form>')})}function l(){return'<form class="callmeback-feedback"><h5>Someone will call you</h5><p>Thank you, a member of our staff will call you in the '+m(E.find(z).val())+"</p></form>"}function m(a){switch(a){case"M":time="morning";break;case"A":time="afternoon";break;default:time="evening (excludes WA)"}return time}function n(a){E=a}function o(){F.each(function(){setupDefaultValidationOnForm(a(this))}),v.length>0&&v.add("rules",{required:!0,messages:{required:"Please enter your name"}}),x.length>0&&x.add("rules",{validateTelNo:!0,messages:{validateTelNo:"Please enter the contact number in the format (area code)(local number) for landline or 04xxxxxxxx for mobile"}}),z.length>0&&z.add("rules",{required:!0,messages:{required:"Please select when you want us to call you back"}})}function p(){null!==E&&E.find(D).removeClass("disabled")}function q(){null!==E&&E.find(D).addClass("disabled")}var r=window.meerkat,s=(r.modules.events,r.logging.info,r.messaging),t={callMeBack:{REQUESTED:"CALL_ME_BACK_REQUESTED",VALID:"CALL_ME_BACK_VALID",INVALID:"CALL_ME_BACK_INVALID"}},u=t.callMeBack,v=null,w=".callmeback_name",x=null,y=".callmeback_phone",z=null,A=".callmeback_timeOfDay",B=null,C=".callmeback_optin",D=null,E=null,F=null,G=null,H=!1,I=null,J=null,K=null;r.modules.register("callMeBack",{init:c,events:t,hasCallbackBeenRequested:h,prefillForm:e,updateSelectedElements:d,submitCallMeBack:g})}(jQuery),function(a,b){function c(){jQuery(document).ready(function(a){$modalContent=a("#callMeBackModalContent"),$openButton=a("#callMeBackTabButton"),$openButton.on("click",d)}),k.subscribe(j.callMeBack.VALID,f),k.subscribe(j.callMeBack.INVALID,g),k.subscribe(j.callMeBack.REQUESTED,h)}function d(){var b=i.modules.dialogs.show({title:"Get a call back",htmlContent:$modalContent.html(),buttons:[{label:isRequested?"Close":"Cancel",className:"btn-cancel modal-call-me-back-close",closeWindow:!0},{label:"Call me",className:"btn-cta disabled modal-call-me-back-submit"+(isRequested?" displayNone":""),action:e}],onClose:function(){$openButton.fadeIn()}});$currentCallMeBackModal=a("#"+b),i.modules.callMeBack.updateSelectedElements(),i.modules.callMeBack.prefillForm($currentCallMeBackModal.find("form")),$currentCallMeBackModal.find("h5").hide(),$currentCallMeBackModal.find(".call-me-back-submit").hide(),$openButton.fadeOut();var c=$currentCallMeBackModal.find(".callmeback_name"),d=$currentCallMeBackModal.find(".callmeback_phone");""===c.val()?c.focus():""===d.val()?d.focus():$currentCallMeBackModal.find(".callmeback_timeOfDay").focus()}function e(){i.modules.callMeBack.submitCallMeBack($currentCallMeBackModal.find("form"))}function f(){null!==$currentCallMeBackModal&&$currentCallMeBackModal.find(".modal-call-me-back-submit").removeClass("disabled")}function g(){null!==$currentCallMeBackModal&&$currentCallMeBackModal.find(".modal-call-me-back-submit").addClass("disabled")}function h(){isRequested=!0,null!==$currentCallMeBackModal&&($currentCallMeBackModal.find(".modal-call-me-back-submit").hide(),$currentCallMeBackModal.find(".modal-call-me-back-close").html("Close"))}var i=window.meerkat,j=i.modules.events,k=i.messaging,l=(i.logging.info,{callMeBackTab:{}});l.callMeBackTab;$currentCallMeBackModal=null,isRequested=!1,i.modules.register("callMeBackTab",{init:c})}(jQuery),function(a,b){function c(){a(document).ready(d)}function d(){$forms=a("html.lt-ie9 form, html.lt-ie9 #dynamic_dom"),$forms.length&&($forms.off("change.checkedForIE").on("change.checkedForIE",".checkbox input, .compareCheckbox input",function(){var b=a(this);b.is(":checked")?b.addClass("checked"):b.removeClass("checked")}),$forms.find(".checkbox input").change())}var e=window.meerkat;e.modules.events;e.modules.register("checkboxIE8",{init:c,support:d})}(jQuery),function(a,b){function c(b){o=_.pick(b,"dateField","getResults","updateData"),a(document).ready(function(){!_.isEmpty(o.dateField)&&a(o.dateField)&&_.isFunction(o.getResults)&&(j.messaging.subscribe(p.commencementDate.COMMENCEMENT_DATE_UPDATED,d),j.messaging.subscribe(k.emailLoadQuote.TRIGGERS_MODAL,f),a(o.dateField).attr("data-attach","true"))})}function d(b){alert(b),a(o.dateField).datepicker("update",b),_.defer(function(){e(b)})}function e(b){var c=a("#expired-commencement-date-template");c.length>0&&(templateCallback=_.template(c.html()));var d={updatedDate:b},e=templateCallback(d),f={htmlContent:e,hashId:"call",className:"expired-commencement-date-modal",closeOnHashChange:!0,openOnHashChange:!1,onOpen:function(a){}};_.defer(function(){callbackModalId=j.modules.dialogs.show(f)})}function f(a){_.isFunction(o.updateData)&&o.updateData(a),_.defer(_.bind(g,this,a))}function g(b){j.messaging.subscribe(k.device.STATE_ENTER_XS,_.bind(i,this,!0)),j.messaging.subscribe(k.device.STATE_LEAVE_XS,_.bind(i,this,!1));var c=a("#edit-details-template");c.length>0&&(templateCallback=_.template(c.html()));var d=a(o.dateField).val(),e=templateCallback(b),f={htmlContent:'<div class="edit-details-wrapper expired-quote"></div>',hashId:"expiredCommencementDate",className:"edit-details-modal",closeOnHashChange:!1,openOnHashChange:!1,onOpen:function(b){m=b,l=!0;var c=a(".edit-details-wrapper",a("#"+b));c.html(e),j.modules.contentPopulation.render("#"+b+" .edit-details-wrapper"),a(".accordion-collapse").on("show.bs.collapse",function(){a(this).prev(".accordion-heading").addClass("active-panel")}).on("hide.bs.collapse",function(){a(this).prev(".accordion-heading").removeClass("active-panel")}),$form=a("#modal-commencement-date-form"),setupDefaultValidationOnForm($form),a(o.dateField+"_mobile").attr("data-msg-required","Commencement date required"),a(o.dateField+"_mobile option:first").remove(),a("#modal-commencement-date-get-quotes").on("click",function(b){b.preventDefault();var c=a(this);$form.valid()&&(a(o.dateField).datepicker("update",a(o.dateField+"_mobile").val()),j.modules.dialogs.close(m),"results"===j.modules.journeyEngine.getCurrentStep().navigationId&&d!=a(o.dateField).val()&&(_.isUndefined(Results.getAjaxRequest())||Results.getAjaxRequest()===!1||4===Results.getAjaxRequest().readyState||200===Results.getAjaxRequest().status?o.getResults():(c.addClass("disabled"),n=j.messaging.subscribe(k.commencementDate.RESULTS_RENDER_COMPLETED,h))))}),c.find("a.btn-edit").on("click",function(b){b.preventDefault(),"results"!==j.modules.journeyEngine.getCurrentStep().navigationId||_.isUndefined(Results.getAjaxRequest())||Results.getAjaxRequest()===!1||4===Results.getAjaxRequest().readyState||200===Results.getAjaxRequest().status||Results.getAjaxRequest().abort(),j.modules.dialogs.close(m),j.modules.journeyEngine.gotoPath(a(this).attr("href").substring(1))}),"xs"===j.modules.deviceMediaState.get()?c.show():c.find(".accordion-collapse").addClass("in").end().show()},onClose:function(b){a(o.dateField).datepicker("update",a(o.dateField+"_mobile").val()),m=!1}};j.modules.dialogs.show(f)}function h(){j.messaging.unsubscribe(k.commencementDate.RESULTS_RENDER_COMPLETED,n),_.defer(o.getResults)}function i(b){if(b=b||!1,m!==!1&&j.modules.dialogs.isDialogOpen(m)){var c=a(".edit-details-wrapper",a("#"+m));b===!0?(c.find(".accordion-collapse").not(".expired-panel").removeClass("in"),c.find(".accordion-heading.active-panel").next(".accordion-collapse").addClass("in")):c.find(".accordion-collapse").each(function(){$that=a(this),$that.addClass("in").css({height:"auto"})})}}var j=window.meerkat,k=j.modules.events,l=(j.logging.info,!1),m=!1,n=!1,o={dateField:null,getResults:null,updateData:null,renderCompletedEvent:null},p={commencementDate:{COMMENCEMENT_DATE_UPDATED:"COMMENCEMENT_DATE_UPDATED",RESULTS_RENDER_COMPLETED:"RESULTS_RENDER_COMPLETED"}};j.modules.register("commencementDate",{initCommencementDate:c,events:p})}(jQuery),function(a,b){function c(a){return e("POST",a)}function d(a){return e("GET",a)}function e(b,c){var d=a.extend({},r,c);("undefined"==typeof c.errorLevel||null===c.errorLevel)&&console.error("Message to dev: please provide an errorLevel to the comms.post() or comms.get() function.");var e=i(d);if(e===!0){var g=h(d);return a.Deferred(function(a){return null!=d.onSuccess&&d.onSuccess(g.result),null!=d.onComplete&&d.onComplete(),a.resolveWith(this,[g.result]).promise()})}return d.attemptsCounter=1,f(d,{url:d.url,data:d.data,dataType:d.dataType,type:b,timeout:d.timeout})}function f(b,c){var d=n.modules.transactionId.get();try{null==c.data&&(c.data={}),_.isString(c.data)?(c.data+="&transactionId="+d,n.site.isCallCentreUser&&(c.data+="&"+q+"=true")):_.isArray(c.data)?(c.data=a.merge([],b.data),-1===_.indexOf(c.data,"transactionId")&&c.data.push({name:"transactionId",value:d}),n.site.isCallCentreUser&&c.data.push({name:q,value:!0})):_.isObject(c.data)&&(c.data=a.extend(!0,{},b.data),c.data.hasOwnProperty("transactionId")===!1&&(c.data.transactionId=d),n.site.isCallCentreUser&&(c.data[q]=!0))}catch(e){}var f=a.ajax(c),h=f.then(function(a,d,e){var f="undefined"!=typeof b.data?b.data:null;j(a)===!0?l(e,"Server generated error",k(a),b,f,c):(b.cache===!0&&g(b.url,f,a),null!=b.onSuccess&&b.onSuccess(a),null!=b.onComplete&&b.onComplete(e,d),"undefined"!=typeof a.timeout&&a.timeout&&n.modules.session.update(a.timeout))},function(a,d,e){var f="undefined"!=typeof b.data?b.data:null;l(a,d,e,b,f,c),null!=b.onComplete&&b.onComplete(a,d)});return b.hasOwnProperty("returnAjaxObject")&&b.returnAjaxObject===!0?f:h}function g(a,b,c){o.push({url:a,postData:b,result:c})}function h(a){for(var b=0;b<o.length;b++){var c=o[b];if(a.url===c.url){if(null===a.data&&null===c.postData)return c;if(null!==a.data&&null!==c.postData&&_.isEqual(a.data,c.postData))return c}}return null}function i(a){if(a.cache===!0){var b=h(a);if(null!==b)return n.logging.info("Retrieved from cache",b),!0}return!1}function j(a){return"undefined"!=typeof a.error||"undefined"!=typeof a.errors&&a.errors.length>0?!0:!1}function k(a){var b;if(_.isUndefined(a.errors)){if(_.isUndefined(a.error))return"";b=a.error}else b=a.errors;return _.isArray(b)&&b.length>0&&(b=b[0].hasOwnProperty("message")?b[0].message:b[0]),_.isString(b)?b:""}function l(a,b,c,d,e,g){b!==p&&(d.numberOfAttempts>d.attemptsCounter++?f(d,g):("undefined"==typeof d&&(d={}),d.useDefaultErrorHandling&&d.onErrorDefaultHandling(a,b,c,d,e),null!=d.onError&&d.onError(a,b,c,d,e)))}function m(){return q}var n=window.meerkat,o=[],p="abort",q="checkAuthenticated",r={url:"not-set",data:null,dataType:!1,numberOfAttempts:1,attemptCallback:null,timeout:6e4,cache:!1,errorLevel:null,useDefaultErrorHandling:!0,returnAjaxObject:!0,onSuccess:function(a,b,c){},onError:function(a){},onComplete:function(a,b){},onErrorDefaultHandling:function(b,c,d,e,f){if(c!==p){var g={400:"There was a problem with the last request to the server [400]. Please try again.",401:"There was a problem accessing the data for the last request [401].",403:"There was a problem accessing the data for the last request [403].",404:"The requested page could not be found [404]. Please try again.",412:"Supplied parameters failed to meet preconditions [412].",500:"There was a problem with your last request to the server [500]. Please try again.",503:"There was a problem with your last request to the server [503]. Please try again."},h="",i={errorLevel:e.errorLevel,message:h,page:"comms.js",description:"Error loading url: "+e.url+" : "+c+" "+d,data:f};b.status&&200!=b.status?h=g[b.status]:"parsererror"==c?h+="There was a problem handling the response from the server [parsererror]. Please try again.":"timeout"==c?h+="There was a problem connecting to the server. Please check your internet connection and try again. [Request Time out].":"abort"==c&&(h+="There was a problem handling the response from the server [abort]. Please try again."),h&&""!==h||d!=q?h&&""!==h||(h="Unknown Error"):(h="Your Simples login session has been lost. Please open Simples in a separate tab, login, then you can continue with this quote.",n.modules.dialogs.isDialogOpen(q)||n.modules.journeyEngine.gotoPath("previous"),a.extend(i,{errorLevel:"warning",id:q})),a.extend(i,{message:h}),(d!=q||d==q&&!n.modules.dialogs.isDialogOpen(q))&&n.modules.errorHandling.error(i)}}};n.modules.register("comms",{post:c,get:d,getCheckAuthenticatedLabel:m})}(jQuery),function(a,b){function c(b){b="object"==typeof b&&null!==b?b:{},K=a.extend({},J,b),A=Results.settings.paths.productId,jQuery(document).ready(function(a){d(),e()})}function d(){z=a(Results.settings.elements.resultsContainer),z.on("change",".compare-tick",f),K.elements.basketLocationPrice.on("click",".remove-compare",f),z.on("click",".clear-compare",i),a(document).on("click",".enter-compare-mode",j),z.on("resultsReset resultsFetchStart",i),K.elements.exitCompareButton.on("click",i)}function e(){B.messaging.subscribe(F.ADD_PRODUCT,g),B.messaging.subscribe(F.REMOVE_PRODUCT,h),B.messaging.subscribe(F.RENDER_BASKET,k),B.messaging.subscribe(F.ENTER_COMPARE,j),B.messaging.subscribe(ResultsView.moduleEvents.RESULTS_TOGGLE_MODE,m),B.messaging.subscribe(C.device.STATE_ENTER_XS,i),B.messaging.subscribe(C.journeyEngine.STEP_CHANGED,i)}function f(b){var c,d=a(this),e=d.attr("data-productId");d.is(":checked")?(c=F.ADD_PRODUCT,d.addClass("checked")):(c=F.REMOVE_PRODUCT,d.removeClass("checked")),B.messaging.publish(c,{element:d,productId:e,product:Results.getResult("productId",e)})}function g(a){B.messaging.publish(F.BEFORE_ADD_COMPARE_PRODUCT);var b=a.productId,c=s(b,a.product);c?(l(b,!0),w()&&K.autoCompareAtMax===!0?B.messaging.publish(F.ENTER_COMPARE):B.messaging.publish(F.RENDER_BASKET)):D("[compare] Failed to add product")}function h(a){var b=a.productId;if("undefined"!=typeof b){var c=t(b);c?(v()&&n(),B.messaging.publish(F.RENDER_BASKET),l(b,!1)):D("[compare] Failed to remove product")}}function i(){if(Results.getFilteredResults()!==!1&&(G=[],B.messaging.publish(F.RENDER_BASKET),l(!1,!1),v())){if(H=!1,"price"==y)"function"==typeof K.callbacks.switchMode&&K.callbacks.switchMode(y);else{var a=B.site.vertical.indexOf("lmi")?"lmi":B.site.vertical;"undefined"!=typeof B.modules[a+"Results"]&&"function"==typeof B.modules[a+"Results"].publishExtraSuperTagEvents&&B.modules[a+"Results"].publishExtraSuperTagEvents()}K.elements.exitCompareButton.addClass("hidden"),_.defer(function(){o()}),B.messaging.publish(F.EXIT_COMPARE)}}function j(){if(H=!0,K.elements.enterCompareMode.addClass("disabled"),K.elements.exitCompareButton.removeClass("hidden"),y=Results.getDisplayMode(),"price"==y)"function"==typeof K.callbacks.switchMode&&K.callbacks.switchMode("features");else{var a=B.site.vertical.indexOf("lmi")?"lmi":B.site.vertical;"undefined"!=typeof B.modules[a+"Results"]&&"function"==typeof B.modules[a+"Results"].publishExtraSuperTagEvents&&B.modules[a+"Results"].publishExtraSuperTagEvents()}n(),B.messaging.publish(F.AFTER_ENTER_COMPARE_MODE),x(),setTimeout(function(){K.elements.enterCompareMode.removeClass("disabled")},250)}function k(b){switch(Results.getDisplayMode()){case"features":$template=K.templates.compareBasketFeatures,$location=K.elements.basketLocationFeatures,a(K.elements.basketLocationPrice).empty();break;case"price":$template=K.templates.compareBasketPrice,$location=K.elements.basketLocationPrice,a(K.elements.basketLocationFeatures).empty()}if("undefined"!=typeof $template&&0!==$template.length){var c=_.template($template.html()),d={maxAllowable:q(),resultsCount:Results.getFilteredResults().length,comparedResultsCount:p().length,products:p(),isCompareOpen:v()};$location.html(c(d)),"price"==Results.getDisplayMode()&&(p().length?$location.closest("nav").removeClass("hidden"):$location.closest("nav").addClass("hidden"))}}function l(b,c){var d,e;b===!1?(d=a(".compare-tick[data-productId]"),e=a(".result-row.compared",z)):(d=a('.compare-tick[data-productId="'+b+'"]'),e=a('.result-row[data-productId="'+b+'"]',z)),d.each(function(){var b=a(this);b.prop("checked",c).toggleClass("checked",c)}),e.each(function(){a(this).toggleClass("compared",c)})}function m(){switch(B.messaging.publish(F.RENDER_BASKET),Results.getDisplayMode()){case"features":K.elements.compareBar.addClass("hidden")}}function n(){var b=r();b.length>1?(I=!0,Results.filterBy("productId","value",{inArray:b},!0),Results.settings.show.unavailableCombined===!0&&_.defer(function(){Results.view.fadeResultOut(a(".result_unavailable_combined"),Results.settings.animation.filter.active)})):i()}function o(){Results.unfilterBy("productId","value",I),Results.settings.show.unavailableCombined===!0&&_.defer(function(){Results.view.fadeResultIn(a(".result_unavailable_combined"),Results.getFilteredResults().length+1,Results.settings.animation.filter.active)}),I=!1}function p(){return"object"==typeof G&&null!==G?G:[]}function q(){return K.maxProducts}function r(a){for(var b=[],c=p(),d=0;d<c.length;d++)if("undefined"!=typeof c[d][A])if(a){var e={productID:String(c[d][A])};"undefined"!=typeof c[d].brandCode&&(e.productBrandCode=c[d].brandCode),b.push(e)}else b.push(String(c[d][A]));else D("[getComparedProductIds] No Product Id in Object: ",c[d]);return b}function s(a,b){if("object"==typeof G&&null!==G){var c=u(p(),a);if(null===c)return G.push(b),!0}return!1}function t(a){var b=p(),c=u(b,a,!0,A);return"undefined"!=typeof b[c]?(b.splice(c,1),!0):!1}function u(a,b,c,d){d=d?d:A;for(var e=0,f=a.length;f>e;e++)if(b==a[e][d])return c?e:a[e];return null}function v(){return H}function w(){return q()==p().length}function x(){B.messaging.publish(C.tracking.TOUCH,{touchType:"H",touchComment:"ResCompare"});var a="home"===B.site.vertical?"Home_Contents":B.site.vertical;B.messaging.publish(C.tracking.EXTERNAL,{method:"trackQuoteComparison",object:{products:r(!0),vertical:a}})}var y,z,A,B=window.meerkat,C=B.modules.events,D=B.logging.info,E={compare:{RENDER_BASKET:"RENDER_BASKET",BEFORE_ADD_COMPARE_PRODUCT:"BEFORE_ADD_COMPARE_PRODUCT",ADD_PRODUCT:"COMPARE_ADD_PRODUCT",REMOVE_PRODUCT:"COMPARE_REMOVE_PRODUCT",ENTER_COMPARE:"ENTER_COMPARE",AFTER_ENTER_COMPARE_MODE:"AFTER_ENTER_COMPARE_MODE",EXIT_COMPARE:"EXIT_COMPARE_MODE"}},F=E.compare,G=[],H=!1,I=!1,J={minProducts:2,maxProducts:3,autoCompareAtMax:!0,elements:{basketLocationFeatures:a(".resultInsert.controlContainer"),basketLocationPrice:a("#navbar-compare > .compare-basket"),enterCompareMode:a(".enter-compare-mode"),clearCompare:a(".clear-compare"),exitCompareButton:a(".back-to-price-mode"),compareBar:a("#navbar-compare"),priceModeToggle:a(".filter-pricemode"),featuresModeToggle:a(".filter-featuresmode")},templates:{compareBasketFeatures:a("#compare-basket-features-template"),compareBasketPrice:a("#compare-basket-price-template")},callbacks:{switchMode:function(b){switch(b){case"features":K.elements.featuresModeToggle.trigger("click");break;case"price":K.elements.priceModeToggle.trigger("click"),a(".featuresHeaders .expandable.expanded, .featuresList .expandable.expanded").removeClass("expanded").addClass("collapsed");break;default:D("[compare:switchMode] No mode specified")}}}},K={};B.modules.register("compare",{initCompare:c,events:E,isCompareOpen:v})}(jQuery),function(a,b){function c(){}function d(b){a(document).ready(function(){a.extend(H,b),_.each(H,function(b,c){_.each(b,function(b,d){var f=a.extend(b,{index:d,type:c,fieldIndex:1});e(f),i(f),"undefined"!=typeof f.$otherField&&(f=a.extend({},f,{alternateOtherField:!0,fieldIndex:2}),e(f))})}),prefillLaterFields=!0})}function e(b){var c=x(b);"undefined"!=typeof b.alternateOtherField&&b.alternateOtherField&&(c=b.$otherField),c.on("change.contactDetails",function(){$this=a(this),_.defer(function(){f($this,b)})}),f(c,b,!1)}function f(a,b,c){if("undefined"==typeof c&&(c=!0),a.isValid())if(g(b))h(b,c);else{var d=j(b);c&&k(d),m(d)}}function g(b){var c=["email"];return"undefined"!=b.$optInField&&-1!==a.inArray(b.type,c)?!0:!1}function h(b,c){E.modules.loadingAnimation.showAfter(b.$field);var d={data:{type:b.type,value:b.$field.val()},onComplete:function(){E.modules.loadingAnimation.hide(b.$field)},onSuccess:function(d){var e={optins:{email:d.optInMarketing}},f=a.extend(j(b),e);c&&k(f),m(f)},onError:function(){u(b.$optInField)}};E.modules.optIn.fetch(d)}function i(a){"undefined"!=typeof a.$optInField&&a.$optInField.on("change.contactDetails",function(){var b=j(a);l(b),w(b)})}function j(a){var b={index:a.index,type:a.type,$field:x(a),$otherField:a.$otherField,fieldIndex:a.fieldIndex,$savedField:a.$field,$optInField:a.$optInField};return"undefined"!=typeof a.alternateOtherField&&a.alternateOtherField&&(b.$otherField=b.$field,b.$field=a.$otherField),b}function k(a){F.publish(a.type.toUpperCase()+"_FIELD_CHANGED",a)}function l(a){F.publish(a.type.toUpperCase()+"_OPTIN_FIELD_CHANGED",a)}function m(a){"undefined"!=typeof a.$optInField&&n(a)&&t(a.$optInField,a.optins[a.type]),prefillLaterFields&&a.index!==H[a.type].length&&y(a)}function n(a){return o(a)&&!p(a)}function o(a){return"undefined"!=typeof a.optins&&"undefined"!=typeof a.optins[a.type]?!0:!1}function p(a){return r(a).length>1}function q(a){var b=r(a),c=!0;return _.each(b,function(a){a.$field.isValid()||(c=!1)}),c}function r(a){var b=[];return _.each(s(),function(c){"undefined"!=typeof c.$optInField&&c.$optInField.is(a.$optInField)&&b.push(c)}),b}function s(){var b=[];return _.each(H,function(c,d){_.each(c,function(c,e){b.push(a.extend(c,{type:d}))})}),b}function t(a,b){b?v(a):u(a)}function u(a){B(a,!1),a.parents(".fieldrow").first().slideDown()}function v(a){a.parents(".fieldrow").first().slideUp(),a.attr("data-visible","true"),B(a,!0)}function w(a){prefillLaterFields&&a.index!==H[a.type].length&&z(a)}function x(a){var b=null;return b="undefined"!=typeof a.$fieldInput?a.$fieldInput:a.$field}function y(b){var c=b.$field,d="undefined"==typeof c.attr("data-previous-value")?"":c.attr("data-previous-value"),e=c.val();c.attr("data-previous-value",e);var f;f="undefined"==typeof b.$optInField?null:o(b)?b.optins[b.type]||A(b.$optInField):A(b.$optInField);for(var g=b.index+1;g<H[b.type].length;g++){var h=a.extend(H[b.type][g],{type:b.type}),i=x(h);if(!(""!==i.val()&&d!==i.val()||"undefined"!=typeof h.$otherField&&""!==h.$otherField.val())){if("name"==b.type&&"undefined"!=typeof h.$otherField){var j=e.split(" ");i.val(j[0]),h.$otherField.val(j.slice(1).join(" "))}else if("alternatePhone"===b.type&&"undefined"!=typeof h.$otherField){var k=e.replace(/\D/g,"");k.match(/^(04|614|6104)/g)?i.val(e):h.$otherField.val(e)}else i.val(e).attr("data-previous-value",e);(E.modules.performanceProfiling.isIE8()||E.modules.performanceProfiling.isIE9())&&("undefined"!=typeof h.$fieldInput?E.modules.placeholder.invalidatePlaceholder(h.$fieldInput):E.modules.placeholder.invalidatePlaceholder(i)),"undefined"!=typeof h.$fieldInput&&i.trigger("change").trigger("blur").trigger("focusout"),"undefined"==typeof h.$optInField||p(h)||t(h.$optInField,f)}}}function z(b){var c=A(b.$optInField),d=null;if(o(b)&&(d=b.optins[b.type]),"undefined"!=typeof c)for(var e=b.index+1;e<H[b.type].length;e++){var f=a.extend(H[b.type][e],{type:b.type});"undefined"!=typeof f.$optInField&&(c&&!p(f)?t(f.$optInField,c):(u(f.$optInField),B(f.$optInField,c)))}}function A(b){var c=b.attr("type"),d=null;if("checkbox"==c)d=b.is(":checked");else{if("radio"!=c)return!1;b.each(function(){return a(this).is(":checked")?(d="Y"==b.val(),!1):void 0})}return d}function B(b,c){var d=b.attr("type");if("checkbox"==d)b.prop("checked",c);else if("radio"==d){var e=null;e=c?"Y":"N",b.each(function(){return a(this).val()==e?(a(this).prop("checked",!0).trigger("change"),!1):void 0})}}function C(){return H}function D(a){var b="",c=C()[a];return _.each(c,function(a){"undefined"!=typeof a.$field&&""!==a.$field.val()&&(b=a.$field.val())}),b}var E=window.meerkat,F=(E.modules.events,E.logging.info,E.messaging),G={contactDetails:{name:{FIELD_CHANGED:"NAME_FIELD_CHANGED",OPTIN_FIELD_CHANGED:"NAME_OPTIN_FIELD_CHANGED"},email:{FIELD_CHANGED:"EMAIL_FIELD_CHANGED",OPTIN_FIELD_CHANGED:"EMAIL_OPTIN_FIELD_CHANGED"},phone:{FIELD_CHANGED:"PHONE_FIELD_CHANGED",OPTIN_FIELD_CHANGED:"PHONE_OPTIN_FIELD_CHANGED"},mobile:{FIELD_CHANGED:"MOBILE_FIELD_CHANGED",OPTIN_FIELD_CHANGED:"MOBILE_OPTIN_FIELD_CHANGED"},otherPhone:{FIELD_CHANGED:"OTHERPHONE_FIELD_CHANGED",OPTIN_FIELD_CHANGED:"OTHERPHONE_OPTIN_FIELD_CHANGED"}}},H=(G.contactDetails,{});prefillLaterFields=!0,E.modules.register("contactDetails",{init:c,events:G,configure:d,getFields:C,getFieldsFromOptInGroup:r,isOptInGroupValid:q,isPartOfOptInGroup:p,getLatestValue:D})}(jQuery),function(a,b){function c(){}function d(b){a("[data-source]",a(b)).each(function(){a(this).empty()})}function e(b){a("[data-source]",a(b)).each(function(){var b="",c=a(this),d=a(c.attr("data-source")),e=a(c.attr("data-alternate-source"));if(d.length){if(sourceType=d.get(0).tagName.toLowerCase(),dataType=c.attr("data-type"),callback=c.attr("data-callback"),callback)try{var g=callback.split(".");if(g.length){for(var h=g.pop(),i=window,j=0;j<g.length;j++)i=i[g[j]];b=i[h].apply(i,[d])}else b=callback.apply(window,[d])}catch(k){f.modules.errorHandling.error({message:"Unable to perform render Content Population Callback properly.",page:"contentPopulation.js:render()",errorLevel:"silent",description:"Unable to perform contentPopulation callback labelled: "+callback,data:{error:k.toString(),sourceElement:c.attr("data-source")}}),b=""}else if(dataType){var l;switch(dataType){case"checkboxgroup":l=d.parent().find(":checked").next("label"),l.length&&(b=l.text()||"");break;case"radiogroup":l=d.find(":checked").parent("label"),l.length&&(b=l.text()||"");break;case"list":var m=d.find("li");m.length>0?m.each(function(){b+="<li>"+a(this).find("span:eq(0)").text()+"</li>"}):b+="<li>None selected</li>";break;case"optional":b=d.val()||e.val()||"",""!==b&&a(".noDetailsEntered").remove();break;case"object":}}else switch(sourceType){case"select":var n=d.find("option:selected");""===n.val()?b="":(b=n.text()||"",""===b&&e.length&&(n=e.find("option:selected"),b=""===n.val()?"":n.text()||""));break;case"input":b=d.val()||e.val()||"";break;default:b=d.html()||e.html()||""}c.html(b)}})}var f=window.meerkat,g=(f.modules.events,f.logging.info,{contentPopulation:{}});g.contentPopulation;f.modules.register("contentPopulation",{init:c,events:g,render:e,empty:d})}(jQuery),function(a,b){function c(){a(document).ready(function(){e(),D===!0&&(q=a(".coupon-id-field"),r=a(".coupon-code-field"),s=a(".coupon-optin-field"),t=a(".coupon-optin-group"),u=a(".coupon-error-container"),v=a(".coupon-success-container"),f(),_.defer(function(){d()}))})}function d(){w.messaging.subscribe(x.journeyEngine.STEP_CHANGED,function(){m()})}function e(){a(".coupon-id-field").length>0&&(D=!0)}function f(){w.site.isCallCentreUser&&""!==w.site.vdn?g("vdn",w.site.vdn):""!==w.site.couponId&&g("couponId",w.site.couponId)}function g(a,b,c){if(D===!0&&a){var d="",e={};switch(e.transactionId=w.modules.transactionId.get(),a){case"couponId":d="coupon/id/get.json",e.couponId=b;break;case"vdn":d="coupon/vdn/get.json",e.vdn=b;break;case"filter":if(j()===!0)return void("function"==typeof c&&c());d="coupon/filter.json";break;default:return void z("invalid type to load coupon")}w.modules.comms.get({url:d,cache:!1,errorLevel:"silent",dataType:"json",data:e}).done(function(a){p(a),n(),"function"==typeof c&&c()}).fail(function(a,b,c){z(b+": "+c)})}}function h(a){if(D===!0){var b=w.modules.transactionId.get();w.modules.comms.get({url:"coupon/code/validate.json",cache:!1,errorLevel:"silent",dataType:"json",useDefaultErrorHandling:!1,data:{transactionId:b,couponCode:a}}).done(function(a){p(a),k()}).fail(function(a,b,c){z(b+": "+c)})}}function i(){j()===!0&&B.hasOwnProperty("contentBanner")&&(a(".coupon-banner-container").html(B.contentBanner),B.showPopup===!0&&C===!1&&_.defer(function(){a(".coupon-banner").click(),C=!0}))}function j(){return B!==!1&&B.hasOwnProperty("couponId")?isNaN(B.couponId)||B.couponId<=0?(y("No valid coupon found - can not render"),!1):!0:(y("Coupon has not been stored correctly - can not render"),!1)}function k(){""===r.val().trim()?(r.parent().removeClass("has-custom-error"),u.addClass("hidden"),l()):j()===!1?(r.parent().addClass("has-custom-error"),u.find("label").html("Oops! This offer has now expired or you have entered an invalid code. To continue, simply remove the promo code or try re-entering your code."),u.removeClass("hidden"),l()):B.hasOwnProperty("errors")&&B.errors.length>0?(r.parent().addClass("has-custom-error"),u.find("label").html(B.errors[0].message),u.removeClass("hidden"),l()):(l(),q.val(B.couponId),r.parent().removeClass("has-custom-error"),u.addClass("hidden"),B.hasOwnProperty("contentSuccess")&&""!==B.contentSuccess&&(v.html(B.contentSuccess),v.removeClass("hidden")),B.hasOwnProperty("contentCheckbox")&&""!==B.contentCheckbox?(t.find(".checkbox label").html(B.contentCheckbox),t.removeClass("hidden")):s.prop("type","hidden"))}function l(){v.addClass("hidden"),q.val(""),s.prop("type","checkbox"),s.attr("checked",!1),t.addClass("hidden")}function m(){r.parent().removeClass("has-custom-error"),v.addClass("hidden"),u.addClass("hidden"),s.prop("type","checkbox"),s.attr("checked",!1),t.addClass("hidden")}function n(){j()===!0&&B.canPrePopulate===!0&&(q.val(B.couponId),r.val(B.couponCode))}function o(){return B}function p(a){B=a}var q,r,s,t,u,v,w=window.meerkat,x=w.modules.events,y=(w.logging.info,w.logging.debug),z=w.logging.exception,A={coupon:{}
},B=!1,C=!1,D=!1;w.modules.register("coupon",{init:c,events:A,loadCoupon:g,getCurrentCoupon:o,validateCouponCode:h,renderCouponBanner:i})}(jQuery),function(a,b){function c(b){var c=d(b);c.on("blur",function(){c.val(a.trim(c.val().replace(/[^\d.-]/g,""))),""===c.val()&&c.val("0"),""!==c.val()?b.val(c.asNumber()):b.val(""),c.formatCurrency({symbol:"$",roundToDecimalPlace:-2})}),c.on("focus",function(){c.toNumber().setCursorPosition(c.val().length,c.val().length),"0"==c.val()&&c.val("")})}function d(b){var c="#"+b.attr("id")+"entry";return a(c)}function e(){var b=a(this),e=d(b);c(b),""!==e.val()&&"$0"!==e.val()&&e.trigger("blur")}function f(){var b=a("#journeyEngineSlidesContainer").find(".currency");b.each(e)}function g(b,c){return"function"==typeof a.fn.formatCurrency?(c=c||{},a("<input value=''/>").val(b).formatCurrency(c).val()):"$"+b}function h(){a.fn.setCursorPosition=function(b){var c=a(this).get(0);if(c.setSelectionRange)c.setSelectionRange(b,b);else if(c.createTextRange){var d=c.createTextRange();"function"==typeof d.collapse&&d.collapse(!0).moveEnd("character",b).moveStart("character",b).select()}},f(),j("[Currency] Initialised")}var i=window.meerkat,j=(i.modules.events,i.logging.info);i.modules.register("currencyField",{initCurrency:h,formatCurrency:g,initSingleCurrencyField:e})}(jQuery),function(a,b){function c(a){a.closest(".dateinput_container").find(".withDatePicker .input-group-addon-button").on("click",function(){a.datepicker("show")})}function d(b){a(document).on("hide",b,function(b){var c=a(b.target);if(b.target)return c.is("input")?void c.blur():void(c.find("input").is(":focus")||(c.find("input").blur(),(l.modules.performanceProfiling.isIE8()||l.modules.performanceProfiling.isIE9())&&l.modules.placeholder.invalidatePlaceholder(a("input.dateinput-date"))))})}function e(){"object"==typeof a.fn.datepicker.defaults?(a.fn.datepicker.defaults.format="dd/mm/yyyy",a.fn.datepicker.defaults.autoclose=!0,a.fn.datepicker.defaults.forceParse=!1,a.fn.datepicker.defaults.weekStart=1,a.fn.datepicker.defaults.todayHighlight=!0,a.fn.datepicker.defaults.clearBtn=!1,a.fn.datepicker.defaults.keyboardNavigation=!1):p("core/datepicker:(lib-defaults-not-setable)")}function f(){d(k)}function g(a){c(a),a.on("serialised.meerkat.formDateInput",function(){a.datepicker("update").blur()}),a.on("hide",function(){a.closest(".dateinput_container").find(".withDatePicker input").blur(),a.blur()})}function h(){if(k="[data-provide=datepicker]",j=a(k),n("[datepicker]","Initialised"),j.length>0){if("function"!=typeof a.fn.datepicker)return void p("core/datepicker:(lib-not-loaded-err)");e()}else o("[datepicker]","No datepickers found");j.each(function(){var b=a(this),c=b.data("date-mode");switch("undefined"==typeof c&&(c="component"),c){case"component":f();break;case"inline":break;case"range":break;case"separated":g(b)}})}function i(){a(document).ready(function(){l.messaging.subscribe(m.journeyEngine.READY,function(){h()})})}var j,k,l=window.meerkat,m=l.modules.events,n=l.logging.info,o=l.logging.debug,p=l.logging.exception;l.modules.register("datepicker",{init:i,initSeparated:g,initComponent:f,setDefaults:e})}(jQuery),function(a){function b(){jQuery(document).ready(function(a){a(window).load(function(){a("[data-defer-src]").each(function(){$this=a(this),$this.attr("src",$this.attr("data-defer-src")).removeAttr("data-defer-src")})})})}var c=window.meerkat;c.modules.register("deferSrcLoad",{init:b})}(jQuery),function(a,b){function c(){function a(a){var b,c=a.target,d=c.tagName.toLowerCase();if(a.shiftKey&&83===a.which&&"input"!==d&&"textarea"!==d&&"select"!==d){b=document.getElementsByTagName("link");for(var e=0;e<b.length;e++){var f=b[e];if(f.rel.toLowerCase().indexOf("stylesheet")>=0){var g=f.getAttribute("href");g=g.replace(/(&|\?)forceReload=\d+/,""),g=g+(g.indexOf("?")>=0?"&":"?")+"forceReload="+(new Date).getTime(),f.setAttribute("href",g)}}}}window.addEventListener&&window.addEventListener("keypress",a)}function d(){e.site.isDev===!0&&c()}var e=window.meerkat;e.modules.register("development",{init:d})}(jQuery),function(a,b){function c(){return a("html").css("font-family").replace(/'/g,"").replace(/\"/g,"")}function d(){h=c(),a(window).resize(_.debounce(function(){var a=c();e.messaging.publish(g.RESIZE_DEBOUNCED,{previousState:h,state:a}),a!==h&&(e.messaging.publish(g.STATE_CHANGE,{previousState:h,state:a}),e.messaging.publish(g["STATE_ENTER_"+a.toUpperCase()]),h&&e.messaging.publish(g["STATE_LEAVE_"+h.toUpperCase()]),h=a)}))}var e=window.meerkat,f=(e.modules.events,e.logging.info,{device:{RESIZE_DEBOUNCED:"DEVICE_RESIZE_DEBOUNCED",STATE_CHANGE:"DEVICE_MEDIA_STATE_CHANGE",STATE_ENTER_XS:"DEVICE_STATE_ENTER_XS",STATE_ENTER_SM:"DEVICE_STATE_ENTER_SM",STATE_ENTER_MD:"DEVICE_STATE_ENTER_MD",STATE_ENTER_LG:"DEVICE_STATE_ENTER_LG",STATE_LEAVE_XS:"DEVICE_STATE_LEAVE_XS",STATE_LEAVE_SM:"DEVICE_STATE_LEAVE_SM",STATE_LEAVE_MD:"DEVICE_STATE_LEAVE_MD",STATE_LEAVE_LG:"DEVICE_STATE_LEAVE_LG"}}),g=f.device,h=!1;e.modules.register("deviceMediaState",{init:d,events:f,get:c})}(jQuery),function(a,b){function c(b){var c=a.extend({},u,b);o="xs"===p.modules.deviceMediaState.get()?!0:!1;var f="mkDialog_"+r;_.isUndefined(c.id)?(c.id=f,r++):m(c.id)&&d(c.id),null!=c.hashId&&p.modules.address.appendToHash(c.hashId);var j=_.template(c.templates.dialogWindow);(null!=c.url||null!=c.externalUrl)&&(c.htmlContent=p.modules.loadingAnimation.getTemplate());var k=j(c);a("#dynamic_dom").append(k);var l=a("#"+c.id);l.modal({show:!0,backdrop:c.buttons&&c.buttons.length>0?"static":!0,keyboard:!1}),l.css("z-index",parseInt(l.eq(0).css("z-index"))+10*t.length);var n=a(".modal-backdrop");if(n.eq(n.length-1).css("z-index",parseInt(n.eq(0).css("z-index"))+10*t.length),l.on("hidden.bs.modal",function(b){if("undefined"!=typeof b.target){var c=a(b.target);0!==c.length&&c.hasClass("modal")!==!1&&e(c.attr("id"))}}),l.on("shown.bs.tab",function(a){i(c.id)}),l.find("button").on("click",function(b){var d=c.buttons[a(b.currentTarget).attr("data-index")];_.isUndefined(d)||(d.closeWindow===!0&&a(b.currentTarget).closest(".modal").modal("hide"),"function"==typeof d.action&&d.action(b))}),l.find(".navbar-nav button").off().on("click",function(b){var d=c[a(b.currentTarget).attr("data-button")];"undefined"!=typeof d&&"function"==typeof d.callback&&d.callback(b)}),null!=c.url&&p.modules.comms.get({url:c.url,cache:c.cacheUrl,errorLevel:"warning",onSuccess:function(a){g(c.id,a),"function"==typeof c.onLoad&&c.onLoad(c.id)}}),null!=c.externalUrl){var q='<iframe class="displayNone" id="'+c.id+'_iframe" width="100%" height="100%" frameborder="0" scrolling="no" allowtransparency="true" src="'+c.externalUrl+'"></iframe>';h(c.id,q),a("#"+c.id+"_iframe").on("load",function(){a(this).show(),p.modules.loadingAnimation.hide(a("#"+c.id))})}return window.setTimeout(function(){i(c.id)},0),"function"==typeof c.onOpen&&c.onOpen(c.id),t.push(c),c.id}function d(b){a("#"+b).modal("hide")}function e(b){t.length>1&&_.defer(function(){t.length>0&&t[0].id!==b&&a(document.body).addClass("modal-open")});var c=k(b);null!==c&&"function"==typeof c.onClose&&c.onClose(b),c.destroyOnClose===!0?j(b):p.modules.address.removeFromHash(c.hashId)}function f(b){a("#dynamic_dom .modal").each(function(b,c){i(a(c).attr("id"))})}function g(b,c,d){a("#"+b+" .modal-body").html(c),"function"==typeof d&&d(),f()}function h(b,c){a("#"+b+" .modal-body").append(c),f()}function i(b){o="xs"===p.modules.deviceMediaState.get()?!0:!1;var c=a("#"+b);if(0===c.find(".modal-header").outerHeight(!0))window.setTimeout(function(){i(b)},20);else{var d,e,f,g=c.find(".modal-content"),h=c.find(".modal-body"),j=c.find(".modal-dialog");d=a(window).height(),o||(d-=60),e=d,e-=c.find(".modal-header").outerHeight(!0),e-=c.find(".modal-footer").outerHeight(!0),e-=c.find(".modal-closebar").outerHeight(!0),o?(g.css("height",d),c.find(".modal-body").css("max-height","none").css("height",e),f=0,j.css("top",f)):(g.css("max-height",d),"true"===c.attr("data-fullheight")?(g.css("height",d),h.css("height",e)):(g.css("height","auto"),h.css("height","auto")),c.find(".modal-body").css("max-height",e),f=d/2-j.height()/2,g.height()<d&&(f/=2),j.css("top",f))}}function j(b){if(b&&0!==b.length){var c=a("#"+b);c.find("button").off().end().remove();var d=k(b);if(null!=d){if(null!=d.hashId){p.modules.address.removeFromHash(d.hashId);var e=_.findWhere(s,{hashId:d.hashId});null==e&&s.push(d)}t.splice(d.index,1)}}}function k(a){var b=l(a);return null!==b?(t[b].index=b,t[b]):null}function l(a){for(var b=0;b<t.length;b++)if(t[b].id==a)return b;return null}function m(a){return!_.isNull(l(a))}function n(){a(document).ready(function(){a(document).on("click",".btn-close-dialog",function(){a(this).closest(".modal").modal("hide")}),Modernizr.touch&&(a(document).on("touchmove",".modal",function(a){a.preventDefault()}),a(document).on("touchmove",".modal .modal-body",function(a){a.stopPropagation()}))});var b=this;p.messaging.subscribe(q.dynamicContentLoading.PARSED_DIALOG,function(b){var d,e=b.element.attr("data-dialog-hash-id"),f=null;""!==e&&(f=e),d="url"===b.contentType?{title:b.element.attr("data-title"),url:b.contentValue,cacheUrl:b.element.attr("data-cache")?!0:!1}:"externalUrl"===b.contentType?{title:b.element.attr("data-title"),externalUrl:b.contentValue}:{title:a(b.contentValue).attr("data-title"),htmlContent:b.contentValue};var g=a.extend({hashId:f,closeOnHashChange:!0,className:b.element.attr("data-class")},d);c(g)});var d=_.debounce(f,300);a(window).resize(d),p.messaging.subscribe(q.ADDRESS_CHANGE,function(a){for(var c=t.length-1;c>=0;c--){var d=t[c];d.closeOnHashChange===!0&&-1==_.indexOf(a.hashArray,d.hashId)&&b.close(d.id)}for(var e=0;e<a.hashArray.length;e++){var f=_.findWhere(t,{hashId:a.hashArray[e]});if(null==f){var g=_.findWhere(s,{hashId:a.hashArray[e]});null!=g&&g.openOnHashChange===!0&&p.modules.dialogs.show(g)}}},window)}var o,p=window.meerkat,q=p.modules.events,r=(p.logging.info,0),s=[],t=[],u={title:"",htmlContent:null,url:null,cacheUrl:!1,buttons:[],className:"",leftBtn:{label:"Back",icon:"",className:"btn-sm btn-close-dialog",callback:null},rightBtn:{label:"",icon:"",className:"",callback:null},tabs:[],htmlHeaderContent:"",hashId:null,destroyOnClose:!0,closeOnHashChange:!1,openOnHashChange:!0,fullHeight:!1,templates:{dialogWindow:'<div id="{{= id }}" class="modal" tabindex="-1" role="dialog" aria-labelledby="{{= id }}_title" aria-hidden="true"{{ if(fullHeight===true){ }} data-fullheight="true"{{ } }}><div class="modal-dialog {{= className }}"><div class="modal-content"><div class="modal-closebar">	<a href="javascript:;" class="btn btn-close-dialog"><span class="icon icon-cross"></span></a></div><div class="navbar navbar-default xs-results-pagination visible-xs"><div class="container"><ul class="nav navbar-nav"><li><button data-button="leftBtn" class="btn btn-back {{= leftBtn.className }}">{{= leftBtn.icon }} {{= leftBtn.label }}</button></li><li class="navbar-text modal-title-label">	{{= title }}</li>{{ if(rightBtn.label != "" || rightBtn.icon != "") { }}<li class="right"><button data-button="rightBtn" class="btn btn-save {{= rightBtn.className }}">{{= rightBtn.label }} {{= rightBtn.icon }}</button></li>{{ } }}</ul></div></div>{{ if(title != "" || tabs.length > 0 || htmlHeaderContent != "" ) { }}<div class="modal-header">{{ if (tabs.length > 0) { }}<ul class="nav nav-tabs tab-count-{{= tabs.length }}">{{ _.each(tabs, function(tab, iterator) { }}<li><a href="javascript:;" data-target="{{= tab.targetSelector }}" title="{{= tab.xsTitle }}">{{= tab.title }}</a></li>{{ }); }}</ul>{{ } else if(title != "" ){ }}<h4 class="modal-title hidden-xs" id="{{= id }}_title">{{= title }}</h4>{{ } else if(htmlHeaderContent != "") { }}{{= htmlHeaderContent }}{{ } }}</div>{{ } }}<div class="modal-body">{{= htmlContent }}</div>{{ if(typeof buttons !== "undefined" && buttons.length > 0 ){ }}<div class="modal-footer {{ if(buttons.length > 1 ){ }} mustShow {{ } }}">{{ _.each(buttons, function(button, iterator) { }}<button data-index="{{= iterator }}" type="button" class="btn {{= button.className }} ">{{= button.label }}</button>{{ }); }}</div>{{ } }}</div></div></div>'},onOpen:function(a){},onClose:function(a){},onLoad:function(a){}};p.modules.register("dialogs",{init:n,show:c,changeContent:g,close:d,isDialogOpen:m,resizeDialog:i})}(jQuery),function(a,b){function c(){a(document).ready(function(){Modernizr.touch&&(a(document).on("touchmove",".dropdown-backdrop, .dropdown-interactive form",function(a){a.preventDefault(),a.stopPropagation()}),a(document).on("touchmove",".dropdown-interactive .scrollable",function(a){a.stopPropagation()}))}),a(document).on("show.bs.dropdown",function(b){if(b.target){var c=a(b.target);c.hasClass("dropdown-interactive")!==!1&&d(c)}}),a(document).on("shown.bs.dropdown",function(b){if(b.target){var c=a(b.target);if(c.hasClass("dropdown-interactive")!==!1){var d=!0;"xs"===h.modules.deviceMediaState.get()&&(d=!1),_.defer(function(){e(c,d)&&a(document.body).addClass("dropdown-fitviewport")}),a(document.body).addClass("dropdown-open")}}}),a(document).on("hidden.bs.dropdown",function(b){a(document.body).removeClass("dropdown-open").removeClass("dropdown-fitviewport")}),h.messaging.subscribe(i.device.RESIZE_DEBOUNCED,function(b){a(".dropdown-interactive").each(function(){var b=a(this);b.removeAttr("data-maxheight"),f(b),b.hasClass("open")&&(e(b,!1)&&a(document.body).addClass("dropdown-fitviewport"),a(document.body).addClass("dropdown-open"))})})}function d(a){var b=a.closest(".dropdown-interactive-base"),c=a.closest(".dropdown-interactive");return b.length&&c.length?j.prependTo(b).on("click",g):c.length?j.prependTo(c).on("click",g):void 0}function e(b,c){if(b&&0!==b.length){var d=0,e=0,g=0;return c===!0&&b.attr("data-maxheight")?e=b.attr("data-maxheight"):(d=a(window).height(),"xs"===h.modules.deviceMediaState.get()?(g+=a("header .dynamicTopHeaderContent").outerHeight(),g+=a("header .navbar-header").outerHeight(),g+=b.find(".activator").outerHeight(),b.prevAll("li:visible").each(function(){g+=a(this).outerHeight()})):(g+=20,b.closest(".navbar-affix").each(function(){g+=a(this).outerHeight()})),g+=b.find("form").outerHeight()-b.find(".scrollable").outerHeight(),e=d-g,b.attr("data-maxheight",e)),e>0?(b.find(".dropdown-container .scrollable").css("max-height",e).css("overflow-y","auto").hide().show(0),!0):(f(b),!1)}}function f(a){a.find(".dropdown-container .scrollable").css("max-height","")}function g(){a('[data-toggle="dropdown"]').parent(".open").children('[data-toggle="dropdown"]').dropdown("toggle")}var h=window.meerkat,i=h.modules.events,j=(h.logging.info,a('<div class="dropdown-backdrop" />'));h.modules.register("dropdownInteractive",{init:c,fitIntoViewport:e,addBackdrop:d})}(jQuery),function(a,b){function c(){d()}function d(){a(document.body).on("click","a[data-content]",function(a){a.preventDefault(),a.stopPropagation(),e(a)}),a(document.body).on("mouseenter",'[data-trigger=mouseenter], [data-trigger="mouseenter click"]',function(a){e(a)})}function e(b){var c=null,d=null,e=a(b.currentTarget),g=e.attr("data-content"),i=e.attr("data-toggle");if("undefined"!=typeof i&&""!==i){var j=g.split(".");"#"===g[0]||"."===g[0]?(c="selector",d=a(g).html()):"helpid:"==g.substr(0,7)?(c="url",d="ajax/xml/help.jsp?id="+g.substr(7,g.length)):"http"===g.substring(0,4)||"www"===g.substring(0,3)?(c="externalUrl",d=g):"jsp"==j[j.length-1]||"html"==j[j.length-1]?(c="url",d=g):(c="content",d=g),f.messaging.publish(h["PARSED_"+i.toUpperCase()],{element:e,contentType:c,contentValue:d})}}var f=window.meerkat,g=(f.modules.events,f.logging.info,{dynamicContentLoading:{PARSED_POPOVER:"DYNAMIC_CONTENT_PARSED_POPOVER",PARSED_DIALOG:"DYNAMIC_CONTENT_PARSED_DIALOG"}}),h=g.dynamicContentLoading;f.modules.register("dynamicContentLoading",{init:c,events:g})}(jQuery),function(a,b){function c(b){var c=a.extend({},j,b);return d(c),c=g.modules.sendEmail.setup(c),c.emailBrochuresOnClickFunction=function(){g.messaging.publish(g.modules.events.sendEmail.REQUEST_SEND,{instanceSettings:c})},c.submitButton.on("click",c.emailBrochuresOnClickFunction),h[c.identifier]=c,c}function d(a){var b=h[a.identifier];"undefined"!=typeof b&&null!=b&&(h[b.identifier]=null,g.modules.sendEmail.tearDown(b),b.submitButton.off("click",b.emailBrochuresOnClickFunction))}function e(a){return a.emailInput.valid()}function f(a){var b=null;return b="undefined"!=typeof a.productData?a.productData:[],b.push({name:"premiumFrequency",value:Results.settings.frequency}),b.push({name:"marketing",value:a.marketing.val()}),b}var g=window.meerkat,h={},i=(g.modules.events,g.logging.info,g.messaging,{emailBrochures:{QUOTE_SAVED:"EMAIL_BROCHURE_SAVED",DESTROY:"EMAIL_BROCHURE_DESTROY"}}),j=(i.emailBrochures,{sendEmailDataFunction:f,canEnableSubmit:e,submitUrl:"productBrochures/send/email.json",lockoutOnCheckUserExists:!0});g.modules.register("emailBrochures",{setup:c,events:i,tearDown:d})}(jQuery),function(a,b){function c(){e()&&(h.step_init=g.messaging.subscribe(g.modules.events.journeyEngine.STEP_INIT,_.bind(d,this,!0)),h.validation_error=g.messaging.subscribe(g.modules.events.journeyEngine.STEP_VALIDATION_ERROR,_.bind(d,this,!1)))}function d(a){g.messaging.unsubscribe(g.modules.events.journeyEngine.STEP_INIT,h.step_init),g.messaging.unsubscribe(g.modules.events.journeyEngine.STEP_VALIDATION_ERROR,h.validation_error);var b=function(){g.messaging.publish(i.emailLoadQuote.TRIGGERS_MODAL,{action:g.site.pageAction,valid:a})};a&&g.modules.performanceProfiling.isIE8()?_.defer(b):b()}function e(){return!g.site.isNewQuote&&_.indexOf(j,g.site.pageAction)>-1}function f(a){return e()?"results":a}var g=window.meerkat,h=(g.modules.events,g.logging.info,g.messaging,{data_ready:!1,validation_error:!1}),i={emailLoadQuote:{TRIGGERS_MODAL:"TRIGGERS_MODAL"}},j=["expired","promotion"];g.modules.register("emailLoadQuote",{init:c,events:i,getStartStepOverride:f})}(jQuery),function(a,b){function c(b){("undefined"==typeof b.errorLevel||null===b.errorLevel)&&console.error("Message to dev: please provide an errorLevel to the errorHandling.error() function.");var c,f=a.extend({},h,b);switch(f.errorLevel){case"warning":c=!1,d(c,f);break;case"fatal":c=!0,d(c,f);break;default:c=!1}f.fatal=c;var g="";if("undefined"!=typeof e.modules.transactionId&&(g=e.modules.transactionId.get(),null===g&&(g="")),f.transactionId=g,"object"==typeof f.data&&null!==f.data&&(f.data=JSON.stringify(f.data)),c)try{e.modules.writeQuote.write({triggeredsave:"fatalerror",triggeredsavereason:f.description},!1)}catch(i){}e.modules.comms.post({url:"ajax/write/register_fatal_error.jsp",data:f,useDefaultErrorHandling:!1,errorLevel:"silent",onError:function(){}})}function d(b,c){var d;b?(d=c.closeWindow===!0?[{label:"Close page",className:"btn-cta",action:function(a){window.close()},closeWindow:!1}]:[{label:"Refresh page",className:"btn-cta",action:function(a){location.reload()},closeWindow:!1}],e.site.isDev===!0&&d.push({label:"Attempt to continue [dev only]",className:"btn-cancel",action:null,closeWindow:!0})):d=[{label:"OK",className:"btn-cta",closeWindow:!0,action:function(){e.messaging.publish(g.OK_CLICKED)}}];var f={title:c.title,htmlContent:c.message,buttons:d};_.isNull(c.id)||a.extend(f,{id:c.id});var h=e.modules.dialogs.show(f);b&&!e.site.isDev&&a("#"+h+" .modal-closebar").remove()}var e=window.meerkat,f=(e.logging.info,{errorHandling:{OK_CLICKED:"OK_CLICKED"}}),g=f.errorHandling,h={errorLevel:"silent",page:"unknown",title:"Error",message:"Sorry, an error has occurred",description:"unknown",data:null,id:null};e.modules.register("errorHandling",{error:c,events:f})}(jQuery),function(a,b){function c(){j=a("#deviceType").attr("data-deviceType"),jQuery(document).ready(function(a){d(),e()})}function d(){a(document).on("results.view.animation.start, pagination.scrolling.start",function(){f("startPaginationScroll")}),a(document).on("pagination.scrolling.end",function(){f("endPaginationScroll")}),a(document).on("results.view.animation.end",function(){a(".result-row").css({position:""}),f("filterAnimationEnded")})}function e(){h.messaging.subscribe(i.affix.AFFIXED,function(){k=!0,f("affixed")}),h.messaging.subscribe(i.affix.UNAFFIXED,function(){k=!1,f("unaffixed")}),h.messaging.subscribe(i.device.STATE_CHANGE,function(){f("deviceMediaStateChange")}),h.messaging.subscribe(i.compare.EXIT_COMPARE,function(){f("startPaginationScroll")}),h.messaging.subscribe(i.compare.AFTER_ENTER_COMPARE_MODE,function(){f("endPaginationScroll")})}function f(b){_.isNull(l)&&(l=a("#results_v3").length>0);var c=a(".featuresDockedHeader"),d=a(".headers");if(l===!0&&"TABLET"!=j&&"xs"!=h.modules.deviceMediaState.get()){var e="features"==Results.getDisplayMode()?!0:!1,f=!0,i="startPaginationScroll"==b||"endPaginationScroll"==b||"filterAnimationEnded"==b;if(e){var m=a(".fixedDockedHeader");if(k){d.parent().hasClass("featuresHeaders")===!1&&d.hide();var n=a(".currentPage"),o=a("#navbar-filter").height()+a("#navbar-main").outerHeight(),p="startPaginationScroll"==b?"0":o+"px",q=a(".result-row").first().width(),r=a("#pageContent").offset(),s=a("#navbar-filter").offset(),t=(_.isUndefined(s)?0:s.top)-(_.isUndefined(r)?0:r.top)+7,u="startPaginationScroll"==b?"absolute":"fixed",v="startPaginationScroll"==b?t+"px":"0px";i?(f=!1,c.css({position:u,top:p,width:q,"padding-top":v}).show(),("endPaginationScroll"==b||"filterAnimationEnded"==b)&&(n.length>=1?n.siblings(":not(.currentPage)").find(c).hide():c.hide(),f=!0)):n.find(c).css({top:p,width:q}).show(),g(f)}else c.hide(),m.hide(),d.show()}else d.show(),c.hide()}else d.show(),c.hide()}function g(b){var c=a(".fixedDockedHeader"),d=a(".currentPage"),e=a("#navbar-filter").height()+a("#navbar-main").outerHeight();if(b){var f=a(".cell.feature").width()+2+"px",g="100px";d.length>=1&&(g=a(".currentPage .resultInsert.featuresMode:visible").first().innerHeight()+1+"px"),c.css({top:e,width:f,height:g}).show()}}var h=window.meerkat,i=h.modules.events,j=(h.logging.info,null),k=!1,l=null;h.modules.register("featuresDockedHeader",{init:c})}(jQuery),function(a,b){function c(){jQuery(document).ready(function(a){meerkat.modules.performanceProfiling.isFFAffectedByDropdownMenuBug()&&a("html").addClass("ff-no-custom-menu")})}meerkat.modules.register("firefoxMenuFix",{init:c})}(jQuery),function(a,b){function c(){}function d(a){return f(a).serializeArray()}function e(a){return f(a).serialize()}function f(b){return b.find(":input:visible, input[type=hidden], :input[data-visible=true], :input[data-initValue=true], :input[data-attach=true]").filter(function(){return""!==a(this).val()&&"Please choose..."!==a(this).val()})}function g(a){h(a),a.find(":input[data-visible]").removeAttr("data-visible"),a.find(":input:visible").attr("data-visible","true")}function h(a){a.find(":input[data-initValue]").removeAttr("data-initValue")}function i(b){$elements=b.find(":input").filter(function(){return""!==a(this).val()&&"Please choose..."!==a(this).val()}),$elements.attr("data-initValue","true")}function j(a,b,c){a.append('<input type="hidden" id="'+b+'" name="'+b+'" data-visible="true" value="'+c+'" />')}var k=window.meerkat,l=(k.modules.events,k.logging.info,k.messaging,{form:{}});l.form;k.modules.register("form",{init:c,events:l,getData:d,getSerializedData:e,appendHiddenField:j,markFieldsAsVisible:g,markInitialFieldsWithValue:i,clearInitialFieldsAttribute:h})}(jQuery),function(a,b){function c(){var b=g.modules.performanceProfiling.isIos(),c=g.modules.performanceProfiling.isIos5(),h=g.modules.performanceProfiling.isAndroid(),i=g.modules.performanceProfiling.isChrome();a(document).ready(function(){var g=!1;Modernizr.inputtypes.date&&(b&&!c||h&&i)&&(g=!0),a("[data-provide=dateinput]").each(function(){var b=a(this);g?(b.attr("data-dateinput-type","native"),b.find(".dateinput-tripleField").addClass("hidden"),b.find(".dateinput-nativePicker").removeClass("hidden").find("input").on("change",f)):b.find("input.dateinput-day, input.dateinput-month, input.dateinput-year").on("input",e).on("change",f);var c=b.find(".serialise");d(b,c.val()),c.on("change",function(){d(b,this.value)})})})}function d(b,c){var d=c.split("/"),e="";if(1!=b.attr("data-locked")){b.attr("data-locked",1),0===c.length||3!==d.length?d=["","",""]:(1===d[0].length&&(d[0]="0"+d[0]),1===d[1].length&&(d[1]="0"+d[1]),4===d[2].length&&2===d[1].length&&2===d[0].length&&(e=d[2]+"-"+d[1]+"-"+d[0])),b.find("input.dateinput-day").val(d[0]),b.find("input.dateinput-month").val(d[1]),b.find("input.dateinput-year").val(d[2]),b.find(".dateinput-nativePicker input").val(e),(g.modules.performanceProfiling.isIE8()||g.modules.performanceProfiling.isIE9())&&(g.modules.placeholder.invalidatePlaceholder(b.find("input.dateinput-day")),g.modules.placeholder.invalidatePlaceholder(b.find("input.dateinput-month")),g.modules.placeholder.invalidatePlaceholder(b.find("input.dateinput-year"))),b.removeAttr("data-locked");var f=a.Event("populated.meerkat.formDateInput");b.trigger(f)}}function e(){var b=a(this);if(b.attr("maxlength")&&!b.hasClass("year")&&!b.hasClass("dateinput-year")&&b.val().length==b.attr("maxlength")){var c=b.hasClass("dateinput-day")?"input.dateinput-month":"input.dateinput-year";b.closest('[data-provide="dateinput"]').find(c).focus().select()}}function f(){var b=a(this).parents('[data-provide="dateinput"]'),c=b.find(".serialise"),d="",e="",f="";if(1!=b.attr("data-locked")){if(b.attr("data-locked",1),"native"==b.attr("data-dateinput-type")){var g=this.value.length>0?this.value.split("-"):["","",""];f=g[0],e=g[1],d=g[2]}else d=b.find("input.dateinput-day").val(),e=b.find("input.dateinput-month").val(),f=b.find("input.dateinput-year").val();if(1===d.length&&(d="0"+d),1===e.length&&(e="0"+e),"native"!=b.attr("data-dateinput-type")&&(b.find("input.dateinput-day").val(d),b.find("input.dateinput-month").val(e)),d.length>0&&Number(d)>0&&e.length>0&&Number(e)>0&&f.length>0&&Number(f)>0){c.val(d+"/"+e+"/"+f),c.valid();var h=a.Event("serialised.meerkat.formDateInput");c.trigger(h,c.val())}else c.val("");c.change(),b.removeAttr("data-locked")}}var g=window.meerkat;g.logging.info;g.modules.register("formDateInput",{init:c,populate:d,serialise:f})}(jQuery),function(a,b){function c(){jQuery(document).ready(function(a){a.hasOwnProperty("number")&&_.isFunction(a.number)&&a("input.liveFormatNumber").each(function(){var b=a(this),c=0;b.hasClass("formattedInteger")?c=0:b.hasClass("formattedDecimal")&&a(b.attr("class").split(" ")).each(function(){0===this.indexOf("formattedDecimal_")&&(c=Number(this.split("_")[1]))}),b.number(!0,c)})})}var d=window.meerkat,e=(d.modules.events,d.logging.info,d.messaging,{});d.modules.register("formNumberFormatInputs",{init:c,events:e})}(jQuery),function(a,b){function c(){Modernizr.input.placeholder&&d()}function d(){var b=a("input[data-placeholder-unfocused]");b.each(function(){var b=a(this),c="";b.attr("placeholder")&&(c=b.attr("placeholder")),b.attr("data-placeholder",c),b.attr("placeholder",b.attr("data-placeholder-unfocused")),b.on("focus.formPlaceholders.unfocused",function(){a(this).attr("placeholder",a(this).attr("data-placeholder"))}),b.on("blur.formPlaceholders.unfocused",function(){a(this).val().length>0||a(this).attr("placeholder",a(this).attr("data-placeholder-unfocused"))})})}var e=window.meerkat;e.modules.register("formPlaceholders",{init:c})}(jQuery),function(a,b){function c(){jQuery(document).ready(function(a){a(".help-icon").prop("tabindex",-1)})}var d=window.meerkat,e=(d.modules.events,d.logging.info,d.messaging,{});d.modules.register("helpIcons",{init:c,events:e})}(jQuery),function(a,b){function c(){}function d(b,c){e.modules.performanceProfiling.isIE8()&&b.on("focus",c,function(){var b=a(this);b.data("width",b.width()),b.width("auto"),b.data("width-auto",a(this).width()),b.data("width-auto")<b.data("width")?b.width(b.data("width")):b.width(b.data("width-auto")+15)}).on("blur",c,function(){var b=a(this);b.width(b.data("width"))})}var e=window.meerkat;e.modules.register("ie8SelectMenuAutoExpand",{init:c,bindEvents:d})}(jQuery),function(a,b){function c(b){function c(a,b){a>=R.steps.length&&b(null);var e=R.steps[a];if(e.navigationId===R.startStepId)b(e,!0);else try{d(e,l),null!=e.onAfterEnter&&e.onAfterEnter(l),M=e,p(),t(e,function(){null!=M.onBeforeLeave&&M.onBeforeLeave(l),null!=M.onAfterLeave&&M.onAfterLeave(l),_.defer(function(){c(a+1,b)})})}catch(f){I.logging.info("[journeyEngine]",f),b(e,!1)}}if(null===b)return k(),!1;a.extend(R,b),a(R.slideContainer+" ."+R.slideClassName).removeClass("active").addClass("hiddenSlide");for(var f=0;f<R.steps.length;f++)R.steps[f]=a.extend({},S,R.steps[f]);if(R.steps.sort(function(a,b){return a.slideIndex<b.slideIndex?-1:a.slideIndex>b.slideIndex?1:0}),null===R.startStepId&&""===I.modules.address.getWindowHash())R.startStepId=R.steps[0].navigationId,I.modules.address.setStartHash(R.startStepId),e({navigationId:R.startStepId});else{if(null===R.startStepId){var g=I.modules.address.getWindowHashAt(0),h=n(g);null===h?R.startStepId=R.steps[0].navigationId:R.startStepId=g}var l={};l.direction=P,l.isForward=!0,l.isBackward=!1,l.isStartMode=!0;var m=R.steps[0];c(0,function(a,b){null==a&&(a=m),R.startStepId=a.navigationId,b?(M=null,O=null):(j(M,!1,null),i(l,null,!1));var c=R.startStepId;"undefined"!=typeof a&&"function"==typeof a.additionalHashInfo&&(c+="/"+a.additionalHashInfo()),""!==I.modules.address.getWindowHash()&&I.modules.address.getWindowHash()!==c?I.modules.address.setHash(c):(I.modules.address.setStartHash(c),e({navigationId:R.startStepId}))})}I.messaging.publish(L.READY,this)}function d(a,b){a.initialised===!1&&null!=a.onInitialise&&a.onInitialise(b),a.initialised=!0,H(a),null!=a.onBeforeEnter&&a.onBeforeEnter(b)}function e(b){try{b.isStartMode=!1,""===b.navigationId&&(b.navigationId=R.startStepId);var c=n(b.navigationId);if(null===c&&(c=n(0)),c.stepIndex=l(c.navigationId),null===M)b.direction=P,b.isForward=!0,b.isBackward=!1,f(c,b);else{if(b.previousNavigationId=M.navigationId,b.navigationId==M.navigationId)return!1;if(l(c.navigationId)<l(M.navigationId))b.direction=Q,b.isForward=!1,b.isBackward=!0,f(c,b);else{if(l(c.navigationId)!=l(M.navigationId)+1)throw"Moving forward too many steps. "+M.navigationId+" to "+b.navigationId;b.direction=P,b.isForward=!0,b.isBackward=!1,"1"==a(R.slideContainer).attr("data-prevalidation-completed")?(a(R.slideContainer).removeAttr("data-prevalidation-completed"),f(c,b)):t(M,function(){f(c,b)})}}}catch(d){return w(),I.modules.address.setHash(M.navigationId),I.logging.info("[journeyEngine]",d),!1}return!0}function f(a,b){I.messaging.publish(L.BEFORE_STEP_CHANGED),null!==M&&null!=M.onBeforeLeave&&M.onBeforeLeave(b),d(a,b),g(a,b)}function g(b,c){function d(){null!=M&&null!=M.onAfterLeave&&M.onAfterLeave(c)}var e=M;null===M||b.slideIndex==M.slideIndex?(d(),null===M&&j(b,!1),M=b,p(),i(c,e,!0)):($slide=a(R.slideContainer+" ."+R.slideClassName+":eq("+M.slideIndex+")"),$slide.fadeOut(250,function(){$slide.removeClass("active").addClass("hiddenSlide"),d(),M=b,p(),j(b,!0,function(){i(c,e,!0),h(M)})}))}function h(a){I.modules.sessionCamHelper.updateVirtualPageFromJourneyEngine(a)}function i(b,c,d){a("body").attr("data-step",M.navigationId);var e=I.site.title;null!=M.title&&(e=M.title+" - "+e),window.document.title=e,M.slideScrollTo&&null!==M.slideScrollTo&&I.modules.utils.scrollPageTo(M.slideScrollTo),d===!0&&null!=M.onAfterEnter&&M.onAfterEnter(b),w();var f=L.STEP_INIT;null!==c&&(f=L.STEP_CHANGED),f===L.STEP_INIT&&k(),b.step=M,b.navigationId=M.navigationId,I.messaging.publish(f,b),null!=M.tracking?(I.messaging.publish(J.tracking.TOUCH,M.tracking),a(".journeyNavButton").removeClass("poke")):a(".journeyNavButton").addClass("poke"),null!=M.externalTracking&&I.messaging.publish(J.tracking.EXTERNAL,M.externalTracking)}function j(b,c,d){$slide=a(R.slideContainer+" ."+R.slideClassName+":eq("+b.slideIndex+")"),c===!0?$slide.fadeIn(250,function(){$slide.removeClass("hiddenSlide").addClass("active"),null!=d&&d()}):($slide.removeClass("hiddenSlide").addClass("active"),null!=d&&d())}function k(){a(document.body).removeClass("jeinit")}function l(a){for(var b=0;b<R.steps.length;b++){
var c=R.steps[b];if(c.navigationId==a)return b}}function m(){return R.steps.length}function n(a){var b=l(a);return null==b?null:R.steps[b]}function o(){var a=0;return null!==M&&(a=M.navigationId),l(a)}function p(){(_.isNull(O)||l(O.navigationId)<l(M.navigationId))&&(O=M)}function q(){return l(O.navigationId)}function r(){return M}function s(){var a=0,b=o();return b>0&&(a=--b),R.steps[a].navigationId}function t(b,c,d){var e=!1;if(null!=b.validation){if(b.validation.validate===!0){var f=!1;a("."+R.slideClassName+":eq("+b.slideIndex+"):visible").length>0&&(f=!0);var g=a("."+R.slideClassName+":eq("+b.slideIndex+")");g.removeClass("hiddenSlide").addClass("active"),I.modules.form.markFieldsAsVisible(g);var h=!0;if(g.find("form").each(function(b,c){$element=a(c);var d=$element.valid();d===!1&&(h=!1)}),f===!1&&g.removeClass("active").addClass("hiddenSlide"),h===!1)throw"function"==typeof d&&d(),I.messaging.publish(L.STEP_VALIDATION_ERROR,b),"Validation failed on "+b.navigationId}null!=b.validation.customValidation&&(e=!0,b.validation.customValidation(function(a){if(!a)throw"function"==typeof d&&d(),I.messaging.publish(L.STEP_VALIDATION_ERROR,b),"Custom validation failed on "+b.navigationId;c(!0)}))}return e===!1&&c(!0),!0}function u(){return a(R.slideContainer+" ."+R.slideClassName+":eq("+M.slideIndex+") form").valid()}function v(){a(R.slideContainer).attr("data-locked","1")}function w(){a(R.slideContainer).removeAttr("data-locked")}function x(){return"1"==a(R.slideContainer).attr("data-locked")}function y(b){var c=a(b.currentTarget);return c.is(".disabled, :disabled")?!1:(b.preventDefault(),void z(c.attr("data-slide-control"),c))}function z(b,c){if("undefined"!=typeof c&&c.hasClass("show-loading")){var d=c.attr("data-loadinganimation");_.isUndefined(d)||_.isEmpty(d)?I.modules.loadingAnimation.showAfter(c):"inside"===d?I.modules.loadingAnimation.showInside(c):I.modules.loadingAnimation.showAfter(c)}try{if(x())throw"Journey engine action in progress (isLocked)";v();var e=b;if(null!==M&&M.navigationId!==e){var f;if("next"==e||"previous"==e){var g=l(M.navigationId),h=null;if("next"==e){if(f="forward",h=g+1,h>=R.steps.length)throw"No next steps"}else if(f="backward",h=g-1,0>h)throw"No previous steps";e=R.steps[h].navigationId,"function"==typeof R.steps[h].additionalHashInfo&&(e+="/"+R.steps[h].additionalHashInfo())}l(e)==l(M.navigationId)+1&&"forward"==f?t(M,function(){a(R.slideContainer).attr("data-prevalidation-completed","1"),I.modules.address.setHash(e),"undefined"!=typeof c&&I.modules.loadingAnimation.hide(c)},B):(I.modules.address.setHash(e),"undefined"!=typeof c&&I.modules.loadingAnimation.hide(c))}}catch(i){w(),I.logging.info("[journeyEngineListener]",i),"undefined"!=typeof c&&I.modules.loadingAnimation.hide(c)}}function A(b){return"radio"==b.attr("type")||"checkbox"==b.attr("type")?a("input[name="+b.attr("name")+"]:checked").val()||"":b.val()}function B(){var b=[],c=0;return b.push({name:"stepId",value:I.modules.journeyEngine.getCurrentStep().navigationId}),b.push({name:"hasPrivacyOptin",value:I.modules.optIn.isPrivacyOptedIn()}),a(".error-field:visible",".journeyEngineSlide.active").each(function(){var d=a(this).find("label"),e=d.attr("for");"undefined"!=typeof e&&(b.push({name:e,value:A(a(":input[name="+e+"]"))+"::"+d.text()}),c++)}),0===c?!1:I.modules.comms.post({url:"logging/validation.json",data:b,dataType:"json",cache:!0,errorLevel:"silent",useDefaultErrorHandling:!1})}function C(){I.messaging.subscribe(J.ADDRESS_CHANGE,function(a){return N===!0?void I.modules.address.setHash(M.navigationId):void e({navigationId:a.hashArray[0]})},window),a(document.body).on("click","a[data-slide-control]",y),I.messaging.subscribe(J.WEBAPP_LOCK,function(b){N=!0,a("a[data-slide-control]").each(function(){a(this).addClass("disabled").addClass("inactive")})}),I.messaging.subscribe(J.WEBAPP_UNLOCK,function(b){N=!1,a("a[data-slide-control]").each(function(){a(this).removeClass("disabled").removeClass("inactive")})}),a(document).on("keydown",function(a){a.ctrlKey&&39==a.keyCode&&z("next"),a.ctrlKey&&37==a.keyCode&&z("previous")}),a("#journeyEngineLoading .loading-logo").after(I.modules.loadingAnimation.getTemplate())}function D(){return I.modules.form.getData(a("#mainform"))}function E(){return I.modules.form.getSerializedData(a("#mainform"))}function F(b,c){b=b||"Please wait...",c=c||!1;var d=a("#journeyEngineLoading");"1"!==d.attr("data-active")&&(d.attr("data-active","1"),d.find(".message").attr("data-oldtext",d.find(".message").text()).text(b),d.addClass("displayBlock"),c?d.addClass("opacity1"):_.defer(function(){d.addClass("opacity1")}))}function G(){var b=a("#journeyEngineLoading");b.attr("data-active","0"),b.removeClass("opacity1");var c=b.transitionDuration();_.delay(function(){"1"!==b.attr("data-active")&&(b.removeClass("displayBlock"),b.find(".message").text(b.find(".message").attr("data-oldtext")))},c)}function H(b){var c="car"==I.site.vertical?"quote":I.site.vertical;a("#"+c+"_journey_stage").val(b.navigationId)}var I=window.meerkat,J=I.modules.events,K=(I.logging.info,{journeyEngine:{BEFORE_STEP_CHANGED:"BEFORE_STEP_CHANGED",STEP_CHANGED:"STEP_CHANGED",STEP_INIT:"STEP_INIT",READY:"JOURNEY_READY",STEP_VALIDATION_ERROR:"STEP_VALIDATION_ERROR"}}),L=K.journeyEngine,M=null,N=!1,O=null,P="DIRECTION_FORWARD",Q="DIRECTION_BACKWARD",R={startStepId:null,steps:[],progressBarSteps:[],slideContainer:"#journeyEngineContainer",slideClassName:"journeyEngineSlide",transition:null},S={title:null,navigationId:null,slideId:null,initialised:!1,onInitialise:null,onBeforeEnter:null,onAfterEnter:null,onBeforeLeave:null,onAfterLeave:null,additionalHashInfo:null,validation:{validate:!0,customValidation:null},slideScrollTo:"html, body",tracking:null,externalTracking:null};I.modules.register("journeyEngine",{init:C,events:K,configure:c,getStepIndex:l,getCurrentStepIndex:o,getFurtherestStepIndex:q,getStepsTotalNum:m,isCurrentStepValid:u,getFormData:D,getSerializedFormData:E,getCurrentStep:r,loadingShow:F,loadingHide:G,gotoPath:z,getPreviousStepId:s,sessionCamRecorder:h})}(jQuery),function(a,b){function c(){a(document).ready(function(){r=a(".journeyProgressBar")}),n.messaging.subscribe(o.journeyEngine.STEP_INIT,function(b){t=b.navigationId,a(document).ready(function(){e(!0)})}),n.messaging.subscribe(o.journeyEngine.STEP_CHANGED,function(a){t=a.navigationId,e(!1)})}function d(b){s=b;var c=99/s.length;a("head").append("<style>.journeyProgressBar>li{ width: "+c+"% }</style>")}function e(a){var b="",c="",d="",e=_.isArray(s)?s.length-1:0,f=null,g=null,h=!1,i=!1;v?r.removeClass("invisible"):r.addClass("invisible"),_.each(s,function(a,j){f="",g="",i=t===a.navigationId||-1!=_.indexOf(a.matchAdditionalSteps,t),i?(f=' class="current"',h=!0):h?g=' tabindex="-1"':f=' class="complete"',u||i||h?c=d="div":(c='a href="javascript:;"'+g+' data-slide-control="'+a.navigationId+'"',d="a"),b+="<li"+f+"><"+c+">"+a.label+"</"+d+"></li>",j==e&&(f="","complete"==t&&(f=" complete"),b+='<li class="end'+f+'"><div></div></li>')}),r.html(b),a&&n.messaging.publish(q.INIT)}function f(){return s}function g(a){_.each(s,function(b,c){return b.label===a?!0:void 0})}function h(a,b){_.each(s,function(c,d){c.label===a&&(c.matchAdditionalSteps=[b])})}function i(){t="complete",r.addClass("complete"),e()}function j(){u=!1,e()}function k(){u=!0,e()}function l(){v=!0,e()}function m(){v=!1,e()}var n=window.meerkat,o=n.modules.events,p={journeyProgressBar:{INIT:"PROGRESS_BAR_INITED"}},q=p.journeyProgressBar,r=null,s=null,t=null,u=!1,v=!0;n.modules.register("journeyProgressBar",{init:c,render:e,events:p,configure:d,disable:k,enable:j,show:l,hide:m,setComplete:i,showSteps:f,checkLabel:g,addAdditionalStep:h})}(jQuery),function(a,b){function c(a){g()!==!1&&a!==j&&(h.html(d(h.html(),a)),k=j,j=a)}function d(a,b){if(g()!==!1){var c=new RegExp(j,"g");return a.replace(c,b)}}function e(){if(g()!==!1){var a=0;try{"undefined"!=typeof i?a=i.modules.transactionId.get():"undefined"!=typeof Track&&Track._getTransactionId&&(a=Track._getTransactionId())}catch(b){}k_button.setCustomVariable(7891,a)}}function f(){a(document).ready(function(){h=a("#kampyle"),g()!==!1&&(h.prependTo(a("#footer .container")),h.attr("data-kampyle-formid")&&(j=h.attr("data-kampyle-formid")),h.on("click","#kampylink",function(a){e(),"undefined"!=typeof k_button&&(a.preventDefault(),k_button.open_ff("site_code=7343362&lang=en&form_id="+j)),i.modules.writeQuote.write({triggeredsave:"kampyle"})}))})}function g(){return 0===h.length?!1:!0}var h,i=window.meerkat,j=(i.modules.events,i.logging.info,""),k="";i.modules.register("kampyle",{init:f,setFormId:c})}(jQuery),function(a,b){function c(){}function d(b,c){c=c||{};var d={url:"leadfeed/"+b.vertical+"/getacall.json",data:b,dataType:"json",cache:!1,useDefaultErrorHandling:!1,numberOfAttempts:3,errorLevel:"silent"};_.isObject(c)||_.isEmpty(c)||(d=a.extend(d,c)),e.modules.comms.post(d)}var e=window.meerkat,f=(e.modules.events,{});e.modules.register("leadFeed",{init:c,events:f,generate:d})}(jQuery),function(a,b){function c(){var b=!(f.modules.performanceProfiling.isIos()||f.modules.performanceProfiling.isIE8()||f.modules.performanceProfiling.isIE9()||f.modules.performanceProfiling.isIE10());a(document).ready(function(){i="generic"===f.site.vertical||"confirmation"==f.site.pageAction?!0:!1,b===!1&&a("#js-logo-link").length&&a("#js-logo-link").on("click",function(a){return f.modules.leavePageWarning.disable(),confirm(d())?void 0:!1})}),f.site.leavePageWarning.enabled&&f.site.isCallCentreUser===!1&&b===!0&&(window.onbeforeunload=function(){return i===!1?d():void 0},f.messaging.subscribe(g.journeyEngine.STEP_CHANGED,function(a){i=!1}),f.messaging.subscribe(g.saveQuote.QUOTE_SAVED,function(){i=!0}))}function d(){return f.modules.saveQuote.isAvailable()===!0?f.site.leavePageWarning.message:"undefined"!=typeof f.site.leavePageWarning.defaultMessage?f.site.leavePageWarning.defaultMessage:void 0}function e(){i=!0}var f=window.meerkat,g=f.modules.events,h=(f.logging.info,{leavePageWarning:{}}),i=(h.leavePageWarning,!0);f.modules.register("leavePageWarning",{init:c,events:h,disable:e})}(jQuery),function(a){function b(b){return b.each(function(){var b=a(this),c=b.attr("data-loadinganimation");"after"===c?b.next(".spinner").hide():b.find(".spinner").hide()}),b.find(".spinner")}function c(b){return b.each(function(){var b=a(this),c=b.next(".spinner");c.length>0?c.show():(b.attr("data-loadinganimation","after"),b.after(e()))}),b.find(".spinner")}function d(b,c){return b.each(function(){var b=a(this),d=b.find(".spinner");d.length>0?d.show():(b.attr("data-loadinganimation","inside"),c===!0?b.append(e()):b.prepend(e()))}),b.find(".spinner")}function e(){return'<div class="spinner"><div class="bounce1"></div><div class="bounce2"></div><div class="bounce3"></div></div>'}var f=window.meerkat;f.logging.info;f.modules.register("loadingAnimation",{hide:b,showAfter:c,showInside:d,getTemplate:e})}(jQuery),function(a,b){function c(){a(document).ready(d)}function d(){if($logo=a("html.lt-ie9 #logo"),$logo.length){var b=$logo.css("background-image").slice(5,-2),c=$logo.text();$logo.css("background-image","none"),$img=a("<img/>",{src:b,alt:c}).attr("style","width:100%;height:100%"),$logo.empty().append($img)}}var e=window.meerkat;e.modules.events;e.modules.register("logoIE8",{init:c})}(jQuery),function(a,b){function c(){a(document).ready(function(){var b=a("#mailCheckData");if(b.length){var c=JSON.parse(b.val());f=c.emailDomains,g=[];for(var d=0;d<f.length;d++)g.push(f[d].split(".")[0]);h=a(c.emailField),i=a(c.attemptsField),j=a(c.selectionsField),k=a(c.outputField),n()}})}var d=window.meerkat,e=(d.modules.events,d.logging.info,d.messaging,{}),f=null,g=null,h=null,i=null,j=null,k=null,l=null,m=function(a,b){if(!a||!b)return 99;for(var c=a.length,d=b.length,e=[],f=0;c>=f;f++)e[f]=[],e[f][0]=f;for(var g=0;d>=g;g++)e[0][g]=g;var h=0;for(g=1;d>=g;g++)for(f=1;c>=f;f++)h=a.charAt(f-1)==b.charAt(g-1)?0:1,e[f][g]=Math.min(e[f][g-1]+1,Math.min(e[f-1][g]+1,e[f-1][g-1]+h));return e[c][d]},n=function(){h.on("blur",function(b){var c=a(this).val();a(this).mailcheck({domains:f,secondLevelDomains:g,topLevelDomains:null,distanceFunction:m,suggested:function(b,d){_.isEmpty(c)||c==l||(l=c,p(i,c)),$link=a("<a/>",{title:"use "+d.full+" instead?",text:d.full}),$link.on("click",_.bind(o,this,d.full)),k.empty().append("Did you mean ").append($link).append("&nbsp;?")},empty:function(a){k.empty()}})})},o=function(a){p(j,a),h.val(a).trigger("blur")},p=function(a,b){var c=a.val();c=_.isEmpty(c)?b:c+","+b,a.val(c)};d.modules.register("mailCheck",{init:c,events:e})}(jQuery),function(a,b){function c(b){return K=a.extend({},J,b),"confirmation"===D.site.pageAction?!1:(jQuery(document).ready(function(a){"undefined"!=typeof K.template&&(A=_.template(K.template),d(),e())}),void D.messaging.subscribe(E.device.STATE_CHANGE,y))}function d(){"undefined"!=typeof Results.settings&&(a(Results.settings.elements.page).on("click",".btn-more-info",f),a(Results.settings.elements.page).on("click",".btn-close-more-info",i)),a(document).on("resultsFetchStart",function(){i()}),a(document.body).on("click",".btn-more-info-apply",function(b){b.preventDefault();var c=a(this);c.addClass("inactive").addClass("disabled"),D.modules.loadingAnimation.showInside(c,!0),"function"==typeof K.onBeforeApply&&K.onBeforeApply(),Results.setSelectedProduct(c.attr("data-productId"));var d=Results.getSelectedProduct();return d?"function"==typeof K.onClickApplyNow?K.onClickApplyNow(d,r):void 0:(r(!1),!1)}),a(document.body).on("click",".dialogPop",function(){D.modules.dialogs.show({title:a(this).attr("title"),htmlContent:a(this).attr("data-content")})}),a(document.body).on("click",".more-info",function(a){n(D.modules.carResults.getSelectedProduct()),openModal()})}function e(){a(document).on("resultPageChange",function(){I&&i()})}function f(b){var c=a(this);if("undefined"!=typeof c.attr("data-productId")&&("undefined"==typeof c.attr("data-available")||"Y"===c.attr("data-available"))){"function"==typeof K.onBeforeShowBridgingPage&&K.onBeforeShowBridgingPage();var d=c.attr("data-productId"),e=c.hasClass("more-info-showapply");n(Results.getResult("productId",d),e),K.runDisplayMethod(d),D.modules.sessionCamHelper.setMoreInfoModal()}}function g(b){x(!0),b.html(D.modules.loadingAnimation.getTemplate()).show(),p(function(){var c=A(z);b.find(".spinner").fadeOut(),b.html(c),"function"==typeof K.onBeforeShowTemplate&&K.onBeforeShowTemplate(C);var d=400,e=250,f=0;I?(b.find(".more-info-content")[K.showAction](d,function(){"function"==typeof K.onAfterShowTemplate&&K.onAfterShowTemplate()}),f=d):(D.modules.utils.scrollPageTo(".resultsHeadersBg",e,-a("#navbar-main").height(),function(){"function"==typeof updatePosition&&(updatePosition(),b.css({top:topPosition})),b.find(".more-info-content")[K.showAction](d,l),I=!0,"function"==typeof K.onAfterShowTemplate&&K.onAfterShowTemplate()}),f=d+e),_.delay(function(){D.messaging.publish(G.bridgingPage.SHOW,{isOpen:I})},f);var g={productID:z.productId};null!==K.additionalTrackingData&&"object"==typeof K.additionalTrackingData&&(g=a.extend({},g,K.additionalTrackingData)),z.hasOwnProperty("brandCode")&&(g.productBrandCode=z.brandCode),D.messaging.publish(E.tracking.EXTERNAL,{method:"trackProductView",object:g}),D.messaging.publish(E.tracking.TOUCH,{touchType:"H",touchComment:"MoreInfo"}),D.modules.session.poke()})}function h(){p(function(){x(!0);var b={htmlContent:A(z),hashId:"moreinfo",closeOnHashChange:!0};"function"==typeof K.onBeforeShowModal&&(b.onOpen=function(a){K.onBeforeShowModal(C)}),"object"==typeof K.modalOptions&&(b=a.extend(b,K.modalOptions)),B=D.modules.dialogs.show(b),H=!0,a(".bridgingContainer, .more-info-content").show(),"function"==typeof K.onAfterShowModal&&K.onAfterShowModal(),_.delay(function(){D.messaging.publish(G.bridgingPage.SHOW,{isOpen:H})},0);var c={productID:z.productId};null!==K.additionalTrackingData&&"object"==typeof K.additionalTrackingData&&(c=a.extend({},c,K.additionalTrackingData)),z.hasOwnProperty("brandCode")&&(c.productBrandCode=z.brandCode),D.messaging.publish(E.tracking.EXTERNAL,{method:"trackProductView",object:c}),D.messaging.publish(E.tracking.TOUCH,{touchType:"H",touchComment:"MoreInfo"})})}function i(){H&&(k(),D.modules.address.removeFromHash("moreinfo"),D.modules.sessionCamHelper.setResultsShownPage()),I&&(j(K.container),D.modules.address.removeFromHash("moreinfo"),D.modules.sessionCamHelper.setResultsShownPage())}function j(a){"function"==typeof K.onBeforeHideTemplate&&K.onBeforeHideTemplate(),a[K.hideAction](400,function(){x(!1),m(a),"function"==typeof K.onAfterHideTemplate&&K.onAfterHideTemplate()})}function k(){a("#"+B).modal("hide"),a(".bridgingContainer, .more-info-content").hide(function(){x(!1)}),H=!1}function l(){D.messaging.publish(G.bridgingPage.CHANGE,{isOpen:!0})}function m(a){a.empty().hide(),I=!1,D.messaging.publish(G.bridgingPage.CHANGE,{isOpen:I}),D.messaging.publish(G.bridgingPage.HIDE,{isOpen:I})}function n(a,b){return"undefined"!=typeof a&&"undefined"!=typeof a.productId&&Results.setSelectedProduct(a.productId),z=a,z!==!1&&(b===!0?z.showApply=!0:z.showApply=!1),z}function o(){return I===!1&&H===!1?null:z}function p(a){"function"==typeof K.prepareCover&&K.prepareCover(),q(a)}function q(b){a.when(K.retrieveExternalCopy(z)).then(b)}function r(b){_.delay(function(){a(".btn-more-info-apply").removeClass("inactive").removeClass("disabled"),D.modules.loadingAnimation.hide(a(".btn-more-info-apply"))},1e3),b===!0&&"function"==K.onApplySuccess&&K.onApplySuccess()}function s(){return I}function t(){return H}function u(a){C=a}function v(){return C}function w(b){"object"==typeof b&&(K=a.extend(!0,{},K,b))}function x(b){b=b||!1,b?a("body").addClass(L):a("body").removeClass(L)}function y(){_.isFunction(K.onBreakpointChangeCallback)&&_.defer(K.onBreakpointChangeCallback)}var z,A,B,C,D=window.meerkat,E=D.modules.events,F=(D.logging.info,{moreInfo:{bridgingPage:{CHANGE:"BRIDGINGPAGE_CHANGE",SHOW:"BRIDGINGPAGE_SHOW",HIDE:"BRIDGINGPAGE_HIDE"}}}),G=F.moreInfo,H=!1,I=!1,J={container:a(".bridgingContainer"),template:a("#more-info-template").html(),hideAction:"slideUp",showAction:"slideDown",modalOptions:!1,runDisplayMethod:null,onBeforeShowBridgingPage:null,onBeforeShowTemplate:null,onBeforeShowModal:null,onAfterShowTemplate:null,onAfterShowModal:null,onBeforeHideTemplate:null,onAfterHideTemplate:null,onBeforeApply:null,onClickApplyNow:null,onApplySuccess:null,retrieveExternalCopy:null,additionalTrackingData:null,onBreakpointChangeCallback:null},K={},L="moreInfoVisible";D.modules.register("moreInfo",{initMoreInfo:c,events:F,open:f,close:i,showTemplate:g,hideTemplate:j,showModal:h,hideModal:k,isBridgingPageOpen:s,isModalOpen:t,getOpenProduct:o,setProduct:n,setDataResult:u,getDataResult:v,applyCallback:r,updateSettings:w})}(jQuery),function(a,b){function c(){m.addClass("disabled")}function d(){m.removeClass("disabled")}function e(){m.hasClass("collapsed")===!0&&(n.addClass("in"),o.addClass("active"),m.removeClass("collapsed"),a('<div class="navMenu-backdrop-underlay" />').prependTo(p).on("click",f))}function f(){m.hasClass("collapsed")===!1&&(n.removeClass("in"),o.removeClass("active"),m.addClass("collapsed"),a(".navMenu-backdrop-underlay").remove())}function g(){h()?d():c()}function h(){var b=-1;return a(".navMenu-contents").find(".navbar-nav").find("li").each(function(){"block"==a(this).css("display")&&b++,b>0}),b>0}function i(){l("[navMenu] Initialised"),a(document).ready(function(){m=a("[data-toggle=navMenu]"),n=a(".navMenu-contents"),o=a(".navMenu-row"),p=a(".navMenu-row .navMenu-row-fixed"),"offcanvas"===j.site.navMenu.type&&(o.addClass("navMenu-offcanvas"),"left"===j.site.navMenu.direction?o.addClass("navMenu-left"):o.addClass("navMenu-right")),debug("[navMenu] Configured as: "+j.site.navMenu.type+" "+j.site.navMenu.direction),m.on("click",function(){m.hasClass("disabled")===!1&&(m.hasClass("collapsed")===!0?e():f())}),g()}),j.messaging.subscribe(k.journeyEngine.STEP_CHANGED,function(){j.modules.navMenu.close(),g()}),j.messaging.subscribe(k.device.STATE_LEAVE_XS,function(){j.modules.navMenu.close()}),j.messaging.subscribe(k.device.STATE_ENTER_XS,function(){a(".navbar-nav .open").length>0&&j.modules.navMenu.open(),g()}),j.messaging.subscribe(k.journeyEngine.STEP_INIT,function(){g()}),j.messaging.publish(r.READY,this)}var j=window.meerkat,k=j.modules.events,l=j.logging.info;debug=j.logging.debug;var m,n,o,p,q={navMenu:{READY:"NAVMENU_READY"}},r=q.navMenu;j.modules.register("navMenu",{init:i,events:q,close:f,open:e,enable:d,disable:c,toggleNavMenu:g})}(jQuery),function(a,b){function c(){}function d(){var b=a(':input[id$="privacyoptin"]');return"checkbox"==b.attr("type")?b.is(":checked"):"Y"===b.val()}function e(a){var b={save_email:a.data.value,vertical:f.site.vertical},c={url:"ajax/json/get_user_exists.jsp",data:b,dataType:"json",cache:!1,errorLevel:"silent",onSuccess:function(b){"function"==typeof a.onSuccess&&a.onSuccess(b)},onError:function(){"function"==typeof a.onError&&a.onError()},onComplete:function(){"function"==typeof a.onComplete&&a.onComplete()}};return a.hasOwnProperty("returnAjaxObject")&&(c.returnAjaxObject=a.returnAjaxObject),f.modules.comms.post(c)}var f=window.meerkat,g=(f.modules.events,f.logging.info,f.messaging,{optIn:{}});g.optIn;f.modules.register("optIn",{init:c,events:g,fetch:e,isPrivacyOptedIn:d})}(jQuery),function(a,b){function c(b){var c=b.product,d=c.handoverType&&"post"===c.handoverType.toLowerCase()?"POST":"GET",e=b.brand?b.brand:c.provider,f=b.msg?b.msg:"",g=_.omit(b.tracking,"brandCode");g.brandXCode=b.tracking.brandCode,g=encodeURIComponent(JSON.stringify(g));try{return m="transferring.jsp?transactionId="+k.modules.transactionId.get()+"&trackCode="+c.trackCode+"&brand="+e+"&msg="+f+"&vertical="+k.site.vertical+"&productId="+c.productId+"&tracking="+g,"post"===d.toLowerCase()&&(m+="&handoverType="+c.handoverType+"&handoverData="+encodeURIComponent(c.handoverData)+"&handoverURL="+encodeURIComponent(c.handoverUrl)+"&handoverVar="+c.handoverVar),a.isEmptyObject(b.extraParams)||a.each(b.extraParams,function(a,b){m+="&"+a+"="+escape(b)}),m}catch(h){return k.modules.errorHandling.error({errorLevel:"warning",message:b.errorMessage,page:"partnerTransfer.js:buildURL",description:b.errorDescription,data:c}),null}}function d(a){var b=null;if(!_.isUndefined(a)&&_.isString(a)){var c=a.split("?");2==c.length&&(b=c[1])}return b}function e(b){var c=_.pick(b,"actionStep","brandCode","currentJourney","lastFieldTouch","productBrandCode","productID","productName","quoteReferenceNumber","rootID","trackingKey","transactionID","type","vertical","verticalFilter","handoverQS","simplesUser"),e="undefined"==typeof k.modules.coverLevelTabs?"default":k.modules.coverLevelTabs.getOriginatingTab(),f="undefined"==typeof k.modules.coverLevelTabs?"default":k.modules.coverLevelTabs.getDepartingTabJourney();return k.modules.tracking.updateObjectData(c),c=a.extend({actionStep:null,brandCode:null,currentJourney:null,lastFieldTouch:null,productBrandCode:b.product.provider,productID:b.product.productId,productName:b.product.name,quoteReferenceNumber:"undefined"!=typeof b.product.leadNo?b.product.leadNo:c.transactionID,rootID:null,transactionID:null,type:"ONLINE",vertical:null,verticalFilter:null,originatingTab:e,departingTab:f,handOverQS:d(b.product.quoteUrl),simplesUser:k.site.isCallCentreUser},c),_.isEmpty(c.actionStep)&&(c.actionStep=a.trim(c.vertical+" transfer "+c.type)),c}function f(b){var d=a.extend({},n,b);d.product;if(d.tracking=e(d),m=c(d),null!=m){if(d.closeBridgingModalDialog===!0&&(k.modules.moreInfo.isBridgingPageOpen()||k.modules.moreInfo.isModalOpen())&&k.modules.moreInfo.close(),a("html").hasClass("ie")){var f="location=1,menubar=1,resizable=1,scrollbars=1,status=1,titlebar=1,toolbar=1,top=0,left=0,height="+screen.availHeight+",width="+screen.availWidth;window.open(m,"_blank",f)}else window.open(m,"_blank");a("#transferring-popup").length>0&&a("#transferring-popup").delay(4e3).queue(function(a){a()}),d.trackHandover===!0&&g(d.tracking,{type:"A",productId:d.product.productId,comment:"Apply Online"}),_.has(d,"noSaleLead")&&!_.isEmpty(d.noSaleLead)&&k.modules.leadFeed.generate(d.noSaleLead.data,d.noSaleLead.settings),k.messaging.publish(o.partnerTransfer.TRANSFER_TO_PARTNER,{transactionID:d.tracking.transactionID,partnerID:d.product.trackCode,productDescription:d.product.productId})}"function"==typeof d.applyNowCallback&&d.applyNowCallback(!0)}function g(a,b){b=b||!1,b!==!1&&_.isObject(b)&&_.has(b,"type")&&k.messaging.publish(l.tracking.TOUCH,{touchType:b.type,touchComment:_.has(b,"comment")?b.comment:"",productId:b.productId});var c=_.pick(a,"actionStep","brandCode","currentJourney","departingTab","lastFieldTouch","originatingTab","productBrandCode","productID","productName","quoteReferenceNumber","rootID","trackingKey","transactionID","type","vertical","verticalFilter","handoverQS","simplesUser");k.messaging.publish(l.tracking.EXTERNAL,{method:"trackQuoteHandoverClick",object:c}),k.modules.session.poke()}function h(a,b){a=e(a||{}),b=b||!1,g(a,b)}function i(){a(document.body).on("click",".btn-apply",function(b){b.preventDefault();var c=Results.getResultByProductId(a(this).attr("data-productid")),d={product:c};f(d)})}function j(){a(document).ready(function(){i()})}var k=window.meerkat,l=k.modules.events,m=(k.logging.info,null),n={product:null,trackHandover:!0,applyNowCallback:null,errorMessage:"An error occurred. Sorry about that!",errorDescription:"There is an issue with the handover url.",closeBridgingModalDialog:!0},o={partnerTransfer:{TRANSFER_TO_PARTNER:"TRANSFER_TO_PARTNER"}};k.modules.register("partnerTransfer",{initTransfer:j,transferToPartner:f,trackHandoverEvent:h,buildURL:c,events:o})}(jQuery),function(a,b){function c(){return"1"===x.val()}function d(){return x.val("")}function e(a){g(),x.val("1").valid(),F.paymentEngine.success(a),m(),i()}function f(a){l(),j(),a&&a.length>0&&(g(),F.paymentEngine.fail(a),y.modules.errorHandling.error({message:a,page:"paymentGateway.js",description:"meerkat.modules.paymentGateway.fail()",errorLevel:"silent",data:F}))}function g(){B=!0,y.modules.dialogs.close(modalId)}function h(){var a="cc";return"function"==typeof F.getSelectedPaymentMethod&&(a=F.getSelectedPaymentMethod()),E!==a&&d(),E="cc"==a&&F.handledType.credit||"ba"==a&&F.handledType.bank?a:"",n(),""!==E}function i(){v.slideDown(),w.slideUp()}function j(){v.slideUp(),w.slideDown()}function k(){v.slideUp(),w.slideUp()}function l(){u.slideDown()}function m(){u.slideUp()}function n(){c()?(m(),i()):(d(),l(),k()),o()}function o(){switch(E){case"cc":a("."+F.name+"-credit").slideDown(),x.rules("add",{required:!0,messages:{required:"Please register your credit card details"}});break;default:a("."+F.name+"-credit").slideUp("","",function(){a(this).hide()}),q()}}function p(){F.handledType={credit:!1,bank:!1},E="",n(),a("body").removeClass(F.name+"-active"),q(),d(),a('[data-provide="paymentGateway"]').off("click",'[data-gateway="launcher"]',t),a("#update-premium").off("click."+F.name,h),"undefined"!=typeof F.paymentTypeSelector&&F.paymentTypeSelector.trigger("change"),y.messaging.unsubscribe(A.SUCCESS,C),y.messaging.unsubscribe(A.FAIL,D)}function q(){x.rules("remove","required")}function r(){}function s(b){return F=a.extend({},F,b),a('[data-provide="paymentGateway"]').on("click",'[data-gateway="launcher"]',t),null==F.paymentEngine?!1:(u=a("."+F.name+" .launcher"),v=a("."+F.name+" .success"),w=a("."+F.name+" .fail"),x=a("#"+F.name+"-registered"),F.paymentEngine.setup(F),a("body").addClass(F.name+"-active"),a("#update-premium").on("click."+F.name,h),"object"==typeof F.clearValidationSelectors&&F.clearValidationSelectors.on("change",q),C=y.messaging.subscribe(A.SUCCESS,e),void(D=y.messaging.subscribe(A.FAIL,f)))}function t(){B=!1,y.modules.tracking.recordSupertag("trackCustomPage","Payment gateway popup"),modalId=y.modules.dialogs.show({htmlContent:y.modules.loadingAnimation.getTemplate(),onOpen:F.paymentEngine.onOpen,onClose:function(){B||f()}})}var u,v,w,x,y=window.meerkat,z=(y.modules.events,y.logging.info,{paymentGateway:{SUCCESS:"PAYMENT_GATEWAY_SUCCESS",FAIL:"PAYMENT_GATEWAY_FAIL"}}),A=z.paymentGateway,B=!1,C=null,D=null,E="",F={paymentEngine:null,name:"",handledType:{credit:!1,bank:!1}};y.modules.register("paymentGateway",{init:r,events:z,reset:p,setup:s})}(jQuery),function(a,b){function c(a){var b=(new Date).getTime(),c={name:a,startTime:b};w.push(c)}function d(a){var b=(new Date).getTime(),c=_.findWhere(w,{name:a});if("undefined"==typeof c)return null;var d=w.indexOf(c);w.splice(d,1);var e=b-c.startTime;return e}function e(){return!!navigator.platform.match(/iPhone|iPod|iPad/i)}function f(){return y.indexOf("android")>-1}function g(){return y.indexOf("chrome")>-1}function h(){return y.indexOf("opera mini")>-1}function i(){return y.indexOf("blackBerry")>-1}function j(){return y.indexOf("iemobile")>-1}function k(){return e()||f()||i()||h()||j()}function l(){return y.match(/firefox\/(30|31|32|33|34).*/i)}function m(){return y.match(/(8\.\d+\.?\d?|7\.1|6\.2) safari/i)}function n(){return 8===u()?!0:!1}function o(){return 9===u()?!0:!1}function p(){return 10===u()?!0:!1}function q(){return 11===u()?!0:!1}function r(){return e()&&y.match(/os 5/)?!0:!1}function s(){return e()&&y.match(/os 6/)?!0:!1}function t(){return e()&&y.match(/os 7/)?!0:!1}function u(){var a=y,b=a.indexOf("msie ")>0||a.indexOf("trident")>0;if(b){var c=a.indexOf("msie");if(-1==c){var d=a.match(/trident.*rv[ :]*(11|12)\./i);return parseInt(d[1])}return parseInt(a.substring(c+5,a.indexOf(".",c)))}return null}var v=window.meerkat,w=(v.modules.events,[]),x={LOW:"low",MEDIUM:"medium",HIGH:"high"},y=navigator.userAgent.toLowerCase();v.modules.register("performanceProfiling",{PERFORMANCE:x,startTest:c,endTest:d,isIos5:r,isIos6:s,isIos7:t,isIos:e,isAndroid:f,isChrome:g,isBlackBerry:i,isOpera:h,isWindows:j,isMobile:k,isFFAffectedByDropdownMenuBug:l,isSafariAffectedByColumnCountBug:m,isIE8:n,isIE9:o,isIE10:p,isIE11:q,getIEVersion:u})}(jQuery),function(a,b){function c(){var b,c=a(this);c.data("fakeplaceholder")||c.is("[type=checkbox]")||c.is("[type=radio]")||c.is("[type=hidden]")||c.is("[type=file]")||(b=a("<div/>",{"class":"fakeplaceholder"}),b.height(c.height()-c.css("padding-bottom").replace("px","")).css({"margin-top":c.css("margin-top"),"margin-bottom":c.css("margin-bottom"),"margin-left":c.css("margin-left"),"margin-right":c.css("margin-right"),"padding-top":c.css("padding-top"),"padding-bottom":c.css("padding-bottom"),"padding-left":c.css("padding-left"),"padding-right":c.css("padding-right"),"font-size":c.css("font-size"),"line-height":c.css("line-height"),color:c.css("color")}).data("for",c),c.before(b.text(c.attr("placeholder"))).data("fakeplaceholder",b),c.val()&&b.hide())}function d(b){if(!i){var d=a(b||document).find("[placeholder]");d.each(c)}}function e(){i||(d(),a(document).on("focus.fakeplaceholder","input[placeholder]",function(){var b=a(this),c=b.data("fakeplaceholder");"undefined"!=typeof c&&c.hide()}).on("blur.fakeplaceholder","input[placeholder]",function(){var b=a(this),c=b.data("fakeplaceholder");!b.val()&&"undefined"!=typeof c&&c.show()}).on("click.fakeplaceholder",".fakeplaceholder",function(){a(this).data("for").focus()}),h("[Placeholder] Initialised"))}function f(a){placeholder=a.data("fakeplaceholder"),placeholder&&placeholder.length>0&&(a.val()?placeholder.hide():placeholder.show())}var g=window.meerkat,h=g.logging.info,i=Modernizr.input.placeholder;g.modules.register("placeholder",{init:e,initPlaceholders:d,invalidatePlaceholder:f})}(jQuery),function(a,b){function c(){if(navigator.userAgent.match(/IEMobile\/10\.0/)){var b=document.createElement("style");b.appendChild(document.createTextNode("@-ms-viewport{width:auto!important}")),document.getElementsByTagName("head")[0].appendChild(b)}e&&a(document).on("click",'form button[type="submit"]',function(b){b.preventDefault(),a(this).closest("form").submit()}).on("keypress","form input",function(b){13===b.which&&a(this).closest("form").submit()}),a(function(){"undefined"!=typeof FastClick&&FastClick.attach(document.body);
})}var d=window.meerkat,e="button"===document.createElement("button").type;d.modules.register("polyfills",{init:c})}(jQuery),function(a,b){function c(b){var c=a.extend({},f,b),d="",g=null;"url"==c.contentType?g=function(b,f){var g=e.modules.loadingAnimation.getTemplate();return e.modules.comms.get({url:c.contentValue,cache:!0,errorLevel:"silent",onSuccess:function(b){var c="";a(b).find("help").each(function(){""===d&&(d=a(this).attr("header")),c+=a(this).text()}),g=c,f.set("content.text",c),f.set("content.title",d),f.reposition()},onError:function(){f.set("content.text","Apologies. This information did not download successfully."),f.reposition()}}),g}:(g=c.contentValue,d=c.element.attr("data-title"));var h=null;h=c.element.attr("data-trigger")?c.element.attr("data-trigger"):c.showEvent;var i=null;switch(h){case"mouseenter":i="mouseleave";break;case"mouseenter click":case"click mouseenter":i="mouseleave unfocus click";break;default:i="unfocus click"}c.element.qtip({content:{text:g,title:d},position:c.position?c.position:{my:c.element.attr("data-my")?c.element.attr("data-my"):"left center",at:c.element.attr("data-at")?c.element.attr("data-at"):"right center",effect:!1,adjust:{method:"flipinvert none",x:c.element.attr("data-adjust-x")?parseInt(c.element.attr("data-adjust-x")):0,y:c.element.attr("data-adjust-y")?parseInt(c.element.attr("data-adjust-y")):0},viewport:a(window)},show:{event:h},hide:{event:i,fixed:!0,delay:150},style:c.style?c.style:{classes:c.element.attr("data-class")?"popover "+c.element.attr("data-class"):"popover",tip:{corner:!0,width:12,height:6}}})}function d(){e.messaging.subscribe("DYNAMIC_CONTENT_PARSED_POPOVER",function(a){a.element.attr("data-hasqtip")||(c(a),a.element.qtip("toggle",!0))})}var e=window.meerkat,f=(e.logging.info,{element:null,contentType:null,contentValue:null,showEvent:"click",onOpen:function(){},onClose:function(){},onLoad:function(){}});e.modules.register("popovers",{init:d,create:c})}(jQuery),function(a,b){function c(){a(document).on("change","[data-toggle^=radio] input",function(b){var c,d=a(b.target);c=d.parent().parent().find(".btn"),c.removeClass("active"),d.is(":checked")&&(c=d.parent(),c.addClass("active"))}),a(document).on("focusin","[data-toggle^=radio] input",function(b){var c=a(b.target).parent().parent().find(".btn");c.removeClass("focus"),c=a(b.target).parent(),c.addClass("focus")}),a(document).on("focusout","[data-toggle^=radio] input",function(b){var c=a(b.target).parent().parent().find(".btn");c.removeClass("focus")})}function d(a,b,c){if("undefined"!=typeof a&&0!==a.length){var d=a.find("label:eq("+b+")");return d.contents().filter(function(){return 3===this.nodeType}).each(function(){var a=/[a-z0-9]+/i;if(this.textContent){if(a.test(this.textContent)===!1)return;this.textContent=c}else if(this.innerText){if(a.test(this.innerText)===!1)return;this.innerText=c}}),d}}var e=window.meerkat;e.modules.register("radioGroup",{init:c,changeLabelText:d})}(jQuery),function(a,b){function c(){}function d(b,c){b=_.extend({plateNumber:null,state:null},b),c=c||{};var d={url:"rest/rego/lookup/list.json",data:b,dataType:"json",cache:!0,useDefaultErrorHandling:!0,numberOfAttempts:3,errorLevel:"fatal"};_.isObject(c)&&!_.isEmpty(c)&&(d=a.extend(d,c)),e.modules.comms.get(d)}var e=window.meerkat,f=(e.modules.events,{});e.modules.register("regoLookup",{init:c,events:f,get:d})}(jQuery),function(a,b){function c(){if("undefined"!=typeof f.site&&"confirmation"!=f.site.pageAction){var b="car"==f.site.vertical?"quote":f.site.vertical;e=a("#"+b+"_renderingMode"),e.length?f.messaging.subscribe(g.journeyEngine.READY,d):a("#mainform").append('<input type="hidden" name="'+b+'_renderingMode" id="'+b+'_renderingMode" class="" value="'+f.modules.deviceMediaState.get()+'" data-autosave="true">'),f.messaging.subscribe(g.journeyEngine.BEFORE_STEP_CHANGED,d),f.messaging.subscribe(g.RESULTS_INITIALISED,d)}}function d(){e.val(f.modules.deviceMediaState.get())}var e,f=window.meerkat,g=f.modules.events;f.modules.register("renderingMode",{init:c})}(jQuery),function(a,b){function c(){u=a(".resultsHeadersBg"),v=a(".affixOnScroll"),w=a(".resultsContainer"),x=a("#navbar-main").height()}function d(b){if(0===D||b){var c=0;a(".dynamicTopHeaderContent > *").each(function(){a(this).hasClass("simplesHidden")&&A.site.isCallCentreUser||(c+=a(this).height())}),D=c+a(".header-top .container").height()+u.position().top}}function e(){return a(window).scrollTop()>=D?!0:!1}function f(){return a(window).scrollTop()>=D+5?!0:!1}function g(){return w.hasClass("affixed")}function h(){return w.hasClass("affixed-compact")}function i(){return w.hasClass("affixed-absoluted")}function j(){d(),e()===!0?(g()===!1&&(v.addClass("affixed"),w.addClass("affixed-settings")),f()===!0&&h()===!1?(v.addClass("affixed-compact"),w.find(".result .productSummary").addClass("compressed")):f()===!1&&h()===!0&&k()):e()===!1&&g()===!0&&l()}function k(){v.removeClass("affixed-compact"),w.find(".result .productSummary").removeClass("compressed")}function l(){k(),v.removeClass("affixed"),w.removeClass("affixed-settings")}function m(){if(g()&&E===!1){E=!0;var b=a(window).scrollTop()+x-w.offset().top;w.find(".result").css("top",b+"px"),w.removeClass("affixed"),w.addClass("affixed-absoluted")}}function n(){i()&&E===!0&&(E=!1,w.removeClass("affixed-absoluted"),w.addClass("affixed"),w.find(".result").css("top",""))}function o(){h()&&a(Results.settings.elements.productHeaders).refreshLayout()}function p(){"xs"!==A.modules.deviceMediaState.get()&&(_.defer(function(){j()}),a(window).on("scroll.resultsHeaderBar",_.throttle(j,25)),y=A.messaging.subscribe(B.device.STATE_ENTER_XS,function(){q()}))}function q(){A.messaging.unsubscribe(y),l(),a(window).off("scroll.resultsHeaderBar"),r()}function r(){z=A.messaging.subscribe(B.device.STATE_LEAVE_XS,function(){A.messaging.unsubscribe(z),s()})}function s(){"xs"===A.modules.deviceMediaState.get()?r():p(),a(Results.settings.elements.resultsContainer).off("pagination.instantScroll").on("pagination.instantScroll",o),a(Results.settings.elements.resultsContainer).off("pagination.scrolling.start").on("pagination.scrolling.start",m),a(Results.settings.elements.resultsContainer).off("pagination.scrolling.end").on("pagination.scrolling.end",n),a(Results.settings.elements.resultsContainer).off("results.view.animation.start").on("results.view.animation.start",m),a(Results.settings.elements.resultsContainer).off("results.view.animation.end").on("results.view.animation.end",n),u.prevAll(".simples-dialogue.toggle").off("click.updateHeaderBarOffset").on("click.updateHeaderBarOffset",function(){_.delay(function(){d(!0)},300)})}function t(){"undefined"!=typeof y&&A.messaging.unsubscribe(y),"undefined"!=typeof z&&A.messaging.unsubscribe(z),a(window).off("scroll.resultsHeaderBar"),a(Results.settings.elements.resultsContainer).off("pagination.instantScroll"),a(Results.settings.elements.resultsContainer).off("pagination.scrolling.start"),a(Results.settings.elements.resultsContainer).off("pagination.scrolling.end"),a(Results.settings.elements.resultsContainer).off("results.view.animation.start"),a(Results.settings.elements.resultsContainer).off("results.view.animation.end")}var u,v,w,x,y,z,A=window.meerkat,B=A.modules.events,C=(window.meerkat.logging.info,{resultsHeaderBar:{}}),D=(C.resultsHeaderBar,0),E=!1;A.modules.register("resultsHeaderBar",{init:c,registerEventListeners:s,removeEventListeners:t,enableAffixMode:p,disableAffixMode:q})}(jQuery),function(a,b){function c(a){if(Results.settings.hasOwnProperty("rankings")){var b=Results.settings.rankings;if(_.isObject(b)){var c=e(b.filterUnavailableProducts),h=f(b,c);h&&(g(b,c),d(a,h),l.messaging.publish(m.RESULTS_RANKING_READY))}}}function d(a,b){n("[resultsRankings] sendWriteRank",{trigger:a,data:b}),Results.getFilteredResults().length&&l.modules.comms.post({url:"ajax/write/quote_ranking.jsp",data:b,cache:!1,errorLevel:"silent",onError:function(a,b,c,d,e){l.modules.errorHandling.error({message:"Failed to write ranking results.",page:"core:resultsRankings.js:runWriteRank()",errorLevel:"silent",description:"Failed to write ranking results: "+c,data:{settings:d,resultsData:e}})}})}function e(a){var b=[],c=Results.getSortedResults(),d=Results.getFilteredResults();if(a===!0)for(var e=0;e<c.length;e++)for(var f=0;f<d.length;f++)c[e]==d[f]&&(b[b.length]=c[e]);else b=c;return b}function f(a,b){var c={rootPath:l.site.vertical,rankBy:Results.getSortBy()+"-"+Results.getSortDir(),rank_count:b.length,transactionId:l.modules.transactionId.get()},d=null;if(a.hasOwnProperty("paths")&&_.isObject(a.paths)?d="paths":a.hasOwnProperty("callback")&&_.isFunction(a.callback)&&(d="callback"),null===d)return null;for(var e=0;e<b.length;e++){var f=b[e];switch(d){case"paths":for(var g in a.paths)if(a.paths.hasOwnProperty(g)){var h=Object.byString(f,a.paths[g]);c[g+e]=h}break;case"callback":var i=a.callback(f,e);_.isObject(i)&&!_.isEmpty(i)&&_.extend(c,i)}}return c}function g(a,b){r=[];var c=!1;a.hasOwnProperty("forceIdNumeric")&&_.isBoolean(a.forceIdNumeric)&&(c=a.forceIdNumeric);for(var d=0,e=0;e<b.length;e++){d++;var f=b[e];if("object"==typeof f){var g=f.productId;c&&(g=String(g).replace(/\D/g,"")),data={productID:g,productName:Object.byString(f,Results.settings.paths.productName)||null,productBrandCode:Object.byString(f,Results.settings.paths.productBrandCode)||null,ranking:d,available:Object.byString(f,Results.settings.paths.availability.product)||"N"},r.push(data)}}}function h(){return r}function i(){var a=Results.settings.rankings;if(_.isObject(a)){var b=e(!0);g(a,b)}}function j(){var a=Results.settings.rankings;if(_.isObject(a)&&(a.hasOwnProperty("paths")&&!_.isEmpty(a.paths)||a.hasOwnProperty("callback")&&_.isFunction(a.callback))){var b=q;a.hasOwnProperty("triggers")&&_.isArray(a.triggers)&&(b=a.triggers);for(var d=0;d<b.length;d++)m.hasOwnProperty(b[d])&&l.messaging.subscribe(m[b[d]],_.bind(c,this,b[d]))}}function k(){a(document).ready(function(){l.messaging.subscribe(m.RESULTS_INITIALISED,j)})}var l=window.meerkat,m=l.modules.events,n=window.meerkat.logging.info,o={RESULTS_RANKING_READY:"RESULTS_RANKING_READY",RESULTS_INITIALISED:"RESULTS_INITIALISED",RESULTS_DATA_READY:"RESULTS_DATA_READY",RESULTS_SORTED:"RESULTS_SORTED"},p=o,q=["RESULTS_DATA_READY","RESULTS_SORTED"],r=[];l.modules.register("resultsRankings",{init:k,events:p,write:c,getTrackingProductObject:h,resetTrackingProductObject:i,sendQuoteRanking:d,fetchProductsToRank:e,getWriteRankData:f})}(jQuery),function(a,b){function c(){"generic"!==h.site.vertical&&""!==h.site.vertical&&h.messaging.subscribe(l.TRACK_QUOTE_RESULTS_LIST,g)}function d(a){m=a}function e(){return m}function f(){var a;return h.modules.compare.isCompareOpen()===!0?a="compare":(a=Results.getDisplayMode(),a=0===a.indexOf("f")?a.slice(0,-1):a),a}function g(b){j("[trackQuoteResultsList]",b),b=b||{};var c=h.modules.tracking.getTrackingVertical(),e={actionStep:c+" results",display:f(),event:m,products:h.modules.resultsRankings.getTrackingProductObject(),rankingFilter:"undefined"!=typeof h.modules.coverLevelTabs?h.modules.coverLevelTabs.getRankingFilter():"default",recordRanking:"Y",offeredCouponID:h.modules.coupon.getCurrentCoupon()?h.modules.coupon.getCurrentCoupon().couponId:null};"object"==typeof b.additionalData&&(e=a.extend({},e,b.additionalData)),h.messaging.publish(i.tracking.EXTERNAL,{method:"trackQuoteResultsList",object:e}),"string"==typeof b.onAfterEventMode&&d(b.onAfterEventMode)}var h=window.meerkat,i=h.modules.events,j=h.logging.info,k={resultsTracking:{TRACK_QUOTE_RESULTS_LIST:"TRACK_QUOTE_RESULTS_LIST"}},l=k.resultsTracking,m="Load";h.modules.register("resultsTracking",{init:c,events:k,setResultsEventMode:d,getResultsEventMode:e,trackQuoteResultsList:g})}(jQuery),function(a,b){function c(){jQuery(document).ready(function(a){if(E=a("#email-quote-dropdown"),$auxilleryActivator=a("[data-opensavequote=true]"),D=E.find(".dropdown-container"),F=a("#email-quote-component"),P=a("#callmeback-save-quote-dropdown"),G=a(".saveQuoteInstructions"),H=a("#save_email"),I=a("#save_password"),J=a("#save_confirm"),K=a("#save_marketing"),L=a(Q),M=a(".saveQuotePasswords"),N=a("#saveQuoteSuccess"),O=a(".saveQuoteFields"),d()){var b=y.modules[y.site.vertical+"SaveQuote"].getCopy("buttonLabel");b!==!1&&L.text(b);var c=y.modules[y.site.vertical+"SaveQuote"].getCopy("saveSuccess");c!==!1&&N.empty().append(c)}H.on("keyup change",h),H.on("blur",function(){a(this).val(a.trim(a(this).val()))}),J.on("keyup change",i),I.on("keyup change",i),F.on("click",".btn-save-quote",m),E.find(".activator").on("click",e),D.on("click",".btn-cancel",x),a(".save-quote-openAsModal").length&&a(".save-quote-openAsModal").on("click",function(b){return b.preventDefault(),a(this).hasClass("disabled")||a(this).hasClass("inactive")?!1:void f()}),g(),l("init"),q(),y.messaging.subscribe(z.WEBAPP_LOCK,v),y.messaging.subscribe(z.WEBAPP_UNLOCK,u)}),A.subscribe(y.modules.events.contactDetails.email.FIELD_CHANGED,function(a){""===H.val()&&H.val(a.$field.val()).trigger("change")})}function d(){return!_.isUndefined(y.modules[y.site.vertical+"SaveQuote"])&&y.modules[y.site.vertical+"SaveQuote"].hasOwnProperty("getCopy")}function e(){W?(P.hide(),N.hide(),F.show(),O.hide()):(P.hide(),""!==H.val()&&L.hasClass("disabled")&&!a(".saveQuotePasswords").is(":visible")&&H.trigger("change")),0!==P.length&&D.find(".callmeback-feedback").remove()}function f(){y.modules.dialogs.show({hashId:"email-quote",closeOnHashChange:!0,onOpen:function(b){D.after('<div id="email-quote-placeholder"></div>'),D.appendTo(a("#"+b+" .modal-body")),D.on("click.modal",".btn-cancel",function(){a("#"+b).modal("hide")}),e()},onClose:function(b){var c=a("#email-quote-placeholder");D.insertAfter(c),c.remove()}})}function g(){null!==F&&0!==F.length&&(setupDefaultValidationOnForm(F),I.length>0&&I.rules("add",{required:!0,minlength:6,messages:{required:"Please enter a password",minlength:jQuery.format("Password must be at least {0} characters")}}),J.length>0&&J.rules("add",{required:!0,equalTo:"#"+I.attr("id"),messages:{required:"Please confirm your password",equalTo:jQuery.format("Password and confirmation password must match")}}))}function h(a){13==a.keyCode||9==a.keyCode?j():R!=H.val()?(t(),clearInterval(S),S=setTimeout(j,800)):""!==I.val()&&""!==I.val()&&s()}function i(a){I.valid()&&J.valid()?s():t()}function j(){var a=H.valid();a&&k()}function k(){var a=H.val();R=a,T&&"pending"===T.state()&&"function"==typeof T.abort&&T.abort(),t(),y.modules.loadingAnimation.showAfter(H);var b={returnAjaxObject:!0,data:{type:"email",value:a},onComplete:function(){s(),y.modules.loadingAnimation.hide(H)},onSuccess:function(a){U=a.exists,a.optInMarketing?(q(),K.prop("checked",!0)):r(),y.site.isCallCentreUser||(a.exists?(l("clickSubmit"),p()):(l("createLogin"),o()))},onError:function(){U=!1,y.site.isCallCentreUser||(l("createLogin"),o())}};T=y.modules.optIn.fetch(b)}function l(b){var c="";if(d()&&(c=y.modules[y.site.vertical+"SaveQuote"].getCopy(b)),_.isEmpty(c))switch(b){case"clickSubmit":c="Enter your email address to retrieve your quote at any time.";break;case"createLogin":c="Create a login to retrieve your quote at any time.";break;case"saveAgain":c='Click \'Save Quote\' to update your saved quote <a href="javascript:;" class="btn btn-save btn-save-quote">Email Quote</a>';break;case"init":c=y.site.isCallCentreUser?"Please enter the email you want the quote sent to.":"We will check if you have an existing login or help you set one up."}G.html(c),"saveAgain"===b&&(L=a(Q),L.html("Save Quote"))}function m(){if(F.valid()){if(V&&"pending"===V.state())return;t();var b=a("#mainform");0===a("#saved_email").length&&y.modules.form.appendHiddenField(b,"saved_email",H.val()),0===a("#saved_marketing").length&&y.modules.form.appendHiddenField(b,"saved_marketing",K.val());var c,d=[];c=-1!==a.inArray(y.site.vertical,["home","car","ip","life"])?"no":"yes";var e=y.modules.form.getData(F),f=y.modules.journeyEngine.getFormData();d=e.concat(f),d.push({name:"quoteType",value:y.site.vertical}),d.push({name:"vertical",value:y.site.vertical}),d.push({name:"sendConfirm",value:c}),y.modules.loadingAnimation.showAfter(L),W?y.messaging.publish(z.tracking.TOUCH,{touchType:"S",touchComment:null,includeFormData:!0,callback:function(a){n(a.result.success,a.result.transactionId)}}):y.modules.comms.post({url:"ajax/json/save_email_quote.jsp",data:d,dataType:"json",cache:!1,errorLevel:"silent",onSuccess:function(a){n("OK"===a.result,a.transactionId)},onError:function(){(y.site.isCallCentreUser||""!==I.val()&&""!==J.val())&&s()},onComplete:function(){y.modules.loadingAnimation.hide(L)}})}}function n(b,c){if(s(),y.modules.loadingAnimation.hide(L),b){if(F.hide(),N.fadeIn(),0===P.length||W||y.modules.callMeBack.hasCallbackBeenRequested()||y.site.isCallCentreUser||(y.modules.callMeBack.prefillForm(P),P.fadeIn()),W||(W=!0,l("saveAgain"),E.find(".activator span:not([class])").html("Save Quote"),$auxilleryActivator.find("span:not([class])").html("Save Quote")),"undefined"!=typeof c&&y.modules.transactionId.set(c),-1!==a.inArray(y.site.vertical,["car","ip","life","health","home"])){var d="home"===y.site.vertical?"Home_Contents":y.site.vertical;y.messaging.publish(z.tracking.EXTERNAL,{method:"trackQuoteEvent",object:{action:"Save",transactionID:c,vertical:d,simplesUser:y.site.isCallCentreUser}})}y.messaging.publish(C.QUOTE_SAVED)}}function o(){M.slideDown()}function p(){M.slideUp()}function q(){K.parents(".row").first().hide()}function r(){K.parents(".row").first().show()}function s(){L.removeClass("disabled")}function t(){L.addClass("disabled")}function u(a){E.children(".activator").removeClass("inactive").removeClass("disabled"),$auxilleryActivator.find("a").removeClass("inactive").removeClass("disabled")}function v(a){x(),E.children(".activator").addClass("inactive").addClass("disabled"),$auxilleryActivator.find("a").addClass("inactive").addClass("disabled")}function w(){return E.is(":visible")}function x(){E.hasClass("open")&&E.find(".activator").dropdown("toggle")}var y=window.meerkat,z=y.modules.events,A=(y.logging.info,y.messaging),B={saveQuote:{QUOTE_SAVED:"SAVE_QUOTE_SAVED"}},C=B.saveQuote,D=null,E=null,F=null,G=null,H=null,I=null,J=null,K=null,L=null,M=null,N=null,O=null,P=null,Q=".btn-save-quote",R=null,S=null,T=null,U=null,V=null,W=!1;y.modules.register("saveQuote",{init:c,events:B,close:x,enable:u,disable:v,enableSubmitButton:s,disableSubmitButton:t,isAvailable:w,openAsModal:f})}(jQuery),function(a,b){function c(){m.each(function(){var b=a(this),c=b.data("varname"),f=window[c];b.is("select")&&("undefined"!=typeof f&&"undefined"!=typeof f.options&&_.isArray(f.options)&&f.options.length&&d(b,f.options),b.on("change",function(){e(this)})),q[b.index()]=["0000"]})}function d(a,b){for(var c="",d=0;d<b.length;d++){var e=b[d];c+='<option value="'+e.value+'">'+e.text+"</option>"}a.append(c)}function e(b){var c=a(b),d=c.find("option:selected"),e=c.val(),h=j(c),i=d.text(),k=i;k.length>25&&(k=k.substr(0,20)+"..."),k="<span>"+k+"</span>",d.not("[readonly]").length&&!f(e)&&(c[0].selectedIndex=0,c.find('option[value="'+e+'"]').text(p+i).attr("disabled","disabled"),g(h,k,i,e))}function f(a,b){if("undefined"==typeof a)return!1;var c=a.index();return"undefined"==typeof q[c]&&(q[c]=["0000"]),-1!==q[c].indexOf(b)}function g(b,c,d,e){_.defer(function(){"undefined"==typeof q[b.index()]&&(q[b.index()]=["0000"]),q[b.index()].push(e),b.append(a("<li>").html(c).data("value",e).data("fulltext",d).addClass("selected-tag").hide().append(a("<button>").html("&times;").attr("type","button").addClass("btn").on("click",function(){h(this)}).hover(function(){a(this).parents("li").addClass("hover")},function(){a(this).parents("li").removeClass("hover")})).fadeIn(o,function(){i()}))})}function h(b){var c=a(b),d=c.closest(".row").prev(".select-tags-row").find(":input"),e=c.closest("li"),f=e.data("value"),g=e.data("fulltext");d.is("select")&&d.find('option[value="'+f+'"]').text(g).removeAttr("disabled");var h=j(d),k=h.index();"undefined"==typeof q[k]&&(q[k]=["0000"]);var l=q[k].indexOf(f);-1!=l&&q[k].splice(l,1),e.fadeOut(o,function(){a(this).remove(),i()})}function i(){m.each(function(){var b=a(this),c=b.closest(".row"),d=j(b),e=c.find(".validate"),f=[];d.find("li").each(function(){f.push(a(this).data("value"))}),e.val(f.join(","))})}function j(a){return a.closest(".row").next(n+"-row").find(n)}function k(a){return q[a]}var l=window.meerkat,m=(l.modules.events,l.logging.info,a(".select-tags")),n=".selected-tags",o="fast",p="[selected] ",q={};l.modules.register("selectTags",{init:c,getListElement:j,appendToTagList:g,isAlreadySelected:f,getItemsSelected:k})}(jQuery),function(a,b){function c(){t.subscribe(v.REQUEST_SEND,function(a){l(a.instanceSettings)})}function d(b){var c=a.extend({},w,b);return f(c),n(c),c.emailInputOnChangeFunction=function(a){g(a,c)},c.emailInputBlurFunction=function(b){g(b,c),a(this).val(a.trim(a(this).val()))},c.fieldChangedFunction=function(a){""===c.emailInput.val()&&c.emailInput.val(a.$field.val()).trigger("change")},c.emailRequestFunction=function(a){c.identifier===a.instanceSettings.identifier&&l(b)},t.subscribe(s.contactDetails.email.FIELD_CHANGED,c.fieldChangedFunction),c.emailInput.on("keyup change",c.emailInputOnChangeFunction),c.emailInput.on("blur",c.emailInputBlurFunction),c}function e(a){a.emailInput.off("blur",a.emailInputBlurFunction),a.emailInput.off("keyup change",a.emailInputOnChangeFunction),a.submitButton.off("click",a.submitClickButtonFunction),t.unsubscribe(s.contactDetails.email.FIELD_CHANGED,a.fieldChangedFunction)}function f(a){return null===a.form||0===a.form.length?!1:(r.modules.validation.setupDefaultValidationOnForm(a.form),!0)}function g(a,b){if(13==a.keyCode||9==a.keyCode)h(b);else{var c=b.lastEmailChecked!=b.emailInput.val();c&&(clearInterval(b.emailTypingTimer),b.emailTypingTimer=setTimeout(function(){h(b)},800))}}function h(a){if("undefined"==typeof a.emailInput)r.modules.errorHandling.error({errorLevel:"info",page:"sendEmail.js:emailChanged",description:"settings.emailInput is undefined"}),q(a),e(a);else{var b=!0;null!==a.form&&a.form.length>0&&(b=a.emailInput.valid());var c=a.lastEmailChecked!=a.emailInput.val();b&&c&&k(a),a.canEnableSubmit(a)?p(a):q(a)}}function i(a){q(a),r.modules.loadingAnimation.showAfter(a.emailInput)}function j(a){a.canEnableSubmit(a)&&p(a),r.modules.loadingAnimation.hide(a.emailInput)}function k(a){a.checkUserAjaxObject&&"pending"===a.checkUserAjaxObject.state()&&"function"==typeof settings.checkUserAjaxObject.abort&&a.checkUserAjaxObject.abort(),a.lockoutOnCheckUserExists&&(i(a),r.modules.loadingAnimation.showAfter(a.emailInput));var b=a.emailInput.val();a.lastEmailChecked=b,a.checkUserAjaxObject=r.modules.optIn.fetch({returnAjaxObject:!0,data:{type:"email",value:b},onComplete:function(){a.lockoutOnCheckUserExists&&(r.modules.loadingAnimation.hide(a.emailInput),a.canEnableSubmit(a)&&j(a))},onSuccess:function(b){b.optInMarketing?n(a):o(a)},onError:function(){userExists=!1,o(a)}})}function l(a){if(!a.isPending&&a.form.valid()){a.isPending=!0;var b=a.sendEmailDataFunction(a);b.push({name:"vertical",value:r.site.vertical}),b.push({name:"email",value:a.emailInput.val()}),i(a),r.modules.comms.post({url:a.submitUrl,data:b,dataType:"json",cache:!1,errorLevel:"warning",onSuccess:function(b){"undefined"!=typeof b.transactionId&&""!==b.transactionId&&r.modules.transactionId.set(b.transactionId),"function"==typeof a.emailResultsSuccessCallback&&a.emailResultsSuccessCallback(b,a)},onError:function(){a.emailResultsFailCallback(a)},onComplete:function(){a.isPending=!1,j(a)}})}}function m(a){p(a)}function n(a){a.marketing.parents(".row").first().slideUp()}function o(a){a.marketing.parents(".row").first().slideDown()}function p(a){a.submitButton.removeClass("disabled")}function q(a){a.submitButton.addClass("disabled")}var r=window.meerkat,s=r.modules.events,t=r.messaging,u={sendEmail:{REQUEST_SEND:"REQUEST_SEND"}},v=u.sendEmail,w={form:null,instructions:null,email:null,marketing:null,submitButton:null,emailResultsSuccess:null,emailResultsFields:null,lastEmailChecked:null,emailTypingTimer:null,checkUserAjaxObject:null,userExists:null,isConfirmed:!1,isEnabled:!1,emailResultsFailCallback:m};r.modules.register("sendEmail",{init:c,events:u,setup:d,tearDown:e,sendEmail:l,emailChanged:h,enableSubmitButton:p,disableSubmitButton:q,checkUserExists:k})}(jQuery),function(a,b){var c=window.meerkat,d=(c.modules.events,function(){}),e=function(a){"use strict";f(a),g()},f=function(b){for(var d=null,e=[],f=0;f<b.validationErrors.length;f++){var g=b.validationErrors[f],h=g.elementXpath.replace(/\//g,"_");if(d=a(":input[name$='"+h+"']"),0===d.length&&""!==g.elements)for(var i=g.elements.split(","),j=0;j<i.length;j++){var k=h+"_"+a.trim(i[j]);d=a('input[name*="'+k+'"]'),0===d.length&&(d=a('input[id*="'+k+'"]'))}for(var l=0;l<d.length;l++){var m=d[l];e.push(m);var n=a(m);a(m).parent().removeClass("has-success"),a(m).parent().addClass("has-error");var o=n;null!==n.attr("data-validation-placement")&&""!==n.attr("data-validation-placement")&&(o=a(n.attr("data-validation-placement")));var p=o.closest(".row-content, .fieldrow_value");0===p.length&&(p=n.parent());var q=p.children(".error-field"),r="invalid field";"ELEMENT REQUIRED"===g.message&&(r="This field is required."),0===q.length&&(p.prepend('<div class="error-field"></div>'),q=p.children(".error-field"),q.hide().slideDown(100)),q.append(r)}}d.length>0&&("undefined"==typeof b.startStage&&(b.startStage="start"),c.modules.address.setHash(b.startStage))},g=function(){"undefined"!=typeof FormElements&&!FormElements.errorContainer.is(":visible")&&FormElements.errorContainer.find("li").length>0&&(FormElements.rightPanel.addClass("hidden"),FormElements.errorContainer.show(),FormElements.errorContainer.find("li").show(),FormElements.errorContainer.find("li .error").show())};c.modules.register("serverSideValidationOutput",{init:d,outputValidationErrors:e})}(jQuery),function(a,b){function c(){!n.modules.simplesTickler&&n.site.session.firstPokeEnabled&&(h(n.site.session.windowTimeout),d().done(function(a){firstPoke=!1,a.timeout<0&&"undefined"!=typeof a.bigIP&&a.bigIP!==n.site.session.bigIP&&(n.modules.errorHandling.error({errorLevel:"silent",message:"Session poke failed on first load",description:"Session poke failed on first load",page:"session_poke.json",data:{transactionId:n.modules.transactionId.get(),bigIP_onPageLoad:n.site.session.bigIP,bigIP_onFirstSessionPoke:a.bigIP},id:n.modules.transactionId.get()}),h(n.site.session.windowTimeout))}),a(document).on("click.session",".poke, .btn:not(.journeyNavButton,.dontPoke), .btn-back, .dropdown-toggle, .btn-pagination",function(a){f()}))}function d(a){var b="session_poke.json";return b+=a===!0?"?check":"",n.modules.comms.get({url:b,dataType:"json",onSuccess:function(a){u=0,h(a.timeout)},useDefaultErrorHandling:!1,errorLevel:"silent",onError:function(b,c,e){"timeout"===c&&3>u?setTimeout(function(){d(a),u++},3e4):(j(!1),n.modules.errorHandling.error({errorLevel:"silent",message:"Session poke error",description:"An error occurred with your browsing session, session poke failed to return: "+c+" "+e,data:{status:c,error:e,transactionId:n.modules.transactionId.get()},id:n.modules.transactionId.get()}))}})}function e(){return d(!0)}function f(){q<=g-n.site.session.deferredPokeDuration?d():r||(r=window.setTimeout(d,n.site.session.deferredPokeDuration))}function g(){return parseInt(+new Date)}function h(a){a>0?(q=g(),window.clearTimeout(o),o=window.setTimeout(function(){e()},a),m()):firstPoke||j(p?!1:!0)}function i(a){n.modules.leavePageWarning.disable(),m(),n.modules.utils.scrollPageTo("body"),"boolean"==typeof a&&a?(n.modules.journeyEngine.loadingShow("Reloading..."),window.location.reload()):(n.modules.journeyEngine.loadingShow("Redirecting..."),window.location=n.site.urls.exit)}function j(b){m(),p=!0;var c={title:"Hi, are you still there?",className:"sessionModalContainer",leftBtn:{label:""},onOpen:function(b){a("#"+b).find(".modal-closebar").remove()}};if(b){var e=180;l(e),c.htmlContent=['<p id="sessionModalCountDown">',k(e),"</p>","<p>We haven't noticed any activity from you for a while, so we wanted to let you know that your session will automatically time out in 3 minutes.</p>","<p>If you are still there, great!</p>",'<p>To continue with your session, please click the "Continue" button below.</p>'].join(""),c.buttons=[{label:"Continue",className:"btn btn-success",closeWindow:!0,action:d}]}else c.htmlContent=["<p>We didn't see any activity from you for a while, or your connection was interrupted, so we wanted to let you know your session has timed out.</p>"].join(""),c.buttons=[{label:"Reload Page",className:"btn btn-success",closeWindow:!0,action:function(){i(!0)}},{label:"Visit "+n.site.name+"'s Home Page",className:"btn btn-success",closeWindow:!0,action:i}];s=n.modules.dialogs.show(c)}function k(a){var b=Math.floor(a/60),c=("0"+(a-60*b)).slice(-2);return b+":"+c}function l(b){var c=b,d=function(){a(document).find("#sessionModalCountDown").text(k(c)),0>=c&&e().then(function(a){a.timeout<=0?n.modules.writeQuote.write({triggeredsave:"sessionpop"},!1,function(){window.clearInterval(t),i()}):m()}),c-=1};t=window.setInterval(d,1e3)}function m(){window.clearInterval(t),n.modules.dialogs.close(s),p=!1}var n=window.meerkat,o=null,p=!1,q=0,r=null,s=null,t=null,u=0;firstPoke=!0,n.modules.register("session",{init:c,poke:d,check:e,update:h})}(jQuery),function(a,b){function c(){q.subscribe(ResultsModel.moduleEvents.WEBAPP_LOCK,h),q.subscribe(o.modules.events.RESULTS_RANKING_READY,_.bind(i,this,2e3)),q.subscribe(ResultsView.moduleEvents.RESULTS_TOGGLE_MODE,j),q.subscribe(o.modules.events.journeyEngine.READY,g)}function d(a){-1===_.indexOf(s,a)&&s.push(a)}function e(a,b){_.isArray(s)&&-1!==_.indexOf(s,a.navigationId)||f(a,b)}function f(a,b){b=b||1e3,a.navigationId!==t&&(t=a.navigationId,window.sessionCamRecorder&&window.sessionCamRecorder.createVirtualPageLoad&&setTimeout(function(){p("[sessionCamHelper:createVirtualPageLoad]",a),window.sessionCamRecorder.createVirtualPageLoad(location.pathname+"/"+t)},b))}function g(){setTimeout(function(){e(o.modules.journeyEngine.getCurrentStep())},2e3)}function h(a,b){a=a||!1,b=b||!1,a!==!1&&_.has(a,"source")&&"resultsModel"===a.source&&f({navigationId:v.RESULTS_LOADING},b)}function i(a){a=a||!1,f(l(),a)}function j(){u===!1&&i(),u=!1}function k(a){a=a||!1,f(m(),a)}function l(){return{navigationId:v.RESULTS_PAGE+"-"+Results.getDisplayMode()}}function m(a){return a=a||!1,n({navigationId:v.MOREINFO_PAGE},a)}function n(a,b){return b=b||!1,b===!1||_.isEmpty(b)||(a.navigationId+="-"+b),a}var o=window.meerkat,p=(o.modules.events,o.logging.info),q=o.messaging,r={},s=["results"],t=!1,u=!0,v={RESULTS_LOADING:"resultsLoading",RESULTS_PAGE:"resultsPage",MOREINFO_PAGE:"MoreInfo"};o.modules.register("sessionCamHelper",{init:c,events:r,updateVirtualPage:f,updateVirtualPageFromJourneyEngine:e,addStepToIgnoreList:d,setResultsLoadingPage:h,setResultsShownPage:i,setMoreInfoModal:k,getMoreInfoStep:m})}(jQuery),function(a,b){function c(b){b.preventDefault();var c=a(this),d=c.attr("data-title");url=c.attr("href"),"undefined"!=typeof c.attr("data-url")&&(url=c.attr("data-url")),d&&(d=d.replace(/ /g,"_")),window.open(url,d,"width=800,height=600,toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbars=yes,copyhistory=no,resizable=no")}function d(a){jQuery(document).ready(function(a){a(document.body).on("click",".showDoc",c)})}var e=window.meerkat;e.modules.events,e.logging.info;e.modules.register("showDoc",{init:d})}(jQuery),function(a,b){function c(){a(document).ready(d)}function d(){return"function"!=typeof a.fn.noUiSlider?void j("[sliders.js]","noUiSlider plugin is not available."):void a(".slider-control").each(function(){var b=a(this),c=b.find(".slider"),d=b.find("input"),i=b.find(".selection"),j=c.data("value"),k=c.data("range").split(","),m=c.data("markers"),n=c.data("step"),o=c.data("legend").split(","),p=c.data("type"),q=c.data("use-default-output"),r=null;k={min:Number(k[0]),max:Number(k[1])
};var s,t=!1;s=function(a){i.text(a)},"excess"===p&&(q===!1&&(d=a("#health_excess")),d.length>0&&d.val().length>0&&(j=d.val()),s=function(a){a>0&&a<=o.length?i.text(o[a-1]):i.text(" "),d.val(a)},r={lower:[a.Link({target:s,format:{decimals:0}})]}),"price"===p&&(q===!1&&(d=a("#health_filter_priceMin")),d.length>0&&d.val().length>0&&(j=d.val()),s=function(a,b,c){a<=k.min||isNaN(a)?(d.val(0),i.text("All prices")):(d.val(a),i.text("from $"+a))},r={lower:[a.Link({target:s,format:{decimals:0,encoder:function(a){return a=Math.round(a),5*Math.floor(a/5)}}})]},t=function(a,b,e,f){var h=k.min,i=k.max,j=d.val();if(c.val(j),k={min:b,max:e},g(c,{min:0,"1%":b,max:e},!0),f)if(j==h||"0"==j)c.val(0);else if(j==i)c.val(k.max);else{var l=(j-h)/(i-h),m=k.min+(k.max-k.min)*l;c.val(m)}}),"function"==typeof t&&a(this).on(l.EVENT_UPDATE_RANGE,t),c.on(l.EVENT_SET_VALUE,function(a,b){h(c,b)}),c.noUiSlider({range:k,step:n,start:[j],serialization:r,behaviour:"extend-tap"}),e(b,m),f(b,o)})}function e(b,c){var d,e,f;if(c>1){for(c-=1,d=a("<div />"),f=0;c>f;f++)e=a("<div />"),e.addClass("slider-marker"),e.css("width",100/c+"%"),d.append(e);d.find(".slider-marker:first").addClass("first"),d.find(".slider-marker").appendTo(b.find(".noUi-base"))}}function f(b,c){var d,e,f;if(c.length>1){for(d=a("<div />"),f=0;f<c.length;f++)e=a("<div><span><b /></span></div>"),e.addClass("slider-legend"),e.css("width",100/(c.length-1)+"%"),e.find("b").text(c[f]),d.append(e);d.find(".slider-legend:first").addClass("first"),d.find(".slider-legend:last").addClass("last"),d.find(".slider-legend").appendTo(b.find(".slider-legends"))}}function g(a,b){a.noUiSlider({range:b},!0);var c=a.data("markers"),d=a.closest(".slider-control");"undefined"!=typeof c&&d.length>0&&e(d,c)}function h(a,b){a.val(b)}var i=window.meerkat,j=i.logging.info,k=(i.modules.events,{sliders:{EVENT_UPDATE_RANGE:"EVENT_UPDATE_RANGE",EVENT_SET_VALUE:"SET_VALUE"}}),l=k.sliders;i.modules.register("sliders",{init:c,events:k})}(jQuery),function(a,b){function c(){a(document).ready(function(){var b="car"==g.site.vertical?"quote":g.site.vertical,c=b+"_"+j;k=a("#"+c);var e=k.val();_.isEmpty(e)||d(e),g.messaging.publish(m.SPLIT_TEST_READY)})}function d(a){h=a,i=_.isEmpty(h)?[]:h.split("-"),k.val(h)}function e(a){return a=a||!1,a===!0?_.extend({},i):h}function f(a){if(_.isArray(a)){for(var b=0;b<a.length;b++)if(_.indexOf(i,String(a[b]))>=0)return!0;return!1}return _.indexOf(i,String(a))>=0}var g=window.meerkat,h=(g.modules.events,null),i=[],j="currentJourney",k=null,l={splitTest:{SPLIT_TEST_READY:"SPLIT_TEST_READY"}},m=l.splitTest;g.modules.register("splitTest",{init:c,events:l,get:e,isActive:f})}(jQuery),function(a,b){function c(a,b,c,d,e){var f=[];d&&(f=p.modules.journeyEngine.getFormData()),f.push({name:"quoteType",value:p.site.vertical}),f.push({name:"touchtype",value:a}),f.push({name:"comment",value:b}),f.push({name:"productId",value:c}),p.modules.comms.post({url:"ajax/json/access_touch.jsp",data:f,errorLevel:"silent",onSuccess:function(a){_.has(a,"result")&&_.has(a.result,"transactionId")&&_.isNumber(a.result.transactionId)&&a.result.transactionId>0&&p.modules.transactionId.set(a.result.transactionId),"function"==typeof e&&e(a)}})}function d(a,b){try{if("undefined"==typeof _satellite)throw"_satellite is undefined";for(var c in b)if(b.hasOwnProperty(c)&&"function"!=typeof b[c])if(null!==b[c]){var d="string"==typeof b[c]?b[c].toLowerCase():b[c];_satellite.setVar(c,d)}else _satellite.setVar(c,"");p.logging.info("DTM",a,b),_satellite.track(a)}catch(e){p.logging.info("_satellite catch",a,b,e)}}function e(a,b){try{if("undefined"==typeof superT)throw"Supertag is undefined";superT[a](b),p.logging.info("Supertag",a,b)}catch(c){p.logging.info("Supertag catch",a,b,c)}}function f(a,b,c,d){return p.modules.comms.post({url:"ajax/json/get_email_id.jsp",data:{vertical:p.site.vertical,email:a,m:b,o:c},cache:!0,errorLevel:"silent"})}function g(b){_.isUndefined(b)||_.isEmpty(b)||b===s||(s=b,a("#"+t).val(s),p.logging.debug("last touched field: "+s))}function h(){a(document.body).on("click focus","form input, form select",function(b){g(a(this).closest(":input").attr("name"))}),a("a[data-slide-control]").on("click",function(){g(a(this).attr("data-slide-control")+"-"+p.modules.journeyEngine.getCurrentStep().navigationId)})}function i(){var b=p.site.vertical;b="car"===b?"quote":b,t=b+"_lastFieldTouch",a("#mainform").append(a("<input/>",{type:"hidden",name:t,id:t,value:""})),h()}function j(){a(document).on("click","a[data-tracking-type]",function(b){var c=a(b.currentTarget).attr("data-tracking-type"),d=a(b.currentTarget).attr("data-tracking-value");p.modules.tracking.recordTouch(c,d)}),a(document).on("click","a[data-supertag-method]",function(b){var c=a(b.currentTarget).attr("data-supertag-method"),d=a(b.currentTarget).attr("data-supertag-value");p.modules.tracking.recordSupertag(c,d)}),p.messaging.subscribe(r.TOUCH,function(a){if("undefined"!=typeof a){var b=!1;"undefined"!=typeof a.includeFormData&&a.includeFormData===!0&&(b=!0),c(a.touchType,a.touchComment,a.productId,b,a.callback)}}),p.messaging.subscribe(r.EXTERNAL,k),a(document).ready(function(){i(),"undefined"!=typeof p&&"undefined"!=typeof p.site&&"undefined"!=typeof p.site.tracking&&p.site.tracking.userTrackingEnabled===!0&&p.modules.utils.pluginReady("sessionCamRecorder").done(function(){o()})})}function k(b,c){if(c=c||!1,"undefined"!=typeof b){"object"!=typeof p.site.tracking&&(p.site.tracking={});var g,h=b.object;g=(p.site.tracking.superTagEnabled===!0||p.site.tracking.DTMEnabled===!0)&&"function"==typeof h?h():h,g=c===!1?n(g):g;var i=a.Deferred().resolve().promise();"object"==typeof g&&null!==g.email&&""!==g.email&&null===g.emailID&&(i=f(g.email,g.marketOptIn,g.okToCall).done(function(a){"undefined"!=typeof a.emailId&&(g.emailID=a.emailId,g.email=null)})),i.always(function(){p.site.tracking.superTagEnabled===!0&&e(b.method,g),p.site.tracking.DTMEnabled===!0&&d(b.method,g)})}}function l(){return p.modules.splitTest.get()}function m(){var a=p.site.vertical;return"home"===a&&(a="Home_Contents"),a}function n(b){return"undefined"==typeof b.brandCode&&(b.brandCode=p.site.tracking.brandCode),"undefined"==typeof b.transactionID&&(b.transactionID=p.modules.transactionId.get()),"undefined"==typeof b.rootID&&(b.rootID=p.modules.transactionId.getRootId()),"undefined"==typeof b.currentJourney&&(b.currentJourney=l()),"undefined"==typeof b.vertical&&(b.vertical=m()),"undefined"==typeof b.simplesUser&&(b.simplesUser=p.site.isCallCentreUser),"undefined"==typeof b.contactCentreID&&(b.contactCentreID=p.site.userId||null),"undefined"==typeof b.campaignID&&(b.campaignID=a("input[name$=tracking_cid]").val()||null),"undefined"==typeof b.verticalFilter&&(b.verticalFilter="undefined"!=typeof p.modules[p.site.vertical]&&"function"==typeof p.modules[p.site.vertical].getVerticalFilter?p.modules[p.site.vertical].getVerticalFilter():null),b.trackingKey=p.modules.trackingKey.get(),b.lastFieldTouch=s,b}function o(){if("undefined"!=typeof window.sessionCamRecorder){"object"!=typeof window.sessioncamConfiguration&&(window.sessioncamConfiguration={}),"object"!=typeof window.sessioncamConfiguration.customDataObjects&&(window.sessioncamConfiguration.customDataObjects=[]);var a={key:"transactionId",value:p.modules.transactionId.get()};window.sessioncamConfiguration.customDataObjects.push(a),a={key:"brandCode",value:p.site.tracking.brandCode},window.sessioncamConfiguration.customDataObjects.push(a),a={key:"vertical",value:p.site.vertical},window.sessioncamConfiguration.customDataObjects.push(a),a={key:"rootID",value:p.modules.transactionId.getRootId()},window.sessioncamConfiguration.customDataObjects.push(a),a={key:"currentJourney",value:l()},window.sessioncamConfiguration.customDataObjects.push(a)}}var p=window.meerkat,q={tracking:{TOUCH:"TRACKING_TOUCH",EXTERNAL:"TRACKING_EXTERNAL"}},r=q.tracking,s=null,t=null;p.modules.register("tracking",{init:j,events:q,recordTouch:c,recordSupertag:e,updateLastFieldTouch:g,applyLastFieldTouchListener:h,getCurrentJourney:l,updateObjectData:n,getTrackingVertical:m})}(jQuery),function(a,b){function c(){a(document).ready(function(){if("undefined"!=typeof ResultsModel){var b="car"==g.site.vertical?"quote":g.site.vertical,c=b+"_trackingKey";if(i=a("#"+c),i.length){var f=i.val();_.isEmpty(f)||e(f)}else a("#mainform").append(a("<input />",{id:c,name:c,value:h}).attr("type","hidden").attr("data-autosave","true"));g.messaging.subscribe(ResultsModel.moduleEvents.RESULTS_UPDATED_INFO_RECEIVED,d)}})}function d(a){a.hasOwnProperty("trackingKey")&&e(a.trackingKey)}function e(a){h=a,i.val(h)}function f(){return h}var g=window.meerkat,h=(g.modules.events,null),i=null;g.modules.register("trackingKey",{init:c,get:f})}(jQuery),function(a,b){function c(){g(),jQuery(document).ready(function(a){n=a(".transactionId"),o=a(".rootId"),f(l,m),j()})}function d(){return"undefined"==typeof l&&g(),l}function e(){return"undefined"==typeof m&&g(),m}function f(a,b){a!=l&&p.messaging.publish(r.CHANGED,{transactionId:l}),l=a,"undefined"!=typeof b&&(m=b),k(),j()}function g(){null!==p.site.initialTransactionId&&"number"==typeof p.site.initialTransactionId&&(l=p.site.initialTransactionId,m=p.site.initialTransactionId,p.site.initialTransactionId=null)}function h(a,b,c,d){p.modules.comms.post({url:"ajax/json/get_transactionid.jsp",dataType:"json",async:a,errorLevel:"silent",numberOfAttempts:_.isNumber(c)?c:1,data:{quoteType:p.site.vertical,id_handler:b},onSuccess:function(a){a.transactionId!==l&&f(a.transactionId,a.rootId),"function"==typeof d&&d(l)},onError:function(a,b,c,e,f){p.modules.errorHandling.error({message:"An error occurred fetching a transaction ID. Please check your connection or try again later.",page:"core/transactionId.js module",description:"fetch() AJAX request(s) returned an error: "+b+" "+c+". Original transactionId: "+l,errorLevel:"fatal",data:l}),"function"==typeof d&&d(0)}})}function i(a,b){s=!0,h(!0,"increment_tranId",a,function(a){s=!1,"function"==typeof b&&b(a)})}function j(){try{p.site.isCallCentreUser&&parent.postMessage({eventType:"transactionId",transactionId:l},"*")}catch(a){}}function k(){"number"==typeof l&&l>0&&n.html(l)}var l,m,n,o,p=window.meerkat,q=(p.modules.events,p.logging.info,{transactionId:{CHANGED:"CHANGED"}}),r=q.transactionId,s=!1;p.modules.register("transactionId",{init:c,events:q,get:d,getRootId:e,set:f,getNew:i})}(jQuery),function(a,b){function c(){jQuery(document).ready(function(a){a(h).length&&(d(),e())})}function d(){var b=a(h);Modernizr.localstorage===!0&&null!==localStorage.getItem("closedUnsupportedBrowser")&&b.parent().remove(),b.length&&b.off("click").on("click",function(b){return b.preventDefault(),b.stopPropagation(),a(this).parent().remove(),Modernizr.localstorage===!0&&localStorage.setItem("closedUnsupportedBrowser","true"),!1})}function e(){a(document).on("resultsLoaded",function(){a(h).click()})}var f=window.meerkat,g=(f.modules.events,f.logging.info,{unsupportedBrowser:{}}),h=(g.unsupportedBrowser,"#js-close-unsupported-browser");f.modules.register("unsupportedBrowser",{init:c,events:g})}(jQuery),function(a,b){function c(a){return a=a.replace(/[^\w\s-]/g,""),a=a.replace(/^\s+/,"").replace(/\s+$/,"").toLowerCase(),a=a.replace(/[-\s]+/g,"-")}function d(b,c,d,e){var f,g=a(b),h=250,i=0,j=!1;"undefined"!=typeof c&&(h=c),"undefined"!=typeof d&&(i=d),g.offset().top<a(window).scrollTop()?a("html, body").animate({scrollTop:g.offset().top+i},h,function(){f=!0,j||"function"!=typeof e||(j=!0,e(this,f))}):(f=!1,"function"==typeof e&&e(this,f))}function e(){var a=new Date;return Date.UTC(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate(),a.getUTCHours(),0,0,0)}function f(a,b){var c=new Date;c.setHours(0,0,0);var d=g(a),e=c.getFullYear()-d.getFullYear();if(1>e)return(c-d)/31536e6;var f=e-c.getFullYear()%4;f=(f-f%4)/4;var h=(366*f+365*(e-f))/e,i=.005;d.getMonth()==c.getMonth()&&d.getDate()>c.getDate()&&(i=-.005);var j=(c-d)/(864e5*h)+i;return b?Math.floor(j):j}function g(a){return new Date(a.substring(6,10),a.substring(3,5)-1,a.substring(0,2))}function h(a){var b=leadingZero(a.getDate()),c=leadingZero(a.getMonth()+1);return a.getFullYear()+"-"+c+"-"+b}function i(a){var b=leadingZero(a.getDate()),c=leadingZero(a.getMonth()+1);return b+"/"+c+"/"+a.getFullYear()}function j(a,b){return b=b||"/",a.split(b).reverse().join(b)}function k(a,b){b=_.isBoolean(b)?b:!1;var c,d;if(window.event)c=window.event.keyCode;else{if(!a)return!0;c=a.which}d=String.fromCharCode(c);var e=[8,35,37,39];return null==c||0===c||9==c||12==c||13==c||27==c?!0:-1!==_.indexOf(e,c)||"0123456789".indexOf(d)>-1?!0:b&&"."==d?!0:!1}function l(b){var c=a.Deferred();if(jQuery.fn[b]||window[b])return c.resolve(),c.promise();var d=setInterval(function(){(jQuery.fn[b]||window[b])&&c.resolve()},300);return setTimeout(function(){clearInterval(d)},1e4),a.when(c).then(function(){clearInterval(d)}),c.promise()}function m(a,b){for(var c=0;b>c;)a.setDate(a.getDate()+1),0!==a.getDay()&&6!==a.getDay()&&c++;return a}function n(a){a instanceof Date==!1&&(a=new Date(a));var b=Math.floor((new Date-a)/1e3),c=Math.floor(b/31536e3);return c>1?c+" years":(c=Math.floor(b/2592e3),c>1?c+" months":(c=Math.floor(b/86400),c>1?c+" days":(c=Math.floor(b/3600),c>1?c+" hours":(c=Math.floor(b/60),c>1?c+" minutes":Math.floor(b)+" seconds"))))}var o=window.meerkat;o.logging.info;jQuery.fn.animateAuto=function(a,b,c){var d,e,f;return this.each(function(g,h){h=jQuery(h),d=h.clone().css({height:"auto",width:"auto"}).appendTo("body"),e=d.css("height"),f=d.css("width"),d.remove(),"height"===a?h.animate({height:e},b,c):"width"===a?h.animate({width:f},b,c):"both"===a&&h.animate({width:f,height:e},b,c)})},o.modules.register("utils",{slugify:c,scrollPageTo:d,getUTCToday:e,returnAge:f,returnDate:g,isValidNumericKeypressEvent:k,invertDate:j,returnDateValue:h,returnDateValueFormFormat:i,pluginReady:l,calcWorkingDays:m,getTimeAgo:n})}(jQuery),jQuery.fn.extend({refreshLayout:function(){var a=$("<div>");$(this).append(a),_.defer(function(){$(this).remove(a)})}}),function(a,b){function c(){a.validator.addMethod("personName",d,"Please enter alphabetic characters only. Unfortunately, international alphabetic characters, numbers and symbols are not supported by many of our partners at this time.")}function d(a){var b=null!==a.match(k);return!b&&j.test(a)}function e(a,b,c){a.rules("add",{messages:{min_DateOfBirth:c+" age cannot be under "+b},min_DateOfBirth:{ageMin:b}})}function f(b,c){if(c)return b.valid();var d=a(document).find(".journeyEngineSlide").eq(h.modules.journeyEngine.getCurrentStepIndex()).children("form");try{return d.validate().check(b)}catch(e){return!0}}function g(b){b.validate({submitHandler:function(a){a.submit()},invalidHandler:function(b,c){if(c.numberOfInvalids()&&!jQuery.validator.scrollingInProgress){var d=a(c.errorList[0].element),e=d.closest(".row-content, .fieldrow_value");null!==d.attr("data-validation-placement")&&""!==d.attr("data-validation-placement")&&($ele2=a(d.attr("data-validation-placement")),$ele2.length>0&&(d=$ele2)),e.length>0&&(d=e),jQuery.validator.scrollingInProgress=!0,h.modules.utils.scrollPageTo(d,500,-50,function(){jQuery.validator.scrollingInProgress=!1})}},ignore:":hidden,:disabled",meta:"validate",debug:!0,errorClass:"has-error",validClass:"has-success",errorPlacement:function(b,c){var d=c;null!==c.attr("data-validation-placement")&&""!==c.attr("data-validation-placement")&&(d=a(c.attr("data-validation-placement")));var e=d.closest(".row-content, .fieldrow_value");0===e.length&&(e=c.parent());var f=e.children(".error-field");0===f.length&&(e.prepend('<div class="error-field"></div>'),f=e.children(".error-field"),f.hide().slideDown(100)),f.append(b)},onkeyup:function(a){var b=jQuery(a).attr("id");this.settings.rules.hasOwnProperty(b)&&this.settings.rules[b].onkeyup&&validation&&"captcha_code"!==a.name&&this.element(a)},onfocusout:function(b,c){var d=a(b);if(d.hasClass("tt-query")){var e=d.nextAll(".tt-dropdown-menu");if(e.length>0&&e.first().is(":visible"))return!1}a.validator.defaults.onfocusout.call(this,b,c)},highlight:function(b,c,d){"radio"===b.type?this.findByName(b.name).addClass(c).removeClass(d):a(b).addClass(c).removeClass(d);var e=a(b).closest(".row-content, .fieldrow_value");e.addClass(c).removeClass(d);var f=e.find(".error-field");0===f.find("label:visible").length&&(f.is(":visible")&&f.stop(),f.delay(10).slideDown(100))},unhighlight:function(a,b,c){return this.ctm_unhighlight(a,b,c)}})}var h=window.meerkat,i={validation:{}},j=/^([a-zA-Z .'\-,]*)$/,k=/(?:[^\s])\.(com|co|net|org|asn|ws|us|mobi)(\.[a-z][a-z])?/;h.modules.register("validation",{init:c,events:i,isValid:f,setupDefaultValidationOnForm:g,validatePersonName:d,setMinAgeValidation:e})}(jQuery),jQuery.fn.extend({isValid:function(a){return meerkat.modules.validation.isValid($(this),a)}}),function(a,b){function c(){n.site.isCallCentreUser===!1&&d()}function d(){n.messaging.subscribe(o.journeyEngine.STEP_INIT,function(){return"undefined"==typeof n.site.watchedFields||""===n.site.watchedFields?!1:(r=n.site.watchedFields,a(r).length?(a(r).attr("data-autoSave","true"),f(),void _.defer(function(){g(),e()})):(p("[writeQuote] No fields identified from selector provided."),!1))})}function e(){a(document).on("change",".journeyEngineSlide.active :input[data-autoSave]",function(){k(a(this))}).on("focus",".journeyEngineSlide.active :input[data-autoSave]",function(){k(a(this))})}function f(){a(":input",a(".journeyEngineSlide")).each(function(){h(a(this))})}function g(){n.messaging.subscribe(o.journeyEngine.STEP_CHANGED,function(){s&&clearTimeout(s),u!==!1&&"function"==typeof u.state&&"pending"==u.state()&&u.abort(),f()})}function h(a){var b=i(a);b!==!1&&(v[b]=j(a))}function i(a){return a.attr("name")||a.attr("id")||!1}function j(b){return"radio"==b.attr("type")||"checkbox"==b.attr("type")?a("input[name="+b.attr("name")+"]:checked").val()||"":b.val()}function k(a){(s||s&&typeof u!==!1&&"function"==typeof u.state&&"pending"==u.state())&&clearTimeout(s),s=setTimeout(l,t)}function l(){var b=[];a(":input",a(".journeyEngineSlide")).add(a("input[id*=lastFieldTouch]")).each(function(){var c=a(this),d=i(c);if(d!==!1){var e=j(c);v[d]!==e&&(b.push({name:d,value:e}),v[d]=e)}}),b.length&&(null!==n.modules.journeyEngine.getCurrentStep()&&b.push({name:a(".journey_stage").attr("name"),value:n.modules.journeyEngine.getCurrentStep().navigationId}),b.push({name:"hasPrivacyOptin",value:n.modules.optIn.isPrivacyOptedIn()}),u=n.modules.comms.post({url:"quote/write_lite.json",data:b,dataType:"json",timeout:2e4,numberOfAttempts:1,cache:!1,returnAjaxObject:!0,errorLevel:"silent",useDefaultErrorHandling:!1}))}function m(b,c,d){var e=[];if(a.extend(e,n.modules.journeyEngine.getFormData()),e.push({name:"quoteType",value:n.site.vertical}),null!==n.modules.journeyEngine.getCurrentStep()&&e.push({name:"stage",value:n.modules.journeyEngine.getCurrentStep().navigationId}),"object"==typeof b)for(var f in b)b.hasOwnProperty(f)&&e.push({name:f,value:b[f]});n.modules.comms.post({url:"ajax/write/write_quote.jsp",data:e,dataType:"json",cache:!1,errorLevel:c?"fatal":"silent",onSuccess:function(a){"function"==typeof d&&d(a)}})}var n=window.meerkat,o=n.modules.events,p=(n.logging.info,n.logging.debug),q=(n.logging.exception,{writeQuote:{}}),r=null,s=null,t=3e3,u=!1,v={};n.modules.register("writeQuote",{init:c,events:q,write:m})}(jQuery);
//# sourceMappingURL=modules.yhoo.min.map