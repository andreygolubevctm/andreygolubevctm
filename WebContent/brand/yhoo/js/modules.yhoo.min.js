/*!
 * CTM-Platform v0.8.3
 * Copyright 2014 Compare The Market Pty Ltd
 * http://www.comparethemarket.com.au/
 */


function ISODateString(a){function b(a){return 10>a?"0"+a:a}return a.getUTCFullYear()+"-"+b(a.getUTCMonth()+1)+"-"+b(a.getUTCDate())+"T"+b(a.getUTCHours())+":"+b(a.getUTCMinutes())+":"+b(a.getUTCSeconds())+"Z"}function printStackTrace(a){a=a||{guess:!0};var b=a.e||null;a=!!a.guess;var c=new printStackTrace.implementation,b=c.run(b);return a?c.guessAnonymousFunctions(b):b}!function(a){var b,c;b=window.meerkat=window.meerkat||{},c={},b.messaging={},b.messaging.channels={},b.messaging.subscribe=function(a,c,d){return handler={callback:c,context:d||window},b.messaging.channels[a]||(b.messaging.channels[a]=[]),b.messaging.channels[a].push(handler),handler},b.messaging.unsubscribe=function(a,c){var d=b.messaging.channels[a];if(b.messaging.channels[a]){var e=d.indexOf(c);if(e>-1)return d.splice(e,1),!0}return!1},b.messaging.publish=function(a){var c;if(!b.messaging.channels[a])return!1;c=Array.prototype.slice.call(arguments,1);for(var d=0;d<b.messaging.channels[a].length;d++){var e=b.messaging.channels[a][d];e.callback.apply(e.context,c)}return this},b.site={},b.site.init=function(c){a.extend(b,{site:c})},b.getModule=function(b,c,d){var e=a(b).closest("[data-module]"),f=function(){var a=!0;return e.length&&e.data("module")?(c&&(a=a&&e.data("module").type===c),d&&(a=a&&e.data("module").subtype===d),a):!1};for(f(e);!f(e)&&e.length;)e=e.parent().closest("[data-module]");return f(e)&&e},b.init=function(d,e){a.extend(c,e||{}),b.site.init(d),b.logging.init(),b.modules.init()}}(jQuery),meerkat.logging={};var Driftwood=new function(){this.logger=function(){function a(a,b,e){var f=d(b),g=new Date,h=a[0];if(f>=c.consoleLevelId&&(a[0]=b+":["+ISODateString(g)+"] "+a[0]),f>=c.exceptionLevelId){var i="Sorry, we have encountered an error. Please try again.";"development"==c.mode&&(i+="["+h+"]"),meerkat.modules.errorHandling.error({errorLevel:"silent",page:"meerkat.logging.js",message:i,description:h})}"production"!==c.mode&&"Microsoft Internet Explorer"!=navigator.appName&&e.apply(console,Array.prototype.slice.call(a))}var b=["NONE","DEBUG","INFO","ERROR","EXCEPTION","NONE"],c={consoleLevel:"DEBUG",consoleLevelId:0,exceptionLevel:"NONE",exceptionLevelId:99,mode:"development",serverPath:"/exceptions/notify?payload=",applicationName:"js_client",cors:!0},d=function(a){return b.indexOf(a.toUpperCase())};return{setServerPath:function(a){c.serverPath=a},env:function(a){a=a.toLowerCase(),"development"==a?(c.consoleLevel="DEBUG",c.exceptionLevel="none",c.consoleLevelId=0,c.exceptionLevelId=4,c.mode=a):"production"==a?(c.consoleLevel="ERROR",c.exceptionLevel="none",c.consoleLevelId=2,c.exceptionLevelId=3,c.mode=a):console.log("Unknown environment level")},applicationName:function(a){c.applicationName=a},logLevel:function(a){var b=d(a);b>-1?(c.consoleLevel=a.toUpperCase(),c.consoleLevelId=b):console.log("Setting an invalid log level: "+a)},exceptionLevel:function(a){var b=d(a);b>-1?(c.exceptionLevel=a.toUpperCase(),c.exceptionLevelId=b):console.log("Setting an invalid log level: "+a)},debug:function(){a(arguments,"DEBUG",console.debug)},info:function(){a(arguments,"INFO",console.info)},error:function(){a(arguments,"ERROR",console.error)},exception:function(b){a(b,"EXCEPTION",console.error)}}},defaultLogger=new this.logger,this.exception=function(){defaultLogger.exception(arguments)},this.applicationName=function(a){defaultLogger.applicationName(a)},this.debug=defaultLogger.debug,this.info=defaultLogger.info,this.error=defaultLogger.error,this.env=function(a){defaultLogger.env(a)},this.setServerPath=function(a){defaultLogger.setServerPath(a)},this.exceptionLevel=function(a){"NONE"!=a?defaultLogger.exceptionLevel(a):(this.debug=_.bind(console.debug,console),this.info=_.bind(console.info,console),this.error=_.bind(console.error,console),this.log=_.bind(console.log,console))},this.logLevel=function(a){defaultLogger.logLevel(a)}};window.onerror=function(a,b,c){Driftwood.exception(a,{url:b,line:c})},Array.prototype.indexOf||(Array.prototype.indexOf=function(a){"use strict";if(void 0===this||null===this)throw new TypeError;var b=Object(this),c=b.length>>>0;if(0===c)return-1;var d=0;if(arguments.length>0&&(d=Number(arguments[1]),d!==d?d=0:0!==d&&d!==1/0&&d!==-(1/0)&&(d=(d>0||-1)*Math.floor(Math.abs(d)))),d>=c)return-1;for(var e=d>=0?d:Math.max(c-Math.abs(d),0);c>e;e++)if(e in b&&b[e]===a)return e;return-1});var JSON;if(JSON||(JSON={}),function(){function f(a){return 10>a?"0"+a:a}function quote(a){return escapable.lastIndex=0,escapable.test(a)?'"'+a.replace(escapable,function(a){var b=meta[a];return"string"==typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function str(a,b){var c,d,e,f,g,h=gap,i=b[a];switch(i&&"object"==typeof i&&"function"==typeof i.toJSON&&(i=i.toJSON(a)),"function"==typeof rep&&(i=rep.call(b,a,i)),typeof i){case"string":return quote(i);case"number":return isFinite(i)?String(i):"null";case"boolean":case"null":return String(i);case"object":if(!i)return"null";if(gap+=indent,g=[],"[object Array]"===Object.prototype.toString.apply(i)){for(f=i.length,c=0;f>c;c+=1)g[c]=str(c,i)||"null";return e=0===g.length?"[]":gap?"[\n"+gap+g.join(",\n"+gap)+"\n"+h+"]":"["+g.join(",")+"]",gap=h,e}if(rep&&"object"==typeof rep)for(f=rep.length,c=0;f>c;c+=1)"string"==typeof rep[c]&&(d=rep[c],e=str(d,i),e&&g.push(quote(d)+(gap?": ":":")+e));else for(d in i)Object.prototype.hasOwnProperty.call(i,d)&&(e=str(d,i),e&&g.push(quote(d)+(gap?": ":":")+e));return e=0===g.length?"{}":gap?"{\n"+gap+g.join(",\n"+gap)+"\n"+h+"}":"{"+g.join(",")+"}",gap=h,e}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;"function"!=typeof JSON.stringify&&(JSON.stringify=function(a,b,c){var d;if(gap="",indent="","number"==typeof c)for(d=0;c>d;d+=1)indent+=" ";else"string"==typeof c&&(indent=c);if(rep=b,!b||"function"==typeof b||"object"==typeof b&&"number"==typeof b.length)return str("",{"":a});throw new Error("JSON.stringify")}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){function walk(a,b){var c,d,e=a[b];if(e&&"object"==typeof e)for(c in e)Object.prototype.hasOwnProperty.call(e,c)&&(d=walk(e,c),void 0!==d?e[c]=d:delete e[c]);return reviver.call(a,b,e)}var j;if(text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),printStackTrace.implementation=function(){},printStackTrace.implementation.prototype={run:function(a,b){return a=a||this.createException(),b=b||this.mode(a),"other"===b?this.other(arguments.callee):this[b](a)},createException:function(){try{this.undef()}catch(a){return a}},mode:function(a){return a.arguments&&a.stack?"chrome":a.stack&&a.sourceURL?"safari":a.stack&&a.number?"ie":a.stack&&a.fileName?"firefox":a.message&&a["opera#sourceloc"]?!a.stacktrace||-1<a.message.indexOf("\n")&&a.message.split("\n").length>a.stacktrace.split("\n").length?"opera9":"opera10a":a.message&&a.stack&&a.stacktrace?0>a.stacktrace.indexOf("called from line")?"opera10b":"opera11":a.stack&&!a.fileName?"chrome":"other"},instrumentFunction:function(a,b,c){a=a||window;var d=a[b];a[b]=function(){return c.call(this,printStackTrace().slice(4)),a[b]._instrumented.apply(this,arguments)},a[b]._instrumented=d},deinstrumentFunction:function(a,b){a[b].constructor===Function&&a[b]._instrumented&&a[b]._instrumented.constructor===Function&&(a[b]=a[b]._instrumented)},chrome:function(a){return(a.stack+"\n").replace(/^[\s\S]+?\s+at\s+/," at ").replace(/^\s+(at eval )?at\s+/gm,"").replace(/^([^\(]+?)([\n$])/gm,"{anonymous}() ($1)$2").replace(/^Object.<anonymous>\s*\(([^\)]+)\)/gm,"{anonymous}() ($1)").replace(/^(.+) \((.+)\)$/gm,"$1@$2").split("\n").slice(0,-1)},safari:function(a){return a.stack.replace(/\[native code\]\n/m,"").replace(/^(?=\w+Error\:).*$\n/m,"").replace(/^@/gm,"{anonymous}()@").split("\n")},ie:function(a){return a.stack.replace(/^\s*at\s+(.*)$/gm,"$1").replace(/^Anonymous function\s+/gm,"{anonymous}() ").replace(/^(.+)\s+\((.+)\)$/gm,"$1@$2").split("\n").slice(1)},firefox:function(a){return a.stack.replace(/(?:\n@:0)?\s+$/m,"").replace(/^(?:\((\S*)\))?@/gm,"{anonymous}($1)@").split("\n")},opera11:function(a){var b=/^.*line (\d+), column (\d+)(?: in (.+))? in (\S+):$/;a=a.stacktrace.split("\n");for(var c=[],d=0,e=a.length;e>d;d+=2){var f=b.exec(a[d]);if(f){var g=f[4]+":"+f[1]+":"+f[2],f=f[3]||"global code",f=f.replace(/<anonymous function: (\S+)>/,"$1").replace(/<anonymous function>/,"{anonymous}");c.push(f+"@"+g+" -- "+a[d+1].replace(/^\s+/,""))}}return c},opera10b:function(a){var b=/^(.*)@(.+):(\d+)$/;a=a.stacktrace.split("\n");for(var c=[],d=0,e=a.length;e>d;d++){var f=b.exec(a[d]);f&&c.push((f[1]?f[1]+"()":"global code")+"@"+f[2]+":"+f[3])}return c},opera10a:function(a){var b=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i;a=a.stacktrace.split("\n");for(var c=[],d=0,e=a.length;e>d;d+=2){var f=b.exec(a[d]);f&&c.push((f[3]||"{anonymous}")+"()@"+f[2]+":"+f[1]+" -- "+a[d+1].replace(/^\s+/,""))}return c},opera9:function(a){var b=/Line (\d+).*script (?:in )?(\S+)/i;a=a.message.split("\n");for(var c=[],d=2,e=a.length;e>d;d+=2){var f=b.exec(a[d]);f&&c.push("{anonymous}()@"+f[2]+":"+f[1]+" -- "+a[d+1].replace(/^\s+/,""))}return c},other:function(a){for(var b,c,d=/function\s*([\w\-$]+)?\s*\(/i,e=[],f=Array.prototype.slice;a&&a.arguments&&10>e.length;){b=d.test(a.toString())?RegExp.$1||"{anonymous}":"{anonymous}",c=f.call(a.arguments||[]),e[e.length]=b+"("+this.stringifyArguments(c)+")";try{a=a.caller}catch(g){e[e.length]=""+g;break}}return e},stringifyArguments:function(a){for(var b=[],c=Array.prototype.slice,d=0;d<a.length;++d){var e=a[d];void 0===e?b[d]="undefined":null===e?b[d]="null":e.constructor&&(b[d]=e.constructor===Array?3>e.length?"["+this.stringifyArguments(e)+"]":"["+this.stringifyArguments(c.call(e,0,1))+"..."+this.stringifyArguments(c.call(e,-1))+"]":e.constructor===Object?"#object":e.constructor===Function?"#function":e.constructor===String?'"'+e+'"':e.constructor===Number?e:"?")}return b.join(",")},sourceCache:{},ajax:function(a){var b=this.createXMLHTTPObject();if(b)try{return b.open("GET",a,!1),b.send(null),b.responseText}catch(c){}return""},createXMLHTTPObject:function(){for(var a,b=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}],c=0;c<b.length;c++)try{return a=b[c](),this.createXMLHTTPObject=b[c],a}catch(d){}},isSameDomain:function(a){return"undefined"!=typeof location&&-1!==a.indexOf(location.hostname)},getSource:function(a){return a in this.sourceCache||(this.sourceCache[a]=this.ajax(a).split("\n")),this.sourceCache[a]},guessAnonymousFunctions:function(a){for(var b=0;b<a.length;++b){var c=/^(.*?)(?::(\d+))(?::(\d+))?(?: -- .+)?$/,d=a[b],e=/\{anonymous\}\(.*\)@(.*)/.exec(d);if(e){var f=c.exec(e[1]);f&&(c=f[1],e=f[2],f=f[3]||0,c&&this.isSameDomain(c)&&e&&(c=this.guessAnonymousFunction(c,e,f),a[b]=d.replace("{anonymous}",c)))}}return a},guessAnonymousFunction:function(a,b){var c;try{c=this.findFunctionName(this.getSource(a),b)}catch(d){c="getSource failed with url: "+a+", exception: "+d.toString()}return c},findFunctionName:function(a,b){for(var c,d,e=/function\s+([^(]*?)\s*\(([^)]*)\)/,f=/['"]?([$_A-Za-z][$_A-Za-z0-9]*)['"]?\s*[:=]\s*function\b/,g=/['"]?([$_A-Za-z][$_A-Za-z0-9]*)['"]?\s*[:=]\s*(?:eval|new Function)\b/,h="",i=Math.min(b,20),j=0;i>j;++j)if(c=a[b-j-1],d=c.indexOf("//"),d>=0&&(c=c.substr(0,d)),c&&(h=c+h,(c=f.exec(h))&&c[1]||(c=e.exec(h))&&c[1]||(c=g.exec(h))&&c[1]))return c[1];return"(?)"}},"undefined"==typeof console)var console={log:function(){}};Function.prototype.bind&&console&&"object"==typeof console.log&&["log","info","warn","error","assert","dir","clear","profile","profileEnd"].forEach(function(a){console[a]=this.bind(console[a],console)},Function.prototype.call),"undefined"==typeof console.debug&&(console.debug=console.log),meerkat.logging.logger=Driftwood,meerkat.logging.debug=meerkat.logging.logger.debug,meerkat.logging.info=meerkat.logging.logger.info,meerkat.logging.error=meerkat.logging.logger.error,meerkat.logging.exception=meerkat.logging.logger.exception,meerkat.logging.init=function(){var a="";a=""!==meerkat.site.vertical?"["+meerkat.site.vertical+"]":"",meerkat.logging.logger.applicationName(a);var b=meerkat.site.showLogging?"development":"production";meerkat.logging.logger.env(b),meerkat.logging.info("[logging]","Sergei sees you runnings on "+meerkat.site.environment+" ("+b+"s mode).")},function(a){function b(b,c){if(e[b])throw"A module is already defined with the key: "+b;e[b]=c,e[b].moduleName=b,"function"==typeof c.init&&g.push(b),"function"==typeof c.events?a.extend(!0,f,e[b].events()):"object"==typeof e.events&&a.extend(!0,f,e[b].events)}function c(){for(g=g.reverse();g.length;){var a=g.pop();e[a].init()}}var d=window.meerkat,e=(d.logging.info,{}),f={},g=[];e=d.modules={register:b,init:c},d.modules.events=f}(jQuery),function(a){function b(a){window.location.hash=a}function c(a){l.defaultHash=a}function d(a){-1==_.indexOf(g(),a)&&(window.location.hash=i()+"/"+a)}function e(a){for(var b=j.modules.address.getWindowHashAsArray(),c=b.length-1;c>=0;c--)b[c]==a&&b.splice(c,1);window.location.hash=b.join("/")}function f(){a(window).on("hashchange",function(){j.messaging.publish(k.ADDRESS_CHANGE,{hash:j.modules.address.getWindowHash(),hashArray:j.modules.address.getWindowHashAsArray()})})}function g(){return i().split("/")}function h(a){var b=g();return a>=b.length?"":b[a]}function i(){var a=window.location.hash;return null!=a?a.replace("#",""):""}var j=window.meerkat,k=(j.logging.info,{ADDRESS_CHANGE:"ADDRESS_CHANGE"}),l={defaultHash:""};j.modules.register("address",{init:f,events:k,getWindowHashAsArray:g,getWindowHash:i,setHash:b,appendToHash:d,removeFromHash:e,setStartHash:c,getWindowHashAt:h})}(jQuery),function(a){function b(b){b.each(function(b,c){$item=a(c),$item.affix({offset:{top:function(){var a=$item.offset().top;return this.top=a}}}),$item.on("affixed.bs.affix",function(){d.messaging.publish(g.AFFIXED,$item)}),$item.on("affixed-top.bs.affix",function(){d.messaging.publish(g.UNAFFIXED,$item)})})}function c(){d.messaging.subscribe(e.journeyProgressBar.INIT,function(){if("xs"===d.modules.deviceMediaState.get())var c=d.messaging.subscribe(e.device.STATE_LEAVE_XS,function(){d.messaging.unsubscribe(c),b(a(".navbar-affix"))});else b(a(".navbar-affix"))})}var d=window.meerkat,e=d.modules.events,f=(window.meerkat.logging.info,{affix:{AFFIXED:"CORE_AFFIX_AFFIXED",UNAFFIXED:"CORE_AFFIX_UNAFFIXED"}}),g=f.affix;d.modules.register("affix",{init:c,events:f})}(jQuery),function(a){function b(){var b=a("input.typeahead");b.each(function(){var b=a(this),f={name:b.attr("name"),remote:{beforeSend:function(){c(b)},filter:function(a){return d(b),a},url:b.attr("data-source-url")+"%QUERY"},limit:150};f=e(b,f),b.typeahead(f),b.hasClass("input-lg")&&b.prev(".tt-hint").addClass("hint-lg"),b.hasClass("input-sm")&&b.prev(".tt-hint").addClass("hint-sm"),b.hasClass("blur-on-select")&&b.bind("typeahead:selected",function(a,b){b.hasOwnProperty("value")&&"Type your address..."===b.value||a&&a.target&&a.target.blur&&a.target.blur()})})}function c(a){a.hasClass("show-loading")&&g.modules.loadingAnimation.showInside(a.parent(".twitter-typeahead"))}function d(a){a.hasClass("show-loading")&&g.modules.loadingAnimation.hide(a.parent(".twitter-typeahead"))}function e(a,b){return a&&a.hasClass("typeahead-address")&&(b.remote.url=a.attr("id"),b.remote.replace=f,b.valueKey="value",b.template=_.template("<p><%= highlight %></p>"),a.hasClass("typeahead-streetSearch")&&(b.remote.filter=function(b){return d(a),0===b.length&&b.push({value:"Type your address...",highlight:"Can't find your address? <u>Click here.</u>"}),b},a.bind("typeahead:selected",function(a,b){if(b.hasOwnProperty("value")&&"Type your address..."===b.value){var c="";a.target&&a.target.id&&(c=a.target.id.replace("_streetSearch","")),g.messaging.publish(h.CANT_FIND_ADDRESS,{fieldgroup:c})}}))),b}function f(b){var c=a("#"+b);return b="",c.trigger("getSearchURL"),c.data("source-url")&&(b=c.data("source-url")),b}var g=window.meerkat,h={CANT_FIND_ADDRESS:"EVENT_CANT_FIND_ADDRESS"};g.modules.register("autocomplete",{init:b,events:h})}(jQuery),function(a){function b(){jQuery(document).ready(function(){c()}),r.subscribe(q.modules.events.contactDetails.name.FIELD_CHANGED,function(b){H="undefined"!=typeof b.$otherField?a.trim(1===b.fieldIndex?b.$field.val()+" "+b.$otherField.val():b.$otherField.val()+" "+b.$field.val()):b.$field.val()}),r.subscribe(q.modules.events.contactDetails.mobile.FIELD_CHANGED,function(a){I=a.$field.val()}),r.subscribe(q.modules.events.contactDetails.otherPhone.FIELD_CHANGED,function(a){J=a.$field.val()}),r.subscribe(t.VALID,o),r.subscribe(t.INVALID,p)}function c(){u=a(v),w=a(x),y=a(z),A=a(B),u.off("keyup").on("keyup",e),w.off("keyup").on("keyup",e),w.off("focusout").on("focusout",function(){a(this).siblings("[type=hidden]").val(a(this).val().replace(/[^0-9]+/g,""))}),y.off("change").on("change",e),C=a(".call-me-back-submit"),E=a(".call-me-back-form"),C.off("click").on("click",function(){f(a(this).parents("form").first())}),n()}function d(a){null!==H&&a.find(v).val(H),null!==I?a.find(x).val(I):null!==J&&a.find(x).val(J)}function e(){m(a(this).parents("form").first());var b=""!==D.find(u).val(),c=""!==D.find(w).val(),d=""!==D.find(y).val();r.publish(b&&c&&d&&D.valid()?t.VALID:t.INVALID)}function f(b){if(m(b),(!F||"pending"!==F.state())&&D.valid()&&!G){D.find(B).val("Y");var c=[],d=q.modules.form.getData(D),e=q.modules.journeyEngine.getFormData();c=d.concat(e),c.push({name:"quoteType",value:q.site.vertical}),r.publish(t.INVALID),q.modules.loadingAnimation.showAfter(C),F=q.modules.comms.post({url:"ajax/write/request_callback.jsp",data:c,dataType:"json",cache:!1,errorLevel:"silent",onSuccess:function(b){G=!0,q.messaging.publish(t.REQUESTED,{phone:D.find(w).val(),name:D.find(u).val()}),h(),i();var c=a("#mainform");D.find(":input").each(function(){$this=a(this),q.modules.form.appendHiddenField(c,$this.attr("name"),$this.val())}),q.modules.form.appendHiddenField(c,q.site.vertical+"_callmeback_time",b.time),q.modules.form.appendHiddenField(c,q.site.vertical+"_callmeback_date",b.date),0===a("#requested_callmeback_time").length&&q.modules.form.appendHiddenField(c,"requested_callmeback_time",b.time),0===a("#requested_callmeback_date").length&&q.modules.form.appendHiddenField(c,"requested_callmeback_date",b.date)},onError:function(){h(),j(),r.publish(t.VALID)},onComplete:function(){q.modules.loadingAnimation.hide(C)}})}}function g(){return G}function h(){E.each(function(){a(this).hide()})}function i(){E.each(function(){a(this).after(k())})}function j(){E.each(function(){a(this).after('<form class="callmeback-feedback"><h5>Call back service offline</h5><p>Sadly our call back service is offline - Please try again later.</p></form>')})}function k(){return'<form class="callmeback-feedback"><h5>Someone will call you</h5><p>Thank you, a member of our staff will call you in the '+l(D.find(y).val())+"</p></form>"}function l(a){switch(a){case"M":time="morning";break;case"A":time="afternoon";break;default:time="evening (excludes WA)"}return time}function m(a){D=a}function n(){E.each(function(){setupDefaultValidationOnForm(a(this))}),u.length>0&&u.add("rules",{required:!0,messages:{required:"Please enter your name"}}),w.length>0&&w.add("rules",{validateTelNo:!0,messages:{validateTelNo:"Please enter the contact number in the format (area code)(local number) for landline or 04xxxxxxxx for mobile"}}),y.length>0&&y.add("rules",{required:!0,messages:{required:"Please select when you want us to call you back"}})}function o(){null!==D&&D.find(C).removeClass("disabled")}function p(){null!==D&&D.find(C).addClass("disabled")}var q=window.meerkat,r=(q.modules.events,q.logging.info,q.messaging),s={callMeBack:{REQUESTED:"CALL_ME_BACK_REQUESTED",VALID:"CALL_ME_BACK_VALID",INVALID:"CALL_ME_BACK_INVALID"}},t=s.callMeBack,u=null,v=".callmeback_name",w=null,x=".callmeback_phone",y=null,z=".callmeback_timeOfDay",A=null,B=".callmeback_optin",C=null,D=null,E=null,F=null,G=!1,H=null,I=null,J=null;q.modules.register("callMeBack",{init:b,events:s,hasCallbackBeenRequested:g,prefillForm:d,updateSelectedElements:c,submitCallMeBack:f})}(jQuery),function(a){function b(){jQuery(document).ready(function(a){$modalContent=a("#callMeBackModalContent"),$openButton=a("#callMeBackTabButton"),$openButton.on("click",c)}),j.subscribe(i.callMeBack.VALID,e),j.subscribe(i.callMeBack.INVALID,f),j.subscribe(i.callMeBack.REQUESTED,g)}function c(){var b=h.modules.dialogs.show({title:"Get a call back",htmlContent:$modalContent.html(),buttons:[{label:isRequested?"Close":"Cancel",className:"btn-cancel modal-call-me-back-close",closeWindow:!0},{label:"Call me",className:"btn-cta disabled modal-call-me-back-submit"+(isRequested?" displayNone":""),action:d}],onClose:function(){$openButton.fadeIn()}});$currentCallMeBackModal=a("#"+b),h.modules.callMeBack.updateSelectedElements(),h.modules.callMeBack.prefillForm($currentCallMeBackModal.find("form")),$currentCallMeBackModal.find("h5").hide(),$currentCallMeBackModal.find(".call-me-back-submit").hide(),$openButton.fadeOut();var c=$currentCallMeBackModal.find(".callmeback_name"),e=$currentCallMeBackModal.find(".callmeback_phone");""===c.val()?c.focus():""===e.val()?e.focus():$currentCallMeBackModal.find(".callmeback_timeOfDay").focus()}function d(){h.modules.callMeBack.submitCallMeBack($currentCallMeBackModal.find("form"))}function e(){null!==$currentCallMeBackModal&&$currentCallMeBackModal.find(".modal-call-me-back-submit").removeClass("disabled")}function f(){null!==$currentCallMeBackModal&&$currentCallMeBackModal.find(".modal-call-me-back-submit").addClass("disabled")}function g(){isRequested=!0,null!==$currentCallMeBackModal&&($currentCallMeBackModal.find(".modal-call-me-back-submit").hide(),$currentCallMeBackModal.find(".modal-call-me-back-close").html("Close"))}{var h=window.meerkat,i=h.modules.events,j=h.messaging,k=(h.logging.info,{callMeBackTab:{}});k.callMeBackTab}$currentCallMeBackModal=null,isRequested=!1,h.modules.register("callMeBackTab",{init:b})}(jQuery),function(a){function b(b){var c=a.extend({},n,b);("undefined"==typeof b.errorLevel||null===b.errorLevel)&&console.error("Message to dev: please provide an errorLevel to the comms.post() or comms.get() function.");var e=g(c);return e===!0?!0:(c.attemptsCounter=1,d(c,{url:c.url,data:c.data,dataType:c.dataType,type:"POST",timeout:c.timeout}))}function c(b){var c=a.extend({},n,b);("undefined"==typeof b.errorLevel||null===b.errorLevel)&&console.error("Message to dev: please provide an errorLevel to the comms.post() or comms.get() function.");var e=g(c);return e===!0?!0:(c.attemptsCounter=1,d(c,{url:c.url,data:c.data,dataType:c.dataType,type:"GET",timeout:c.timeout}))}function d(b,c){var d=k.modules.transactionId.get();try{null==c.data&&(c.data={}),_.isString(c.data)?(c.data+="&transactionId="+d,k.site.isCallCentreUser&&(c.data+="&"+m+"=true")):_.isArray(c.data)?(-1===_.indexOf(c.data,"transactionId")&&c.data.push({name:"transactionId",value:d}),k.site.isCallCentreUser&&c.data.push({name:m,value:!0})):_.isObject(c.data)&&(c.data.hasOwnProperty("transactionId")===!1&&(c.data.transactionId=d),k.site.isCallCentreUser&&(c.data[m]=!0))}catch(f){}var g=a.ajax(c),j=g.then(function(a,d,f){var g="undefined"!=typeof b.data?b.data:null;h(a)===!0?i(f,"Server generated error",a.error,b,g,c):(b.cache===!0&&e(b.url,g,a),null!=b.onSuccess&&b.onSuccess(a),null!=b.onComplete&&b.onComplete(f,d))},function(a,d,e){var f="undefined"!=typeof b.data?b.data:null;i(a,d,e,b,f,c),null!=b.onComplete&&b.onComplete(a,d)});return b.hasOwnProperty("returnAjaxObject")&&b.returnAjaxObject===!0?g:j}function e(a,b,c){l.push({url:a,postData:b,result:c})}function f(a){for(var b=0;b<l.length;b++){var c=l[b];if(a.url===c.url){if(null===a.data&&null===c.postData)return c;if(null!==a.data&&null!==c.postData&&_.isEqual(a.data,c.postData))return c}}return null}function g(a){if(a.cache===!0){var b=f(a);if(null!==b)return k.logging.info("Retrieved from cache",b),null!=a.onSuccess&&a.onSuccess(b.result),null!=a.onComplete&&a.onComplete(),!0}return!1}function h(a){return"undefined"!=typeof a.error||"undefined"!=typeof a.errors&&a.errors.length>0?!0:!1}function i(a,b,c,e,f,g){e.numberOfAttempts>e.attemptsCounter++?d(e,g):("undefined"==typeof e&&(e={}),e.useDefaultErrorHandling&&e.onErrorDefaultHandling(a,b,c,e,f),null!=e.onError&&e.onError(a,b,c,e,f))}function j(){return m}var k=window.meerkat,l=[],m="checkAuthenticated",n={url:"not-set",data:null,dataType:!1,numberOfAttempts:1,attemptCallback:null,timeout:6e4,cache:!1,errorLevel:null,useDefaultErrorHandling:!0,returnAjaxObject:!1,onSuccess:function(){},onError:function(){},onComplete:function(){},onErrorDefaultHandling:function(b,c,d,e,f){var g={400:"There was a problem with the last request to the server [400]. Please try again.",401:"There was a problem accessing the data for the last request [401].",403:"There was a problem accessing the data for the last request [403].",404:"The requested page could not be found [404]. Please try again.",412:"Supplied parameters failed to meet preconditions [412].",500:"There was a problem with your last request to the server [500]. Please try again.",503:"There was a problem with your last request to the server [503]. Please try again."},h="",i={errorLevel:e.errorLevel,message:h,page:"comms.js",description:"Error loading url: "+e.url+" : "+c+" "+d,data:f};b.status&&200!=b.status?h=g[b.status]:"parsererror"==c?h+="There was a problem handling the response from the server [parsererror]. Please try again.":"timeout"==c?h+="There was a problem connecting to the server. Please check your internet connection and try again. [Request Time out].":"abort"==c&&(h+="There was a problem handling the response from the server [abort]. Please try again."),h&&""!==h||d!=m?h&&""!==h||(h="Unknown Error"):(h="Your Simples login session has been lost. Please open Simples in a separate tab, login, then you can continue with this quote.",k.modules.dialogs.isDialogOpen(m)||k.modules.journeyEngine.gotoPath("previous"),a.extend(i,{errorLevel:"warning",id:m})),a.extend(i,{message:h}),(d!=m||d==m&&!k.modules.dialogs.isDialogOpen(m))&&k.modules.errorHandling.error(i)}};k.modules.register("comms",{post:b,get:c,getCheckAuthenticatedLabel:j})}(jQuery),function(a){function b(){}function c(b){a.extend(F,b),_.each(F,function(b,c){_.each(b,function(b,e){var f=a.extend(b,{index:e,type:c,fieldIndex:1});d(f),h(f),"undefined"!=typeof f.$otherField&&(f=a.extend({},f,{alternateOtherField:!0,fieldIndex:2}),d(f))})}),prefillLaterFields=!0}function d(b){var c=w(b);"undefined"!=typeof b.alternateOtherField&&b.alternateOtherField&&(c=b.$otherField),c.on("change.contactDetails",function(){$this=a(this),_.defer(function(){e($this,b)})}),e(c,b,!1)}function e(a,b,c){if("undefined"==typeof c&&(c=!0),a.isValid())if(f(b))g(b,c);else{var d=i(b);c&&j(d),l(d)}}function f(b){var c=["email"];return"undefined"!=b.$optInField&&-1!==a.inArray(b.type,c)?!0:!1}function g(b,c){C.modules.loadingAnimation.showAfter(b.$field);var d={data:{type:b.type,value:b.$field.val()},onComplete:function(){C.modules.loadingAnimation.hide(b.$field)},onSuccess:function(d){var e={optins:{email:d.optInMarketing}},f=a.extend(i(b),e);c&&j(f),l(f)},onError:function(){t(b.$optInField)}};C.modules.optIn.fetch(d)}function h(a){"undefined"!=typeof a.$optInField&&a.$optInField.on("change.contactDetails",function(){var b=i(a);k(b),v(b)})}function i(a){var b={index:a.index,type:a.type,$field:w(a),$otherField:a.$otherField,fieldIndex:a.fieldIndex,$savedField:a.$field,$optInField:a.$optInField};return"undefined"!=typeof a.alternateOtherField&&a.alternateOtherField&&(b.$otherField=b.$field,b.$field=a.$otherField),b}function j(a){D.publish(a.type.toUpperCase()+"_FIELD_CHANGED",a)}function k(a){D.publish(a.type.toUpperCase()+"_OPTIN_FIELD_CHANGED",a)}function l(a){"undefined"!=typeof a.$optInField&&m(a)&&s(a.$optInField,a.optins[a.type]),prefillLaterFields&&a.index!==F[a.type].length&&x(a)}function m(a){return n(a)&&!o(a)}function n(a){return"undefined"!=typeof a.optins&&"undefined"!=typeof a.optins[a.type]?!0:!1}function o(a){return q(a).length>1}function p(a){var b=q(a),c=!0;return _.each(b,function(a){a.$field.isValid()||(c=!1)}),c}function q(a){var b=[];return _.each(r(),function(c){"undefined"!=typeof c.$optInField&&c.$optInField.is(a.$optInField)&&b.push(c)}),b}function r(){var b=[];return _.each(F,function(c,d){_.each(c,function(c){b.push(a.extend(c,{type:d}))})}),b}function s(a,b){b?u(a):t(a)}function t(a){A(a,!1),a.parents(".fieldrow").first().slideDown()}function u(a){a.parents(".fieldrow").first().slideUp(),a.attr("data-visible","true"),A(a,!0)}function v(a){prefillLaterFields&&a.index!==F[a.type].length&&y(a)}function w(a){var b=null;return b="undefined"!=typeof a.$fieldInput?a.$fieldInput:a.$field}function x(b){var c=b.$field,d="undefined"==typeof c.attr("data-previous-value")?"":c.attr("data-previous-value"),e=c.val();c.attr("data-previous-value",e);var f;f="undefined"==typeof b.$optInField?null:n(b)?b.optins[b.type]||z(b.$optInField):z(b.$optInField);for(var g=b.index+1;g<F[b.type].length;g++){var h=a.extend(F[b.type][g],{type:b.type}),i=w(h);if(!(""!==i.val()&&d!==i.val()||"undefined"!=typeof h.$otherField&&""!==h.$otherField.val())){if("name"==b.type&&"undefined"!=typeof h.$otherField){var j=e.split(" ");i.val(j[0]),h.$otherField.val(j.slice(1).join(" "))}else i.val(e).attr("data-previous-value",e);(C.modules.performanceProfiling.isIE8()||C.modules.performanceProfiling.isIE9())&&C.modules.placeholder.invalidatePlaceholder("undefined"!=typeof h.$fieldInput?h.$fieldInput:i),"undefined"!=typeof h.$fieldInput&&i.trigger("change").trigger("blur").trigger("focusout"),"undefined"==typeof h.$optInField||o(h)||s(h.$optInField,f)}}}function y(b){var c=z(b.$optInField),d=null;if(n(b)&&(d=b.optins[b.type]),"undefined"!=typeof c)for(var e=b.index+1;e<F[b.type].length;e++){var f=a.extend(F[b.type][e],{type:b.type});"undefined"!=typeof f.$optInField&&(c&&!o(f)?s(f.$optInField,c):(t(f.$optInField),A(f.$optInField,c)))}}function z(b){var c=b.attr("type"),d=null;if("checkbox"==c)d=b.is(":checked");else{if("radio"!=c)return!1;b.each(function(){return a(this).is(":checked")?(d="Y"==b.val(),!1):void 0})}return d}function A(b,c){var d=b.attr("type");if("checkbox"==d)b.prop("checked",c);else if("radio"==d){var e=null;e=c?"Y":"N",b.each(function(){return a(this).val()==e?(a(this).prop("checked",!0).trigger("change"),!1):void 0})}}function B(){return F}var C=window.meerkat,D=(C.modules.events,C.logging.info,C.messaging),E={contactDetails:{name:{FIELD_CHANGED:"NAME_FIELD_CHANGED",OPTIN_FIELD_CHANGED:"NAME_OPTIN_FIELD_CHANGED"},email:{FIELD_CHANGED:"EMAIL_FIELD_CHANGED",OPTIN_FIELD_CHANGED:"EMAIL_OPTIN_FIELD_CHANGED"},phone:{FIELD_CHANGED:"PHONE_FIELD_CHANGED",OPTIN_FIELD_CHANGED:"PHONE_OPTIN_FIELD_CHANGED"},mobile:{FIELD_CHANGED:"MOBILE_FIELD_CHANGED",OPTIN_FIELD_CHANGED:"MOBILE_OPTIN_FIELD_CHANGED"},otherPhone:{FIELD_CHANGED:"OTHERPHONE_FIELD_CHANGED",OPTIN_FIELD_CHANGED:"OTHERPHONE_OPTIN_FIELD_CHANGED"}}},F=(E.contactDetails,{});
prefillLaterFields=!0,C.modules.register("contactDetails",{init:b,events:E,configure:c,getFields:B,getFieldsFromOptInGroup:q,isOptInGroupValid:p,isPartOfOptInGroup:o})}(jQuery),function(a){function b(){}function c(b){a("[data-source]",a(b)).each(function(){a(this).empty()})}function d(b){a("[data-source]",a(b)).each(function(){var b="",c=a(this),d=a(c.attr("data-source"));if(d.length){if(sourceType=d.get(0).tagName.toLowerCase(),dataType=c.attr("data-type"),callback=c.attr("data-callback"),callback)try{var f=callback.split(".");if(f.length){for(var g=f.pop(),h=window,i=0;i<f.length;i++)h=h[f[i]];b=h[g].apply(h,[d])}else b=callback.apply(window,[d])}catch(j){e.modules.errorHandling.error({message:"Unable to perform render Content Population Callback properly.",page:"contentPopulation.js:render()",errorLevel:"silent",description:"Unable to perform contentPopulation callback labelled: "+callback,data:{error:j.toString(),sourceElement:c.attr("data-source")}}),b=""}else if(dataType)switch(dataType){case"radiogroup":var k=d.find(":checked").parent("label");k.length&&(b=k.text()||"");break;case"list":d.find("li").each(function(){b+="<li>"+a(this).find("span:eq(0)").text()+"</li>"});break;case"object":}else switch(sourceType){case"select":var l=d.find("option:selected");b=""===l.val()?"":l.text()||"";break;case"input":b=d.val()||"";break;default:b=d.html()||""}c.html(b)}})}{var e=window.meerkat,f=(e.modules.events,e.logging.info,{contentPopulation:{}});f.contentPopulation}e.modules.register("contentPopulation",{init:b,events:f,render:d,empty:c})}(jQuery),function(a){function b(a){a.closest(".dateinput_container").find(".withDatePicker .input-group-addon-button").on("click",function(){a.datepicker("show")})}function c(b){a(document).on("hide",b,function(b){var c=a(b.target);if(b.target)return c.is("input")?void c.blur():void(c.find("input").is(":focus")||(c.find("input").blur(),(h.modules.performanceProfiling.isIE8()||h.modules.performanceProfiling.isIE9())&&h.modules.placeholder.invalidatePlaceholder(a("input.dateinput-date"))))})}function d(){a.fn.datepicker.defaults.format="dd/mm/yyyy",a.fn.datepicker.defaults.autoclose=!0,a.fn.datepicker.defaults.forceParse=!1,a.fn.datepicker.defaults.weekStart=1,a.fn.datepicker.defaults.todayHighlight=!0,a.fn.datepicker.defaults.clearBtn=!1,a.fn.datepicker.defaults.keyboardNavigation=!1}function e(){return"function"!=typeof a.fn.datepicker?void k("core/datepicker:(lib-not-loaded-err)"):(g="[data-provide=datepicker]",$datePickerElms=a(g),d(),$datePickerElms.each(function(){var d=a(this),e=d.data("date-mode");switch("undefined"==typeof e&&(e="component"),e){case"component":c(g);break;case"inline":break;case"range":break;case"separated":b(d),d.on("serialised.meerkat.formDateInput",function(){d.datepicker("update"),d.blur()}),d.on("hide",function(){d.closest(".dateinput_container").find(".withDatePicker input").blur(),d.blur()})}}),void j("[datepicker] Initialised"))}function f(){a(document).ready(function(){h.messaging.subscribe(i.journeyEngine.READY,function(){e()})})}var g,h=window.meerkat,i=h.modules.events,j=h.logging.info,k=h.logging.exception;h.modules.register("datepicker",{init:f})}(jQuery),function(){function a(){function a(a){var b,c=a.target,d=c.tagName.toLowerCase();if(a.shiftKey&&83===a.which&&"input"!==d&&"textarea"!==d&&"select"!==d){b=document.getElementsByTagName("link");for(var e=0;e<b.length;e++){var f=b[e];if(f.rel.toLowerCase().indexOf("stylesheet")>=0){var g=f.getAttribute("href");g=g.replace(/(&|\?)forceReload=\d+/,""),g=g+(g.indexOf("?")>=0?"&":"?")+"forceReload="+(new Date).getTime(),f.setAttribute("href",g)}}}}window.addEventListener&&window.addEventListener("keypress",a)}function b(){c.site.isDev===!0&&a()}var c=window.meerkat;c.modules.register("development",{init:b})}(jQuery),function(a){function b(){return a("html").css("font-family").replace(/'/g,"").replace(/\"/g,"")}function c(){g=b(),a(window).resize(_.debounce(function(){var a=b();d.messaging.publish(f.RESIZE_DEBOUNCED,{previousState:g,state:a}),a!==g&&(d.messaging.publish(f.STATE_CHANGE,{previousState:g,state:a}),d.messaging.publish(f["STATE_ENTER_"+a.toUpperCase()]),g&&d.messaging.publish(f["STATE_LEAVE_"+g.toUpperCase()]),g=a)}))}var d=window.meerkat,e=(d.modules.events,d.logging.info,{device:{RESIZE_DEBOUNCED:"DEVICE_RESIZE_DEBOUNCED",STATE_CHANGE:"DEVICE_MEDIA_STATE_CHANGE",STATE_ENTER_XS:"DEVICE_STATE_ENTER_XS",STATE_ENTER_SM:"DEVICE_STATE_ENTER_SM",STATE_ENTER_MD:"DEVICE_STATE_ENTER_MD",STATE_ENTER_LG:"DEVICE_STATE_ENTER_LG",STATE_LEAVE_XS:"DEVICE_STATE_LEAVE_XS",STATE_LEAVE_SM:"DEVICE_STATE_LEAVE_SM",STATE_LEAVE_MD:"DEVICE_STATE_LEAVE_MD",STATE_LEAVE_LG:"DEVICE_STATE_LEAVE_LG"}}),f=e.device,g=!1;d.modules.register("deviceMediaState",{init:c,events:e,get:b})}(jQuery),function(a){function b(b){var e=a.extend({},t,b);p="xs"===n.modules.deviceMediaState.get()?!0:!1;var i="mkDialog_"+q;_.isUndefined(e.id)?(e.id=i,q++):l(e.id)&&c(e.id),null!=e.hashId&&n.modules.address.appendToHash(e.hashId);var j=_.template(e.templates.dialogWindow);(null!=e.url||null!=e.externalUrl)&&(e.htmlContent=n.modules.loadingAnimation.getTemplate());var k=j(e);a("#dynamic_dom").append(k);var m=a("#"+e.id);m.modal({show:!0,backdrop:e.buttons&&e.buttons.length>0?"static":!0,keyboard:!1}),m.css("z-index",parseInt(m.eq(0).css("z-index"))+10*s.length);var o=a(".modal-backdrop");if(o.eq(o.length-1).css("z-index",parseInt(o.eq(0).css("z-index"))+10*s.length),m.on("hidden.bs.modal",function(b){if("undefined"!=typeof b.target){var c=a(b.target);0!==c.length&&c.hasClass("modal")!==!1&&d(c.attr("id"))}}),m.on("shown.bs.tab",function(){h(e.id)}),m.find("button").on("click",function(b){var c=e.buttons[a(b.currentTarget).attr("data-index")];_.isUndefined(c)||(c.closeWindow===!0&&a(b.currentTarget).closest(".modal").modal("hide"),"function"==typeof c.action&&c.action(b))}),m.find(".navbar-nav button").off().on("click",function(b){var c=e[a(b.currentTarget).attr("data-button")];"undefined"!=typeof c&&"function"==typeof c.callback&&c.callback(b)}),null!=e.url&&n.modules.comms.get({url:e.url,cache:e.cacheUrl,errorLevel:"warning",onSuccess:function(a){f(e.id,a),"function"==typeof e.onLoad&&e.onLoad(e.id)}}),null!=e.externalUrl){var r='<iframe class="displayNone" id="'+e.id+'_iframe" width="100%" height="100%" frameborder="0" scrolling="no" allowtransparency="true" src="'+e.externalUrl+'"></iframe>';g(e.id,r),a("#"+e.id+"_iframe").on("load",function(){a(this).show(),n.modules.loadingAnimation.hide(a("#"+e.id))})}return window.setTimeout(function(){h(e.id)},0),"function"==typeof e.onOpen&&e.onOpen(e.id),s.push(e),e.id}function c(b){a("#"+b).modal("hide")}function d(b){s.length>1&&_.defer(function(){s.length>0&&s[0].id!==b&&a(document.body).addClass("modal-open")});var c=j(b);null!==c&&"function"==typeof c.onClose&&c.onClose(b),i(b)}function e(){a("#dynamic_dom .modal").each(function(b,c){h(a(c).attr("id"))})}function f(b,c,d){a("#"+b+" .modal-body").html(c),"function"==typeof d&&d(),e()}function g(b,c){a("#"+b+" .modal-body").append(c),e()}function h(b){p="xs"===n.modules.deviceMediaState.get()?!0:!1;var c=a("#"+b);if(0===c.find(".modal-header").outerHeight(!0))window.setTimeout(function(){h(b)},20);else{var d,e,f,g=c.find(".modal-content"),i=c.find(".modal-dialog");d=a(window).height(),p||(d-=60),e=d,e-=c.find(".modal-header").outerHeight(!0),e-=c.find(".modal-footer").outerHeight(!0),e-=c.find(".modal-closebar").outerHeight(!0),p?(g.css("height",d),c.find(".modal-body").css("height",e),f=0,i.css("top",f)):(g.css("max-height",d),"true"===c.attr("data-fullheight")&&g.css("height",d),c.find(".modal-body").css("max-height",e),f=d/2-i.height()/2,g.height()<d&&(f/=2),i.css("top",f))}}function i(b){if(b&&0!==b.length){var c=a("#"+b);c.find("button").unbind(),c.remove();var d=j(b);if(null!=d){if(null!=d.hashId){n.modules.address.removeFromHash(d.hashId);var e=_.findWhere(r,{hashId:d.hashId});null==e&&r.push(d)}s.splice(d.index,1)}}}function j(a){var b=k(a);return null!==b?(s[b].index=b,s[b]):null}function k(a){for(var b=0;b<s.length;b++)if(s[b].id==a)return b;return null}function l(a){return!_.isNull(k(a))}function m(){a(document).ready(function(){a(document).on("click",".btn-close-dialog",function(){a(this).closest(".modal").modal("hide")}),Modernizr.touch&&(a(document).on("touchmove",".modal",function(a){a.preventDefault()}),a(document).on("touchmove",".modal .modal-body",function(a){a.stopPropagation()}))});var c=this;n.messaging.subscribe(o.dynamicContentLoading.PARSED_DIALOG,function(c){var d,e=c.element.attr("data-dialog-hash-id"),f=null;""!==e&&(f=e),d="url"===c.contentType?{title:c.element.attr("data-title"),url:c.contentValue,cacheUrl:c.element.attr("data-cache")?!0:!1}:"externalUrl"===c.contentType?{title:c.element.attr("data-title"),externalUrl:c.contentValue}:{title:a(c.contentValue).attr("data-title"),htmlContent:c.contentValue};var g=a.extend({hashId:f,closeOnHashChange:!0,className:c.element.attr("data-class")},d);b(g)});var d=_.debounce(e,300);a(window).resize(d),n.messaging.subscribe(o.ADDRESS_CHANGE,function(a){for(var b=s.length-1;b>=0;b--){var d=s[b];d.closeOnHashChange===!0&&-1==_.indexOf(a.hashArray,d.hashId)&&c.close(d.id)}for(var e=0;e<a.hashArray.length;e++){var f=_.findWhere(s,{hashId:a.hashArray[e]});if(null==f){var g=_.findWhere(r,{hashId:a.hashArray[e]});null!=g&&g.openOnHashChange===!0&&n.modules.dialogs.show(g)}}},window)}var n=window.meerkat,o=n.modules.events,p=(n.logging.info,"xs"===n.modules.deviceMediaState.get()?!0:!1),q=0,r=[],s=[],t={title:"",htmlContent:null,url:null,cacheUrl:!1,buttons:[],className:"",leftBtn:{label:"Back",icon:"",className:"btn-sm btn-close-dialog",callback:null},rightBtn:{label:"",icon:"",className:"",callback:null},tabs:[],htmlHeaderContent:"",hashId:null,closeOnHashChange:!1,openOnHashChange:!0,fullHeight:!1,templates:{dialogWindow:'<div id="{{= id }}" class="modal" tabindex="-1" role="dialog" aria-labelledby="{{= id }}_title" aria-hidden="true"{{ if(fullHeight===true){ }} data-fullheight="true"{{ } }}>\n						<div class="modal-dialog {{= className }}">\n\n							<div class="modal-content">\n								<div class="modal-closebar">\n									<a href="javascript:;" class="btn btn-close-dialog"><span class="icon icon-cross"></span></a>\n								</div>\n\n								<div class="navbar navbar-default xs-results-pagination visible-xs">\n									<div class="container">\n										<ul class="nav navbar-nav">\n											<li>\n												<button data-button="leftBtn" class="btn btn-back {{= leftBtn.className }}">{{= leftBtn.icon }} {{= leftBtn.label }}</button>\n											</li>\n											<li class="navbar-text modal-title-label">\n												{{= title }}\n											</li>\n											{{ if(rightBtn.label != "" || rightBtn.icon != "") { }}\n												<li class="right">\n													<button data-button="rightBtn" class="btn btn-save {{= rightBtn.className }}">{{= rightBtn.label }} {{= rightBtn.icon }}</button>\n												</li>\n								{{ } }}\n										</ul>\n									</div>\n								</div>\n\n								<!-- title OR tab list OR htmlHeaderContent e.g. search box -->\n								{{ if(title != "" || tabs.length > 0 || htmlHeaderContent != "" ) { }}\n								<div class="modal-header">\n									{{ if (tabs.length > 0) { }}\n										<ul class="nav nav-tabs tab-count-{{= tabs.length }}">\n											{{ _.each(tabs, function(tab, iterator) { }}\n												<li><a href="javascript:;" data-target="{{= tab.targetSelector }}" title="{{= tab.xsTitle }}">{{= tab.title }}</a></li>\n											{{ }); }}\n										</ul>\n									{{ } else if(title != "" ){ }}\n										<h4 class="modal-title hidden-xs" id="{{= id }}_title">{{= title }}</h4>\n									{{ } else if(htmlHeaderContent != "") { }}\n										{{= htmlHeaderContent }}\n									{{ } }}\n								</div>\n								{{ } }}\n\n								<div class="modal-body">\n									{{= htmlContent }}\n								</div>\n								{{ if(typeof buttons !== "undefined" && buttons.length > 0 ){ }}\n									<div class="modal-footer {{ if(buttons.length > 1 ){ }} mustShow {{ } }}">\n										{{ _.each(buttons, function(button, iterator) { }}\n											<button data-index="{{= iterator }}" type="button" class="btn {{= button.className }} ">{{= button.label }}</button>\n										{{ }); }}\n									</div>\n								{{ } }}\n							</div>\n						</div>\n					</div>'},onOpen:function(){},onClose:function(){},onLoad:function(){}};n.modules.register("dialogs",{init:m,show:b,changeContent:f,close:c,isDialogOpen:l,resizeDialog:h})}(jQuery),function(a){function b(){a(document).ready(function(){Modernizr.touch&&(a(document).on("touchmove",".dropdown-backdrop, .dropdown-interactive form",function(a){a.preventDefault(),a.stopPropagation()}),a(document).on("touchmove",".dropdown-interactive .scrollable",function(a){a.stopPropagation()}))}),a(document).on("show.bs.dropdown",function(b){if(b.target){var d=a(b.target);d.hasClass("dropdown-interactive")!==!1&&c(d)}}),a(document).on("shown.bs.dropdown",function(b){if(b.target){var c=a(b.target);if(c.hasClass("dropdown-interactive")!==!1){var e=!0;"xs"===g.modules.deviceMediaState.get()&&(e=!1),_.defer(function(){d(c,e)&&a(document.body).addClass("dropdown-fitviewport")}),a(document.body).addClass("dropdown-open")}}}),a(document).on("hidden.bs.dropdown",function(){a(document.body).removeClass("dropdown-open").removeClass("dropdown-fitviewport")}),g.messaging.subscribe(h.device.RESIZE_DEBOUNCED,function(){a(".dropdown-interactive").each(function(){var b=a(this);b.removeAttr("data-maxheight"),e(b),b.hasClass("open")&&(d(b,!1)&&a(document.body).addClass("dropdown-fitviewport"),a(document.body).addClass("dropdown-open"))})})}function c(a){var b=a.closest(".dropdown-interactive-base"),c=a.closest(".dropdown-interactive");return b.length&&c.length?i.prependTo(b).on("click",f):c.length?i.prependTo(c).on("click",f):void 0}function d(b,c){if(b&&0!==b.length){var d=0,f=0,h=0;return c===!0&&b.attr("data-maxheight")?f=b.attr("data-maxheight"):(d=a(window).height(),"xs"===g.modules.deviceMediaState.get()?(h+=a("header .dynamicTopHeaderContent").outerHeight(),h+=a("header .navbar-header").outerHeight(),h+=b.find(".activator").outerHeight(),b.prevAll("li:visible").each(function(){h+=a(this).outerHeight()})):(h+=20,b.closest(".navbar-affix").each(function(){h+=a(this).outerHeight()})),h+=b.find("form").outerHeight()-b.find(".scrollable").outerHeight(),f=d-h,b.attr("data-maxheight",f)),f>0?(b.find(".dropdown-container .scrollable").css("max-height",f).css("overflow-y","auto"),!0):(e(b),!1)}}function e(a){a.find(".dropdown-container .scrollable").css("max-height","")}function f(){a('[data-toggle="dropdown"]').parent(".open").children('[data-toggle="dropdown"]').dropdown("toggle")}var g=window.meerkat,h=g.modules.events,i=(g.logging.info,a('<div class="dropdown-backdrop" />'));g.modules.register("dropdownInteractive",{init:b,fitIntoViewport:d,addBackdrop:c})}(jQuery),function(a){function b(){c()}function c(){a(document.body).on("click","a[data-content]",function(a){a.preventDefault(),a.stopPropagation(),d(a)}),a(document.body).on("mouseenter",'[data-trigger=mouseenter], [data-trigger="mouseenter click"]',function(a){d(a)})}function d(b){var c=null,d=null,f=a(b.currentTarget),h=f.attr("data-content"),i=f.attr("data-toggle");if("undefined"!=typeof i&&""!==i){var j=h.split(".");"#"===h[0]||"."===h[0]?(c="selector",d=a(h).html()):"helpid:"==h.substr(0,7)?(c="url",d="ajax/xml/help.jsp?id="+h.substr(7,h.length)):"http"===h.substring(0,4)||"www"===h.substring(0,3)?(c="externalUrl",d=h):"jsp"==j[j.length-1]||"html"==j[j.length-1]?(c="url",d=h):(c="content",d=h),e.messaging.publish(g["PARSED_"+i.toUpperCase()],{element:f,contentType:c,contentValue:d})}}var e=window.meerkat,f=(e.modules.events,e.logging.info,{dynamicContentLoading:{PARSED_POPOVER:"DYNAMIC_CONTENT_PARSED_POPOVER",PARSED_DIALOG:"DYNAMIC_CONTENT_PARSED_DIALOG"}}),g=f.dynamicContentLoading;e.modules.register("dynamicContentLoading",{init:b,events:f})}(jQuery),function(a){function b(){jQuery(document).ready(function(a){v=a("#email-results-dropdown"),w=a("#email-results-component"),x=a(".emailResultsInstructions"),y=a("#emailresults_email"),z=a("#emailresults_marketing"),A=a(D),B=a("#emailResultsSuccess"),C=a(".emailResultsFields"),y.on("keyup change",e),y.on("blur",function(){a(this).val(a.trim(a(this).val()))}),w.on("click",".btn-email-results",i),v.find(".activator").on("click",c),v.on("click",".btn-cancel",q),d(),h(),k(),r.messaging.subscribe(s.WEBAPP_LOCK,p),r.messaging.subscribe(s.WEBAPP_UNLOCK,o)}),t.subscribe(r.modules.events.contactDetails.email.FIELD_CHANGED,function(a){""===y.val()&&y.val(a.$field.val()).trigger("change")})}function c(){J?(B.hide(),w.show(),C.hide()):""!==y.val()&&A.hasClass("disabled")&&y.trigger("change")}function d(){null!==w&&0!==w.length&&setupDefaultValidationOnForm(w)}function e(a){13==a.keyCode||9==a.keyCode?f():E!=y.val()?(n(),clearInterval(F),F=setTimeout(f,800)):m()}function f(){var a=y.valid();a&&g()}function g(){var a=y.val();E=a,G&&"pending"===G.state()&&"function"==typeof G.abort&&G.abort(),n(),r.modules.loadingAnimation.showAfter(y);var b={returnAjaxObject:!0,data:{type:"email",value:a},onComplete:function(){m(),r.modules.loadingAnimation.hide(y),h("emailresultsReady")},onSuccess:function(a){a.optInMarketing?(k(),z.prop("checked",!0)):l()},onError:function(){H=!1,h()}};G=r.modules.optIn.fetch(b)}function h(b){var c="Please enter the email you want your results sent to.";switch(b){case"emailresultsAgain":c='Click the button to send an email of these results.  <a href="javascript:;" class="btn btn-save btn-email-results">Email Results</a>';break;case"emailresultsReady":c="Click the button to send the results to this email address.";break;default:c="Please enter the email address you want these results sent to."}x.html(c),"emailresultsAgain"===b&&(A=a(D),A.html("Email Results"))}function i(){if(w.valid()){if(I&&"pending"===I.state())return;n();var a=[];switch(a.push("emailresults_email="+encodeURIComponent(y.val())),a.push("transactionId="+r.modules.transactionId.get()),a=a.join("&"),Track._type){case"Health":Health._rates!==!1&&(a+=Health._rates)}r.modules.loadingAnimation.showAfter(A),r.modules.comms.post({url:"ajax/json/email_results.jsp",data:a,dataType:"json",cache:!1,errorLevel:"silent",onSuccess:function(a){j(a.success,a.transactionId)},onError:function(){m()},onComplete:function(){r.modules.loadingAnimation.hide(A)}})}}function j(a,b){m(),r.modules.loadingAnimation.hide(A),a&&(w.hide(),B.fadeIn(),J||(J=!0,h("emailresultsAgain"),v.find(".activator span:not([class])").html("Email Results")),"undefined"!=typeof b&&r.modules.transactionId.set(b))}function k(){z.parents(".row").first().hide()}function l(){z.parents(".row").first().show()}function m(){A.removeClass("disabled")}function n(){A.addClass("disabled")}function o(){v.children(".activator").removeClass("inactive").removeClass("disabled")}function p(){q(),v.children(".activator").addClass("inactive").addClass("disabled")}function q(){v.hasClass("open")&&v.find(".activator").dropdown("toggle")}var r=window.meerkat,s=r.modules.events,t=(r.logging.info,r.messaging),u={emailResults:{}},v=(u.emailResults,null),w=null,x=null,y=null,z=null,A=null,B=null,C=null,D=".btn-email-results",E=null,F=null,G=null,H=null,I=null,J=!1;r.modules.register("emailResults",{init:b,events:u,close:q,enable:o,disable:p,enableSubmitButton:m,disableSubmitButton:n})}(jQuery),function(a){function b(b){("undefined"==typeof b.errorLevel||null===b.errorLevel)&&console.error("Message to dev: please provide an errorLevel to the errorHandling.error() function.");var e,f=a.extend({},g,b);switch(f.errorLevel){case"warning":e=!1,c(e,f);break;case"fatal":e=!0,c(e,f);break;default:e=!1}f.fatal=e;var h="";if("undefined"!=typeof d.modules.transactionId&&(h=d.modules.transactionId.get(),null===h&&(h="")),f.transactionId=h,"object"==typeof f.data&&null!==f.data&&(f.data=JSON.stringify(f.data)),e)try{d.modules.writeQuote.write({triggeredsave:"fatalerror",triggeredsavereason:f.description},!1)}catch(i){}d.modules.comms.post({url:"ajax/write/register_fatal_error.jsp",data:f,useDefaultErrorHandling:!1,errorLevel:"silent",onError:function(){}})}function c(b,c){var e;b?(e=[{label:"Refresh page",className:"btn-cta",action:function(){location.reload()},closeWindow:!1}],d.site.isDev===!0&&e.push({label:"Attempt to continue [dev only]",className:"btn-cancel",action:null,closeWindow:!0})):e=[{label:"OK",className:"btn-cta",closeWindow:!0,action:function(){d.messaging.publish(f.OK_CLICKED)}}];var g={title:"Error",htmlContent:c.message,buttons:e};_.isNull(c.id)||a.extend(g,{id:c.id});var h=d.modules.dialogs.show(g);b&&!d.site.isDev&&a("#"+h+" .modal-closebar").remove()}var d=window.meerkat,e=(d.logging.info,{errorHandling:{OK_CLICKED:"OK_CLICKED"}}),f=e.errorHandling,g={errorLevel:"silent",page:"unknown",message:"Sorry, an error has occurred",description:"unknown",data:null,id:null};d.modules.register("errorHandling",{error:b,events:e})}(jQuery),function(){function a(){jQuery(document).ready(function(a){meerkat.modules.performanceProfiling.isFFAffectedByDropdownMenuBug()&&a("html").addClass("ff-no-custom-menu")})}meerkat.modules.register("firefoxMenuFix",{init:a})}(jQuery),function(a){function b(){}function c(a){return e(a).serializeArray()}function d(a){return e(a).serialize()}function e(b){return b.find(":input:visible, input[type=hidden], :input[data-visible=true], :input[data-initValue=true], :input[data-attach=true]").filter(function(){return""!==a(this).val()&&"Please choose..."!==a(this).val()})}function f(a){a.find(":input[data-initValue]").removeAttr("data-initValue"),a.find(":input[data-visible]").removeAttr("data-visible"),a.find(":input:visible").attr("data-visible","true")}function g(b){$elements=b.find(":input").filter(function(){return""!==a(this).val()&&"Please choose..."!==a(this).val()}),$elements.attr("data-initValue","true")}function h(a,b,c){a.append('<input type="hidden" id="'+b+'" name="'+b+'" data-visible="true" value="'+c+'" />')}{var i=window.meerkat,j=(i.modules.events,i.logging.info,i.messaging,{form:{}});j.form}i.modules.register("form",{init:b,events:j,getData:c,getSerializedData:d,appendHiddenField:h,markFieldsAsVisible:f,markInitialFieldsWithValue:g})}(jQuery),function(a){function b(){var b=f.modules.performanceProfiling.isIos(),g=f.modules.performanceProfiling.isIos5(),h=f.modules.performanceProfiling.isAndroid(),i=f.modules.performanceProfiling.isChrome();a(document).ready(function(){var f=!1;Modernizr.inputtypes.date&&(b&&!g||h&&i)&&(f=!0),a("[data-provide=dateinput]").each(function(){var b=a(this);f?(b.attr("data-dateinput-type","native"),b.find(".dateinput-tripleField").addClass("hidden"),b.find(".dateinput-nativePicker").removeClass("hidden").find("input").on("change",e)):b.find("input.dateinput-day, input.dateinput-month, input.dateinput-year").on("input",d).on("change",e);var g=b.find(".serialise");c(b,g.val()),g.on("change",function(){c(b,this.value)})})})}function c(b,c){var d=c.split("/"),e="";if(1!=b.attr("data-locked")){b.attr("data-locked",1),0===c.length||3!==d.length?d=["","",""]:(1===d[0].length&&(d[0]="0"+d[0]),1===d[1].length&&(d[1]="0"+d[1]),4===d[2].length&&2===d[1].length&&2===d[0].length&&(e=d[2]+"-"+d[1]+"-"+d[0])),b.find("input.dateinput-day").val(d[0]),b.find("input.dateinput-month").val(d[1]),b.find("input.dateinput-year").val(d[2]),b.find(".dateinput-nativePicker input").val(e),(f.modules.performanceProfiling.isIE8()||f.modules.performanceProfiling.isIE9())&&(f.modules.placeholder.invalidatePlaceholder(b.find("input.dateinput-day")),f.modules.placeholder.invalidatePlaceholder(b.find("input.dateinput-month")),f.modules.placeholder.invalidatePlaceholder(b.find("input.dateinput-year"))),b.removeAttr("data-locked");var g=a.Event("populated.meerkat.formDateInput");b.trigger(g)}}function d(){var b=a(this);if(b.attr("maxlength")&&!b.hasClass("year")&&b.val().length==b.attr("maxlength")){var c=b.hasClass("dateinput-day")?"input.dateinput-month":"input.dateinput-year";b.closest('[data-provide="dateinput"]').find(c).focus().select()}}function e(){var b=a(this).parents('[data-provide="dateinput"]'),c=b.find(".serialise"),d="",e="",f="";if(1!=b.attr("data-locked")){if(b.attr("data-locked",1),"native"==b.attr("data-dateinput-type")){var g=this.value.length>0?this.value.split("-"):["","",""];f=g[0],e=g[1],d=g[2]}else d=b.find("input.dateinput-day").val(),e=b.find("input.dateinput-month").val(),f=b.find("input.dateinput-year").val();if(1===d.length&&(d="0"+d),1===e.length&&(e="0"+e),d.length>0&&Number(d)>0&&e.length>0&&Number(e)>0&&f.length>0&&Number(f)>0){c.val(d+"/"+e+"/"+f),c.valid();var h=a.Event("serialised.meerkat.formDateInput");c.trigger(h,c.val())}else c.val("");c.change(),b.removeAttr("data-locked")}}{var f=window.meerkat;f.logging.info}f.modules.register("formDateInput",{init:b,populate:c,serialise:e})}(jQuery),function(a){function b(){Modernizr.input.placeholder&&c()}function c(){var b=a("input[data-placeholder-unfocused]");b.each(function(){var b=a(this),c="";b.attr("placeholder")&&(c=b.attr("placeholder")),b.attr("data-placeholder",c),b.attr("placeholder",b.attr("data-placeholder-unfocused")),b.on("focus.formPlaceholders.unfocused",function(){a(this).attr("placeholder",a(this).attr("data-placeholder"))}),b.on("blur.formPlaceholders.unfocused",function(){a(this).val().length>0||a(this).attr("placeholder",a(this).attr("data-placeholder-unfocused"))})})}var d=window.meerkat;d.modules.register("formPlaceholders",{init:b})}(jQuery),function(){function a(){jQuery(document).ready(function(a){a(".help-icon").prop("tabindex",-1)})}var b=window.meerkat,c=(b.modules.events,b.logging.info,b.messaging,{});b.modules.register("helpIcons",{init:a,events:c})}(jQuery),function(a){function b(b){function e(a,b){a>=N.steps.length&&b(null);var d=N.steps[a];if(d.navigationId===N.startStepId)b(d,!0);else try{c(d,m),null!=d.onAfterEnter&&d.onAfterEnter(m),I=d,n(),r(d,function(){null!=I.onBeforeLeave&&I.onBeforeLeave(m),null!=I.onAfterLeave&&I.onAfterLeave(m),_.defer(function(){e(a+1,b)})})}catch(f){E.logging.info("[journeyEngine]",f),b(d,!1)}}if(null===b)return i(),!1;a.extend(N,b),a(N.slideContainer+" ."+N.slideClassName).removeClass("active").addClass("hiddenSlide");for(var f=0;f<N.steps.length;f++)N.steps[f]=a.extend({},O,N.steps[f]);if(null===N.startStepId&&""===E.modules.address.getWindowHash())N.startStepId=N.steps[0].navigationId,E.modules.address.setStartHash(N.startStepId),d({navigationId:N.startStepId});else{if(null===N.startStepId){var j=E.modules.address.getWindowHashAt(0),k=l(j);N.startStepId=null===k?N.steps[0].navigationId:j}var m={};m.direction=L,m.isForward=!0,m.isBackward=!1,m.isStartMode=!0;var o=N.steps[0];e(0,function(a,b){null==a&&(a=o),N.startStepId=a.navigationId,b?(I=null,K=null):(h(I,!1,null),g(m,null,!1)),""!==E.modules.address.getWindowHash()&&E.modules.address.getWindowHash()!==N.startStepId?E.modules.address.setHash(N.startStepId):(E.modules.address.setStartHash(N.startStepId),d({navigationId:N.startStepId}))})}E.messaging.publish(H.READY,this)}function c(a,b){a.initialised===!1&&null!=a.onInitialise&&a.onInitialise(b),a.initialised=!0,D(a),null!=a.onBeforeEnter&&a.onBeforeEnter(b)}function d(b){try{b.isStartMode=!1,""===b.navigationId&&(b.navigationId=N.startStepId);var c=l(b.navigationId);if(null===c&&(c=l(0)),c.stepIndex=j(c.navigationId),null===I)b.direction=L,b.isForward=!0,b.isBackward=!1,e(c,b);else{if(b.previousNavigationId=I.navigationId,b.navigationId==I.navigationId)return!1;if(j(c.navigationId)<j(I.navigationId))b.direction=M,b.isForward=!1,b.isBackward=!0,e(c,b);else{if(j(c.navigationId)!=j(I.navigationId)+1)throw"Moving forward too many steps. "+I.navigationId+" to "+b.navigationId;b.direction=L,b.isForward=!0,b.isBackward=!1,"1"==a(N.slideContainer).attr("data-prevalidation-completed")?(a(N.slideContainer).removeAttr("data-prevalidation-completed"),e(c,b)):r(I,function(){e(c,b)})}}}catch(d){return u(),E.modules.address.setHash(I.navigationId),E.logging.info("[journeyEngine]",d),!1}return!0}function e(a,b){null!==I&&null!=I.onBeforeLeave&&I.onBeforeLeave(b),c(a,b),f(a,b)}function f(b,c){function d(){null!=I&&null!=I.onAfterLeave&&I.onAfterLeave(c)}var e=I;null===I||b.slideIndex==I.slideIndex?(d(),null===I&&h(b,!1),I=b,n(),g(c,e,!0)):($slide=a(N.slideContainer+" ."+N.slideClassName+":eq("+I.slideIndex+")"),$slide.fadeOut(250,function(){$slide.removeClass("active").addClass("hiddenSlide"),d(),I=b,n(),h(b,!0,function(){g(c,e,!0)})}))}function g(b,c,d){a("body").attr("data-step",I.navigationId);var e=E.site.title;null!=I.title&&(e=I.title+" - "+e),window.document.title=e,I.slideScrollTo&&null!==I.slideScrollTo&&E.modules.utilities.scrollPageTo(I.slideScrollTo),d===!0&&null!=I.onAfterEnter&&I.onAfterEnter(b),u();var f=H.STEP_INIT;null!==c&&(f=H.STEP_CHANGED),f===H.STEP_INIT&&i(),b.step=I,b.navigationId=I.navigationId,E.messaging.publish(f,b),null!=I.tracking&&E.messaging.publish(F.tracking.TOUCH,I.tracking),null!=I.externalTracking&&E.messaging.publish(F.tracking.EXTERNAL,I.externalTracking)}function h(b,c,d){$slide=a(N.slideContainer+" ."+N.slideClassName+":eq("+b.slideIndex+")"),c===!0?$slide.fadeIn(250,function(){$slide.removeClass("hiddenSlide").addClass("active"),null!=d&&d()}):($slide.removeClass("hiddenSlide").addClass("active"),null!=d&&d())}function i(){a(document.body).removeClass("jeinit")}function j(a){for(var b=0;b<N.steps.length;b++){var c=N.steps[b];if(c.navigationId==a)return b}}function k(){return N.steps.length}function l(a){var b=j(a);return null==b?null:N.steps[b]}function m(){var a=0;return null!==I&&(a=I.navigationId),j(a)}function n(){(_.isNull(K)||j(K.navigationId)<j(I.navigationId))&&(K=I)}function o(){return j(K.navigationId)}function p(){return I}function q(){var a=0,b=m();return b>0&&(a=--b),N.steps[a].navigationId}function r(b,c){var d=!1;if(null!=b.validation){if(b.validation.validate===!0){var e=!1;a("."+N.slideClassName+":eq("+b.slideIndex+"):visible").length>0&&(e=!0);var f=a("."+N.slideClassName+":eq("+b.slideIndex+")");f.removeClass("hiddenSlide").addClass("active"),E.modules.form.markFieldsAsVisible(f);var g=!0;if(f.find("form").each(function(b,c){$element=a(c);var d=$element.valid();d===!1&&(g=!1)}),e===!1&&f.removeClass("active").addClass("hiddenSlide"),g===!1)throw"Validation failed on "+b.navigationId}null!=b.validation.customValidation&&(d=!0,b.validation.customValidation(function(a){if(!a)throw"Custom validation failed on "+b.navigationId;c(!0)}))}return d===!1&&c(!0),!0}function s(){return a(N.slideContainer+" ."+N.slideClassName+":eq("+I.slideIndex+") form").valid()}function t(){a(N.slideContainer).attr("data-locked","1")}function u(){a(N.slideContainer).removeAttr("data-locked")}function v(){return"1"==a(N.slideContainer).attr("data-locked")}function w(b){var c=a(b.currentTarget);return c.is(".disabled, :disabled")?!1:(b.preventDefault(),b.stopPropagation(),void x(c.attr("data-slide-control"),c))}function x(b,c){"undefined"!=typeof c&&c.hasClass("show-loading")&&E.modules.loadingAnimation.showAfter(c);try{if(v())throw"Journey engine action in progress (isLocked)";t();var d=b;if(I.navigationId!==d){var e;if("next"==d||"previous"==d){var f=j(I.navigationId),g=null;if("next"==d){if(e="forward",g=f+1,g>=N.steps.length)throw"No next steps"}else if(e="backward",g=f-1,0>g)throw"No previous steps";d=N.steps[g].navigationId}j(d)==j(I.navigationId)+1&&"forward"==e?r(I,function(){a(N.slideContainer).attr("data-prevalidation-completed","1"),E.modules.address.setHash(d),"undefined"!=typeof c&&E.modules.loadingAnimation.hide(c)}):(E.modules.address.setHash(d),"undefined"!=typeof c&&E.modules.loadingAnimation.hide(c))}}catch(h){u(),E.logging.info("[journeyEngineListener]",h),"undefined"!=typeof c&&E.modules.loadingAnimation.hide(c)}}function y(){E.messaging.subscribe(F.ADDRESS_CHANGE,function(a){return J===!0?void E.modules.address.setHash(I.navigationId):void d({navigationId:a.hashArray[0]})},window),a(document.body).on("click","a[data-slide-control]",w),E.messaging.subscribe(F.WEBAPP_LOCK,function(){J=!0,a("a[data-slide-control]").each(function(){a(this).addClass("disabled").addClass("inactive")
})}),E.messaging.subscribe(F.WEBAPP_UNLOCK,function(){J=!1,a("a[data-slide-control]").each(function(){a(this).removeClass("disabled").removeClass("inactive")})}),a(document).on("keydown",function(a){a.ctrlKey&&39==a.keyCode&&x("next"),a.ctrlKey&&37==a.keyCode&&x("previous")}),a("#journeyEngineLoading .loading-logo").after(E.modules.loadingAnimation.getTemplate())}function z(){return E.modules.form.getData(a("#mainform"))}function A(){return E.modules.form.getSerializedData(a("#mainform"))}function B(b,c){b=b||"Please wait...",c=c||!1;var d=a("#journeyEngineLoading");"1"!==d.attr("data-active")&&(d.attr("data-active","1"),d.find(".message").attr("data-oldtext",d.find(".message").text()).text(b),d.addClass("displayBlock"),c?d.addClass("opacity1"):_.defer(function(){d.addClass("opacity1")}))}function C(){var b=a("#journeyEngineLoading");b.attr("data-active","0"),b.removeClass("opacity1");var c=b.transitionDuration();_.delay(function(){b.removeClass("displayBlock"),b.find(".message").text(b.find(".message").attr("data-oldtext"))},c)}function D(b){var c="car"==E.site.vertical?"quote":E.site.vertical;a("#"+c+"_journey_stage").val(b.navigationId)}var E=window.meerkat,F=E.modules.events,G=(E.logging.info,{journeyEngine:{STEP_CHANGED:"STEP_CHANGED",STEP_INIT:"STEP_INIT",READY:"JOURNEY_READY"}}),H=G.journeyEngine,I=null,J=!1,K=null,L="DIRECTION_FORWARD",M="DIRECTION_BACKWARD",N={startStepId:null,steps:[],progressBarSteps:[],slideContainer:"#journeyEngineContainer",slideClassName:"journeyEngineSlide",transition:null},O={title:null,navigationId:null,slideId:null,initialised:!1,onInitialise:null,onBeforeEnter:null,onAfterEnter:null,onBeforeLeave:null,onAfterLeave:null,validation:{validate:!0,customValidation:null},slideScrollTo:"html, body",tracking:null,externalTracking:null};E.modules.register("journeyEngine",{init:y,events:G,configure:b,getStepIndex:j,getCurrentStepIndex:m,getFurtherestStepIndex:o,getStepsTotalNum:k,isCurrentStepValid:s,getFormData:z,getSerializedFormData:A,getCurrentStep:p,loadingShow:B,loadingHide:C,gotoPath:x,getPreviousStepId:q})}(jQuery),function(a){function b(){a(document).ready(function(){n=a(".journeyProgressBar")}),j.messaging.subscribe(k.journeyEngine.STEP_INIT,function(b){p=b.navigationId,a(document).ready(function(){d(!0)})}),j.messaging.subscribe(k.journeyEngine.STEP_CHANGED,function(a){p=a.navigationId,d(!1)})}function c(b){o=b;var c=99/o.length;a("head").append("<style>.journeyProgressBar>li{ width: "+c+"% }</style>")}function d(a){var b="",c="",d="",e=_.isArray(o)?o.length-1:0,f=null,g=null,h=!1,i=!1;r?n.removeClass("invisible"):n.addClass("invisible"),_.each(o,function(a,j){f="",g="",i=p===a.navigationId||-1!=_.indexOf(a.matchAdditionalSteps,p),i?(f=' class="current"',h=!0):h?g=' tabindex="-1"':f=' class="complete"',q||i||h?c=d="div":(c='a href="javascript:;"'+g+' data-slide-control="'+a.navigationId+'"',d="a"),b+="<li"+f+"><"+c+">"+a.label+"</"+d+"></li>",j==e&&(f="","complete"==p&&(f=" complete"),b+='<li class="end'+f+'"><div></div></li>')}),n.html(b),a&&j.messaging.publish(m.INIT)}function e(){p="complete",n.addClass("complete"),d()}function f(){q=!1,d()}function g(){q=!0,d()}function h(){r=!0,d()}function i(){r=!1,d()}var j=window.meerkat,k=j.modules.events,l={journeyProgressBar:{INIT:"PROGRESS_BAR_INITED"}},m=l.journeyProgressBar,n=null,o=null,p=null,q=!1,r=!0;j.modules.register("journeyProgressBar",{init:b,render:d,events:l,configure:c,disable:g,enable:f,show:h,hide:i,setComplete:e})}(jQuery),function(a){function b(a){f()!==!1&&a!==i&&(g.html(c(g.html(),a)),j=i,i=a)}function c(a,b){if(f()!==!1){var c=new RegExp(i,"g");return a.replace(c,b)}}function d(){if(f()!==!1){var a=0;try{"undefined"!=typeof h?a=h.modules.transactionId.get():"undefined"!=typeof Track&&Track._getTransactionId&&(a=Track._getTransactionId())}catch(b){}k_button.setCustomVariable(7891,a)}}function e(){a(document).ready(function(){g=a("#kampyle"),f()!==!1&&(g.prependTo(a("#footer .container")),g.attr("data-kampyle-formid")&&(i=g.attr("data-kampyle-formid")),g.on("click","#kampylink",function(a){d(),"undefined"!=typeof k_button&&(a.preventDefault(),k_button.open_ff("site_code=7343362&lang=en&form_id="+i)),h.modules.writeQuote.write({triggeredsave:"kampyle"})}))})}function f(){return 0===g.length?!1:!0}var g,h=window.meerkat,i=(h.modules.events,h.logging.info,""),j="";h.modules.register("kampyle",{init:e,setFormId:b})}(jQuery),function(){function a(){var a=c.modules.performanceProfiling.isIE8()||c.modules.performanceProfiling.isIE9()||c.modules.performanceProfiling.isIE10();c.site.leavePageWarning.enabled&&c.site.isCallCentreUser===!1&&a===!1&&(window.onbeforeunload=function(){return f===!1&&c.modules.saveQuote.isAvailable()===!0?c.site.leavePageWarning.message:void 0},c.messaging.subscribe(d.journeyEngine.STEP_CHANGED,function(){f=!1}),c.messaging.subscribe(d.saveQuote.QUOTE_SAVED,function(){f=!0}))}function b(){f=!0}var c=window.meerkat,d=c.modules.events,e=(c.logging.info,{leavePageWarning:{}}),f=(e.leavePageWarning,!0);c.modules.register("leavePageWarning",{init:a,events:e,disable:b})}(jQuery),function(a){function b(a){var b,c;return"undefined"==typeof a?(b=e.modules.journeyEngine.getCurrentStep(),c=b.navigationId):c=a,"ctm"==h.brand?[h.brand,"quote-form",h.vertical,c].join(":"):["ctm:whiteLabel",h.brand,"quote-form",h.vertical,c].join(":")}function c(a,c,d){if(e.site.liveChat.enabled!==!1){lpMTagConfig.vars.push(["page","ConversionStage",a]);var f=!1;f=e.modules.transactionId.get(),lpMTagConfig.vars.push(["visitor","transactionID",f]),h.hasOwnProperty("unit")&&(lpMTagConfig.vars.push(["page","unit",h.unit]),lpMTagConfig.vars.push(["unit",h.unit])),c?(lpMTagConfig.vars.push(["page","PageName",b(d)]),lpMTagConfig.vars.push(["page","OrderNumber",f]),lpMTagConfig.loadTag()):lpMTagConfig.vars.push(["page","PageName",b()]),lpSendData()}}function d(){a(document).ready(function(a){function b(a){if(!window.lpMTagConfig.lpTagLoaded){("undefined"==typeof a||"object"==typeof a)&&(a=window.lpMTagConfig.lpMTagSrc?window.lpMTagConfig.lpMTagSrc:window.lpMTagConfig.lpTagSrv?window.lpMTagConfig.lpProtocol+"://"+window.lpMTagConfig.lpTagSrv+"/hcp/html/mTag.js":"/hcp/html/mTag.js"),0!==a.indexOf("http")?a=window.lpMTagConfig.lpProtocol+"://"+window.lpMTagConfig.lpServer+a+"?site="+window.lpMTagConfig.lpNumber:a.indexOf("site=")<0&&(a+=a.indexOf("?")<0?"?":"&",a=a+"site="+window.lpMTagConfig.lpNumber);var b=document.createElement("script");b.setAttribute("type","text/javascript"),b.setAttribute("charset","iso-8859-1"),b.setAttribute("src",a),document.getElementsByTagName("head").item(0).appendChild(b)}}function d(a,b,c){if(arguments.length>0&&(window.lpMTagConfig.vars=window.lpMTagConfig.vars||[],window.lpMTagConfig.vars.push([a,b,c])),"undefined"!=typeof lpMTag&&"undefined"!=typeof window.lpMTagConfig.pluginCode&&"undefined"!=typeof window.lpMTagConfig.pluginCode.simpleDeploy){var d=window.lpMTagConfig.pluginCode.simpleDeploy.processVars();lpMTag.lpSendData(d,!0)}}function j(){var b="",c=a("#"+h.button);c.length&&(b=c.html()),""===b||"<span></span>"==b||"<SPAN></SPAN>"==b?a('[data-livechat="target"]').attr("data-livechat-state",!1):a('[data-livechat="target"]').attr("data-livechat-state",!0)}if(i=a("html").hasClass("lt-ie9"),"undefined"!=typeof e.site&&"undefined"!=typeof e.site.liveChat&&e.site.liveChat.enabled!==!1&&!e.site.isCallCentreUser){window.lpMTagConfig=a.extend(lpMTagConfig,e.site.liveChat.config),h=a.extend({},e.site.liveChat.instance),window.lpMTagConfig=window.lpMTagConfig||{},window.lpMTagConfig.vars=window.lpMTagConfig.vars||[],window.lpMTagConfig.dynButton=window.lpMTagConfig.dynButton||[],window.lpMTagConfig.lpProtocol=0===document.location.toString().indexOf("https:")?"https":"http",window.lpMTagConfig.pageStartTime=(new Date).getTime(),window.lpMTagConfig.pluginsLoaded||(window.lpMTagConfig.pluginsLoaded=!1),window.lpMTagConfig.loadTag=function(){for(var a=document.cookie.split(";"),c={},d=0;d<a.length;d++){var e=a[d].substring(0,a[d].indexOf("="));c[e.replace(/^\s+|\s+$/g,"")]=a[d].substring(a[d].indexOf("=")+1)}for(var a=c.HumanClickRedirectOrgSite,c=c.HumanClickRedirectDestSite,d=["lpTagSrv","lpServer","lpNumber","deploymentID"],e=!0,f=0;f<d.length;f++)window.lpMTagConfig[d[f]]||(e=!1,"undefined"!=typeof console&&console.log&&console.log("LivePerson : lpMTagConfig."+d[f]+" is required and has not been defined before lpMTagConfig.loadTag()."));!window.lpMTagConfig.pluginsLoaded&&e&&(window.lpMTagConfig.pageLoadTime=(new Date).getTime()-window.lpMTagConfig.pageStartTime,a="?site="+(a==window.lpMTagConfig.lpNumber?c:window.lpMTagConfig.lpNumber)+"&d_id="+window.lpMTagConfig.deploymentID+"&default=simpleDeploy",b(null!=window.lpMTagConfig.deploymentConfigPath?window.lpMTagConfig.lpProtocol+"://"+window.lpMTagConfig.deploymentConfigPath+a:window.lpMTagConfig.lpProtocol+"://"+window.lpMTagConfig.lpTagSrv+"/visitor/addons/deploy2.asp"+a),window.lpMTagConfig.pluginsLoaded=!0)},window.attachEvent?window.attachEvent("onload",function(){window.lpMTagConfig.disableOnLoad||window.lpMTagConfig.loadTag()}):window.addEventListener("load",function(){window.lpMTagConfig.disableOnLoad||window.lpMTagConfig.loadTag()},!1),window.lpAddMonitorTag=b,window.lpSendData=d;var k=a('div[data-livechat="target"]');if(k.length&&"undefined"!=typeof h.button){var l='<div id="'+h.button+'" data-livechat="button"></div>';k.append(l),a("#"+h.button).on("click","a",function(){lpMTagConfig.dynButton0.actionHook()})}if(i?k.on("propertychange",_.debounce(j,100)):a(document).on("DOMSubtreeModified",'[data-livechat="target"]',_.debounce(j,100)),e.messaging.subscribe(f.journeyEngine.STEP_INIT,function(a){var b=(a.step.slideIndex+1,a.step.stepIndex+1),d=a.navigationId;c(b),e.messaging.subscribe(f.journeyEngine.STEP_CHANGED,function(a){var b=(a.step.slideIndex+1,a.step.stepIndex+1);d=a.navigationId,c(b)})}),j(),k=a('[data-livechat="target"]'),k.length){var m=k.data("livechat-fire");"object"==typeof m&&(g("manual fire",lpMTagConfig.vars),c(m.step,m.confirmation,m.navigationId))}}})}var e=window.meerkat,f=e.modules.events,g=(e.logging.info,e.logging.debug);window.lpMTagConfig=window.lpMTagConfig||{},window.lpMTagConfig.vars=window.lpMTagConfig.vars||[],window.lpSettings=window.lpSettings||{};var h,i;e.modules.register("liveChat",{init:d,fire:c})}(jQuery),function(a){function b(b){return b.each(function(){var b=a(this),c=b.attr("data-loadinganimation");"after"===c?b.next(".spinner").hide():b.find(".spinner").hide()}),b.find(".spinner")}function c(b){return b.each(function(){var b=a(this),c=b.next(".spinner");c.length>0?c.show():(b.attr("data-loadinganimation","after"),b.after(e()))}),b.find(".spinner")}function d(b,c){return b.each(function(){var b=a(this),d=b.find(".spinner");d.length>0?d.show():(b.attr("data-loadinganimation","inside"),c===!0?b.append(e()):b.prepend(e()))}),b.find(".spinner")}function e(){return'<div class="spinner"><div class="bounce1"></div><div class="bounce2"></div><div class="bounce3"></div></div>'}{var f=window.meerkat;f.logging.info}f.modules.register("loadingAnimation",{hide:b,showAfter:c,showInside:d,getTemplate:e})}(jQuery),function(a){function b(b){return F=a.extend({},E,b),"confirmation"===y.site.pageAction?!1:void jQuery(document).ready(function(){"undefined"!=typeof F.template&&(v=_.template(F.template),c(),d())})}function c(){"undefined"!=typeof Results.settings&&(a(Results.settings.elements.page).on("click",".btn-more-info",e),a(Results.settings.elements.page).on("click",".btn-close-more-info",h)),a(document).on("resultsFetchStart",function(){h()}),a(document.body).on("click",".btn-more-info-apply",function(){var b=a(this);b.addClass("inactive").addClass("disabled"),y.modules.loadingAnimation.showInside(b,!0),"function"==typeof F.onBeforeApply&&F.onBeforeApply(),Results.setSelectedProduct(b.attr("data-productId"));var c=Results.getSelectedProduct();return c?"function"==typeof F.onClickApplyNow?F.onClickApplyNow(c,q):void 0:(q(!1),!1)}),a(document.body).on("click",".dialogPop",function(){y.modules.dialogs.show({title:a(this).attr("title"),htmlContent:a(this).attr("data-content")})}),a(document.body).on("click",".more-info",function(){m(y.modules.carResults.getSelectedProduct()),openModal()})}function d(){a(document).on("resultPageChange",function(){D&&h()})}function e(){var b=a(this);if("undefined"!=typeof b.attr("data-productId")&&("undefined"==typeof b.attr("data-available")||"Y"===b.attr("data-available"))){"function"==typeof F.onBeforeShowBridgingPage&&F.onBeforeShowBridgingPage();var c=b.attr("data-productId"),d=b.hasClass("more-info-showapply");m(Results.getResult("productId",c),d),F.runDisplayMethod(c)}}function f(b){b.html(y.modules.loadingAnimation.getTemplate()).show(),o(function(){var c=v(u);b.find(".spinner").fadeOut(),b.html(c),"function"==typeof F.onBeforeShowTemplate&&F.onBeforeShowTemplate(x);var d=400,e=250,f=0;D?(b.find(".more-info-content")[F.showAction](d,function(){"function"==typeof F.onAfterShowTemplate&&F.onAfterShowTemplate()}),f=d):(y.modules.utilities.scrollPageTo(".resultsHeadersBg",e,-a("#navbar-main").height(),function(){"function"==typeof updatePosition&&(updatePosition(),b.css({top:topPosition})),b.find(".more-info-content")[F.showAction](d,k),"function"==typeof F.onAfterShowTemplate&&F.onAfterShowTemplate()}),f=d+e),D=!0,_.delay(function(){y.messaging.publish(B.bridgingPage.SHOW,{isOpen:D})},f),y.messaging.publish(z.tracking.EXTERNAL,{method:"trackProductView",object:{productID:u.productId,vertical:y.site.vertical}}),y.messaging.publish(z.tracking.TOUCH,{touchType:"H",touchComment:"MoreInfo"})})}function g(){o(function(){var b={htmlContent:v(u),hashId:"moreinfo",closeOnHashChange:!0};"function"==typeof F.onBeforeShowModal&&(b.onOpen=function(){F.onBeforeShowModal(x)}),"object"==typeof F.modalOptions&&(b=a.extend(b,F.modalOptions)),w=y.modules.dialogs.show(b),C=!0,a(".bridgingContainer, .more-info-content").show(),"function"==typeof F.onAfterShowModal&&F.onAfterShowModal(),_.delay(function(){y.messaging.publish(B.bridgingPage.SHOW,{isOpen:C})},0),y.messaging.publish(z.tracking.EXTERNAL,{method:"trackProductView",object:{productID:u.productId,vertical:y.site.vertical}}),y.messaging.publish(z.tracking.TOUCH,{touchType:"H",touchComment:"MoreInfo"})})}function h(){C&&j(),D&&i(F.container),y.modules.address.removeFromHash("moreinfo")}function i(a){"function"==typeof F.onBeforeHideTemplate&&F.onBeforeHideTemplate(),a[F.hideAction](400,function(){l(a),"function"==typeof F.onAfterHideTemplate&&F.onAfterHideTemplate()})}function j(){a("#"+w).modal("hide"),a(".bridgingContainer, .more-info-content").hide(),C=!1}function k(){y.messaging.publish(B.bridgingPage.CHANGE,{isOpen:!0})}function l(a){a.empty().hide(),D=!1,y.messaging.publish(B.bridgingPage.CHANGE,{isOpen:D}),y.messaging.publish(B.bridgingPage.HIDE,{isOpen:D})}function m(a,b){return u=a,u!==!1&&(u.showApply=b===!0?!0:!1),u}function n(){return D===!1&&C===!1?null:u}function o(a){"function"==typeof F.prepareCover&&F.prepareCover(),p(a)}function p(b){a.when(F.retrieveExternalCopy(u)).then(b,b)}function q(b){_.delay(function(){a(".btn-more-info-apply").removeClass("inactive").removeClass("disabled"),y.modules.loadingAnimation.hide(a(".btn-more-info-apply"))},1e3),b===!0&&"function"==F.onApplySuccess&&F.onApplySuccess()}function r(){return D}function s(){return C}function t(a){x=a}var u,v,w,x,y=window.meerkat,z=y.modules.events,A=(y.logging.info,{moreInfo:{bridgingPage:{CHANGE:"BRIDGINGPAGE_CHANGE",SHOW:"BRIDGINGPAGE_SHOW",HIDE:"BRIDGINGPAGE_HIDE"}}}),B=A.moreInfo,C=!1,D=!1,E={container:a(".bridgingContainer"),template:a("#more-info-template").html(),hideAction:"slideUp",showAction:"slideDown",modalOptions:!1,runDisplayMethod:null,onBeforeShowBridgingPage:null,onBeforeShowTemplate:null,onBeforeShowModal:null,onAfterShowTemplate:null,onAfterShowModal:null,onBeforeHideTemplate:null,onAfterHideTemplate:null,onBeforeApply:null,onClickApplyNow:null,onApplySuccess:null,retrieveExternalCopy:null},F={};y.modules.register("moreInfo",{initMoreInfo:b,events:A,open:e,close:h,showTemplate:f,hideTemplate:i,showModal:g,hideModal:j,isBridgingPageOpen:r,isModalOpen:s,getOpenProduct:n,setProduct:m,setDataResult:t,applyCallback:q})}(jQuery),function(a){function b(){l.addClass("disabled")}function c(){l.removeClass("disabled")}function d(){l.hasClass("collapsed")===!0&&(m.addClass("in"),n.addClass("active"),l.removeClass("collapsed"),a('<div class="navMenu-backdrop-underlay" />').prependTo(o).on("click",e))}function e(){l.hasClass("collapsed")===!1&&(m.removeClass("in"),n.removeClass("active"),l.addClass("collapsed"),a(".navMenu-backdrop-underlay").remove())}function f(){g()?c():b()}function g(){var b=-1;return a(".navMenu-contents").find(".navbar-nav").find("li").each(function(){"block"==a(this).css("display")&&b++,b>0}),b>0}function h(){k("[navMenu] Initialised"),a(document).ready(function(){l=a("[data-toggle=navMenu]"),m=a(".navMenu-contents"),n=a(".navMenu-row"),o=a(".navMenu-row .navMenu-row-fixed"),"offcanvas"===i.site.navMenu.type&&(n.addClass("navMenu-offcanvas"),n.addClass("left"===i.site.navMenu.direction?"navMenu-left":"navMenu-right")),debug("[navMenu] Configured as: "+i.site.navMenu.type+" "+i.site.navMenu.direction),l.on("click",function(){l.hasClass("disabled")===!1&&(l.hasClass("collapsed")===!0?d():e())}),f()}),i.messaging.subscribe(j.journeyEngine.STEP_CHANGED,function(){i.modules.navMenu.close(),f()}),i.messaging.subscribe(j.device.STATE_LEAVE_XS,function(){i.modules.navMenu.close()}),i.messaging.subscribe(j.device.STATE_ENTER_XS,function(){a(".navbar-nav .open").length>0&&i.modules.navMenu.open(),f()}),i.messaging.subscribe(j.journeyEngine.STEP_INIT,function(){f()}),i.messaging.publish(q.READY,this)}var i=window.meerkat,j=i.modules.events,k=i.logging.info;debug=i.logging.debug;var l,m,n,o,p={navMenu:{READY:"NAVMENU_READY"}},q=p.navMenu;i.modules.register("navMenu",{init:h,events:p,close:e,open:d,enable:c,disable:b,toggleNavMenu:f})}(jQuery),function(a){function b(){}function c(a){var b={save_email:a.data.value,vertical:d.site.vertical},c={url:"ajax/json/get_user_exists.jsp",data:b,dataType:"json",cache:!1,errorLevel:"silent",onSuccess:function(b){"function"==typeof a.onSuccess&&a.onSuccess(b)},onError:function(){"function"==typeof a.onError&&a.onError()},onComplete:function(){"function"==typeof a.onComplete&&a.onComplete()}};return a.hasOwnProperty("returnAjaxObject")&&(c.returnAjaxObject=a.returnAjaxObject),d.modules.comms.post(c)}{var d=window.meerkat,e=(d.modules.events,d.logging.info,d.messaging,{optIn:{}});e.optIn}d.modules.register("optIn",{init:b,events:e,fetch:c})}(jQuery),function(a){function b(b){var c=b.product,d=c.handoverType&&"post"===c.handoverType.toLowerCase()?"POST":"GET",e=b.brand?b.brand:c.provider,f=b.msg?b.msg:"",h=null;try{return h="transferring.jsp?transactionId="+g.modules.transactionId.get()+"&trackCode="+c.trackCode+"&brand="+e+"&msg="+f+"&url=",h+="Y"===c.encodeUrl?encodeURIComponent(c.quoteUrl):c.quoteUrl,"post"===d.toLowerCase()&&(h+="&handoverType="+c.handoverType+"&handoverData="+encodeURIComponent(c.handoverData)+"&handoverURL="+encodeURIComponent(c.handoverUrl)+"&handoverVar="+c.handoverVar),a.isEmptyObject(b.extraParams)||a.each(b.extraParams,function(a,b){h+="&"+a+"="+escape(b)}),h}catch(i){return g.modules.errorHandling.error({errorLevel:"warning",message:b.errorMessage,page:"partnerTransfer.js:buildURL",description:b.errorDescription,data:c}),null}}function c(c){var e=a.extend({},i,c),f=e.product,h=b(e);if(null!=h){if(e.closeBridgingModalDialog===!0&&(g.modules.moreInfo.isBridgingPageOpen()||g.modules.moreInfo.isModalOpen())&&g.modules.moreInfo.close(),a("html").hasClass("ie")){var j="location=1,menubar=1,resizable=1,scrollbars=1,status=1,titlebar=1,toolbar=1,top=0,left=0,height="+screen.availHeight+",width="+screen.availWidth;window.open(h,"_blank",j)}else window.open(h,"_blank");a("#transferring-popup").length>0&&a("#transferring-popup").delay(4e3).queue(function(a){a()}),e.trackHandover===!0&&d(f)}"function"==typeof e.applyNowCallback&&e.applyNowCallback(!0)}function d(a){var b=g.modules.transactionId.get(),c="undefined"!=typeof a.leadNo?a.leadNo:b;g.messaging.publish(h.tracking.TOUCH,{touchType:"A",touchComment:"Apply Online"}),g.messaging.publish(h.tracking.EXTERNAL,{method:"trackHandover",object:{quoteReferenceNumber:c,transactionID:b,productID:a.productId,brandCode:a.brandCode}}),g.messaging.publish(h.tracking.EXTERNAL,{method:"trackHandoverType",object:{type:"ONLINE",quoteReferenceNumber:c,transactionID:b,productID:a.productId,brandCode:a.brandCode,vertical:g.site.vertical}})}function e(){a(document.body).on("click",".btn-apply",function(b){b.preventDefault();var d=Results.getResultByProductId(a(this).attr("data-productid")),e={product:d};c(e)})}function f(){a(document).ready(function(){e()})}var g=window.meerkat,h=g.modules.events,i=(g.logging.info,{product:null,trackHandover:!0,applyNowCallback:null,errorMessage:"An error occurred. Sorry about that!",errorDescription:"There is an issue with the handover url.",closeBridgingModalDialog:!0});g.modules.register("partnerTransfer",{initTransfer:f,transferToPartner:c,trackHandover:d,buildURL:b})}(jQuery),function(a){function b(){return"1"===w.val()}function c(){return w.val("")}function d(a){f(),w.val("1").valid(),E.paymentEngine.success(a),l(),h()}function e(a){k(),i(),a&&a.length>0&&(f(),E.paymentEngine.fail(a),x.modules.errorHandling.error({message:a,page:"paymentGateway.js",description:"meerkat.modules.paymentGateway.fail()",errorLevel:"silent",data:E}))}function f(){A=!0,x.modules.dialogs.close(modalId)}function g(){var a="cc";return"function"==typeof E.getSelectedPaymentMethod&&(a=E.getSelectedPaymentMethod()),D!==a&&c(),D="cc"==a&&E.handledType.credit||"ba"==a&&E.handledType.bank?a:"",m(),""!==D}function h(){u.slideDown(),v.slideUp()}function i(){u.slideUp(),v.slideDown()}function j(){u.slideUp(),v.slideUp()}function k(){t.slideDown()}function l(){t.slideUp()}function m(){b()?(l(),h()):(c(),k(),j()),n()}function n(){switch(D){case"cc":a("."+E.name+"-credit").slideDown(),w.rules("add",{required:!0,messages:{required:"Please register your credit card details"}});break;default:a("."+E.name+"-credit").slideUp("","",function(){a(this).hide()}),p()}}function o(){E.handledType={credit:!1,bank:!1},D="",m(),a("body").removeClass(E.name+"-active"),p(),c(),a('[data-provide="paymentGateway"]').off("click",'[data-gateway="launcher"]',s),a("#update-premium").off("click."+E.name,g),"undefined"!=typeof E.paymentTypeSelector&&E.paymentTypeSelector.trigger("change"),x.messaging.unsubscribe(z.SUCCESS,B),x.messaging.unsubscribe(z.FAIL,C)}function p(){w.rules("remove","required")}function q(){}function r(b){return E=a.extend({},E,b),a('[data-provide="paymentGateway"]').on("click",'[data-gateway="launcher"]',s),null==E.paymentEngine?!1:(t=a("."+E.name+" .launcher"),u=a("."+E.name+" .success"),v=a("."+E.name+" .fail"),w=a("#"+E.name+"-registered"),E.paymentEngine.setup(E),a("body").addClass(E.name+"-active"),a("#update-premium").on("click."+E.name,g),"object"==typeof E.clearValidationSelectors&&E.clearValidationSelectors.on("change",p),B=x.messaging.subscribe(z.SUCCESS,d),void(C=x.messaging.subscribe(z.FAIL,e)))}function s(){A=!1,x.modules.tracking.recordSupertag("trackCustomPage","Payment gateway popup"),modalId=x.modules.dialogs.show({htmlContent:x.modules.loadingAnimation.getTemplate(),onOpen:E.paymentEngine.onOpen,onClose:function(){A||e()}})}var t,u,v,w,x=window.meerkat,y=(x.modules.events,x.logging.info,{paymentGateway:{SUCCESS:"PAYMENT_GATEWAY_SUCCESS",FAIL:"PAYMENT_GATEWAY_FAIL"}}),z=y.paymentGateway,A=!1,B=null,C=null,D="",E={paymentEngine:null,name:"",handledType:{credit:!1,bank:!1}};x.modules.register("paymentGateway",{init:q,events:y,reset:o,setup:r})}(jQuery),function(){function a(a){var b=(new Date).getTime(),c={name:a,startTime:b};o.push(c)}function b(a){var b=(new Date).getTime(),c=_.findWhere(o,{name:a});if("undefined"==typeof c)return null;var d=o.indexOf(c);o.splice(d,1);var e=b-c.startTime;return e}function c(){return!!navigator.platform.match(/iPhone|iPod|iPad/i)}function d(){return navigator.userAgent.toLowerCase().indexOf("android")>-1}function e(){return navigator.userAgent.toLowerCase().indexOf("chrome")>-1}function f(){return navigator.userAgent.toLowerCase().match(/firefox\/(30|31|32|33|34).*/i)}function g(){return 8===m()?!0:!1}function h(){return 9===m()?!0:!1}function i(){return 10===m()?!0:!1}function j(){return c()&&navigator.userAgent.match(/OS 5/)?!0:!1}function k(){return c()&&navigator.userAgent.match(/OS 6/)?!0:!1}function l(){return c()&&navigator.userAgent.match(/OS 7/)?!0:!1}function m(){var a=window.navigator.userAgent,b=a.indexOf("MSIE ");return b>0?parseInt(a.substring(b+5,a.indexOf(".",b))):null}var n=window.meerkat,o=(n.modules.events,[]),p={LOW:"low",MEDIUM:"medium",HIGH:"high"};n.modules.register("performanceProfiling",{PERFORMANCE:p,startTest:a,endTest:b,isIos5:j,isIos6:k,isIos7:l,isIos:c,isAndroid:d,isChrome:e,isFFAffectedByDropdownMenuBug:f,isIE8:g,isIE9:h,isIE10:i,getIEVersion:m})}(jQuery),function(a){function b(){var b,c=a(this);c.data("fakeplaceholder")||c.is("[type=checkbox]")||c.is("[type=radio]")||c.is("[type=hidden]")||c.is("[type=file]")||(b=a("<div/>",{"class":"fakeplaceholder"}),b.height(c.height()-c.css("padding-bottom").replace("px","")).css({"margin-top":c.css("margin-top"),"margin-bottom":c.css("margin-bottom"),"margin-left":c.css("margin-left"),"margin-right":c.css("margin-right"),"padding-top":c.css("padding-top"),"padding-bottom":c.css("padding-bottom"),"padding-left":c.css("padding-left"),"padding-right":c.css("padding-right"),"font-size":c.css("font-size"),"line-height":c.css("line-height"),color:c.css("color")}).data("for",c),c.before(b.text(c.attr("placeholder"))).data("fakeplaceholder",b),c.val()&&b.hide())}function c(c){if(!h){var d=a(c||document).find("[placeholder]");d.each(b)}}function d(){h||(c(),a(document).on("focus.fakeplaceholder","input[placeholder]",function(){var b=a(this),c=b.data("fakeplaceholder");c.hide()}).on("blur.fakeplaceholder","input[placeholder]",function(){var b=a(this),c=b.data("fakeplaceholder");!b.val()&&c.show()}).on("click.fakeplaceholder",".fakeplaceholder",function(){a(this).data("for").focus()}),g("[Placeholder] Initialised"))}function e(a){placeholder=a.data("fakeplaceholder"),placeholder&&placeholder.length>0&&(a.val()?placeholder.hide():placeholder.show())}var f=window.meerkat,g=f.logging.info,h=Modernizr.input.placeholder;f.modules.register("placeholder",{init:d,initPlaceholders:c,invalidatePlaceholder:e})}(jQuery),function(a){function b(){if(navigator.userAgent.match(/IEMobile\/10\.0/)){var b=document.createElement("style");b.appendChild(document.createTextNode("@-ms-viewport{width:auto!important}")),document.getElementsByTagName("head")[0].appendChild(b)}d&&a(document).on("click",'form button[type="submit"]',function(b){b.preventDefault(),a(this).closest("form").submit()}).on("keypress","form input",function(b){13===b.which&&a(this).closest("form").submit()}),a(function(){"undefined"!=typeof FastClick&&FastClick.attach(document.body)})}var c=window.meerkat,d="button"===document.createElement("button").type;c.modules.register("polyfills",{init:b})}(jQuery),function(a){function b(b){var c=a.extend({},e,b),f="",g=null;"url"==c.contentType?g=function(b,e){var g=d.modules.loadingAnimation.getTemplate();return d.modules.comms.get({url:c.contentValue,cache:!0,errorLevel:"silent",onSuccess:function(b){var c="";a(b).find("help").each(function(){""===f&&(f=a(this).attr("header")),c+=a(this).text()}),g=c,e.set("content.text",c),e.set("content.title",f),e.reposition()},onError:function(){e.set("content.text","Apologies. This information did not download successfully."),e.reposition()}}),g}:(g=c.contentValue,f=c.element.attr("data-title"));var h=null;h=c.element.attr("data-trigger")?c.element.attr("data-trigger"):c.showEvent;var i=null;switch(h){case"mouseenter":i="mouseleave";break;case"mouseenter click":case"click mouseenter":i="mouseleave unfocus click";break;default:i="unfocus click"}c.element.qtip({content:{text:g,title:f},position:c.position?c.position:{my:c.element.attr("data-my")?c.element.attr("data-my"):"left center",at:c.element.attr("data-at")?c.element.attr("data-at"):"right center",effect:!1,adjust:{method:"flipinvert none",x:c.element.attr("data-adjust-x")?parseInt(c.element.attr("data-adjust-x")):0,y:c.element.attr("data-adjust-y")?parseInt(c.element.attr("data-adjust-y")):0},viewport:a(window)},show:{event:h},hide:{event:i,fixed:!0,delay:150},style:c.style?c.style:{classes:c.element.attr("data-class")?"popover "+c.element.attr("data-class"):"popover",tip:{corner:!0,width:12,height:6}}})}function c(){d.messaging.subscribe("DYNAMIC_CONTENT_PARSED_POPOVER",function(a){a.element.attr("data-hasqtip")||(b(a),a.element.qtip("toggle",!0))})}var d=window.meerkat,e=(d.logging.info,{element:null,contentType:null,contentValue:null,showEvent:"click",onOpen:function(){},onClose:function(){},onLoad:function(){}});d.modules.register("popovers",{init:c,create:b})}(jQuery),function(a){function b(){a(document).on("change","[data-toggle^=radio] input",function(b){var c,d=a(b.target);c=d.parent().parent().find(".btn"),c.removeClass("active"),d.is(":checked")&&(c=d.parent(),c.addClass("active"))}),a(document).on("focusin","[data-toggle^=radio] input",function(b){var c=a(b.target).parent().parent().find(".btn");c.removeClass("focus"),c=a(b.target).parent(),c.addClass("focus")}),a(document).on("focusout","[data-toggle^=radio] input",function(b){var c=a(b.target).parent().parent().find(".btn");c.removeClass("focus")})}function c(a,b,c){if("undefined"!=typeof a&&0!==a.length){var d=a.find("label:eq("+b+")");return d.contents().filter(function(){return 3===this.nodeType}).each(function(){var a=/[a-z0-9]+/i;if(this.textContent){if(a.test(this.textContent)===!1)return;this.textContent=c}else if(this.innerText){if(a.test(this.innerText)===!1)return;this.innerText=c}}),d}}var d=window.meerkat;d.modules.register("radioGroup",{init:b,changeLabelText:c})}(jQuery),function(a){function b(){t=a(".resultsHeadersBg"),u=a(".affixOnScroll"),v=a(".resultsContainer"),w=a("#navbar-main").height()}function c(b){if(0===C||b){var c=0;a(".dynamicTopHeaderContent > *").each(function(){a(this).hasClass("simplesHidden")&&z.site.isCallCentreUser||(c+=a(this).height())}),C=c+a(".header-top .container").height()+t.position().top}}function d(){return a(window).scrollTop()>=C?!0:!1}function e(){return a(window).scrollTop()>=C+5?!0:!1}function f(){return v.hasClass("affixed")}function g(){return v.hasClass("affixed-compact")}function h(){return v.hasClass("affixed-absoluted")}function i(){c(),d()===!0?(f()===!1&&(u.addClass("affixed"),v.addClass("affixed-settings")),e()===!0&&g()===!1?(u.addClass("affixed-compact"),v.find(".result .productSummary").addClass("compressed")):e()===!1&&g()===!0&&j()):d()===!1&&f()===!0&&k()}function j(){u.removeClass("affixed-compact"),v.find(".result .productSummary").removeClass("compressed")}function k(){j(),u.removeClass("affixed"),v.removeClass("affixed-settings")}function l(){if(f()&&D===!1){D=!0;var b=a(window).scrollTop()+w-v.offset().top;v.find(".result").css("top",b+"px"),v.removeClass("affixed"),v.addClass("affixed-absoluted")}}function m(){h()&&D===!0&&(D=!1,v.removeClass("affixed-absoluted"),v.addClass("affixed"),v.find(".result").css("top",""))}function n(){g()&&a(Results.settings.elements.productHeaders).refreshLayout()}function o(){"xs"!==z.modules.deviceMediaState.get()&&(_.defer(function(){i()}),a(window).on("scroll.resultsHeaderBar",_.throttle(i,25)),x=z.messaging.subscribe(A.device.STATE_ENTER_XS,function(){p()}))}function p(){z.messaging.unsubscribe(x),k(),a(window).off("scroll.resultsHeaderBar"),q()}function q(){y=z.messaging.subscribe(A.device.STATE_LEAVE_XS,function(){z.messaging.unsubscribe(y),r()})}function r(){"xs"===z.modules.deviceMediaState.get()?q():o(),a(Results.settings.elements.resultsContainer).off("pagination.instantScroll").on("pagination.instantScroll",n),a(Results.settings.elements.resultsContainer).off("pagination.scrolling.start").on("pagination.scrolling.start",l),a(Results.settings.elements.resultsContainer).off("pagination.scrolling.end").on("pagination.scrolling.end",m),a(Results.settings.elements.resultsContainer).off("results.view.animation.start").on("results.view.animation.start",l),a(Results.settings.elements.resultsContainer).off("results.view.animation.end").on("results.view.animation.end",m),t.prevAll(".simples-dialogue.toggle").off("click.updateHeaderBarOffset").on("click.updateHeaderBarOffset",function(){_.delay(function(){c(!0)
},300)})}function s(){"undefined"!=typeof x&&z.messaging.unsubscribe(x),"undefined"!=typeof y&&z.messaging.unsubscribe(y),a(window).off("scroll.resultsHeaderBar"),a(Results.settings.elements.resultsContainer).off("pagination.instantScroll"),a(Results.settings.elements.resultsContainer).off("pagination.scrolling.start"),a(Results.settings.elements.resultsContainer).off("pagination.scrolling.end"),a(Results.settings.elements.resultsContainer).off("results.view.animation.start"),a(Results.settings.elements.resultsContainer).off("results.view.animation.end")}var t,u,v,w,x,y,z=window.meerkat,A=z.modules.events,B=(window.meerkat.logging.info,{resultsHeaderBar:{}}),C=(B.resultsHeaderBar,0),D=!1;z.modules.register("resultsHeaderBar",{init:b,registerEventListeners:r,removeEventListeners:s,enableAffixMode:o,disableAffixMode:p})}(jQuery),function(a){function b(a){function b(a,b){c.push({productID:a,ranking:b})}var c=[];if(Results.settings.hasOwnProperty("rankings")){var d=Results.settings.rankings,g=Results.getSortedResults(),h=Results.getFilteredResults(),i=e.site.vertical,j=[],k=null,l=!1;if(_.isObject(d)&&!_.isEmpty(d)&&(d.hasOwnProperty("paths")&&_.isObject(d.paths)?k="paths":d.hasOwnProperty("callback")&&_.isFunction(d.callback)&&(k="callback"),d.hasOwnProperty("forceIdNumeric")&&_.isBoolean(d.forceIdNumeric)&&(l=d.forceIdNumeric)),!_.isNull(k)){for(var m=0;m<g.length;m++)for(var n=0;n<h.length;n++)g[m]==h[n]&&(j[j.length]=g[m]);for(var o={rootPath:i,rankBy:Results.getSortBy()+"-"+Results.getSortDir(),rank_count:j.length,transactionId:e.modules.transactionId.get()},p=0;p<j.length;p++){var q=p+1,r=j[p],s=r.productId;if(l&&(s=String(s).replace(/\D/g,"")),"paths"===k){for(var t in d.paths)if(d.paths.hasOwnProperty(t)){var u=Object.byString(r,d.paths[t]);o[t+p]=u}}else if("callback"===k){var v=d.callback(r,p);_.isObject(v)&&!_.isEmpty(v)&&_.extend(o,v)}b(s,q)}e.logging.info("writing ranking data",{trigger:a,method:k,data:o}),e.modules.comms.post({url:"ajax/write/quote_ranking.jsp",data:o,cache:!1,errorLevel:"silent",onError:function(a,b,c,d,f){e.modules.errorHandling.error({message:"Failed to write ranking results.",page:"core:resultsRankings.js:write()",errorLevel:"silent",description:"Failed to write ranking results: "+c,data:{settings:d,resultsData:f}})}}),e.messaging.publish(f.tracking.EXTERNAL,{method:"trackQuoteProductList",object:{products:c,vertical:e.site.vertical}}),e.messaging.publish(f.RESULTS_RANKING_READY)}}}function c(){var a=Results.settings.rankings;if(_.isObject(a)&&(a.hasOwnProperty("paths")&&!_.isEmpty(a.paths)||a.hasOwnProperty("callback")&&_.isFunction(a.callback))){var c=i;a.hasOwnProperty("triggers")&&_.isArray(a.triggers)&&(c=a.triggers);for(var d=0;d<c.length;d++)f.hasOwnProperty(c[d])&&e.messaging.subscribe(f[c[d]],_.bind(b,this,c[d]))}}function d(){a(document).ready(function(){e.messaging.subscribe(f.RESULTS_INITIALISED,c)})}var e=window.meerkat,f=e.modules.events,g=(window.meerkat.logging.info,{RESULTS_RANKING_READY:"RESULTS_RANKING_READY",RESULTS_INITIALISED:"RESULTS_INITIALISED",RESULTS_DATA_READY:"RESULTS_DATA_READY",RESULTS_SORTED:"RESULTS_SORTED"}),h=g,i=["RESULTS_DATA_READY","RESULTS_SORTED"];e.modules.register("resultsRankings",{init:d,events:h,write:b})}(jQuery),function(a){function b(){jQuery(document).ready(function(a){if(D=a("#email-quote-dropdown"),$auxilleryActivator=a("[data-opensavequote=true]"),C=D.find(".dropdown-container"),E=a("#email-quote-component"),O=a("#callmeback-save-quote-dropdown"),F=a(".saveQuoteInstructions"),G=a("#save_email"),H=a("#save_password"),I=a("#save_confirm"),J=a("#save_marketing"),K=a(P),L=a(".saveQuotePasswords"),M=a("#saveQuoteSuccess"),N=a(".saveQuoteFields"),c()){var b=x.modules[x.site.vertical+"SaveQuote"].getCopy("buttonLabel");b!==!1&&K.text(b);var i=x.modules[x.site.vertical+"SaveQuote"].getCopy("saveSuccess");i!==!1&&M.empty().append(i)}G.on("keyup change",g),G.on("blur",function(){a(this).val(a.trim(a(this).val()))}),I.on("keyup change",h),H.on("keyup change",h),E.on("click",".btn-save-quote",l),D.find(".activator").on("click",d),C.on("click",".btn-cancel",w),a(".save-quote-openAsModal").length&&a(".save-quote-openAsModal").on("click",function(b){return b.preventDefault(),a(this).hasClass("disabled")||a(this).hasClass("inactive")?!1:void e()}),f(),k("init"),p(),x.messaging.subscribe(y.WEBAPP_LOCK,u),x.messaging.subscribe(y.WEBAPP_UNLOCK,t)}),z.subscribe(x.modules.events.contactDetails.email.FIELD_CHANGED,function(a){""===G.val()&&G.val(a.$field.val()).trigger("change")})}function c(){return!_.isUndefined(x.modules[x.site.vertical+"SaveQuote"])&&x.modules[x.site.vertical+"SaveQuote"].hasOwnProperty("getCopy")}function d(){V?(O.hide(),M.hide(),E.show(),N.hide()):(O.hide(),""!==G.val()&&K.hasClass("disabled")&&!a(".saveQuotePasswords").is(":visible")&&G.trigger("change")),0!==O.length&&C.find(".callmeback-feedback").remove()}function e(){x.modules.dialogs.show({hashId:"email-quote",closeOnHashChange:!0,onOpen:function(b){C.after('<div id="email-quote-placeholder"></div>'),C.appendTo(a("#"+b+" .modal-body")),C.on("click.modal",".btn-cancel",function(){a("#"+b).modal("hide")}),d()},onClose:function(){var b=a("#email-quote-placeholder");C.insertAfter(b),b.remove()}})}function f(){null!==E&&0!==E.length&&(setupDefaultValidationOnForm(E),H.length>0&&H.rules("add",{required:!0,minlength:6,messages:{required:"Please enter a password",minlength:jQuery.format("Password must be at least {0} characters")}}),I.length>0&&I.rules("add",{required:!0,equalTo:"#"+H.attr("id"),messages:{required:"Please confirm your password",equalTo:jQuery.format("Password and confirmation password must match")}}))}function g(a){13==a.keyCode||9==a.keyCode?i():Q!=G.val()?(s(),clearInterval(R),R=setTimeout(i,800)):""!==H.val()&&""!==H.val()&&r()}function h(){H.valid()&&I.valid()?r():s()}function i(){var a=G.valid();a&&j()}function j(){var a=G.val();Q=a,S&&"pending"===S.state()&&"function"==typeof S.abort&&S.abort(),s(),x.modules.loadingAnimation.showAfter(G);var b={returnAjaxObject:!0,data:{type:"email",value:a},onComplete:function(){r(),x.modules.loadingAnimation.hide(G)},onSuccess:function(a){T=a.exists,a.optInMarketing?(p(),J.prop("checked",!0)):q(),x.site.isCallCentreUser||(a.exists?(k("clickSubmit"),o()):(k("createLogin"),n()))},onError:function(){T=!1,x.site.isCallCentreUser||(k("createLogin"),n())}};S=x.modules.optIn.fetch(b)}function k(b){var d="";if(c()&&(d=x.modules[x.site.vertical+"SaveQuote"].getCopy(b)),_.isEmpty(d))switch(b){case"clickSubmit":d="Enter your email address to retrieve your quote at any time.";break;case"createLogin":d="Create a login to retrieve your quote at any time.";break;case"saveAgain":d='Click \'Save Quote\' to update your saved quote <a href="javascript:;" class="btn btn-save btn-save-quote">Email Quote</a>';break;case"init":d=x.site.isCallCentreUser?"Please enter the email you want the quote sent to.":"We will check if you have an existing login or help you set one up."}F.html(d),"saveAgain"===b&&(K=a(P),K.html("Save Quote"))}function l(){if(E.valid()){if(U&&"pending"===U.state())return;s();var b=a("#mainform");0===a("#saved_email").length&&x.modules.form.appendHiddenField(b,"saved_email",G.val()),0===a("#saved_marketing").length&&x.modules.form.appendHiddenField(b,"saved_marketing",J.val());var c,d=[];c=-1!==a.inArray(x.site.vertical,["car","ip","life"])?"no":"yes";var e=x.modules.form.getData(E),f=x.modules.journeyEngine.getFormData();d=e.concat(f),d.push({name:"quoteType",value:x.site.vertical}),d.push({name:"vertical",value:x.site.vertical}),d.push({name:"sendConfirm",value:c}),x.modules.loadingAnimation.showAfter(K),V?x.messaging.publish(y.tracking.TOUCH,{touchType:"S",touchComment:null,includeFormData:!0,callback:function(a){m(a.result.success,a.result.transactionId)}}):x.modules.comms.post({url:"ajax/json/save_email_quote_mysql.jsp",data:d,dataType:"json",cache:!1,errorLevel:"silent",onSuccess:function(a){m("OK"===a.result,a.transactionId)},onError:function(){(x.site.isCallCentreUser||""!==H.val()&&""!==I.val())&&r()},onComplete:function(){x.modules.loadingAnimation.hide(K)}})}}function m(b,c){r(),x.modules.loadingAnimation.hide(K),b&&(E.hide(),M.fadeIn(),0===O.length||V||x.modules.callMeBack.hasCallbackBeenRequested()||x.site.isCallCentreUser||(x.modules.callMeBack.prefillForm(O),O.fadeIn()),V||(V=!0,k("saveAgain"),D.find(".activator span:not([class])").html("Save Quote"),$auxilleryActivator.find("span:not([class])").html("Save Quote")),"undefined"!=typeof c&&x.modules.transactionId.set(c),-1!==a.inArray(x.site.vertical,["car","ip","life","health"])&&x.messaging.publish(y.tracking.EXTERNAL,{method:"trackQuoteEvent",object:{action:"Save",transactionID:c,vertical:x.site.vertical}}),x.messaging.publish(B.QUOTE_SAVED))}function n(){L.slideDown()}function o(){L.slideUp()}function p(){J.parents(".row").first().hide()}function q(){J.parents(".row").first().show()}function r(){K.removeClass("disabled")}function s(){K.addClass("disabled")}function t(){D.children(".activator").removeClass("inactive").removeClass("disabled"),$auxilleryActivator.find("a").removeClass("inactive").removeClass("disabled")}function u(){w(),D.children(".activator").addClass("inactive").addClass("disabled"),$auxilleryActivator.find("a").addClass("inactive").addClass("disabled")}function v(){return D.is(":visible")}function w(){D.hasClass("open")&&D.find(".activator").dropdown("toggle")}var x=window.meerkat,y=x.modules.events,z=(x.logging.info,x.messaging),A={saveQuote:{QUOTE_SAVED:"SAVE_QUOTE_SAVED"}},B=A.saveQuote,C=null,D=null,E=null,F=null,G=null,H=null,I=null,J=null,K=null,L=null,M=null,N=null,O=null,P=".btn-save-quote",Q=null,R=null,S=null,T=null,U=null,V=!1;x.modules.register("saveQuote",{init:b,events:A,close:w,enable:t,disable:u,enableSubmitButton:r,disableSubmitButton:s,isAvailable:v,openAsModal:e})}(jQuery),function(a){var b=window.meerkat,c=(b.modules.events,function(){}),d=function(a){"use strict";e(a),f()},e=function(c){for(var d=null,e=[],f=0;f<c.validationErrors.length;f++){var g=c.validationErrors[f],h=g.elementXpath.replace(/\//g,"_");if(d=a(":input[name$='"+h+"']"),0===d.length&&""!==g.elements)for(var i=g.elements.split(","),j=0;j<i.length;j++){var k=h+"_"+a.trim(i[j]);d=a('input[name*="'+k+'"]'),0===d.length&&(d=a('input[id*="'+k+'"]'))}for(var l=0;l<d.length;l++){var m=d[l];e.push(m);var n=a(m);a(m).parent().removeClass("has-success"),a(m).parent().addClass("has-error");var o=n;null!==n.attr("data-validation-placement")&&""!==n.attr("data-validation-placement")&&(o=a(n.attr("data-validation-placement")));var p=o.closest(".row-content, .fieldrow_value");0===p.length&&(p=n.parent());var q=p.children(".error-field"),r="invalid field";"ELEMENT REQUIRED"===g.message&&(r="This field is required."),0===q.length&&(p.prepend('<div class="error-field"></div>'),q=p.children(".error-field"),q.hide().slideDown(100)),q.append(r)}}d.length>0&&("undefined"==typeof c.startStage&&(c.startStage="start"),b.modules.address.setHash(c.startStage))},f=function(){"undefined"!=typeof FormElements&&!FormElements.errorContainer.is(":visible")&&FormElements.errorContainer.find("li").length>0&&(FormElements.rightPanel.addClass("hidden"),FormElements.errorContainer.show(),FormElements.errorContainer.find("li").show(),FormElements.errorContainer.find("li .error").show())};b.modules.register("serverSideValidationOutput",{init:c,outputValidationErrors:d})}(jQuery),function(){function a(){sessionExpiry.poke()}function b(){c.messaging.subscribe(d.journeyEngine.STEP_CHANGED,function(){a()})}var c=window.meerkat,d=c.modules.events;c.modules.register("session",{init:b,poke:a})}(jQuery),function(a){function b(b){b.preventDefault();var c=a(this),d=c.attr("data-title");url=c.attr("href"),"undefined"!=typeof c.attr("data-url")&&(url=c.attr("data-url")),d&&(d=d.replace(/ /g,"_")),window.open(url,d,"width=800,height=600,toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbars=yes,copyhistory=no,resizable=no")}function c(){jQuery(document).ready(function(a){a(document.body).on("click",".showDoc",b)})}{var d=window.meerkat;d.modules.events,d.logging.info}d.modules.register("showDoc",{init:c})}(jQuery),function(a){function b(){a(document).ready(c)}function c(){return"function"!=typeof a.fn.noUiSlider?void i("[sliders.js]","noUiSlider plugin is not available."):void a(".slider-control").each(function(){var b=a(this),c=b.find(".slider"),h=b.find("input"),i=b.find(".selection"),j=c.data("value"),l=c.data("range").split(","),m=c.data("markers"),n=c.data("step"),o=c.data("legend").split(","),p=c.data("type"),q=c.data("use-default-output"),r=null;l={min:Number(l[0]),max:Number(l[1])};var s,t=!1;s=function(a){i.text(a)},"excess"===p&&(q===!1&&(h=a("#health_excess")),h.length>0&&h.val().length>0&&(j=h.val()),s=function(a){i.text(a>0&&a<=o.length?o[a-1]:" "),h.val(a)},r={lower:[a.Link({target:s,format:{decimals:0}})]}),"price"===p&&(q===!1&&(h=a("#health_filter_priceMin")),h.length>0&&h.val().length>0&&(j=h.val()),s=function(a){a<=l.min||isNaN(a)?(h.val(0),i.text("All prices")):(h.val(a),i.text("from $"+a))},r={lower:[a.Link({target:s,format:{decimals:0,encoder:function(a){return a=Math.round(a),5*Math.floor(a/5)}}})]},t=function(a,b,d,e){var g=l.min,i=l.max,j=h.val();if(c.val(j),l={min:b,max:d},f(c,{min:0,"1%":b,max:d},!0),e)if(j==g||"0"==j)c.val(0);else if(j==i)c.val(l.max);else{var k=(j-g)/(i-g),m=l.min+(l.max-l.min)*k;c.val(m)}}),"function"==typeof t&&a(this).on(k.EVENT_UPDATE_RANGE,t),c.on(k.EVENT_SET_VALUE,function(a,b){g(c,b)}),c.noUiSlider({range:l,step:n,start:[j],serialization:r,behaviour:"extend-tap"}),d(b,m),e(b,o)})}function d(b,c){var d,e,f;if(c>1){for(c-=1,d=a("<div />"),f=0;c>f;f++)e=a("<div />"),e.addClass("slider-marker"),e.css("width",100/c+"%"),d.append(e);d.find(".slider-marker:first").addClass("first"),d.find(".slider-marker").appendTo(b.find(".noUi-base"))}}function e(b,c){var d,e,f;if(c.length>1){for(d=a("<div />"),f=0;f<c.length;f++)e=a("<div><span><b /></span></div>"),e.addClass("slider-legend"),e.css("width",100/(c.length-1)+"%"),e.find("b").text(c[f]),d.append(e);d.find(".slider-legend:first").addClass("first"),d.find(".slider-legend:last").addClass("last"),d.find(".slider-legend").appendTo(b.find(".slider-legends"))}}function f(a,b){a.noUiSlider({range:b},!0);var c=a.data("markers"),e=a.closest(".slider-control");"undefined"!=typeof c&&e.length>0&&d(e,c)}function g(a,b){a.val(b)}var h=window.meerkat,i=h.logging.info,j=(h.modules.events,{sliders:{EVENT_UPDATE_RANGE:"EVENT_UPDATE_RANGE",EVENT_SET_VALUE:"SET_VALUE"}}),k=j.sliders;h.modules.register("sliders",{init:b,events:j})}(jQuery),function(a){function b(a,b,c,d){var e=[];c&&(e=f.modules.journeyEngine.getFormData()),e.push({name:"quoteType",value:f.site.vertical}),e.push({name:"touchtype",value:a}),e.push({name:"comment",value:b}),f.modules.comms.post({url:"ajax/json/access_touch.jsp",data:e,errorLevel:"silent",onSuccess:function(a){"function"==typeof d&&d(a)}})}function c(a,b){var c;try{if(c="function"==typeof b?b():b,"undefined"==typeof superT)throw"Supertag is undefined";"undefined"==typeof c.brandCode&&(c.brandCode=f.site.tracking.brandCode),null!==c.email&&""!==c.email&&null===c.emailID?d(c.email,c.marketOptIn,c.okToCall,function(b){c.emailID=b,c.email=null,superT[a](c),f.logging.info("Supertag",a,c)}):(superT[a](c),f.logging.info("Supertag",a,c))}catch(e){f.logging.info("Supertag catch",a,c,e)}}function d(a,b,c,d){f.modules.comms.post({url:"ajax/json/get_email_id.jsp",data:{vertical:f.site.vertical,email:a,m:b,o:c},errorLevel:"silent",onSuccess:function(a){d(a.emailId)}})}function e(){a(document).on("click","a[data-tracking-type]",function(b){var c=a(b.currentTarget).attr("data-tracking-type"),d=a(b.currentTarget).attr("data-tracking-value");f.modules.tracking.recordTouch(c,d)}),a(document).on("click","a[data-supertag-method]",function(b){var c=a(b.currentTarget).attr("data-supertag-method"),d=a(b.currentTarget).attr("data-supertag-value");f.modules.tracking.recordSupertag(c,d)}),f.messaging.subscribe(h.TOUCH,function(a){if("undefined"!=typeof a){var c=!1;"undefined"!=typeof a.includeFormData&&a.includeFormData===!0&&(c=!0),b(a.touchType,a.touchComment,c,a.callback)}}),f.messaging.subscribe(h.EXTERNAL,function(a){"undefined"!=typeof a&&c(a.method,a.object)})}var f=window.meerkat,g={tracking:{TOUCH:"TRACKING_TOUCH",EXTERNAL:"TRACKING_EXTERNAL"}},h=g.tracking;f.modules.register("tracking",{init:e,events:g,recordTouch:b,recordSupertag:c})}(jQuery),function(){function a(){d(),jQuery(document).ready(function(a){j=a(".transactionId"),c(i),g()})}function b(){return"undefined"==typeof i&&d(),i}function c(a){i=a,h(),g()}function d(){null!==k.site.initialTransactionId&&"number"==typeof k.site.initialTransactionId&&(i=k.site.initialTransactionId,k.site.initialTransactionId=null)}function e(a,b,d,f){k.modules.comms.post({url:"ajax/json/get_transactionid.jsp",dataType:"json",async:a,errorLevel:"silent",data:{quoteType:k.site.vertical,id_handler:b},onSuccess:function(a){a.transaction_id!==i&&(c(a.transaction_id),k.messaging.publish(m.CHANGED,{transactionId:i})),"function"==typeof f&&f(i)},onError:function(b,c,g){d>0&&n?e(a,data,d-1,f):(k.modules.errorHandling.error({message:"An error occurred fetching a transaction ID. Please check your connection or try again later.",page:"core/transactionId.js module",description:"fetch() AJAX request(s) returned an error: "+c+" "+g+". Original transactionId: "+i,errorLevel:"fatal",data:i}),"function"==typeof f&&f(0))}})}function f(a,b){n=!0,e(!0,"increment_tranId",a,function(a){n=!1,"function"==typeof b&&b(a)})}function g(){try{k.site.isCallCentreUser&&parent.postMessage({eventType:"transactionId",transactionId:i},"*")}catch(a){}}function h(){"number"==typeof i&&i>0&&j.html(i)}var i,j,k=window.meerkat,l=(k.modules.events,k.logging.info,{transactionId:{CHANGED:"CHANGED"}}),m=l.transactionId,n=!1;k.modules.register("transactionId",{init:a,events:l,get:b,set:c,getNew:f})}(jQuery),function(a){function b(a){return a=a.replace(/[^\w\s-]/g,""),a=a.replace(/^\s+/,"").replace(/\s+$/,"").toLowerCase(),a=a.replace(/[-\s]+/g,"-")}function c(b,c,d,e){var f,g=a(b),h=250,i=0,j=!1;"undefined"!=typeof c&&(h=c),"undefined"!=typeof d&&(i=d),g.offset().top<a(window).scrollTop()?a("html, body").animate({scrollTop:g.offset().top+i},h,function(){f=!0,j||"function"!=typeof e||(j=!0,e(this,f))}):(f=!1,"function"==typeof e&&e(this,f))}function d(){var a=new Date;return Date.UTC(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate(),a.getUTCHours(),0,0,0)}function e(a,b){var c=new Date;c.setHours(0,0,0);var d=f(a),e=c.getFullYear()-d.getFullYear();if(1>e)return(c-d)/31536e6;var g=e-c.getFullYear()%4;g=(g-g%4)/4;var h=(366*g+365*(e-g))/e,i=.005;d.getMonth()==c.getMonth()&&d.getDate()>c.getDate()&&(i=-.005);var j=(c-d)/(864e5*h)+i;return b?Math.floor(j):j}function f(a){return new Date(a.substring(6,10),a.substring(3,5)-1,a.substring(0,2))}function g(a,b){return b=b||"/",a.split(b).reverse().join(b)}function h(a,b){b=_.isBoolean(b)?b:!1;var c,d;if(window.event)c=window.event.keyCode;else{if(!a)return!0;c=a.which}d=String.fromCharCode(c);var e=[8,35,37,39];return null==c||0===c||9==c||12==c||13==c||27==c?!0:-1!==_.indexOf(e,c)||"0123456789".indexOf(d)>-1?!0:b&&"."==d?!0:!1}{var i=window.meerkat;i.logging.info}jQuery.fn.animateAuto=function(a,b,c){var d,e,f;return this.each(function(g,h){h=jQuery(h),d=h.clone().css({height:"auto",width:"auto"}).appendTo("body"),e=d.css("height"),f=d.css("width"),d.remove(),"height"===a?h.animate({height:e},b,c):"width"===a?h.animate({width:f},b,c):"both"===a&&h.animate({width:f,height:e},b,c)})},i.modules.register("utilities",{slugify:b,scrollPageTo:c,getUTCToday:d,returnAge:e,returnDate:f,isValidNumericKeypressEvent:h,invertDate:g})}(jQuery),jQuery.fn.extend({refreshLayout:function(){var a=$("<div>");$(this).append(a),_.defer(function(){$(this).remove(a)})}}),function(){function a(){jQuery(document).ready(function(a){e=a("#mainform")})}function b(a,b){return b?a.valid():e.validate().check(a)===!1?!1:!0}var c=window.meerkat,d=(c.modules.events,c.logging.info,c.messaging,{validation:{}}),e=(d.validation,null);c.modules.register("validation",{init:a,events:d,isValid:b})}(jQuery),jQuery.fn.extend({isValid:function(a){return meerkat.modules.validation.isValid($(this),a)}}),function(a){function b(){}function c(b,c,e){var f=[];if(a.extend(f,d.modules.journeyEngine.getFormData()),f.push({name:"quoteType",value:d.site.vertical}),f.push({name:"stage",value:d.modules.journeyEngine.getCurrentStep().navigationId}),"object"==typeof b)for(var g in b)b.hasOwnProperty(g)&&f.push({name:g,value:b[g]});d.modules.comms.post({url:"ajax/write/write_quote.jsp",data:f,dataType:"json",cache:!1,errorLevel:c?"fatal":"silent",onSuccess:function(a){"function"==typeof e&&e(a)}})}{var d=window.meerkat,e=(d.modules.events,d.logging.info,d.messaging,{writeQuote:{}});e.writeQuote}d.modules.register("writeQuote",{init:b,events:e,write:c})}(jQuery);
//# sourceMappingURL=modules.yhoo.min.map