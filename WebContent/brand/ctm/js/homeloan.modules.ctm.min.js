/*!
 * CTM-Platform v0.8.3
 * Copyright 2014 Compare The Market Pty Ltd
 * http://www.comparethemarket.com.au/
 */


!function(a){function b(){if("confirmation"===k.site.pageAction)k.modules.journeyEngine.configure(null);else{c(!1),k.modules.journeyEngine.configure({startStepId:null,steps:_.toArray(n)});var a=k.modules.transactionId.get();k.messaging.publish(l.tracking.EXTERNAL,{method:"trackQuoteEvent",object:{action:"Start",transactionID:parseInt(a,10)}})}}function c(){d(),e()}function d(){var b={title:"Your Situation",navigationId:"situation",slideIndex:0,externalTracking:{method:"trackQuoteForms",object:k.modules.homeloan.getTrackingFieldsObject},onInitialise:function(){k.modules.homeloanResults.initPage(),k.modules.currencyField.initCurrency()},onBeforeLeave:function(){}},c={title:"Results",navigationId:"results",slideIndex:1,externalTracking:{method:"trackQuoteForms",object:k.modules.homeloan.getTrackingFieldsObject},validation:{validate:!1,customValidation:function(a){Results.getSelectedProduct()===!1&&a(!1),a(!0)}},onInitialise:function(){k.modules.homeloanMoreInfo.initMoreInfo(),k.modules.homeloanFilters.initFilters()},onBeforeEnter:function(b){b.isForward===!0&&(a("#resultsPage").addClass("hidden"),a(".morePromptContainer, .comparison-rate-disclaimer").addClass("hidden"))},onAfterEnter:function(b){b.isForward===!0&&k.modules.homeloanResults.get(),a("#navbar-main").addClass("affix-top").removeClass("affix")},onBeforeLeave:function(a){a.isBackward===!0&&k.modules.transactionId.getNew(3)}},d={title:"Enquiry",navigationId:"enquiry",slideIndex:2,tracking:{touchType:"A"},externalTracking:{method:"trackQuoteForms",object:k.modules.homeloan.getTrackingFieldsObject},onInitialise:function(){k.modules.homeloanEnquiry.initHomeloanEnquiry()},onBeforeEnter:function(){k.modules.homeloanSnapshot.initHomeloanSnapshot(),Results.getSelectedProduct()!==!1&&Results.getSelectedProduct().hasOwnProperty("id")&&(a("#homeloan_product_id").val(Results.getSelectedProduct().id),a("#homeloan_product_lender").val(Results.getSelectedProduct().lender));var b=a("#homeloan_contact_firstName"),c=a("#homeloan_enquiry_contact_firstName").closest(".form-group"),d=a("#homeloan_contact_lastName"),e=a("#homeloan_enquiry_contact_lastName").closest(".form-group");(""===b.val()||""===d.val())&&c.add(e).removeClass("hidden")}};n={startStep:b,resultsStep:c,enquiryStep:d}}function e(){k.modules.journeyProgressBar.configure([{label:"Your Situation",navigationId:n.startStep.navigationId},{label:"Your Quote",navigationId:n.resultsStep.navigationId},{label:"Make an Enquiry",navigationId:n.enquiryStep.navigationId}])}function f(){return a("#homeloan_details_situation").val()||null}function g(b){try{b=b||!1;var c=k.modules.transactionId.get(),d=a("#homeloan_details_goal").val(),e=a("#homeloan_details_postcode").val(),f=a("#homeloan_details_state").val(),g=a("#homeloan_loanDetails_purchasePrice").val(),h=a("#homeloan_loanDetails_loanAmount").val(),i=a("input[name=homeloan_loanDetails_interestRate]:checked").val(),j=a("#homeloan_contact_email").val(),l=a("#homeloan_contact_optIn").is(":checked")?"Y":"N",m=k.modules.journeyEngine.getCurrentStepIndex(),n=k.modules.journeyEngine.getFurtherestStepIndex(),o="";switch(m){case 0:o="your situation";break;case 1:o=b===!0?"homeloan more info":"homeloan results";break;case 2:o="enquire now"}var p={vertical:k.site.vertical,actionStep:o,transactionID:c,quoteReferenceNumber:c,postCode:null,state:null,email:null,emailID:null,marketOptIn:null,okToCall:null};return n>k.modules.journeyEngine.getStepIndex("situation")&&_.extend(p,{verticalFilter:k.modules.homeloan.getVerticalFilter(),goal:d,postCode:e,state:f,purchasePrice:g,loanAmount:h,interestRateType:i,email:j,marketOptIn:l}),n>k.modules.journeyEngine.getStepIndex("enquiry")&&_.extend(p,{}),p}catch(q){return!1}}function h(){k.site.isFromBrochureSite===!0&&_.defer(function(){k.site.brochureValues.hasOwnProperty("situation")&&1===a("#homeloan_details_situation_"+k.site.brochureValues.situation).length&&a("#homeloan_details_situation").val(k.site.brochureValues.situation),k.site.brochureValues.hasOwnProperty("location")&&a("#homeloan_details_location").val(k.site.brochureValues.location)})}function i(){if("confirmation"!==k.site.pageAction){var b=a("#homeloan_contact_contactNumberinput"),c=a("#homeloan_enquiry_contact_contactNumberinput"),d=a("#homeloan_contact_email"),e=a("#homeloan_enquiry_contact_email"),f=a("#homeloan_contact_firstName"),g=a("#homeloan_enquiry_contact_firstName"),h=a("#homeloan_contact_lastName"),i=a("#homeloan_enquiry_contact_lastName"),j={name:[{$field:g,$fieldInput:f},{$field:g,$fieldInput:g}],lastname:[{$field:i,$fieldInput:h},{$field:i,$fieldInput:i}],email:[{$field:e,$fieldInput:d},{$field:e,$fieldInput:e}],phone:[{$field:a("#homeloan_contact_contactNumber"),$fieldInput:b},{$field:a("#homeloan_enquiry_contact_contactNumber"),$fieldInput:c}]};k.modules.contactDetails.configure(j)}}function j(){a(document).ready(function(){return"homeloan"!==k.site.vertical?!1:(h(),b(),void i())})}var k=window.meerkat,l=k.modules.events,m={WEBAPP_LOCK:"WEBAPP_LOCK",WEBAPP_UNLOCK:"WEBAPP_UNLOCK"},n=null;k.modules.register("homeloan",{init:j,events:m,initProgressBar:c,getTrackingFieldsObject:g,getVerticalFilter:f})}(jQuery),function(a){function b(){jQuery(document).ready(function(){if("undefined"!=typeof d.site&&"confirmation"===d.site.pageAction)if(confirmationData.hasOwnProperty("confirmation")===!1||confirmationData.confirmation.hasOwnProperty("flexOpportunityId")===!1){var a="Trying to load the confirmation page failed";confirmationData.hasOwnProperty("confirmation")&&confirmationData.confirmation.hasOwnProperty("message")&&(a=confirmationData.confirmation.message),d.modules.errorHandling.error({message:a,page:"homeloanConfirmation.js module",description:"Invalid data",data:null,errorLevel:"warning"})}else{var b=confirmationData.confirmation;c(b),d.messaging.publish(e.tracking.EXTERNAL,{method:"completedApplication",object:{productID:b.product&&b.product.id?b.product.id:null,productBrandCode:b.product&&b.product.lender?b.product.lender:null,quoteReferenceNumber:b.flexOpportunityId,verticalFilter:b.hasOwnProperty("situation")?b.situation:null,transactionID:confirmationTranId||null,vertical:d.site.vertical}})}})}function c(b){var c=a("#confirmation-template").html();if(c.length){var d=_.template(c),e=d(b);a("#confirmation").html(e)}}{var d=window.meerkat,e=d.modules.events;d.logging.info}d.modules.register("homeloanConfirmation",{init:b})}(jQuery),function(a){function b(){l.on("click",function(){var a=m.modules.journeyEngine.isCurrentStepValid();a&&f()}),j.on("change",function(){"P"===j.val()?k.addClass("show_Y").removeClass("show_N").removeClass("show_"):k.addClass("show_N").removeClass("show_Y").removeClass("show_")}),a("#homeloan_enquiry_contact_firstName, #homeloan_enquiry_contact_lastName").on("change",function(){m.modules.contentPopulation.render(".journeyEngineSlide:eq(2) .snapshot")}),h.on("change",function(){a("#homeloan_enquiry_newLoan_foundAProperty_Y").is(":checked")?i.addClass("show_Y").removeClass("show_N").removeClass("show_"):(i.addClass("show_N").removeClass("show_Y").removeClass("show_"),a("#homeloan_enquiry_newLoan_offerTime").val(""),a("#homeloan_enquiry_newLoan_propertyType").val(""))}),m.messaging.subscribe(n.WEBAPP_LOCK,d),m.messaging.subscribe(n.WEBAPP_UNLOCK,e)}function c(){a(document).ready(function(){l=a("#submit_btn"),j=a("#homeloan_enquiry_contact_bestContact"),k=a("#homeloan_enquiry_contact_bestcontactToggleArea"),h=a("#homeloan_enquiry_newLoan_foundAProperty"),i=a("#homeloan_enquiry_newLoan_foundToggleArea"),b(),j.trigger("change"),h.trigger("change")})}function d(b){var c="undefined"!=typeof b&&b.source&&"homeloanEnquiry"===b.source,d="undefined"!=typeof b&&b.disableFields&&b.disableFields===!0;if(l.addClass("disabled"),d===!0){var e=a("#enquiryForm");e.find(":input").prop("disabled",!0),e.find(".select").addClass("disabled"),e.find(".btn-group label").addClass("disabled")}c===!0&&m.modules.loadingAnimation.showAfter(l)}function e(){l.removeClass("disabled"),m.modules.loadingAnimation.hide(l);var b=a("#enquiryForm");b.find(":input").prop("disabled",!1),b.find(".select").removeClass("disabled"),b.find(".btn-group label").removeClass("disabled")}function f(){if(o===!0)return void alert("This page is still being processed. Please wait.");o=!0;var a=m.modules.journeyEngine.getFormData();m.messaging.publish(p.WEBAPP_LOCK,{source:"homeloanEnquiry",disableFields:!0}),m.modules.comms.post({url:"ajax/json/homeloan_submit.jsp",data:a,cache:!1,useDefaultErrorHandling:!1,errorLevel:"fatal",timeout:75e3,onSuccess:function(a){if(o=!1,a.hasOwnProperty("confirmationkey")===!1)return void g(!1,"","Missing confirmationkey",!1,a);m.messaging.publish(n.tracking.EXTERNAL,{method:"trackQuoteForms",object:m.modules.homeloan.getTrackingFieldsObject});var b=a.confirmationkey;window.location.href="viewConfirmation?key="+encodeURI(b)},onError:g,onComplete:function(){o=!1}})}function g(a,b,c,d,e){o=!1,m.messaging.publish(p.WEBAPP_UNLOCK,{source:"homeloanEnquiry"}),m.modules.errorHandling.error({message:"An error occurred when attempting to submit your enquiry.",page:"homeloanEnquiry.js:submitEnquiry()",errorLevel:"warning",description:"Ajax request to homeloan/opportunity/apply.json failed to return a valid response: "+c,data:e})}var h,i,j,k,l,m=window.meerkat,n=m.modules.events,o=(m.logging.info,!1),p={WEBAPP_LOCK:"WEBAPP_LOCK",WEBAPP_UNLOCK:"WEBAPP_UNLOCK"};m.modules.register("homeloanEnquiry",{initHomeloanEnquiry:c})}(jQuery),function(a){function b(){c("value")}function c(b,c){var d=b||"value";p.find("[data-filter-type]").each(function(){var b=a(this),e=b.attr("data-filter-type"),f=b.attr("id"),g="";if("undefined"!=typeof f){if("radio"===e&&(g=b.find(":checked").val()||"",c!==!0&&("filter-interest-rate-type"==f?(a("#homeloan_filter_loanDetails_interestRate_P").prop("checked",a("#homeloan_loanDetails_interestRate_P").is(":checked")),a("#homeloan_filter_loanDetails_interestRate_I").prop("checked",a("#homeloan_loanDetails_interestRate_I").is(":checked")),a("input[name=homeloan_filter_loanDetails_interestRate]:checked").change(),g=a("input[name=homeloan_filter_loanDetails_interestRate]:checked").val()):"filter-repaymentFrequency"==f&&(a("#homeloan_filter_results_repaymentFrequency_weekly").prop("checked","Y"===a("#homeloan_results_frequency_weekly").val()),a("#homeloan_filter_results_repaymentFrequency_fortnightly").prop("checked","Y"===a("#homeloan_results_frequency_fortnightly").val()),a("#homeloan_filter_results_repaymentFrequency_monthly").prop("checked","Y"===a("#homeloan_results_frequency_monthly").val()),a("input[name=homeloan_filter_results_repaymentFrequency]:checked").change(),g=a("input[name=homeloan_filter_results_repaymentFrequency]:checked").val()))),"select"===e&&(g=b.find(":selected").val()||"",c!==!0&&"filter-loan-term"==f&&(g=a("#homeloan_results_loanTerm").val())),"checkbox"===e){c!==!0&&("filter-loan-type"==f?(a("#homeloan_filter_loanDetails_productFixed").prop("checked",a("#homeloan_loanDetails_productFixed").prop("checked")).change(),a("#homeloan_filter_loanDetails_productVariable").prop("checked",a("#homeloan_loanDetails_productVariable").prop("checked")).change(),a("#homeloan_filter_loanDetails_productLineOfCredit").prop("checked","Y"===a("#homeloan_loanDetails_productLineOfCredit").val()).change(),a("#homeloan_filter_loanDetails_productLowIntroductoryRate").prop("checked","Y"===a("#homeloan_loanDetails_productLowIntroductoryRate").val()).change()):"filter-fees"==f?(a("#homeloan_filter_fees_noApplication").prop("checked","Y"===a("#homeloan_fees_noApplication").val()).change(),a("#homeloan_filter_fees_noOngoing").prop("checked","Y"===a("#homeloan_fees_noOngoing").val()).change()):"filter-features"==f&&(a("#homeloan_filter_features_redraw").prop("checked","Y"===a("#homeloan_features_redraw").val()).change(),a("#homeloan_filter_features_offset").prop("checked","Y"===a("#homeloan_features_offset").val()).change(),a("#homeloan_filter_features_bpay").prop("checked","Y"===a("#homeloan_features_bpay").val()).change(),a("#homeloan_filter_features_onlineBanking").prop("checked","Y"===a("#homeloan_features_onlineBanking").val()).change(),a("#homeloan_filter_features_extraRepayments").prop("checked","Y"===a("#homeloan_features_extraRepayments").val()).change()));var h=[];h=b.find("[type=checkbox]:checked").map(function(){return this.value}),g=h.get().join(w)}"text"===e&&(c!==!0?"filter-loan-amount"==f&&(g=a("#homeloan_loanDetails_loanAmountentry").val(),b.find("input[type=text]").val(g)):g=b.find("input[type=text]").val()),v.hasOwnProperty(f)||(v[f]={}),v[f].type=e,v[f][d]=g}}),u("readFilterValues",c===!0?"readOnlyFromFilters":"!readOnlyFromFilters",_.extend({},v))}function d(){var b,c;for(c in v)if(v.hasOwnProperty(c))switch(b=v[c].value,v[c].type){case"radio":""===b?p.find("#"+c+" input").prop("checked",!1).change():p.find("#"+c+' input[value="'+b+'"]').prop("checked",!0).change();break;case"select":p.find("#"+c+" select").val(b);break;case"text":p.find("#"+c+" input").val(b);break;case"checkbox":if(p.find("#"+c+" input[type=checkbox]").prop("checked",!1),b.length)for(var d=b.split(","),e=0;e<d.length;e++)switch(c){case"filter-loan-type":a("#homeloan_filter_loanDetails_product"+d[e]).prop("checked",!0);break;case"filter-features":a("#homeloan_filter_features_"+d[e]).prop("checked",!0);break;case"filter-fees":a("#homeloan_filter_fees_"+d[e]).prop("checked",!0)}}}function e(){p.addClass("is-saved"),_.defer(function(){var b,d,e,f=!1;c("valueNew",!0);for(e in v)if(v.hasOwnProperty(e)&&v[e].value!==v[e].valueNew&&a("#"+e).attr("data-filter-serverside")){f=!0;break}for(e in v)if(v.hasOwnProperty(e)&&(b=v[e].value,d=v[e].valueNew,b!==d)){var g,j;switch(e){case"filter-loan-amount":var k=a("#homeloan_loanDetails_loanAmountentry");k.val(d),a("#homeloan_loanDetails_loanAmount").val(k.asNumber());break;case"filter-loan-term":a("#homeloan_results_loanTerm").val(d);break;case"filter-interest-rate-type":a("input[name=homeloan_loanDetails_interestRate]").prop("checked",!1).change(),a("#homeloan_loanDetails_interestRate_"+d).prop("checked",!0).change();break;case"filter-repaymentFrequency":a("input[id^=homeloan_results_frequency_]").val(""),a("#homeloan_results_frequency_"+d).val("Y"),""!==d&&Results.setFrequency(d,!1);break;case"filter-fees":case"filter-features":var l="filter-fees"==e?"fees":"features";if(i(a("input[id^=homeloan_"+l+"]")),g=d.split(w),g.length)for(j=0;j<g.length;j++)a("#homeloan_"+l+"_"+g[j]).val("Y");break;case"filter-loan-type":if(i(a("input[id^=homeloan_loanDetails_product]")),g=d.split(w),g.length)for(j=0;j<g.length;j++){var m=a("#homeloan_loanDetails_product"+g[j]);"checkbox"==m.attr("type")?m.prop("checked",!0):m.val("Y")}}}h(),s.messaging.publish(A.CHANGED),f?_.defer(function(){s.modules.journeyEngine.loadingShow("...updating your quotes...",!0),_.delay(function(){s.modules.homeloanResults.get()},100)}):Results.applyFiltersAndSorts()})}function f(){n.hasClass("open")===!1&&n.find(".activator").dropdown("toggle")}function g(){p=a(".filters-component"),p.on("click.filters",".btn-save",e).on("click.filters",".btn-cancel",h),a("#homeloan_filter_loanDetails_loanAmount").each(s.modules.currencyField.initSingleCurrencyField),y&&(p.on("change.checkedForIE",".checkbox input, .compareCheckbox input",function(){var b=a(this);b.is(":checked")?b.addClass("checked"):b.removeClass("checked")}),p.find(".checkbox input").change(),p.on("focus","#homeloan_filter_results_loanTerm",function(){var b=a(this);b.data("width",b.width()),b.width("auto"),b.data("width-auto",a(this).width()),b.width(b.data("width-auto")<b.data("width")?b.data("width"):b.data("width-auto")+15)}).on("blur","#homeloan_filter_results_loanTerm",function(){var b=a(this);b.width(b.data("width"))}))}function h(){n.hasClass("open")&&n.find(".activator").dropdown("toggle"),x!==!1&&(s.modules.navMenu.close(),s.modules.dialogs.close(x))}function i(b){b.each(function(){var b=a(this);"checkbox"==b.attr("type")?b.prop("checked",!1):b.val("")})}function j(){p.hasClass("is-saved")?p.removeClass("is-saved"):d(),x=!1,s.modules.navMenu.close(),p.off("click.filters",".btn-save"),p.off("click.filters",".btn-cancel"),p.find(":checkbox").removeClass("has-error"),p.find(".alert").remove()}function k(){a(document).ready(function(){return"homeloan"!==s.site.vertical||"confirmation"===s.site.pageAction?!1:(y=s.modules.performanceProfiling.isIE8(),l(),void m())})}function l(){n=a("#filters-dropdown"),o=a("#filters-modal"),r=a("#filters-container");var c=a("#filters-template");c.length>0&&(templateCallback=_.template(c.html()),q=templateCallback()),"xs"!==s.modules.deviceMediaState.get()&&r.empty().html(q),n.on("show.bs.dropdown",function(){g(),b()}).on("hidden.bs.dropdown",function(){j()}),o.on("click",function(a){a.preventDefault();var c={htmlContent:q,hashId:"filters",closeOnHashChange:!0,leftBtn:{label:"Back",icon:"",className:"btn-sm btn-close-dialog",callback:j},rightBtn:{label:"Save Changes",icon:"",className:"btn-sm",callback:e},onOpen:function(){g(),p.find(".btn-cancel, .btn-save").addClass("hidden"),b()}};x=s.modules.dialogs.show(c)})}function m(){s.messaging.subscribe(t.WEBAPP_LOCK,function(){h(),n.children(".activator").addClass("inactive").addClass("disabled")}),s.messaging.subscribe(t.WEBAPP_UNLOCK,function(){n.children(".activator").removeClass("inactive").removeClass("disabled")}),s.messaging.subscribe(t.device.STATE_ENTER_XS,function(){n.hasClass("open")&&(s.modules.homeloanFilters.close(),s.modules.navMenu.close()),r.empty()}),s.messaging.subscribe(t.device.STATE_LEAVE_XS,function(){x!==!1&&s.modules.homeloanFilters.close(),r.empty().html(q)})}var n,o,p,q,r,s=window.meerkat,t=s.modules.events,u=s.logging.info,v={},w=",",x=!1,y=!1,z={homeloanFilters:{CHANGED:"HOMELOAN_FILTERS_CHANGED"}},A=z.homeloanFilters;s.modules.register("homeloanFilters",{initFilters:k,events:z,open:f,close:h})}(jQuery),function(a){function b(){var b={container:k,modalOptions:{className:"modal-breakpoint-wide modal-tight bridgingContainer",openOnHashChange:!1,leftBtn:{label:"All Products",icon:'<span class="icon icon-arrow-left"></span>',callback:function(b){a(b.currentTarget).closest(".modal").modal("hide")}}},runDisplayMethod:d,onBeforeShowBridgingPage:null,onBeforeShowTemplate:null,onBeforeShowModal:null,onAfterShowModal:h,onAfterShowTemplate:null,onBeforeHideTemplate:null,onAfterHideTemplate:null,onClickApplyNow:g,onBeforeApply:null,onApplySuccess:null,retrieveExternalCopy:f};i.modules.moreInfo.initMoreInfo(b),e(),c()}function c(){a(document.body).on("click",".btn-apply",g)}function d(){i.modules.moreInfo.showModal(),i.modules.address.appendToHash("moreinfo")}function e(){i.messaging.subscribe(j.device.STATE_ENTER_XS,function(){i.modules.moreInfo.isModalOpen()&&i.modules.moreInfo.close()}),i.messaging.subscribe(j.device.STATE_LEAVE_XS,function(){i.modules.moreInfo.isModalOpen()&&i.modules.moreInfo.close()})}function f(){return a.Deferred(function(a){return a.resolveWith(this,[]).promise()})}function g(){Results.model.setSelectedProduct(a(".btn-apply").attr("data-productId")),i.modules.journeyEngine.gotoPath("next")}function h(){i.messaging.publish(j.tracking.EXTERNAL,{method:"trackQuoteForms",object:_.bind(i.modules.homeloan.getTrackingFieldsObject,this,!0)})}{var i=window.meerkat,j=i.modules.events,k=a(".bridgingContainer"),l={homeloanMoreInfo:{}};l.homeloanMoreInfo}i.modules.register("homeloanMoreInfo",{initMoreInfo:b,events:l,runDisplayMethod:d})}(jQuery),function(a){function b(){d(),Features.init(),v.modules.compare.initCompare({callbacks:{switchMode:function(a){switch(a){case"features":p(!0);break;case"price":o(!0)}}}}),e(),g()}function c(){g(),u!==v.modules.deviceMediaState.get()&&(Results.view.calculateResultsContainerWidth(),Features.clearSetHeights(),Features.balanceVisibleRowsHeight()),Results.pagination.refresh()}function d(){try{var a="price";"undefined"!=typeof v.site&&"undefined"!=typeof v.site.resultOptions&&(a="features"==v.site.resultOptions.displayMode?"features":"price"),Results.init({url:"ajax/json/homeloan_results.jsp",runShowResultsPage:!1,paths:{results:{rootElement:"responseData",list:"responseData.searchResults",general:"responseData.totalCount"},price:{monthly:"monthlyRepayments"},rate:"intrRate",availability:{product:"productAvailable",price:{monthly:"monthly"}},productId:"id"},show:{topResult:!1,savings:!1,featuresCategories:!1,nonAvailableProducts:!1,unavailableCombined:!0},availability:{product:["equals","Y"],price:["equals",!0]},render:{templateEngine:"_",features:{mode:"populate",headers:!1,numberOfXSColumns:1},dockCompareBar:!1},displayMode:a,pagination:{mode:"page",touchEnabled:Modernizr.touch},sort:{sortBy:!1},frequency:"monthly",animation:{results:{individual:{active:!1},delay:500,options:{easing:"swing",duration:0}},shuffle:{active:!1,options:{easing:"swing",duration:0}},filter:{active:!1,reposition:{options:{duration:0,easing:"swing"}},appear:{options:{duration:0}},disappear:{options:{duration:0}}}},elements:{features:{values:".content",extras:".children"}},templates:{pagination:{pageText:"Product {{=currentPage}} of {{=totalPages}}"}},dictionary:{valueMap:[{key:"Y",value:"<span class='icon icon-tick'></span>"},{key:"N",value:"<span class='icon icon-cross'></span>"}]},rankings:{paths:{rank_productId:"id",rank_premium:"monthlyRepayments"},filterUnavailableProducts:!1},incrementTransactionId:!1})}catch(b){Results.onError("Sorry, an error occurred initialising page","results.tag","meerkat.modules.homeloanResults.init(); "+b.message,b)}}function e(){a(document.body).on("click",".btn-enquire-now",q),a(Results.settings.elements.resultsContainer).on("click",".result-row",r),v.messaging.subscribe(w.affix.AFFIXED,function(){a("#resultsPage").css("margin-top","37px")}),v.messaging.subscribe(w.affix.UNAFFIXED,function(){a("#resultsPage").css("margin-top","0")}),v.messaging.subscribe(w.homeloanFilters.CHANGED,function(){Results.settings.incrementTransactionId=!0,v.modules.session.poke()}),v.messaging.subscribe(x.RESULTS_ERROR,function(){_.delay(function(){v.modules.journeyEngine.gotoPath("previous")},1e3)}),v.messaging.subscribe(Results.model.moduleEvents.RESULTS_MODEL_UPDATE_BEFORE_FILTERSHOW,function(){Results.model.returnedProducts=f(Results.model.returnedProducts),Results.model.sortedProducts=Results.model.returnedProducts}),a(Results.settings.elements.resultsContainer).on("featuresDisplayMode",function(){Features.buildHtml()}),a(Results.settings.elements.resultsContainer).on("noFilteredResults",function(){Results.view.show()}),a(Results.settings.elements.resultsContainer).on("noResults",function(){m()}),a(document).on("resultsLoaded",l),a(document).on("resultsReturned",function(){v.modules.utilities.scrollPageTo(a("header")),a(".morePromptContainer, .comparison-rate-disclaimer").removeClass("hidden"),a(".featuresHeaders .expandable.expanded").removeClass("expanded").addClass("collapsed")}),a(document).on("resultsFetchStart",function(){v.modules.journeyEngine.loadingShow("getting your quotes"),a("#resultsPage, .loadingDisclaimerText").removeClass("hidden"),Results.pagination.hide()}),a(document).on("resultsFetchFinish",function(){a(Results.settings.elements.page).show(),v.modules.journeyEngine.loadingHide(),a(".loadingDisclaimerText").addClass("hidden"),"price"!==Results.getDisplayMode()?Results.pagination.show():a(document.body).removeClass("priceMode").addClass("priceMode")}),a(document).on("populateFeaturesStart",function(){v.modules.performanceProfiling.startTest("results")}),a(Results.settings.elements.resultsContainer).on("populateFeaturesEnd",function(){var a,b=v.modules.performanceProfiling.endTest("results");a=800>b?v.modules.performanceProfiling.PERFORMANCE.HIGH:8e3>b&&v.modules.performanceProfiling.isIE8()===!1?v.modules.performanceProfiling.PERFORMANCE.MEDIUM:v.modules.performanceProfiling.PERFORMANCE.LOW,Results.setPerformanceMode(a)}),a(document).on("FeaturesRendered",function(){a(Features.target+" .expandable > "+Results.settings.elements.features.values).on("mouseenter",function(){var b=a(this).attr("data-featureId"),c=a(Features.target+' [data-featureId="'+b+'"]');c.addClass(Results.settings.elements.features.expandableHover.replace(/[#\.]/g,""))}).on("mouseleave",function(){var b=a(this).attr("data-featureId"),c=a(Features.target+' [data-featureId="'+b+'"]');c.removeClass(Results.settings.elements.features.expandableHover.replace(/[#\.]/g,""))})})}function f(a){return _.isArray(a)&&a.length>0&&_.isArray(a[0])?a=[{productAvailable:"N"}]:_.each(a,function(a){_.each(a,function(b,c){b===!0?a[c]="Y":b===!1&&(a[c]="N")}),a.productAvailable="Y",a.brandCode=a.lender,a.productId=a.id,a.formatted={intrRate:Number(a.intrRate).toFixed(2)+"%",comparRate:Number(a.comparRate).toFixed(2)+"%",appFees:v.modules.currencyField.formatCurrency(a.appFees).replace("$0.00","$0"),settlFees:v.modules.currencyField.formatCurrency(a.settlFees).replace("$0.00","$0"),ongoingFees:v.modules.currencyField.formatCurrency(a.ongoingFees).replace("$0.00","$0"),repayments:{monthly:v.modules.currencyField.formatCurrency(a.monthlyRepayments,{roundToDecimalPlace:0}),fortnightly:v.modules.currencyField.formatCurrency(a.fortnightlyRepayments).replace(".00",""),weekly:v.modules.currencyField.formatCurrency(a.weeklyRepayments).replace(".00","")}},a.formatted.repayments.monthlyFull=a.formatted.repayments.monthly+" monthly",a.formatted.repayments.fortnightlyFull=a.formatted.repayments.fortnightly+" fortnightly",a.formatted.repayments.weeklyFull=a.formatted.repayments.weekly+" weekly",a.ongoingFees>0&&(a.formatted.ongoingFees=a.formatted.ongoingFees+" "+a.ongoingFeesCycle)}),a}function g(){h(),v.messaging.subscribe(w.device.STATE_ENTER_XS,function(){"results"===v.modules.journeyEngine.getCurrentStep().navigationId&&h()}),v.messaging.subscribe(w.device.STATE_LEAVE_XS,function(){i(),Results.pagination.setCurrentPageNumber(1),Results.pagination.resync()})}function h(){"xs"===v.modules.deviceMediaState.get()&&"features"===Results.getDisplayMode()&&(Results.view.startColumnWidthTracking(a(window),Results.settings.render.features.numberOfXSColumns,!1),Results.pagination.setCurrentPageNumber(1),Results.pagination.resync())}function i(){Results.view.stopColumnWidthTracking()}function j(){u=v.modules.deviceMediaState.get()}function k(){a("#homeloan_results_pageNumber").val("1"),Results.get()}function l(){switch(h(),Results.getDisplayMode()){case"features":p(!1);break;default:z=!0,o(!1)}}function m(){v.modules.dialogs.show({htmlContent:a("#no-results-content")[0].outerHTML})}function n(){var a;v.modules.compare.isCompareOpen()===!0?a="compare":(a=Results.getDisplayMode(),0===a.indexOf("f")&&(a=a.slice(0,-1)));var b={vertical:v.site.vertical,actionStep:v.site.vertical+" results",display:a,event:y,verticalFilter:v.modules.homeloan.getVerticalFilter()};v.messaging.publish(w.tracking.EXTERNAL,{method:"trackQuoteList",object:b}),y="Load"}function o(b){"undefined"==typeof b&&(b=!0),null!==Results.getDisplayMode()&&"price"!==Results.getDisplayMode()&&(Results.pagination.hide(),a("header .xs-results-pagination").addClass("hidden"),Results.setDisplayMode("price"),i(),a(document.body).addClass("priceMode"),a(window).scrollTop(0),b&&(y="Refresh",n()))}function p(b){if("undefined"==typeof b&&(b=!0),null!==Results.getDisplayMode()&&"features"!==Results.getDisplayMode()){var c=z===!0;Results.setDisplayMode("features",c),h(),_.defer(function(){Results.pagination.gotoPage(1),"xs"===v.modules.deviceMediaState.get()&&Results.view.setColumnWidth(a(window),Results.settings.render.features.numberOfXSColumns,!1),Results.pagination.setupNativeScroll()}),Results.pagination.show(!0),a("header .xs-results-pagination").removeClass("hidden"),z=!1,a(document.body).removeClass("priceMode"),a(window).scrollTop(0),b&&n()}}function q(b){b.preventDefault();var c=a(b.target);Results.setSelectedProduct(c.attr("data-productId")),v.modules.journeyEngine.gotoPath("next",c)}function r(b){if(a(Results.settings.elements.resultsContainer).hasClass("priceMode")!==!1&&"xs"===v.modules.deviceMediaState.get()){var c=a(b.target);c.hasClass("result-row")===!1&&(c=c.parents(".result-row")),"undefined"!=typeof c.attr("data-available")&&"Y"===c.attr("data-available")&&(v.modules.moreInfo.setProduct(Results.getResult("productId",c.attr("data-productId"))),Results.model.setSelectedProduct(c.attr("data-productId")),v.modules.homeloanMoreInfo.runDisplayMethod())}}function s(){t=a("#resultsPage"),v.messaging.subscribe(w.RESULTS_RANKING_READY,n),v.messaging.subscribe(w.compare.AFTER_ENTER_COMPARE_MODE,function(){a(".slide-feature-filters, .slide-feature-filters a").addClass("inactive disabled")}),v.messaging.subscribe(w.compare.EXIT_COMPARE,function(){a(".slide-feature-filters, .slide-feature-filters a").removeClass("inactive disabled")})}var t,u,v=window.meerkat,w=v.modules.events,x=(v.logging.info,{RESULTS_ERROR:"RESULTS_ERROR",RESULTS_REMAINING_PRODUCTS:"HOMELOAN_RESULTS_REMAINING_PRODUCTS"}),y="Load",z=!1;v.modules.register("homeloanResults",{init:s,initPage:b,events:x,onReturnToPage:c,get:k,stopColumnWidthTracking:i,recordPreviousBreakpoint:j,switchToPriceMode:o,switchToFeaturesMode:p,showNoResults:m,publishExtraSuperTagEvents:n,massageResultsObject:f})}(jQuery),function(a){function b(){a(document).ready(c)}function c(){j=a('[data-provide="results-load-more"]'),0!==j.length&&(l=a("#homeloan_results_pageNumber"),k=j.find(".results-load-more-activator"),0===k.length?k=!1:k.on("click.resultsLoadMore",d),m.messaging.subscribe(m.modules.homeloanResults.events.RESULTS_REMAINING_PRODUCTS,function(a){_.isNumber(a)&&a>0?i():h()}))}function d(){m.modules.loadingAnimation.showInside(j,!0),k!==!1&&k.hide(),l.val(parseInt(l.val(),10)+1),m.modules.comms.post({url:Results.settings.url,data:m.modules.form.getData(a(Results.settings.formSelector)),dataType:"json",cache:!1,errorLevel:"warning"}).fail(e).done(f).always(g)}function e(){l.val(parseInt(l.val(),10)-1)}function f(b){Results.model.updateTransactionIdFromResult(b),Results.model.triggerEventsFromResult(b);var c=Object.byString(b,Results.settings.paths.results.list);if("undefined"!=typeof c){var d=Results.model.sortedProducts.length;Results.model.sortedProducts=c,m.modules.homeloanResults.massageResultsObject(Results.model.sortedProducts);var e={};_.each(c,function(a){Results.model.returnedProducts.push(a),Results.model.filteredProducts.push(a),e[d]={productID:a.id,ranking:d},d++}),m.messaging.publish(n.tracking.EXTERNAL,{method:"trackQuoteProductList",object:{products:e,vertical:m.site.vertical}});var f=a(Results.settings.elements.resultsContainer+" "+Results.settings.elements.resultsOverflow),g=f.outerHeight(!0),h="auto";Results.view.buildHtml(),Results.model.sortedProducts=Results.model.filteredProducts;var i=0;a.each(Results.model.sortedProducts,function(b,c){a(".result_"+c.id).addClass("notfiltered").attr("data-position",i).attr("id","result-row-"+b).attr("data-sort",b),i++}),h=f.outerHeight(!0),f.css({height:g,overflow:"hidden"}),f.animate({height:h},2e3,function(){f.css("height","auto")})}}function g(){m.modules.loadingAnimation.hide(j),k!==!1&&k.show()}function h(){j.addClass("hidden")}function i(){j.removeClass("hidden")}{var j,k,l,m=window.meerkat,n=m.modules.events;m.logging.info}m.modules.register("homeloanResultsLoadMore",{init:b,onStart:d,onComplete:g,hide:h,show:i})}(jQuery),function(a){function b(){c(),d()}function c(){var b='<p>Looking to <span data-source="#homeloan_details_goal"></span>';"E"===a("#homeloan_details_situation").val()&&(b+=a("#homeloan_details_currentLoan_Y").is(":checked")?" with an existing loan":" with no existing loan",b+=' and property worth <span data-source="#homeloan_details_assetAmountentry"></span>'),b+='. Looking to borrow <span data-source="#homeloan_loanDetails_loanAmountentry"></span>.',a(".snapshotGoal").html(b),e.modules.contentPopulation.render(".journeyEngineSlide:eq(2) .snapshot")}function d(){var b=a("#snapshot-template").html(),c=_.template(b),d=c(Results.getSelectedProduct());a(".product-snapshot").html(d)}{var e=window.meerkat,f=(e.modules.events,e.logging.info,{homeloanSnapshot:{}});
f.example}e.modules.register("homeloanSnapshot",{initHomeloanSnapshot:b,events:f,renderSnapshot:c})}(jQuery),function(a){function b(){a(document.body).on("click",".btn-view-brands",d),h.on("change",function(){a(this).is(":checked")?(e.attr("required","required").valid(),f.attr("required","required").valid(),g.attr("required","required").valid()):(e.removeAttr("required").valid(),f.removeAttr("required").valid(),g.removeAttr("required").valid())}),i.on("change",function(){var a=[],b=j.val();j.val(""),"E"===i.val()?(a=[{code:"APL",label:"Buy another property to live in"},{code:"IP",label:"Buy an investment property"},{code:"REP",label:"Renovate my existing property"},{code:"CD",label:"Consolidate my debt"},{code:"CL",label:"Compare better home loan options"}],p.addClass("show_Y").removeClass("show_N").removeClass("show_")):(a=[{code:"FH",label:"Buy my first home"},{code:"IP",label:"Buy an investment property"}],p.addClass("show_N").removeClass("show_Y").removeClass("show_"),n.val(""));for(var c=[],d='<option id="homeloan_details_goal_" value="">Please choose...</option>',e=0;e<a.length;e++)d+='<option id="homeloan_details_goal_'+a[e].code+'" value="'+a[e].code+'">'+a[e].label+"</option>",c.push(a[e].code);j.html(d),b&&-1!=c.indexOf(b)&&j.val(b).change()}),""!==i.val()&&i.change(),j.on("change",function(){"FH"===j.val()||"APL"===j.val()||"IP"===j.val()?q.addClass("show_Y").removeClass("show_N").removeClass("show_"):(q.addClass("show_N").removeClass("show_Y").removeClass("show_"),l.val(""))}),k.on("change",function(){a("#homeloan_details_currentLoan_Y").is(":checked")?(n.val(""),o.addClass("show_Y").removeClass("show_N").removeClass("show_")):(o.addClass("show_N").removeClass("show_Y").removeClass("show_"),n.val(""))}),m.on("blur.hmlValidate",function(){0!==l.val().length&&_.delay(function(){l.isValid(!0)},250)}),l.on("blur.hmlValidate",function(){0!==m.val().length&&_.delay(function(){m.isValid(!0)},250)})}function c(){a(document).ready(function(){e=a("#homeloan_contact_firstName"),f=a("#homeloan_contact_lastName"),g=a("#homeloan_contact_email"),h=a("#homeloan_contact_optIn"),i=a("#homeloan_details_situation"),j=a("#homeloan_details_goal"),k=a('input:radio[name="homeloan_details_currentLoan"]'),l=a("#homeloan_loanDetails_purchasePriceentry"),m=a("#homeloan_loanDetails_loanAmountentry"),n=a("#homeloan_details_amountOwingentry"),o=a("#homeloan_details_currentLoanToggleArea"),p=a(".homeloan_details_existingToggleArea"),q=a(".homeloan_loanDetails_purchasePriceToggleArea"),e.removeAttr("required"),f.removeAttr("required"),g.removeAttr("required"),b()})}function d(){var b=_.template(a("#brands-template").html()),c={};c.pretext="<h2>Our Home Loan Lender Panel</h2><p>We can help you find a loan to suit your needs. With access to over 1,300 home loan products from 29 of Australia's reputable lenders, finding a tailored loan to suit your needs has never been so easy.</p>";{var d=b(c);r.modules.dialogs.show({title:a(this).attr("title"),htmlContent:d,hashId:"brands",closeOnHashChange:!0,openOnHashChange:!1})}return!1}{var e,f,g,h,i,j,k,l,m,n,o,p,q,r=window.meerkat;r.modules.events,r.logging.info}r.modules.register("homeloanStart",{init:c})}(jQuery);
//# sourceMappingURL=homeloan.modules.ctm.min.map