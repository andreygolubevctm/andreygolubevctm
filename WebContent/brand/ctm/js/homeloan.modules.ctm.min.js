/*!
 * CTM-Platform v0.8.3
 * Copyright 2015 Compare The Market Pty Ltd
 * http://www.comparethemarket.com.au/
 */


!function(a,b){function c(){if("confirmation"===m.site.pageAction)m.modules.journeyEngine.configure(null);else{d(!1),m.modules.journeyEngine.configure({startStepId:null,steps:_.toArray(p)});var a=m.modules.transactionId.get();m.messaging.publish(n.tracking.EXTERNAL,{method:"trackQuoteEvent",object:{action:"Start",transactionID:parseInt(a,10),vertical:m.site.vertical,verticalFilter:m.modules.homeloan.getVerticalFilter()}})}}function d(a){e(),f()}function e(){var b={title:"Your Situation",navigationId:"situation",slideIndex:0,externalTracking:{method:"trackQuoteForms",object:m.modules.homeloan.getTrackingFieldsObject},onInitialise:function(b){m.modules.homeloanResults.initPage(),m.modules.currencyField.initCurrency();var c=a(".slide-feature-emailquote"),d=a("#homeloan_privacyoptin");d.is(":checked")&&c.addClass("privacyOptinChecked"),d.on("change",function(b){a(this).is(":checked")?c.addClass("privacyOptinChecked"):c.removeClass("privacyOptinChecked")})},onBeforeLeave:function(a){}},c={title:"Results",navigationId:"results",slideIndex:1,externalTracking:{method:"trackQuoteForms",object:m.modules.homeloan.getTrackingFieldsObject},validation:{validate:!1,customValidation:function(a){a(!0)}},onInitialise:function(){m.modules.homeloanMoreInfo.initMoreInfo(),m.modules.homeloanFilters.initFilters()},onBeforeEnter:function(b){Results.removeSelectedProduct(),b.isForward===!0&&(a("#resultsPage").addClass("hidden"),a(".morePromptContainer, .comparison-rate-disclaimer").addClass("hidden"))},onAfterEnter:function(b){b.isForward===!0&&m.modules.homeloanResults.get(),a("#navbar-main").addClass("affix-top").removeClass("affix")},onBeforeLeave:function(a){a.isBackward===!0&&m.modules.transactionId.getNew(3)}},d={title:"Enquiry",navigationId:"enquiry",slideIndex:2,tracking:{touchType:"A"},externalTracking:{method:"trackQuoteForms",object:m.modules.homeloan.getTrackingFieldsObject},onInitialise:function(){m.modules.homeloanEnquiry.initHomeloanEnquiry(),m.modules.homeloanSnapshot.initHomeloanSnapshot()},onBeforeEnter:function(){m.modules.homeloanSnapshot.onEnter(),Results.getSelectedProduct()!==!1&&Results.getSelectedProduct().hasOwnProperty("id")&&(a("#homeloan_product_id").val(Results.getSelectedProduct().id),a("#homeloan_product_lender").val(Results.getSelectedProduct().lender));var b=a("#homeloan_contact_firstName"),c=a("#homeloan_enquiry_contact_firstName").closest(".form-group"),d=a("#homeloan_contact_lastName"),e=a("#homeloan_enquiry_contact_lastName").closest(".form-group");(""===b.val()||""===d.val())&&c.add(e).removeClass("hidden")}};p={startStep:b,resultsStep:c,enquiryStep:d}}function f(){m.modules.journeyProgressBar.configure([{label:"Your Situation",navigationId:p.startStep.navigationId},{label:"Your Quote",navigationId:p.resultsStep.navigationId},{label:"Make an Enquiry",navigationId:p.enquiryStep.navigationId}])}function g(){return a("#homeloan_details_situation").val()||null}function h(b){try{b=b||!1;var c=m.modules.transactionId.get(),d=a("#homeloan_details_goal").val(),e=a("#homeloan_details_postcode").val(),f=a("#homeloan_details_state").val(),g=a("#homeloan_loanDetails_purchasePrice").val(),h=a("#homeloan_loanDetails_loanAmount").val(),i=a("input[name=homeloan_loanDetails_interestRate]:checked").val(),j=a("#homeloan_contact_email").val(),k=a("#homeloan_contact_optIn").is(":checked")?"Y":"N",l=m.modules.journeyEngine.getCurrentStepIndex(),n=m.modules.journeyEngine.getFurtherestStepIndex(),o="";switch(l){case 0:o="your situation";break;case 1:o=b===!0?"homeloan more info":"homeloan results";break;case 2:o="enquire now"}var p={vertical:m.site.vertical,actionStep:o,transactionID:c,quoteReferenceNumber:c,postCode:null,state:null,email:null,emailID:null,marketOptIn:null,okToCall:null};return n>m.modules.journeyEngine.getStepIndex("situation")&&_.extend(p,{verticalFilter:m.modules.homeloan.getVerticalFilter(),goal:d,postCode:e,state:f,purchasePrice:g,loanAmount:h,interestRateType:i,email:j,marketOptIn:k}),n>m.modules.journeyEngine.getStepIndex("enquiry")&&_.extend(p,{}),p}catch(q){return!1}}function i(){m.site.isFromBrochureSite===!0&&_.defer(function(){m.site.brochureValues.hasOwnProperty("situation")&&1===a("#homeloan_details_situation_"+m.site.brochureValues.situation).length&&a("#homeloan_details_situation").val(m.site.brochureValues.situation),m.site.brochureValues.hasOwnProperty("location")&&a("#homeloan_details_location").val(m.site.brochureValues.location)})}function j(){if("confirmation"!==m.site.pageAction){var b=a("#homeloan_contact_contactNumberinput"),c=a("#homeloan_enquiry_contact_contactNumberinput"),d=a("#homeloan_contact_email"),e=a("#homeloan_enquiry_contact_email"),f=a("#homeloan_contact_firstName"),g=a("#homeloan_enquiry_contact_firstName"),h=a("#homeloan_contact_lastName"),i=a("#homeloan_enquiry_contact_lastName"),j={name:[{$field:g,$fieldInput:f},{$field:g,$fieldInput:g}],lastname:[{$field:i,$fieldInput:h},{$field:i,$fieldInput:i}],email:[{$field:e,$fieldInput:d},{$field:e,$fieldInput:e}],phone:[{$field:a("#homeloan_contact_contactNumber"),$fieldInput:b},{$field:a("#homeloan_enquiry_contact_contactNumber"),$fieldInput:c}]};m.modules.contactDetails.configure(j)}}function k(){var a=Results.getSelectedProduct();_.isEmpty(a)&&(a={},a.productId="General Enquiry",a.lenderProductName="General Enquiry",a.brandCode="General Enquiry");var b=m.modules.transactionId.get();m.modules.partnerTransfer.trackHandoverEvent({product:a,type:"ONLINE",quoteReferenceNumber:b,transactionID:b,productID:a.productId,productName:a.lenderProductName,productBrandCode:a.brandCode},!1)}function l(){a(document).ready(function(){return"homeloan"!==m.site.vertical?!1:(i(),c(),void j())})}var m=window.meerkat,n=m.modules.events,o={WEBAPP_LOCK:"WEBAPP_LOCK",WEBAPP_UNLOCK:"WEBAPP_UNLOCK"},p=null;m.modules.register("homeloan",{init:l,events:o,initProgressBar:d,getTrackingFieldsObject:h,getVerticalFilter:g,trackHandover:k})}(jQuery),function(a,b){function c(){a(document).ready(function(){if("undefined"!=typeof e.site&&"confirmation"===e.site.pageAction)if(confirmationData.hasOwnProperty("confirmation")===!1||confirmationData.confirmation.hasOwnProperty("flexOpportunityId")===!1){var a="Trying to load the confirmation page failed";confirmationData.hasOwnProperty("confirmation")&&confirmationData.confirmation.hasOwnProperty("message")&&(a=confirmationData.confirmation.message),e.modules.errorHandling.error({message:a,page:"homeloanConfirmation.js module",description:"Invalid data",data:null,errorLevel:"warning"})}else{var b=confirmationData.confirmation;d(b),e.messaging.publish(f.tracking.EXTERNAL,{method:"completedApplication",object:{productID:b.product&&b.product.id?b.product.id:null,productBrandCode:b.product&&b.product.lender?b.product.lender:null,quoteReferenceNumber:b.flexOpportunityId,verticalFilter:b.hasOwnProperty("situation")?b.situation:null,transactionID:confirmationTranId||null,vertical:e.site.vertical}})}})}function d(b){var c=a("#confirmation-template").html();if(c.length){var d=_.template(c),e=d(b);a("#confirmation").html(e)}}var e=window.meerkat,f=e.modules.events;e.logging.info;e.modules.register("homeloanConfirmation",{init:c})}(jQuery),function(a,b){function c(){m.on("click",function(a){var b=n.modules.journeyEngine.isCurrentStepValid();b&&g()}),k.on("change",function(){"P"===k.val()?l.addClass("show_Y").removeClass("show_N").removeClass("show_"):l.addClass("show_N").removeClass("show_Y").removeClass("show_")}),a("#homeloan_enquiry_contact_firstName, #homeloan_enquiry_contact_lastName").on("change",function(){n.modules.contentPopulation.render(".journeyEngineSlide:eq(2) .snapshot")}),i.on("change",function(){a("#homeloan_enquiry_newLoan_foundAProperty_Y").is(":checked")?j.addClass("show_Y").removeClass("show_N").removeClass("show_"):(j.addClass("show_N").removeClass("show_Y").removeClass("show_"),a("#homeloan_enquiry_newLoan_offerTime").val(""),a("#homeloan_enquiry_newLoan_propertyType").val(""))}),n.messaging.subscribe(o.WEBAPP_LOCK,e),n.messaging.subscribe(o.WEBAPP_UNLOCK,f)}function d(){a(document).ready(function(){m=a("#submit_btn"),k=a("#homeloan_enquiry_contact_bestContact"),l=a("#homeloan_enquiry_contact_bestcontactToggleArea"),i=a("#homeloan_enquiry_newLoan_foundAProperty"),j=a("#homeloan_enquiry_newLoan_foundToggleArea"),c(),k.trigger("change"),i.trigger("change")})}function e(b){var c="undefined"!=typeof b&&b.source&&"homeloanEnquiry"===b.source,d="undefined"!=typeof b&&b.disableFields&&b.disableFields===!0;if(m.addClass("disabled"),d===!0){var e=a("#enquiryForm");e.find(":input").prop("disabled",!0),e.find(".select").addClass("disabled"),e.find(".btn-group label").addClass("disabled")}c===!0&&n.modules.loadingAnimation.showAfter(m)}function f(b){m.removeClass("disabled"),n.modules.loadingAnimation.hide(m);var c=a("#enquiryForm");c.find(":input").prop("disabled",!1),c.find(".select").removeClass("disabled"),c.find(".btn-group label").removeClass("disabled")}function g(){if(p===!0)return void alert("This page is still being processed. Please wait.");p=!0;var a=n.modules.journeyEngine.getFormData();n.messaging.publish(q.WEBAPP_LOCK,{source:"homeloanEnquiry",disableFields:!0}),n.modules.comms.post({url:"ajax/json/homeloan_submit.jsp",data:a,cache:!1,useDefaultErrorHandling:!1,errorLevel:"fatal",timeout:75e3,onSuccess:function(a){if(p=!1,a.hasOwnProperty("confirmationkey")===!1)return void h(!1,"","Missing confirmationkey",!1,a);n.messaging.publish(o.tracking.EXTERNAL,{method:"trackQuoteForms",object:n.modules.homeloan.getTrackingFieldsObject});var b=a.confirmationkey;n.modules.leavePageWarning.disable(),window.location.href="viewConfirmation?key="+encodeURI(b)},onError:h,onComplete:function(){p=!1}})}function h(a,b,c,d,e){p=!1,n.messaging.publish(q.WEBAPP_UNLOCK,{source:"homeloanEnquiry"}),n.modules.errorHandling.error({message:"An error occurred when attempting to submit your enquiry.",page:"homeloanEnquiry.js:submitEnquiry()",errorLevel:"warning",description:"Ajax request to homeloan/opportunity/apply.json failed to return a valid response: "+c,data:e})}var i,j,k,l,m,n=window.meerkat,o=n.modules.events,p=(n.logging.info,!1),q={WEBAPP_LOCK:"WEBAPP_LOCK",WEBAPP_UNLOCK:"WEBAPP_UNLOCK"};n.modules.register("homeloanEnquiry",{initHomeloanEnquiry:d})}(jQuery),function(a,b){function c(){d("value")}function d(b,c){var d=b||"value";q.find("[data-filter-type]").each(function(){var b=a(this),e=b.attr("data-filter-type"),f=b.attr("id"),g="";if("undefined"!=typeof f){if("radio"===e&&(g=b.find(":checked").val()||"",c!==!0&&("filter-interest-rate-type"==f?(a("#homeloan_filter_loanDetails_interestRate_P").prop("checked",a("#homeloan_loanDetails_interestRate_P").is(":checked")),a("#homeloan_filter_loanDetails_interestRate_I").prop("checked",a("#homeloan_loanDetails_interestRate_I").is(":checked")),a("input[name=homeloan_filter_loanDetails_interestRate]:checked").change(),g=a("input[name=homeloan_filter_loanDetails_interestRate]:checked").val()):"filter-repaymentFrequency"==f&&(a("#homeloan_filter_results_repaymentFrequency_weekly").prop("checked","Y"===a("#homeloan_results_frequency_weekly").val()),a("#homeloan_filter_results_repaymentFrequency_fortnightly").prop("checked","Y"===a("#homeloan_results_frequency_fortnightly").val()),a("#homeloan_filter_results_repaymentFrequency_monthly").prop("checked","Y"===a("#homeloan_results_frequency_monthly").val()),a("input[name=homeloan_filter_results_repaymentFrequency]:checked").change(),g=a("input[name=homeloan_filter_results_repaymentFrequency]:checked").val()))),"select"===e&&(g=b.find(":selected").val()||"",c!==!0&&"filter-loan-term"==f&&(g=a("#homeloan_results_loanTerm").val())),"checkbox"===e){c!==!0&&("filter-loan-type"==f?(a("#homeloan_filter_loanDetails_productFixed").prop("checked",a("#homeloan_loanDetails_productFixed").prop("checked")).change(),a("#homeloan_filter_loanDetails_productVariable").prop("checked",a("#homeloan_loanDetails_productVariable").prop("checked")).change(),a("#homeloan_filter_loanDetails_productLineOfCredit").prop("checked","Y"===a("#homeloan_loanDetails_productLineOfCredit").val()).change(),a("#homeloan_filter_loanDetails_productLowIntroductoryRate").prop("checked","Y"===a("#homeloan_loanDetails_productLowIntroductoryRate").val()).change()):"filter-fees"==f?(a("#homeloan_filter_fees_noApplication").prop("checked","Y"===a("#homeloan_fees_noApplication").val()).change(),a("#homeloan_filter_fees_noOngoing").prop("checked","Y"===a("#homeloan_fees_noOngoing").val()).change()):"filter-features"==f&&(a("#homeloan_filter_features_redraw").prop("checked","Y"===a("#homeloan_features_redraw").val()).change(),a("#homeloan_filter_features_offset").prop("checked","Y"===a("#homeloan_features_offset").val()).change(),a("#homeloan_filter_features_bpay").prop("checked","Y"===a("#homeloan_features_bpay").val()).change(),a("#homeloan_filter_features_onlineBanking").prop("checked","Y"===a("#homeloan_features_onlineBanking").val()).change(),a("#homeloan_filter_features_extraRepayments").prop("checked","Y"===a("#homeloan_features_extraRepayments").val()).change()));var h=[];h=b.find("[type=checkbox]:checked").map(function(){return this.value}),g=h.get().join(x)}"text"===e&&(c!==!0?"filter-loan-amount"==f&&(g=a("#homeloan_loanDetails_loanAmountentry").val(),b.find("input[type=text]").val(g)):g=b.find("input[type=text]").val()),w.hasOwnProperty(f)||(w[f]={}),w[f].type=e,w[f][d]=g}}),v("readFilterValues",c===!0?"readOnlyFromFilters":"!readOnlyFromFilters",_.extend({},w))}function e(){var b,c;for(c in w)if(w.hasOwnProperty(c))switch(b=w[c].value,w[c].type){case"radio":""===b?q.find("#"+c+" input").prop("checked",!1).change():q.find("#"+c+' input[value="'+b+'"]').prop("checked",!0).change();break;case"select":q.find("#"+c+" select").val(b);break;case"text":q.find("#"+c+" input").val(b);break;case"checkbox":if(q.find("#"+c+" input[type=checkbox]").prop("checked",!1),b.length)for(var d=b.split(","),e=0;e<d.length;e++)switch(c){case"filter-loan-type":a("#homeloan_filter_loanDetails_product"+d[e]).prop("checked",!0);break;case"filter-features":a("#homeloan_filter_features_"+d[e]).prop("checked",!0);break;case"filter-fees":a("#homeloan_filter_fees_"+d[e]).prop("checked",!0)}}}function f(){q.addClass("is-saved"),_.defer(function(){var b,c,e,f=!1;d("valueNew",!0);for(e in w)if(w.hasOwnProperty(e)&&w[e].value!==w[e].valueNew&&a("#"+e).attr("data-filter-serverside")){f=!0;break}for(e in w)if(w.hasOwnProperty(e)&&(b=w[e].value,c=w[e].valueNew,b!==c)){var g,h;switch(e){case"filter-loan-amount":var k=a("#homeloan_loanDetails_loanAmountentry");k.val(c),a("#homeloan_loanDetails_loanAmount").val(k.asNumber());break;case"filter-loan-term":a("#homeloan_results_loanTerm").val(c);break;case"filter-interest-rate-type":a("input[name=homeloan_loanDetails_interestRate]").prop("checked",!1).change(),a("#homeloan_loanDetails_interestRate_"+c).prop("checked",!0).change();break;case"filter-repaymentFrequency":a("input[id^=homeloan_results_frequency_]").val(""),a("#homeloan_results_frequency_"+c).val("Y"),""!==c&&Results.setFrequency(c,!1);break;case"filter-fees":case"filter-features":var l="filter-fees"==e?"fees":"features";if(j(a("input[id^=homeloan_"+l+"]")),g=c.split(x),g.length)for(h=0;h<g.length;h++)a("#homeloan_"+l+"_"+g[h]).val("Y");break;case"filter-loan-type":if(j(a("input[id^=homeloan_loanDetails_product]")),g=c.split(x),g.length)for(h=0;h<g.length;h++){var m=a("#homeloan_loanDetails_product"+g[h]);"checkbox"==m.attr("type")?m.prop("checked",!0):m.val("Y")}}}i(),t.messaging.publish(B.CHANGED),f?_.defer(function(){t.modules.journeyEngine.loadingShow("...updating your quotes...",!0),_.delay(function(){t.modules.homeloanResults.get()},100)}):Results.applyFiltersAndSorts()})}function g(){o.hasClass("open")===!1&&o.find(".activator").dropdown("toggle")}function h(){q=a(".filters-component"),q.on("click.filters",".btn-save",f).on("click.filters",".btn-cancel",i),a("#homeloan_filter_loanDetails_loanAmount").each(t.modules.currencyField.initSingleCurrencyField),z&&(q.on("change.checkedForIE",".checkbox input, .compareCheckbox input",function(){var b=a(this);b.is(":checked")?b.addClass("checked"):b.removeClass("checked")}),q.find(".checkbox input").change(),t.modules.ie8SelectMenuAutoExpand.bindEvents(q,"#homeloan_filter_results_loanTerm"))}function i(){o.hasClass("open")&&o.find(".activator").dropdown("toggle"),y!==!1&&(t.modules.navMenu.close(),t.modules.dialogs.close(y))}function j(b){b.each(function(){var b=a(this);"checkbox"==b.attr("type")?b.prop("checked",!1):b.val("")})}function k(){q.hasClass("is-saved")?q.removeClass("is-saved"):e(),y=!1,t.modules.navMenu.close(),q.off("click.filters",".btn-save"),q.off("click.filters",".btn-cancel"),q.find(":checkbox").removeClass("has-error"),q.find(".alert").remove()}function l(){a(document).ready(function(){return"homeloan"!==t.site.vertical||"confirmation"===t.site.pageAction?!1:(z=t.modules.performanceProfiling.isIE8(),m(),void n())})}function m(){o=a("#filters-dropdown"),p=a("#filters-modal"),s=a("#filters-container");var b=a("#filters-template");b.length>0&&(templateCallback=_.template(b.html()),r=templateCallback()),"xs"!==t.modules.deviceMediaState.get()&&s.empty().html(r),o.on("show.bs.dropdown",function(){h(),c()}).on("hidden.bs.dropdown",function(){k()}),p.on("click",function(a){a.preventDefault();var b={htmlContent:r,hashId:"filters",closeOnHashChange:!0,leftBtn:{label:"Back",icon:"",className:"btn-sm btn-close-dialog",callback:k},rightBtn:{label:"Save Changes",icon:"",className:"btn-sm",callback:f},onOpen:function(){h(),q.find(".btn-cancel, .btn-save").addClass("hidden"),c()}};y=t.modules.dialogs.show(b)})}function n(){t.messaging.subscribe(u.WEBAPP_LOCK,function(a){i(),o.children(".activator").addClass("inactive").addClass("disabled")}),t.messaging.subscribe(u.WEBAPP_UNLOCK,function(a){o.children(".activator").removeClass("inactive").removeClass("disabled")}),t.messaging.subscribe(u.device.STATE_ENTER_XS,function(){o.hasClass("open")&&(t.modules.homeloanFilters.close(),t.modules.navMenu.close()),s.empty()}),t.messaging.subscribe(u.device.STATE_LEAVE_XS,function(){y!==!1&&t.modules.homeloanFilters.close(),s.empty().html(r)})}var o,p,q,r,s,t=window.meerkat,u=t.modules.events,v=t.logging.info,w={},x=",",y=!1,z=!1,A={homeloanFilters:{CHANGED:"HOMELOAN_FILTERS_CHANGED"}},B=A.homeloanFilters;t.modules.register("homeloanFilters",{initFilters:l,events:A,open:g,close:i})}(jQuery),function(a,b){function c(){var b={container:m,modalOptions:{className:"modal-breakpoint-wide modal-tight bridgingContainer",openOnHashChange:!1,leftBtn:{label:"All Products",icon:'<span class="icon icon-arrow-left"></span>',callback:function(b){a(b.currentTarget).closest(".modal").modal("hide")}}},runDisplayMethod:e,onBeforeShowBridgingPage:null,onBeforeShowTemplate:null,onBeforeShowModal:i,onAfterShowModal:j,onAfterShowTemplate:null,onBeforeHideTemplate:null,onAfterHideTemplate:null,onClickApplyNow:h,onBeforeApply:null,onApplySuccess:null,retrieveExternalCopy:g,additionalTrackingData:{verticalFilter:k.modules.homeloan.getVerticalFilter()}};k.modules.moreInfo.initMoreInfo(b),f(),d()}function d(){a(document.body).on("click",".btn-apply",h)}function e(a){k.modules.moreInfo.showModal(),k.modules.address.appendToHash("moreinfo")}function f(){k.messaging.subscribe(l.device.STATE_ENTER_XS,function(){k.modules.moreInfo.isModalOpen()&&k.modules.moreInfo.close()}),k.messaging.subscribe(l.device.STATE_LEAVE_XS,function(){k.modules.moreInfo.isModalOpen()&&k.modules.moreInfo.close()})}function g(b){return a.Deferred(function(a){return k.modules.moreInfo.setDataResult(b),a.resolveWith(this,[]).promise()})}function h(){Results.model.setSelectedProduct(a(".btn-apply").attr("data-productId")),k.modules.homeloan.trackHandover(),k.modules.journeyEngine.gotoPath("next")}function i(a){var b={additionalTrackingData:{productName:a.lenderProductName}};k.modules.moreInfo.updateSettings(b)}function j(){k.messaging.publish(l.tracking.EXTERNAL,{method:"trackQuoteForms",object:_.bind(k.modules.homeloan.getTrackingFieldsObject,this,!0)})}var k=window.meerkat,l=k.modules.events,m=a(".bridgingContainer"),n={homeloanMoreInfo:{}};n.homeloanMoreInfo;k.modules.register("homeloanMoreInfo",{initMoreInfo:c,events:n,runDisplayMethod:e})}(jQuery),function(a){function b(){d(),Features.init(),v.modules.compare.initCompare({callbacks:{switchMode:function(a){switch(a){case"features":p(!0);break;case"price":o(!0)}}}}),e(),g()}function c(){g(),u!==v.modules.deviceMediaState.get()&&(Results.view.calculateResultsContainerWidth(),Features.clearSetHeights(),Features.balanceVisibleRowsHeight()),Results.pagination.refresh()}function d(){try{var a="price";"undefined"!=typeof v.site&&"undefined"!=typeof v.site.resultOptions&&(a="features"==v.site.resultOptions.displayMode?"features":"price"),Results.init({url:"ajax/json/homeloan_results.jsp",runShowResultsPage:!1,paths:{results:{rootElement:"responseData",list:"responseData.searchResults",general:"responseData.totalCount"},price:{monthly:"monthlyRepayments"},rate:"intrRate",availability:{product:"productAvailable",price:{monthly:"monthly"}},productId:"id",productBrandCode:"brandCode",productName:"lenderProductName"},show:{topResult:!1,savings:!1,featuresCategories:!1,nonAvailableProducts:!1,unavailableCombined:!0},availability:{product:["equals","Y"],price:["equals",!0]},render:{templateEngine:"_",features:{mode:"populate",headers:!1,numberOfXSColumns:1},dockCompareBar:!1},displayMode:a,pagination:{mode:"page",touchEnabled:Modernizr.touch},sort:{sortBy:!1},frequency:"monthly",animation:{results:{individual:{active:!1},delay:500,options:{easing:"swing",duration:0}},shuffle:{active:!1,options:{easing:"swing",duration:0}},filter:{active:!1,reposition:{options:{duration:0,easing:"swing"}},appear:{options:{duration:0}},disappear:{options:{duration:0}}}},elements:{features:{values:".content",extras:".children"}},templates:{pagination:{pageText:"Product {{=currentPage}} of {{=totalPages}}"}},dictionary:{valueMap:[{key:"Y",value:"<span class='icon icon-tick'></span>"},{key:"N",value:"<span class='icon icon-cross'></span>"}]},rankings:{paths:{rank_productId:"id",rank_premium:"monthlyRepayments"},filterUnavailableProducts:!1},incrementTransactionId:!1})}catch(b){Results.onError("Sorry, an error occurred initialising page","results.tag","meerkat.modules.homeloanResults.initResults(); "+b.message,b)}}function e(){a(document.body).on("click",".btn-enquire-now",q),a(Results.settings.elements.resultsContainer).on("click",".result-row",r),v.messaging.subscribe(w.affix.AFFIXED,function(){a("#resultsPage").css("margin-top","37px")}),v.messaging.subscribe(w.affix.UNAFFIXED,function(){a("#resultsPage").css("margin-top","0")}),v.messaging.subscribe(w.homeloanFilters.CHANGED,function(a){Results.settings.incrementTransactionId=!0,v.modules.session.poke()}),v.messaging.subscribe(x.RESULTS_ERROR,function(){_.delay(function(){v.modules.journeyEngine.gotoPath("previous")},1e3)}),v.messaging.subscribe(Results.model.moduleEvents.RESULTS_MODEL_UPDATE_BEFORE_FILTERSHOW,function(){Results.model.returnedProducts=f(Results.model.returnedProducts),Results.model.sortedProducts=Results.model.returnedProducts}),a(Results.settings.elements.resultsContainer).on("featuresDisplayMode",function(){Features.buildHtml()}),a(Results.settings.elements.resultsContainer).on("noFilteredResults",function(){Results.view.show()}),a(Results.settings.elements.resultsContainer).on("noResults",function(){m()}),a(document).on("resultsLoaded",l),a(document).on("resultsReturned",function(){v.modules.utils.scrollPageTo(a("header")),a(".morePromptContainer, .comparison-rate-disclaimer").removeClass("hidden"),a(".featuresHeaders .expandable.expanded").removeClass("expanded").addClass("collapsed")}),a(document).on("resultsFetchStart",function(){v.modules.journeyEngine.loadingShow("getting your quotes"),a("#resultsPage, .loadingDisclaimerText").removeClass("hidden"),Results.pagination.hide()}),a(document).on("resultsFetchFinish",function(){a(Results.settings.elements.page).show(),v.modules.journeyEngine.loadingHide(),a(".loadingDisclaimerText").addClass("hidden"),"price"!==Results.getDisplayMode()?Results.pagination.show():a(document.body).removeClass("priceMode").addClass("priceMode")}),a(document).on("populateFeaturesStart",function(){v.modules.performanceProfiling.startTest("results")}),a(Results.settings.elements.resultsContainer).on("populateFeaturesEnd",function(){var a,b=v.modules.performanceProfiling.endTest("results");a=800>b?v.modules.performanceProfiling.PERFORMANCE.HIGH:8e3>b&&v.modules.performanceProfiling.isIE8()===!1?v.modules.performanceProfiling.PERFORMANCE.MEDIUM:v.modules.performanceProfiling.PERFORMANCE.LOW,Results.setPerformanceMode(a)}),a(document).on("FeaturesRendered",function(){a(Features.target+" .expandable > "+Results.settings.elements.features.values).on("mouseenter",function(){var b=a(this).attr("data-featureId"),c=a(Features.target+' [data-featureId="'+b+'"]');c.addClass(Results.settings.elements.features.expandableHover.replace(/[#\.]/g,""))}).on("mouseleave",function(){var b=a(this).attr("data-featureId"),c=a(Features.target+' [data-featureId="'+b+'"]');c.removeClass(Results.settings.elements.features.expandableHover.replace(/[#\.]/g,""))})})}function f(a){return _.isArray(a)&&a.length>0&&_.isArray(a[0])?a=[{productAvailable:"N"}]:_.each(a,function(a,b){_.each(a,function(b,c,d){b===!0?a[c]="Y":b===!1&&(a[c]="N")}),a.productAvailable="Y",a.brandCode=a.lender,a.productId=a.id,a.formatted={intrRate:Number(a.intrRate).toFixed(2)+"%",comparRate:Number(a.comparRate).toFixed(2)+"%",appFees:v.modules.currencyField.formatCurrency(a.appFees).replace("$0.00","$0"),settlFees:v.modules.currencyField.formatCurrency(a.settlFees).replace("$0.00","$0"),ongoingFees:v.modules.currencyField.formatCurrency(a.ongoingFees).replace("$0.00","$0"),repayments:{monthly:v.modules.currencyField.formatCurrency(a.monthlyRepayments,{roundToDecimalPlace:0}),fortnightly:v.modules.currencyField.formatCurrency(a.fortnightlyRepayments).replace(".00",""),weekly:v.modules.currencyField.formatCurrency(a.weeklyRepayments).replace(".00","")}},a.formatted.repayments.monthlyFull=a.formatted.repayments.monthly+" monthly",a.formatted.repayments.fortnightlyFull=a.formatted.repayments.fortnightly+" fortnightly",a.formatted.repayments.weeklyFull=a.formatted.repayments.weekly+" weekly",a.ongoingFees>0&&(a.formatted.ongoingFees=a.formatted.ongoingFees+" "+a.ongoingFeesCycle)}),a}function g(){h(),v.messaging.subscribe(w.device.STATE_ENTER_XS,function(){"results"===v.modules.journeyEngine.getCurrentStep().navigationId&&h()}),v.messaging.subscribe(w.device.STATE_LEAVE_XS,function(){i(),Results.pagination.setCurrentPageNumber(1),Results.pagination.resync()})}function h(){"xs"===v.modules.deviceMediaState.get()&&"features"===Results.getDisplayMode()&&(Results.view.startColumnWidthTracking(a(window),Results.settings.render.features.numberOfXSColumns,!1),Results.pagination.setCurrentPageNumber(1),Results.pagination.resync())}function i(){Results.view.stopColumnWidthTracking()}function j(){u=v.modules.deviceMediaState.get()}function k(){a("#homeloan_results_pageNumber").val("1"),Results.get()}function l(){switch(h(),Results.getDisplayMode()){case"features":p(!1);break;default:y=!0,o(!1)}}function m(){v.modules.dialogs.show({htmlContent:a("#no-results-content")[0].outerHTML})}function n(){v.messaging.publish(w.resultsTracking.TRACK_QUOTE_RESULTS_LIST,{additionalData:{loadMoreResultsPageNumber:"1"},onAfterEventMode:"Load"})}function o(b){"undefined"==typeof b&&(b=!0),null!==Results.getDisplayMode()&&"price"!==Results.getDisplayMode()&&(Results.pagination.hide(),a("header .xs-results-pagination").addClass("hidden"),Results.setDisplayMode("price"),i(),a(document.body).addClass("priceMode"),a(window).scrollTop(0),b&&(v.modules.resultsTracking.setResultsEventMode("Refresh"),n()))}function p(b){if("undefined"==typeof b&&(b=!0),null!==Results.getDisplayMode()&&"features"!==Results.getDisplayMode()){var c=y===!0;Results.setDisplayMode("features",c),h(),_.defer(function(){Results.pagination.gotoPage(1),"xs"===v.modules.deviceMediaState.get()&&Results.view.setColumnWidth(a(window),Results.settings.render.features.numberOfXSColumns,!1),Results.pagination.setupNativeScroll()}),Results.pagination.show(!0),a("header .xs-results-pagination").removeClass("hidden"),y=!1,a(document.body).removeClass("priceMode"),a(window).scrollTop(0),b&&n()}}function q(b){b.preventDefault();var c=a(b.target).closest("a[data-productId]");c.attr("data-productId")&&Results.setSelectedProduct(c.attr("data-productId")),v.modules.homeloan.trackHandover(),v.modules.journeyEngine.gotoPath("next",c)}function r(b){if(a(Results.settings.elements.resultsContainer).hasClass("priceMode")!==!1&&"xs"===v.modules.deviceMediaState.get()){var c=a(b.target);c.hasClass("result-row")===!1&&(c=c.parents(".result-row")),"undefined"!=typeof c.attr("data-available")&&"Y"===c.attr("data-available")&&(v.modules.moreInfo.setProduct(Results.getResult("productId",c.attr("data-productId"))),Results.model.setSelectedProduct(c.attr("data-productId")),v.modules.homeloanMoreInfo.runDisplayMethod())}}function s(){t=a("#resultsPage"),v.messaging.subscribe(w.RESULTS_RANKING_READY,n),v.messaging.subscribe(w.compare.AFTER_ENTER_COMPARE_MODE,function(){a(".slide-feature-filters, .slide-feature-filters a").addClass("inactive disabled")}),v.messaging.subscribe(w.compare.EXIT_COMPARE,function(){a(".slide-feature-filters, .slide-feature-filters a").removeClass("inactive disabled")})}var t,u,v=window.meerkat,w=v.modules.events,x=(v.logging.info,{RESULTS_ERROR:"RESULTS_ERROR",RESULTS_REMAINING_PRODUCTS:"HOMELOAN_RESULTS_REMAINING_PRODUCTS"}),y=!1;v.modules.register("homeloanResults",{init:s,initPage:b,events:x,onReturnToPage:c,get:k,stopColumnWidthTracking:i,recordPreviousBreakpoint:j,switchToPriceMode:o,switchToFeaturesMode:p,showNoResults:m,publishExtraSuperTagEvents:n,massageResultsObject:f})}(jQuery),function(a,b){function c(){a(document).ready(d)}function d(){k=a('[data-provide="results-load-more"]'),0!==k.length&&(m=a("#homeloan_results_pageNumber"),l=k.find(".results-load-more-activator"),0===l.length?l=!1:l.on("click.resultsLoadMore",e),n.messaging.subscribe(n.modules.homeloanResults.events.RESULTS_REMAINING_PRODUCTS,function(a){_.isNumber(a)&&a>0?j():i()}))}function e(){n.modules.loadingAnimation.showInside(k,!0),l!==!1&&l.hide(),m.val(parseInt(m.val(),10)+1),n.modules.comms.post({url:Results.settings.url,data:n.modules.form.getData(a(Results.settings.formSelector)),dataType:"json",cache:!1,errorLevel:"warning"}).fail(f).done(g).always(h)}function f(){m.val(parseInt(m.val(),10)-1)}function g(b){Results.model.updateTransactionIdFromResult(b),Results.model.triggerEventsFromResult(b);var c=Object.byString(b,Results.settings.paths.results.list);if("undefined"!=typeof c){var d=Results.model.sortedProducts.length;Results.model.sortedProducts=c,n.modules.homeloanResults.massageResultsObject(Results.model.sortedProducts);var e={};_.each(c,function(a,b){Results.model.returnedProducts.push(a),Results.model.filteredProducts.push(a),e[d]={productID:a.id,ranking:d,productName:a.lenderProductName,productBrandCode:a.brandCode,available:"Y"},d++}),n.messaging.publish(o.resultsTracking.TRACK_QUOTE_RESULTS_LIST,{additionalData:{products:e,loadMoreResultsPageNumber:m.val(),event:"Refresh"},onAfterEventMode:"Load"});var f=a(Results.settings.elements.resultsContainer+" "+Results.settings.elements.resultsOverflow),g=f.outerHeight(!0),h="auto";Results.view.buildHtml(),Results.model.sortedProducts=Results.model.filteredProducts;var i=0;a.each(Results.model.sortedProducts,function(b,c){a(".result_"+c.id).addClass("notfiltered").attr("data-position",i).attr("id","result-row-"+b).attr("data-sort",b),i++}),h=f.outerHeight(!0),f.css({height:g,overflow:"hidden"}),f.animate({height:h},2e3,function(){f.css("height","auto")})}}function h(){n.modules.loadingAnimation.hide(k),l!==!1&&l.show()}function i(){k.addClass("hidden")}function j(){k.removeClass("hidden");
}var k,l,m,n=window.meerkat,o=n.modules.events;n.logging.info;n.modules.register("homeloanResultsLoadMore",{init:c,onStart:e,onComplete:h,hide:i,show:j})}(jQuery),function(a,b){function c(){g=a(".snapshotGoal"),h=a(".product-snapshot"),a("#homeloan_enquiry_contact_firstName, #homeloan_enquiry_contact_lastName").on("change",e)}function d(){e(),f()}function e(){var b='<p>Looking to <span data-source="#homeloan_details_goal"></span>';"E"===a("#homeloan_details_situation").val()&&(b+=a("#homeloan_details_currentLoan_Y").is(":checked")?" with an existing loan":" with no existing loan",b+=' and property worth <span data-source="#homeloan_details_assetAmountentry"></span>'),b+='. Looking to borrow <span data-source="#homeloan_loanDetails_loanAmountentry"></span>.',g.html(b),i.modules.contentPopulation.render(".journeyEngineSlide:eq(2) .snapshot")}function f(){var b=Results.getSelectedProduct();if(b!==!1){var c=a("#snapshot-template").html(),d=_.template(c),e=d(b);h.html(e)}else h.empty()}var g,h,i=window.meerkat,j=(i.modules.events,i.logging.info,{homeloanSnapshot:{}});j.example;i.modules.register("homeloanSnapshot",{initHomeloanSnapshot:c,events:j,renderSnapshot:e,onEnter:d})}(jQuery),function(a,b){function c(){a(document.body).on("click",".btn-view-brands",f),k.on("change",function(){a(this).is(":checked")?(h.attr("required","required").valid(),i.attr("required","required").valid(),j.attr("required","required").valid()):(h.removeAttr("required").valid(),i.removeAttr("required").valid(),j.removeAttr("required").valid())}),l.on("change",function(){var a=[],b=m.val();m.val(""),"E"===l.val()?(a=[{code:"APL",label:"Buy another property to live in"},{code:"IP",label:"Buy an investment property"},{code:"REP",label:"Renovate my existing property"},{code:"CD",label:"Consolidate my debt"},{code:"CL",label:"Compare better home loan options"}],d(u,!0)):(a=[{code:"FH",label:"Buy my first home"},{code:"IP",label:"Buy an investment property"}],d(u,!1),r.val(""),s.val(""),$propertyWorth.val(""),$propertyWorthHidden.val(""));for(var c=[],e='<option id="homeloan_details_goal_" value="">Please choose...</option>',f=0;f<a.length;f++)e+='<option id="homeloan_details_goal_'+a[f].code+'" value="'+a[f].code+'">'+a[f].label+"</option>",c.push(a[f].code);m.html(e),b&&-1!=c.indexOf(b)&&m.val(b).change();var h=g();h.navigationId+="-iAm-"+l.val(),w.modules.sessionCamHelper.updateVirtualPage(h)}),""!==l.val()&&l.change(),m.on("change",function(){var b=a(this).val(),c=a("#homeloan_details_currentLoan_Y").is(":checked");"CD"==b||"CL"==b?(r.val(""),s.val(""),d(t,!1),d(v,!1),o.val(""),p.val("")):"FH"===b||"APL"===b||"IP"===b?(c&&d(t,!0),d(v,!0)):(c&&d(t,!0),d(v,!1),o.val(""),p.val(""));var e=g();e.navigationId+="-iAm-"+l.val()+"-lookingTo-"+m.val(),w.modules.sessionCamHelper.updateVirtualPage(e)}),n.on("change",function(){a("#homeloan_details_currentLoan_Y").is(":checked")&&"CD"!=m.val()&&"CL"!=m.val()?d(t,!0):d(t,!1),r.val(""),s.val("");var b=g();b.navigationId+="-iAm-"+l.val()+"-lookingTo-"+m.val()+"-currentLoan-"+n.val(),w.modules.sessionCamHelper.updateVirtualPage(b)}),o.on("blur.hmlValidate",function(){0!==q.val().length&&_.delay(function(){q.isValid(!0)},250)})}function d(a,b){b?a.addClass("show_Y").removeClass("show_N show_"):a.addClass("show_N").removeClass("show_Y show_")}function e(){a(document).ready(function(){h=a("#homeloan_contact_firstName"),i=a("#homeloan_contact_lastName"),j=a("#homeloan_contact_email"),k=a("#homeloan_contact_optIn"),l=a("#homeloan_details_situation"),m=a("#homeloan_details_goal"),n=a('input:radio[name="homeloan_details_currentLoan"]'),o=a("#homeloan_loanDetails_purchasePriceentry"),p=a("#homeloan_loanDetails_purchasePrice"),q=a("#homeloan_loanDetails_loanAmountentry"),r=a("#homeloan_details_amountOwingentry"),s=a("#homeloan_details_amountOwing"),$propertyWorth=a("#homeloan_details_assetAmountentry"),$propertyWorthHidden=a("#homeloan_details_assetAmount"),t=a("#homeloan_details_currentLoanToggleArea"),u=a(".homeloan_details_existingToggleArea"),v=a(".homeloan_loanDetails_purchasePriceToggleArea"),h.removeAttr("required"),i.removeAttr("required"),j.removeAttr("required"),c()})}function f(b){var c=_.template(a("#brands-template").html()),d={};d.pretext="<h2>Our Home Loan Lender Panel</h2><p>We can help you find a loan to suit your needs. With access to over 1,300 home loan products from 29 of Australia's reputable lenders, finding a tailored loan to suit your needs has never been so easy.</p>";var e=c(d);w.modules.dialogs.show({title:a(this).attr("title"),htmlContent:e,hashId:"brands",closeOnHashChange:!0,openOnHashChange:!1});return!1}function g(){return null==x&&(x=w.modules.journeyEngine.getCurrentStep()),_.extend({},x)}var h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w=window.meerkat,x=(w.modules.events,w.logging.info,null);w.modules.register("homeloanStart",{init:e})}(jQuery);
//# sourceMappingURL=homeloan.modules.ctm.min.map