/*!
 * CTM-Platform v0.8.3
 * Copyright 2015 Compare The Market Pty Ltd
 * http://www.comparethemarket.com.au/
 */


!function(a,b){function c(b){C=a.extend(!0,{},B,b),C.enabled!==!1&&jQuery(document).ready(function(a){d(),e()})}function d(){D.length&&D.off("click",".clt-action").on("click",".clt-action",function(b){var c=a(this),d=c.attr("data-clt-index");if(s("[coverleveltabs] click",d),""!==d&&C.activeTabIndex!==d&&"undefined"!=typeof C.activeTabSet[d]&&"function"==typeof C.activeTabSet[d].filter){var e=Results.settings.animation.filter.active;C.disableAnimationsBetweenTabs===!0&&(Results.settings.animation.filter.active=!1),C.activeTabSet[d].filter(),c.siblings().removeClass("active").end().addClass("active"),C.activeTabIndex=d,m(C.activeTabSet[d].rankingFilter),q.messaging.publish(u.CHANGE_COVER_TAB,{activeTab:n()}),C.disableAnimationsBetweenTabs===!0&&(Results.settings.animation.filter.active=e);var f={recordRanking:"Y"},g=-1!==x.indexOf(n());if(g&&(f.recordRanking="N",f.products=[]),y||(A=[]),A.push(n()),q.modules.resultsRankings.resetTrackingProductObject(),q.messaging.publish(r.resultsTracking.TRACK_QUOTE_RESULTS_LIST,{additionalData:f,onAfterEventMode:"Refresh"}),!g&&x.length){var h=q.modules.resultsRankings.getWriteRankData(Results.settings.rankings,q.modules.resultsRankings.fetchProductsToRank(!0));q.modules.resultsRankings.sendQuoteRanking("Cover Level Tabs",h)}g||x.push(n()),q.modules.utils.scrollPageTo("html body",350,0,function(){q.modules.journeyEngine.sessionCamRecorder({navigationId:"CoverLevel"+n()})})}})}function e(){q.messaging.subscribe(Results.model.moduleEvents.RESULTS_BEFORE_DATA_READY,f)}function f(){s("[coverleveltabs] Setup"),h(),g()}function g(){a(".clt-action:visible.active").click()}function h(){if("undefined"!=typeof C.activeTabSet){s("[coverleveltabs] buildTabs",C.activeTabSet);for(var a=C.activeTabSet.length,b=parseInt(12/a,10),c=q.modules.deviceMediaState.get(),d="",e=0;a>e;e++){var f=C.activeTabSet[e],g=v[f.rankingFilter]||null;d+='<div class="col-xs-'+b+" text-center clt-action "+(f.defaultTab===!0?"active":"")+'" data-clt-index="'+e+'">',d+=f.label+("xs"!==c&&f.showCount===!0&&null!==g?" ("+g+")":""),d+="</div>",f.defaultTab===!0&&(z=C.verticalMapping[f.rankingFilter])}E.empty().html(d)}}function i(){return z}function j(){var a="default";if(C.enabled){a="";for(var b="",c=0;c<A.length;c++)a+=b+C.verticalMapping[A[c]],b=","}return a}function k(a){s("[coverleveltabs] activeTabSet",a),C.activeTabSet=a}function l(a){"undefined"==typeof v[a]&&(v[a]=0),v[a]++}function m(a){w=a}function n(){return w}function o(){return C.enabled||!1}function p(a){s("[coverleveltabs] resetView"),E.empty(),x=[],C.activeTabIndex=!1,k(a),v={}}var q=window.meerkat,r=q.modules.events,s=q.logging.info,t={coverLevelTabs:{CHANGE_COVER_TAB:"CHANGE_COVER_TAB"}},u=t.coverLevelTabs,v={},w="default",x=[],y=!1,z="default",A=[],B={enabled:!0,verticalMapping:{},activeTabIndex:!1,disableAnimationsBetweenTabs:!0,activeTabSet:[{label:"Comprehensive",rankingFilter:"C",defaultTab:!0,showCount:!0,filter:function(a){}}]},C={},D=a(".coverLevelTabs"),E=a(".currentTabsContainer");q.modules.register("coverLevelTabs",{initCoverLevelTabs:c,events:t,setActiveTabSet:k,resetView:p,getRankingFilter:n,isEnabled:o,incrementCount:l,getOriginatingTab:i,getDepartingTabJourney:j})}(jQuery),function(a,b){function c(){a(document).ready(function(){i=a("#travel_dates_toDate"),j=a("#travel_dates_fromDate_button"),k=a("#travel_dates_fromDate"),l=a("#travel_dates_toDate_button").trigger("click"),m=a("#travel_adults"),i=a("#travel_dates_toDate"),n=a("input[name=travel_policyType]"),o.modules.travelYourCover.initTravelCover(),d();var b=null;o.site.isFromBrochureSite===!0?b=r.detailsStep.navigationId:((o.site.journeyStage.length>0&&"amend"===o.site.pageAction||"load"===o.site.pageAction)&&(o.modules.journeyEngine.loadingShow("retrieving your quote information"),o.modules.travelReloadQuote.loadQuote()),"latest"===o.site.pageAction&&(o.modules.form.markInitialFieldsWithValue(a("#mainform")),b=r.resultsStep.navigationId)),o.modules.journeyEngine.configure({startStepId:b,steps:_.toArray(r)});var c=o.modules.transactionId.get();o.messaging.publish(p.tracking.EXTERNAL,{method:"trackQuoteEvent",object:{action:"Start",transactionID:c,verticalFilter:o.modules.travel.getVerticalFilter()}}),o.site.isNewQuote===!1&&o.messaging.publish(p.tracking.EXTERNAL,{method:"trackQuoteEvent",object:{action:"Retrieve",transactionID:c}});var e=a("#more-info-template");e.length>0&&(h=_.template(e.html()))})}function d(){var b={title:"Travel Details",navigationId:"start",slideIndex:0,externalTracking:{method:"trackQuoteForms",object:o.modules.travel.getTrackingFieldsObject},onInitialise:function(b){o.modules.splitTest.isActive([5,6])&&a("#travel_location").on("blur",function(){o.modules.travelContactDetails.setLocation(a(this).val())}),n.is(":checked")&&o.messaging.publish(q.traveldetails.COVER_TYPE_CHANGE),n.on("change",function(a){o.messaging.publish(q.traveldetails.COVER_TYPE_CHANGE)}),a("#travel_dates_fromDateInputD, #travel_dates_fromDateInputM, #travel_dates_fromDateInputY").focus(function(){i.datepicker("hide"),j.trigger("click")}),a("#travel_dates_toDateInputD, #travel_dates_toDateInputM, #travel_dates_toDateInputY").focus(function(){k.datepicker("hide"),l.trigger("click")}),m.focus(function(){i.datepicker("hide")})},onBeforeEnter:function(a){},onBeforeLeave:function(a){}},c={title:"Results",navigationId:"results",slideIndex:1,externalTracking:{method:"trackQuoteForms",object:o.modules.travel.getTrackingFieldsObject},onInitialise:function(a){o.modules.travelResults.initPage(),o.modules.travelSummaryText.initSummaryText(),o.modules.travelMoreInfo.initMoreInfo(),o.modules.showMoreQuotesPrompt.initPromptBar(),o.modules.travelSorting.initSorting(),o.modules.partnerTransfer.initTransfer(),o.modules.travelCoverLevelTabs.initTravelCoverLevelTabs()},onBeforeEnter:function(b){o.modules.resultsTracking.setResultsEventMode("Load"),a("#resultsPage").addClass("hidden"),o.modules.travelSummaryText.updateText(),o.modules.travelSorting.resetToDefaultSort(),o.modules.travelCoverLevelTabs.updateSettings()},onAfterEnter:function(a){o.modules.travelResults.get()},onAfterLeave:function(a){a.isBackward&&o.modules.showMoreQuotesPrompt.disablePromptBar()}};r={detailsStep:b,resultsStep:c}}function e(){var b=null;return n.is(":checked")&&(b="S"==a("input[name=travel_policyType]:checked").val()?"Single Trip":"Multi Trip"),b}function f(){try{var b="Y"===a("input[name=travel_marketing]:checked","#mainform").val()?"Y":"N",c=o.modules.transactionId.get(),d=o.modules.journeyEngine.getCurrentStepIndex(),e=o.modules.journeyEngine.getFurtherestStepIndex(),f=a("input[name=travel_policyType]:checked").val(),h=a("#travel_email").val(),i="",j="",k="",l=null,m="";switch(d){case 0:m="travel details";break;case 1:m="travel results"}o.modules.moreInfo.isModalOpen()&&(m="travel more info"),"S"==f?(i=a("#travel_destination").val(),j="Single Trip",k=g(a("#travel_dates_fromDate").val()),l=g(a("#travel_dates_toDate").val())):(j="Annual Policy",i="Multi-Trip",k=g(new Date));var n={vertical:o.site.vertical,actionStep:m,transactionID:c,quoteReferenceNumber:c,email:h,emailID:null,marketOptIn:b,verticalFilter:o.modules.travel.getVerticalFilter()};return e>o.modules.journeyEngine.getStepIndex("start")&&_.extend(n,{email:h,destinationCountry:i,travelInsuranceType:j,marketOptIn:b,leaveDate:k,returnDate:l,adults:a("#travel_adults").val(),children:a("#travel_children").val(),oldest:a("#travel_oldest").val()}),n}catch(p){return!1}}function g(a){if("string"==typeof a){var b=a.split("/");a=new Date(b[2],b[1],b[0])}var c=a.getMonth()+1,d=a.getDate();return(10>d?"0":"")+d+"/"+(10>c?"0":"")+c+"/"+a.getFullYear()}var h,i,j,k,l,m,n,o=window.meerkat,p=o.modules.events,q={traveldetails:{COVER_TYPE_CHANGE:"COVER_TYPE_CHANGE"},WEBAPP_LOCK:"WEBAPP_LOCK",WEBAPP_UNLOCK:"WEBAPP_UNLOCK"},r=null;o.modules.register("travel",{init:c,events:q,getTrackingFieldsObject:f,getVerticalFilter:e})}(jQuery),function(a,b){function c(){l.modules.splitTest.isActive(7)||k.on("change",function(){a(this).is(":checked")?(h.attr("required","required").valid(),d()):h.removeAttr("required").valid()}),h.on("blur",function(){d()})}function d(){l.modules.splitTest.isActive([5,6])&&k.is(":checked")&&h.valid()&&(h.val().trim().length>0?i.slideDown():i.slideUp())}function e(b){if(f(b)){var c=a.trim(String(b)),d=c.split(" "),e=d.pop(),g=d.pop(),h=d.join(" ");a("#travel_state").val(e),a("#travel_postcode").val(g).trigger("change"),a("#travel_suburb").val(h)}}function f(b){var c=new RegExp(/^((\s)*([^~,])+\s+)+\d{4}((\s)+(ACT|NSW|QLD|TAS|SA|NT|VIC|WA)(\s)*)$/);return value=a.trim(String(b)),""!==value&&value.match(c)?!0:!1}function g(){a(document).ready(function(){h=a("#travel_email"),k=a("#travel_marketing"),i=a(".postcodeDetails"),j=i.find("#travel_location"),l.modules.splitTest.isActive(7)||h.removeAttr("required"),c()})}var h,i,j,k,l=window.meerkat;l.modules.events,l.logging.info;l.modules.register("travelContactDetails",{init:g,setLocation:e})}(jQuery),function(a,b){function c(a){for(var b=window.countrySelectionList.isoLocations,c=0;c<b.length;c++)if(b[c].isoCode==a)return b[c].countryName}function d(){a(document).ready(function(){i=a("#travel_destinations"),j=a("#travel_unknownDestinations"),f(),e()})}function e(){if(l.site.countrySelectionDefaults&&l.site.countrySelectionDefaults.length)for(var a=l.site.countrySelectionDefaults.split(","),b=l.modules.selectTags.getListElement(i),d=0;d<a.length;d++)if(a[d].length){var e=c(a[d]),f=e.length>25?e.substr(0,20)+"...":e;l.modules.selectTags.appendToTagList(b,f,e,a[d]),i.val("")}}function f(){i.on("keydown",function(b){13==b.which?(a(".tt-suggestion:first-child").trigger("click"),i.focus()):i.data("ttView").datasets[0].valueKey="countryName"}).on("typeahead:opened",function(){n={},i.val("")}).on("typeahead:selected",function(b,c,d){n=c;var e=l.modules.selectTags.getListElement(a(this));if("undefined"!=typeof c.countryName&&!l.modules.selectTags.isAlreadySelected(e,c.isoCode)){k=c.countryName;var f=k.length>25?k.substr(0,20)+"...":k;l.modules.selectTags.appendToTagList(e,f,c.countryName,c.isoCode)}o=!1}).on("click focus",function(b){i.data("ttView").datasets[0].valueKey="id",i.val("").typeahead("setQuery","1").val(""),a(".tt-hint").hide()}).on("blur",function(a){i.val(""),n||i.typeahead("setQuery","").val("")}).attr("placeholder","Please type in your destination")}function g(){var a=countrySelectionList.countries;if("object"==typeof a&&a.length)for(var b=0;b<a.length;b++)a[b].id="1";else a=[];return a}function h(b){var c=l.modules.performanceProfiling.isIE11()?[]:g(),d=b.attr("data-source-url"),e=(-1==d.indexOf("?")?"?":"&")+"transactionId="+l.modules.transactionId.get(),f=l.modules.selectTags.getListElement(b);return{cache:!0,name:b.attr("name"),valueKey:"id",template:function(a){var b=l.modules.selectTags.isAlreadySelected(f,a.isoCode);return b&&"0000"!=a.isoCode?"<del class='selected'>"+a.countryName+"</del>":("0000"==a.isoCode&&j.val(j.val()+(j.val().length?",":"")+i.data("ttView").inputView.query),"<p>"+a.countryName+"</p>")},local:c,remote:{maxParallelRequests:1,rateLimitWait:500,beforeSend:function(a,c){return 1==i.data("ttView").inputView.getQuery()?(a.abort(),!1):(c.url=c.url.replace(/\btransactionId\b[=]\d+/g,"transactionId="+l.modules.transactionId.get()),void l.modules.autocomplete.autocompleteBeforeSend(b))},filter:function(c){l.modules.autocomplete.autocompleteComplete(b);var d=c.isoLocations;return d.length?a.map(d,function(a){return{id:1,isoCode:a.isoCode,countryName:a.countryName}}):[{id:1,isoCode:"0000",countryName:"Sorry, we could not find that location..."}]},url:d+"%QUERY"+e,error:function(a,c){o||(l.modules.errorHandling.error({page:"travelCountrySelector.js",errorLevel:"silent",title:"An error occurred...",message:"Sorry, an error occurred while finding the country you are looking for. Please try again or reload the page.",description:"Could not complete lookup: "+c,data:a}),l.modules.session.poke(),o=!0),l.modules.autocomplete.autocompleteComplete(b)}},limit:300}}var i,j,k,l=window.meerkat,m=(l.modules.events,l.logging.info,{travelCountrySelector:{}}),n=(m.travelCountrySelector,{}),o=!1;l.modules.register("travelCountrySelector",{init:d,events:m,getCountrySelectorParams:h})}(jQuery),function(a,b){function c(){if(h.modules.splitTest.isActive([2,3,4,83])){e();var b={enabled:!0,tabCount:3,activeTabSet:f(),hasMultipleTabTypes:!0,verticalMapping:d()};h.modules.coverLevelTabs.initCoverLevelTabs(b),a(document).ready(function(){h.messaging.subscribe(i.coverLevelTabs.CHANGE_COVER_TAB,function(a){"D"==a.activeTab?h.modules.showMoreQuotesPrompt.disableForCoverLevelTabs():h.modules.showMoreQuotesPrompt.resetForCoverLevelTabs()})})}}function d(){return{DEFAULT:"DEFAULT",C:"Comprehensive",M:"Mid Range",B:"Basic",I:"International",D:"Domestic"}}function e(){k[0].defaultTab=!1,k[1].defaultTab=!1,k[2].defaultTab=!1,h.modules.splitTest.isActive(2)?k[0].defaultTab=!0:h.modules.splitTest.isActive([3,83])?k[1].defaultTab=!0:h.modules.splitTest.isActive(4)&&(k[2].defaultTab=!0)}function f(){switch(a("input[name=travel_policyType]:checked").val()){case"A":return l;case"S":return k}}function g(){h.modules.coverLevelTabs.isEnabled()&&h.modules.coverLevelTabs.resetView(f())}var h=window.meerkat,i=h.modules.events,j=(h.logging.info,{travelCoverLevelTabs:{}}),k=(j.travelCoverLevelTabs,[{label:"Comprehensive <span class='hidden-xs'>Cover</span>",rankingFilter:"C",defaultTab:!0,disableAnimationsBetweenTabs:!0,showCount:!0,filter:function(){Results.filterBy("coverLevel","value",{equals:"C"},!0)}},{label:"Mid Range <span class='hidden-xs'>Cover</span>",rankingFilter:"M",defaultTab:!1,showCount:!0,filter:function(){Results.filterBy("coverLevel","value",{equals:"M"},!0)}},{label:"Basic <span class='hidden-xs'>Cover</span>",rankingFilter:"B",showCount:!0,defaultTab:!1,filter:function(){Results.filterBy("coverLevel","value",{equals:"B"},!0)}}]),l=[{label:"International <span class='hidden-xs'>Cover</span>",rankingFilter:"I",defaultTab:!0,showCount:!0,filter:function(){Results.filterBy("coverLevel","value",{equals:"I"},!0)}},{label:"Domestic <span class='hidden-xs'>Cover</span>",rankingFilter:"D",defaultTab:!1,showCount:!0,filter:function(){Results.filterBy("coverLevel","value",{equals:"D"},!0)}}];h.modules.register("travelCoverLevelTabs",{initTravelCoverLevelTabs:c,events:j,updateSettings:g})}(jQuery),function(a,b){"use strict";function c(a,b){function c(a){return 10>a?"0"+a:a}"undefined"==typeof b&&(b=!1);var d=new Date(a);return b?[d.getFullYear(),c(d.getMonth()+1),c(d.getDate())].join("-"):[c(d.getDate()),c(d.getMonth()+1),d.getFullYear()].join("/")}function d(){m=t,n=new Date(m.toString()),n.setYear(parseInt(n.getFullYear())+1),q=t,r=new Date(q.toString()),r.setYear(parseInt(r.getFullYear())+1)}function e(){d(),j.datepicker({startDate:m,endDate:n}),j.siblings(".dateinput-nativePicker").find("input").attr("min",c(m,!0)).attr("max",c(n,!0)),k.datepicker({startDate:q,endDate:r}),k.siblings(".dateinput-nativePicker").find("input").attr("min",c(q,!0)).attr("max",c(r,!0))}function f(){l=j.datepicker("getDate"),"Invalid Date"!==l.toString()&&(q=new Date(l.toString()),r=new Date(q.toString()),r.setYear(parseInt(r.getFullYear())+1),k.datepicker("setStartDate",q).datepicker("setEndDate",r),k.siblings(".dateinput-nativePicker").find("input").attr("min",c(q,!0)).attr("max",c(r,!0)),k.rules("remove","maxDateEUR"),k.rules("add",{maxDateEUR:c(r),messages:{maxDateEUR:"The return date should be equal to or before one year after the departure date (i.e. "+c(r)+")"}}))}function g(){l=j.datepicker("getDate"),p=k.datepicker("getDate"),o=new Date(l.toString()),o.setYear(parseInt(o.getFullYear())+1),p>o&&(s.modules.formDateInput.populate(k,c(o)),k.datepicker("update",o))}function h(){j.on("hide serialised.meerkat.formDateInput",function(){g(),f()}),k.on("hide serialised.meerkat.formDateInput",function(){j.blur()})}function i(){a(document).ready(function(){j=a("#travel_dates_fromDate"),k=a("#travel_dates_toDate"),j.datepicker({orientation:"top right",numberOfMonths:2}),k.datepicker({orientation:"top right",numberOfMonths:2}),e(),h()})}var j,k,l,m,n,o,p,q,r,s=window.meerkat,t=(s.modules.events,s.logging.info,new Date);s.modules.register("datesSelection",{init:i})}(jQuery),function(a,b){function c(){var b={container:o,modalOptions:{className:"modal-breakpoint-wide modal-tight bridgingContainer",openOnHashChange:!1,leftBtn:{label:"All Products",icon:'<span class="icon icon-arrow-left"></span>',callback:function(b){a(b.currentTarget).closest(".modal").modal("hide")}}},runDisplayMethod:e,onBeforeShowBridgingPage:null,onBeforeShowTemplate:null,onBeforeShowModal:g,onAfterShowModal:k,onAfterShowTemplate:null,onBeforeHideTemplate:null,onAfterHideTemplate:null,onClickApplyNow:j,onBeforeApply:null,onApplySuccess:null,retrieveExternalCopy:h};m.modules.moreInfo.initMoreInfo(b),f(),d()}function d(){}function e(a){m.modules.moreInfo.showModal(),m.modules.address.appendToHash("moreinfo")}function f(){m.messaging.subscribe(n.device.STATE_ENTER_XS,function(){m.modules.moreInfo.isModalOpen()&&m.modules.moreInfo.close()}),m.messaging.subscribe(n.device.STATE_LEAVE_XS,function(){m.modules.moreInfo.isModalOpen()&&m.modules.moreInfo.close()})}function g(a){var b={additionalTrackingData:{productBrandCode:a.provider,productName:a.name,verticalFilter:m.modules.travel.getVerticalFilter()}};m.modules.moreInfo.updateSettings(b)}function h(b){return a.Deferred(function(c){var d=[],e={},f=[];return f=i(b),a.each(b.info,function(c){""!==this.order&&(e[this.order]=c),-1==a.inArray(c,f)&&d.push([b.info[c].desc,c])}),b.sorting=m.modules.travelMoreInfo.arraySort(e,d),m.modules.moreInfo.setDataResult(b),c.resolveWith(this,[b]).promise()})}function i(b){var c=[];return"undefined"!=typeof b.exemptedBenefits&&a.each(b.exemptedBenefits,function(a){c.push(b.exemptedBenefits[a])}),c}function j(a,b){var c={product:a,applyNowCallback:b};m.modules.partnerTransfer.transferToPartner(c)}function k(){m.messaging.publish(n.tracking.EXTERNAL,{method:"trackQuoteForms",object:_.bind(m.modules.travel.getTrackingFieldsObject,this,!0)})}function l(b,c){var d=[];return b.length>0?(a.each(b,function(e){a.each(c,function(a){b[e]==c[a][1]&&d.push([c[a][0],c[a][1]])})}),d):(c.sort(),c)}var m=window.meerkat,n=m.modules.events,o=a(".bridgingContainer"),p={travelMoreInfo:{}};p.travelMoreInfo;m.modules.register("travelMoreInfo",{initMoreInfo:c,events:p,runDisplayMethod:e,arraySort:l})}(jQuery),function(a,b){function c(){}function d(){var a=f(window.location.search),b="vertical=travel&action=load&id="+a.id+"&hash="+a.hash+"&type="+a.type+"&vertical=TRAVEL&transactionId="+a.id;"undefined"==typeof g.modules.transactionId.get()&&g.modules.transactionId.set(a.id),g.modules.comms.post({url:"ajax/json/remote_load_quote.jsp",data:b,cache:!1,useDefaultErrorHandling:!1,errorLevel:"fatal",timeout:3e4,onError:e,onSuccess:function(a){g.modules.leavePageWarning.disable(),window.location=a.result.destUrl+"&ts="+Number(new Date)}})}function e(a,b,c,d,e){stateSubmitInProgress=!1,g.modules.errorHandling.error({message:"An error occurred when attempting to retrieve your quotes",page:"travelReloadQuote.js:loadQuote()",errorLevel:"warning",description:"Ajax request to remote_load_quote.jsp failed to return a valid response: "+c,data:e}),g.messaging.publish(h.WEBAPP_UNLOCK,{source:"loadQuote"})}function f(a){if(a.length>1){for(var b,c={},d=0,e=a.substr(1).split("&");d<e.length;d++)b=e[d].split("="),c[decodeURIComponent(b[0])]=b.length>1?decodeURIComponent(b[1]):"";return c}}var g=window.meerkat,h=g.modules.events;g.modules.register("travelReloadQuote",{init:c,loadQuote:d})}(jQuery),function(a){function b(){c(),e()}function c(){try{Results.init({url:"ajax/json/travel_quote_results.jsp",runShowResultsPage:!1,paths:{results:{list:"results.price"},productId:"productId",productName:"name",productBrandCode:"provider",coverLevel:"info.coverLevel",price:{premium:"price"},benefits:{cxdfee:"info.cxdfee.value",excess:"info.excess.value",medical:"info.medical.value",luggage:"info.luggage.value"},availability:{product:"available"}},show:{nonAvailableProducts:!1,unavailableCombined:!0},availability:{product:["equals","Y"]},render:{templateEngine:"_",dockCompareBar:!1},displayMode:"price",pagination:{touchEnabled:!1},sort:{sortBy:"price.premium",sortDir:"asc"},frequency:"premium",animation:{results:{individual:{active:!1},delay:500,options:{easing:"swing",duration:1e3}},shuffle:{active:!0,options:{easing:"swing",duration:1e3}},filter:{reposition:{options:{easing:"swing"}}}},rankings:{triggers:["RESULTS_DATA_READY"],callback:n.modules.travelResults.rankingCallback,forceIdNumeric:!1,filterUnavailableProducts:!0}})}catch(a){Results.onError("Sorry, an error occurred initialising page","results.tag","meerkat.modules.travelResults.initResults(); "+a.message,a)}}function d(b){var c=n.modules.travel.getVerticalFilter(),d=a("#travel_destination").val(),e=n.modules.coverLevelTabs.isEnabled();return _.each(b,function(a,b){if("object"==typeof a.info){var f=a.info;if("undefined"!=typeof f.luggage&&f.luggage.value<=0&&(f.luggage.text="$0"),"AUS"==d&&(f.medical.value=0,f.medical.text="N/A"),e===!0)if("Single Trip"==c){var g=5e6;"AUS"==d&&(g=0),f.excess.value<=250&&f.medical.value>=g&&f.cxdfee.value>=7500&&f.luggage.value>=7500?(f.coverLevel="C",n.modules.coverLevelTabs.incrementCount("C")):f.excess.value<=250&&f.medical.value>=g&&f.cxdfee.value>=2500&&f.luggage.value>=2500?(f.coverLevel="M",n.modules.coverLevelTabs.incrementCount("M")):(f.coverLevel="B",n.modules.coverLevelTabs.incrementCount("B"))}else-1==a.des.indexOf("Australia")?(f.coverLevel="I",n.modules.coverLevelTabs.incrementCount("I")):(f.coverLevel="D",n.modules.coverLevelTabs.incrementCount("D"))}}),b}function e(){n.messaging.subscribe(Results.model.moduleEvents.RESULTS_MODEL_UPDATE_BEFORE_FILTERSHOW,function(){Results.model.returnedProducts=d(Results.model.returnedProducts),Results.model.sortedProducts=Results.model.returnedProducts}),n.messaging.subscribe(o.affix.AFFIXED,function(){m.css("margin-top","8px")}),n.messaging.subscribe(o.affix.UNAFFIXED,function(){m.css("margin-top","0")}),a(Results.settings.elements.resultsContainer).on("noFilteredResults",function(){Results.view.show()}),n.messaging.subscribe(p.RESULTS_ERROR,function(){_.delay(function(){n.modules.journeyEngine.gotoPath("previous")},1e3)}),a(document).on("resultsReturned",function(){n.modules.utils.scrollPageTo(a("header")),a(".featuresHeaders .expandable.expanded").removeClass("expanded").addClass("collapsed")}),a(document).on("resultsFetchStart",function(){n.modules.journeyEngine.loadingShow("...getting your quotes..."),m.removeClass("hidden"),Results.pagination.hide()}),a(document).on("resultsFetchFinish",function(){a(Results.settings.elements.page).show(),n.modules.journeyEngine.loadingHide(),"price"!==Results.getDisplayMode()?Results.pagination.show():a(document.body).removeClass("priceMode").addClass("priceMode");var b=0;a.each(Results.model.returnedProducts,function(){"Y"===this.available&&"CURR"!==this.productId&&b++}),0!==b||Results.model.hasValidationErrors||(Results.model.isBlockedQuote?j():i())}),a(Results.settings.elements.resultsContainer).on("click",".result-row",g)}function f(a,b){var c={};return c["rank_premium"+b]=a.price,c["rank_productId"+b]=a.productId,"undefined"!=typeof a.info.coverLevel&&0===b&&(c["coverLevelType"+b]=a.info.coverLevel),_.isNumber(q)&&q>b&&(c["best_price"+b]=1,c["best_price_providerName"+b]=a.provider,c["best_price_productName"+b]=a.name,c["best_price_excess"+b]="undefined"!=typeof a.info.excess?a.info.excess.text:0,c["best_price_medical"+b]="undefined"!=typeof a.info.medical?a.info.medical.text:0,c["best_price_cxdfee"+b]="undefined"!=typeof a.info.cxdfee?a.info.cxdfee.text:0,c["best_price_luggage"+b]="undefined"!=typeof a.info.luggage?a.info.luggage.text:0,c["best_price_price"+b]=a.priceText,c["best_price_service"+b]=a.service,c["best_price_url"+b]=a.quoteUrl),_.isNumber(r)&&r>b&&b>=q&&(c["best_price"+b]=1,c["best_price_price"+b]=a.priceText),c}function g(b){if(a(Results.settings.elements.resultsContainer).hasClass("priceMode")!==!1&&"xs"===n.modules.deviceMediaState.get()){var c=a(b.target);c.hasClass("result-row")===!1&&(c=c.parents(".result-row")),"undefined"!=typeof c.attr("data-available")&&"Y"===c.attr("data-available")&&(n.modules.moreInfo.setProduct(Results.getResult("productId",c.attr("data-productId"))),n.modules.travelMoreInfo.runDisplayMethod())}}function h(){Results.get()}function i(){n.modules.dialogs.show({htmlContent:a("#no-results-content")[0].outerHTML})}function j(){n.modules.dialogs.show({htmlContent:a("#blocked-ip-address")[0].outerHTML})}function k(b){b="undefined"==typeof b?{}:b,n.messaging.publish(o.resultsTracking.TRACK_QUOTE_RESULTS_LIST,{additionalData:a.extend({sortBy:Results.getSortBy()+"-"+Results.getSortDir()},b),onAfterEventMode:"Refresh"})}function l(){a(document).ready(function(){m=a("#resultsPage"),n.modules.splitTest.isActive([2,3,4,83])||n.messaging.subscribe(o.RESULTS_RANKING_READY,k)})}var m,n=window.meerkat,o=n.modules.events,p=(n.logging.info,{RESULTS_ERROR:"RESULTS_ERROR"}),q=5,r=10;n.modules.register("travelResults",{init:l,initPage:b,get:h,showNoResults:i,rankingCallback:f,publishExtraSuperTagEvents:k})}(jQuery),function(a,b){function c(a){var b=a.attr("data-sort-type"),c=a.attr("data-sort-dir");if("undefined"!=typeof b&&"undefined"!=typeof c){b===Results.getSortBy()&&c===Results.getSortDir()&&(c="asc"===c?"desc":"asc",a.attr("data-sort-dir",c));var d=Results.sortBy(b,c);d?(h.parent("li").removeClass("active"),a.parent("li").addClass("active"),i.modules.resultsTracking.setResultsEventMode("Refresh"),i.modules.travelResults.publishExtraSuperTagEvents({products:[],recordRanking:"N"})):k("[travelSorting]","The sortBy or sortDir could not be set",setSortByReturn,setSortDirReturn)}else k("[travelSorting]","No data on sorting element")}function d(){i.messaging.subscribe(j.RESULTS_SORTED,function(a){i.messaging.publish(j.WEBAPP_UNLOCK)}),h.on("click",function(b){$clicked=a(b.target),$clicked.is("a")||($clicked=$clicked.closest("a")),$clicked.hasClass("disabled")||(i.messaging.publish(j.WEBAPP_LOCK),_.defer(function(){$clicked.parent().hasClass("active")||e($clicked),c($clicked)}))}),i.messaging.subscribe(j.WEBAPP_LOCK,function(a){h.addClass("inactive").addClass("disabled")}),i.messaging.subscribe(j.WEBAPP_UNLOCK,function(a){h.removeClass("inactive").removeClass("disabled")})}function e(a){var b=a.attr("data-sort-type");a.attr("data-sort-dir",l[b])}function f(){a(document).ready(function(){h=a("[data-sort-type]"),"undefined"==typeof Results&&i.logging.exception("[travelSorting]","No Results Object Found!")})}function g(){var b=a("[data-sort-type='price.premium']"),c=Results.getSortBy(),d="price.premium";(c!=d||"desc"==b.attr("data-sort-dir")&&c==d)&&(b.parent("li").siblings().removeClass("active").end().addClass("active").end().attr("data-sort-dir","asc"),Results.setSortBy("price.premium"),Results.setSortDir("asc"))}var h,i=window.meerkat,j=i.modules.events,k=(i.logging.info,i.logging.error),l={"benefits.excess":"asc","benefits.medical":"desc","benefits.cxdfee":"desc","benefits.luggage":"desc","price.premium":"asc"},m={travelSortings:{}};m.travelSorting;i.modules.register("travelSorting",{init:f,initSorting:d,events:m,resetToDefaultSort:g})}(jQuery),function(a){function b(){var b='<span class="highlight">',c=j.val(),d=k.val();if(b+=c+" adult"+(1==c?"":"s"),d>0&&(b+=" and "+d+" child"+(1==d?"":"ren")),"S"==a("input[name=travel_policyType]:checked").val()){m.html("Your quote is based on"),b+='</span> <span class="optional">travelling</span> <span class="sm-md-block">to <span class="highlight">',b+=1==n.children().length?n.find("li:first-child").data("fulltext"):"multiple destinations";var e=g.val().split("/"),i=h.val().split("/"),l=new Date(e[2],e[1]-1,e[0]),o=new Date(i[2],i[1]-1,i[0]),p=864e5,q=1+Math.ceil((o.getTime()-l.getTime())/p);b+="</span> for <span class='highlight'>"+q+" days</span>"}else{m.html("Your Annual Multi Trip (AMT) quote is based on");var r=d>1?"sm-md-block":"sm-block";b+="</span> travelling <span class='highlight "+r+"'>multiple times in one year"}f.html(b+"</span>").fadeIn()}function c(){f=a(".resultsSummaryPlaceholder"),g=a("#travel_dates_fromDate"),h=a("#travel_dates_toDate"),i=a("#travel_destinations_do_do"),j=a("#travel_adults"),k=a("#travel_children"),l=a("#travel_policyType"),m=a(".resultsSummaryContainer h5"),n=a(".selected-tags"),d()}function d(){o.messaging.subscribe(p.device.STATE_ENTER_SM,function(){"results"===o.modules.journeyEngine.getCurrentStep().navigationId&&b()}),o.messaging.subscribe(p.device.STATE_ENTER_MD,function(){"results"===o.modules.journeyEngine.getCurrentStep().navigationId&&b()})}function e(){}var f,g,h,i,j,k,l,m,n,o=window.meerkat,p=o.modules.events;o.logging.info;o.modules.register("travelSummaryText",{init:e,initSummaryText:c,updateText:b})}(jQuery),function(a,b){function c(){a(document.body).on("click",".btn-view-brands",e),g=a("#destinationsfs"),h=a("#datestravellersfs"),i=a("#travel_policyType_S"),j=a("#travel_policyType_A"),k=a("#travel_dates_fromDate_row"),l=a("#travel_dates_toDate_row"),m=a("#detailsForm"),n=a(".resultsContainer"),g.hide(),h.hide(),l.hide(),k.hide(),m.find(".well-chatty > .amt, .well-chatty > .single").hide(),o.messaging.subscribe(p.traveldetails.COVER_TYPE_CHANGE,f),d()}function d(){o.messaging.subscribe(p.device.STATE_ENTER_XS,function(){o.modules.dialogs.isDialogOpen(q)&&o.modules.dialogs.close(q)})}function e(b){var c=_.template(a("#brands-template").html());return q=o.modules.dialogs.show({title:a(this).attr("title"),hashId:"travel-brands",className:"travel-brands-modal",htmlContent:c(),closeOnHashChange:!0,openOnHashChange:!1}),!1}function f(){n.attr("policytype",a("input[name=travel_policyType]:checked").val()),o.modules.journeyEngine.sessionCamRecorder({navigationId:"PolicyType-"+a("input[name=travel_policyType]:checked").val()}),i.is(":checked")?(m.find(".well-info, .well-chatty > .single").show(),m.find(".well-chatty > .amt, .well-chatty > .default").hide(),g.slideDown(),h.slideDown(),k.slideDown(),l.slideDown(),h.find("h2").text("Dates & Travellers")):(m.find(".well-info, .well-chatty > .single, .well-chatty > .default").hide(),m.find(".well-chatty > .amt").show(),g.is(":visible")?(g.slideUp(),l.slideUp(),k.slideUp()):h.slideDown(),h.find("h2").text("Travellers"))}var g,h,i,j,k,l,m,n,o=window.meerkat,p=o.modules.events,q=(o.logging.info,null);o.modules.register("travelYourCover",{initTravelCover:c,toggleDetailsFields:f})}(jQuery);
//# sourceMappingURL=travel.modules.ctm.min.map