/*!
 * CTM-Platform v0.8.3
 * Copyright 2015 Compare The Market Pty Ltd
 * http://www.comparethemarket.com.au/
 */


!function(a){function b(b){B=a.extend(!0,{},A,b),B.enabled!==!1&&jQuery(document).ready(function(){c(),d()})}function c(){C.length&&C.off("click",".clt-action").on("click",".clt-action",function(){var b=a(this),c=b.attr("data-clt-index");if(r("[coverleveltabs] click",c),""!==c&&B.activeTabIndex!==c&&"undefined"!=typeof B.activeTabSet[c]&&"function"==typeof B.activeTabSet[c].filter){var d=Results.settings.animation.filter.active;B.disableAnimationsBetweenTabs===!0&&(Results.settings.animation.filter.active=!1),B.activeTabSet[c].filter(),b.siblings().removeClass("active").end().addClass("active"),B.activeTabIndex=c,l(B.activeTabSet[c].rankingFilter),p.messaging.publish(t.CHANGE_COVER_TAB,{activeTab:m()}),B.disableAnimationsBetweenTabs===!0&&(Results.settings.animation.filter.active=d);var e={recordRanking:"Y"},f=-1!==w.indexOf(m());if(f&&(e.recordRanking="N",e.products=[]),x||(z=[]),z.push(m()),p.modules.resultsRankings.resetTrackingProductObject(),p.messaging.publish(q.resultsTracking.TRACK_QUOTE_RESULTS_LIST,{additionalData:e,onAfterEventMode:"Refresh"}),!f&&w.length){var g=p.modules.resultsRankings.getWriteRankData(Results.settings.rankings,p.modules.resultsRankings.fetchProductsToRank(!0));p.modules.resultsRankings.sendQuoteRanking("Cover Level Tabs",g)}f||w.push(m()),p.modules.utilities.scrollPageTo("html body",350,0,function(){p.modules.journeyEngine.sessionCamRecorder({navigationId:"CoverLevel"+m()})})}})}function d(){p.messaging.subscribe(Results.model.moduleEvents.RESULTS_BEFORE_DATA_READY,e)}function e(){r("[coverleveltabs] Setup"),g(),f()}function f(){a(".clt-action:visible.active").click()}function g(){if("undefined"!=typeof B.activeTabSet){r("[coverleveltabs] buildTabs",B.activeTabSet);for(var a=B.activeTabSet.length,b=parseInt(12/a,10),c=p.modules.deviceMediaState.get(),d="",e=0;a>e;e++){var f=B.activeTabSet[e],g=u[f.rankingFilter]||null;d+='<div class="col-xs-'+b+" text-center clt-action "+(f.defaultTab===!0?"active":"")+'" data-clt-index="'+e+'">',d+=f.label+("xs"!==c&&f.showCount===!0&&null!==g?" ("+g+")":""),d+="</div>",f.defaultTab===!0&&(y=B.verticalMapping[f.rankingFilter])}D.empty().html(d)}}function h(){return y}function i(){var a="default";if(B.enabled){a="";for(var b="",c=0;c<z.length;c++)a+=b+B.verticalMapping[z[c]],b=","}return a}function j(a){r("[coverleveltabs] activeTabSet",a),B.activeTabSet=a}function k(a){"undefined"==typeof u[a]&&(u[a]=0),u[a]++}function l(a){v=a}function m(){return v}function n(){return B.enabled||!1}function o(a){r("[coverleveltabs] resetView"),D.empty(),w=[],B.activeTabIndex=!1,j(a),u={}}var p=window.meerkat,q=p.modules.events,r=p.logging.info,s={coverLevelTabs:{CHANGE_COVER_TAB:"CHANGE_COVER_TAB"}},t=s.coverLevelTabs,u={},v="default",w=[],x=!1,y="default",z=[],A={enabled:!0,verticalMapping:{},activeTabIndex:!1,disableAnimationsBetweenTabs:!0,activeTabSet:[{label:"Comprehensive",rankingFilter:"C",defaultTab:!0,showCount:!0,filter:function(){}}]},B={},C=a(".coverLevelTabs"),D=a(".currentTabsContainer");p.modules.register("coverLevelTabs",{initCoverLevelTabs:b,events:s,setActiveTabSet:j,resetView:o,getRankingFilter:m,isEnabled:n,incrementCount:k,getOriginatingTab:h,getDepartingTabJourney:i})}(jQuery),function(){function a(){e("[handoverCookieSetup]","Running the onready code"),"pro"!=c.site.environment&&"prelive"!=c.site.environment&&(e("[handoverCookieSetup]","_CtMH setting test options now"),_CtMH.setOpts({debug:c.site.showLogging,asTest:!0,endp:c.site.ctmh.fBase+"handover/confirm"})),e("[handoverCookieSetup]","_CtMH running start now"),_CtMH.start(c.modules.transactionId.get(),c.site.vertical)}function b(){e("[handoverCookieSetup]","Initialised"),c.messaging.subscribe(d.RESULTS_DATA_READY,function(){e("[handoverCookieSetup]","RESULTS_DATA_READY","Triggered"),"undefined"!=typeof _CtMH&&(e("[handoverCookieSetup]","_CtMH is defined"),_CtMH.onready(a()))}),c.messaging.subscribe(d.partnerTransfer.TRANSFER_TO_PARTNER,function(a){e("[handoverCookieSetup]","partnerTransfer.TRANSFER_TO_PARTNER","Triggered"),"undefined"!=typeof _CtMH&&_CtMH.add(a.transactionID,a.partnerID,a.productDescription)})}var c=window.meerkat,d=c.modules.events,e=c.logging.info;c.modules.register("handoverCookieSetup",{init:b})}(jQuery),function(a){function b(){a(document).ready(function(){h=a("#travel_dates_toDate"),i=a("#travel_dates_fromDate_button"),j=a("#travel_dates_fromDate"),k=a("#travel_dates_toDate_button").trigger("click"),l=a("#travel_adults"),h=a("#travel_dates_toDate"),$travel_destinations=a("#travel_destinations"),m=a("input[name=travel_policyType]"),n.modules.travelYourCover.initTravelCover(),c();var b=null;n.site.isFromBrochureSite===!0?b=q.detailsStep.navigationId:((n.site.journeyStage.length>0&&"amend"===n.site.pageAction||"load"===n.site.pageAction)&&(n.modules.journeyEngine.loadingShow("retrieving your quote information"),n.modules.travelReloadQuote.loadQuote()),"latest"===n.site.pageAction&&(n.modules.form.markInitialFieldsWithValue(a("#mainform")),b=q.resultsStep.navigationId)),n.modules.journeyEngine.configure({startStepId:b,steps:_.toArray(q)});var d=n.modules.transactionId.get();n.messaging.publish(o.tracking.EXTERNAL,{method:"trackQuoteEvent",object:{action:"Start",transactionID:d,verticalFilter:n.modules.travel.getVerticalFilter()}}),n.site.isNewQuote===!1&&n.messaging.publish(o.tracking.EXTERNAL,{method:"trackQuoteEvent",object:{action:"Retrieve",transactionID:d}});var e=a("#more-info-template");e.length>0&&(g=_.template(e.html()))})}function c(){var b={title:"Travel Details",navigationId:"start",slideIndex:0,externalTracking:{method:"trackQuoteForms",object:n.modules.travel.getTrackingFieldsObject},onInitialise:function(){var b=n.modules.tracking.getCurrentJourney();if("undefined"==typeof b||5!==b&&6!==b||a("#travel_location").on("blur",function(){n.modules.travelContactDetails.setLocation(a(this).val())}),m.is(":checked")&&n.messaging.publish(p.traveldetails.COVER_TYPE_CHANGE),m.on("change",function(){n.messaging.publish(p.traveldetails.COVER_TYPE_CHANGE)}),a("#travel_dates_fromDateInputD, #travel_dates_fromDateInputM, #travel_dates_fromDateInputY").focus(function(){h.datepicker("hide"),i.trigger("click")}),a("#travel_dates_toDateInputD, #travel_dates_toDateInputM, #travel_dates_toDateInputY").focus(function(){j.datepicker("hide"),k.trigger("click")}),l.focus(function(){h.datepicker("hide")}),n.site.countrySelectionDefaults.length)for(var c=n.site.countrySelectionDefaults.split(","),d=0;d<c.length;d++)c[d].length&&$travel_destinations.val(c[d]).change()},onBeforeEnter:function(){},onBeforeLeave:function(){}},c={title:"Results",navigationId:"results",slideIndex:1,externalTracking:{method:"trackQuoteForms",object:n.modules.travel.getTrackingFieldsObject},onInitialise:function(){n.modules.travelResults.initPage(),n.modules.travelSummaryText.initSummaryText(),n.modules.travelMoreInfo.initMoreInfo(),n.modules.travelMorePrompt.initTravelMorePrompt(),n.modules.travelSorting.initSorting(),n.modules.partnerTransfer.initTransfer(),n.modules.travelCoverLevelTabs.initTravelCoverLevelTabs()},onBeforeEnter:function(){n.modules.resultsTracking.setResultsEventMode("Load"),a("#resultsPage").addClass("hidden"),n.modules.travelSummaryText.updateText(),n.modules.travelSorting.resetToDefaultSort(),n.modules.travelCoverLevelTabs.updateSettings()},onAfterEnter:function(){n.modules.travelResults.get()},onAfterLeave:function(a){a.isBackward&&n.modules.travelMorePrompt.disablePromptBar()}};q={detailsStep:b,resultsStep:c}}function d(){var b=null;return m.is(":checked")&&(b="S"==a("input[name=travel_policyType]:checked").val()?"Single Trip":"Multi Trip"),b}function e(){try{var b=("Y"===a("input[name=travel_marketing]","#mainform").val()?"Y":"N","Y"===a("input[name=travel_marketing]:checked","#mainform").val()?"Y":"N"),c=n.modules.transactionId.get(),d=n.modules.journeyEngine.getCurrentStepIndex(),e=n.modules.journeyEngine.getFurtherestStepIndex(),g=a("input[name=travel_policyType]:checked").val(),h=a("#travel_email").val(),i="",j="",k="",l=null,m="";switch(d){case 0:m="travel details";break;case 1:m="travel results"}n.modules.moreInfo.isModalOpen()&&(m="travel more info"),"S"==g?(i=a("#travel_destination").val(),j="Single Trip",k=f(a("#travel_dates_fromDate").val()),l=f(a("#travel_dates_toDate").val())):(j="Annual Policy",i="Multi-Trip",k=f(new Date));var o={vertical:n.site.vertical,actionStep:m,transactionID:c,quoteReferenceNumber:c,email:h,emailID:null,marketOptIn:b,verticalFilter:n.modules.travel.getVerticalFilter()};return e>n.modules.journeyEngine.getStepIndex("start")&&_.extend(o,{email:h,destinationCountry:i,travelInsuranceType:j,marketOptIn:b,leaveDate:k,returnDate:l,adults:a("#travel_adults").val(),children:a("#travel_children").val(),oldest:a("#travel_oldest").val()}),o}catch(p){return!1}}function f(a){if("string"==typeof a){var b=a.split("/");a=new Date(b[2],b[1],b[0])}var c=a.getMonth()+1,d=a.getDate();return(10>d?"0":"")+d+"/"+(10>c?"0":"")+c+"/"+a.getFullYear()}var g,h,i,j,k,l,m,n=window.meerkat,o=n.modules.events,p={traveldetails:{COVER_TYPE_CHANGE:"COVER_TYPE_CHANGE"},WEBAPP_LOCK:"WEBAPP_LOCK",WEBAPP_UNLOCK:"WEBAPP_UNLOCK"},q=null;n.modules.register("travel",{init:b,events:p,getTrackingFieldsObject:e,getVerticalFilter:d})}(jQuery),function(a){function b(){7!=k&&j.on("change",function(){a(this).is(":checked")?(g.attr("required","required").valid(),c()):g.removeAttr("required").valid()}),g.on("blur",function(){c()})}function c(){(5==k||6==k)&&j.is(":checked")&&g.valid()&&(g.val().trim().length>0?h.slideDown():h.slideUp())}function d(b){if(e(b)){var c=a.trim(String(b)),d=c.split(" "),f=d.pop(),g=d.pop(),h=d.join(" ");a("#travel_state").val(f),a("#travel_postcode").val(g).trigger("change"),a("#travel_suburb").val(h)}}function e(b){var c=new RegExp(/^((\s)*([^~,])+\s+)+\d{4}((\s)+(ACT|NSW|QLD|TAS|SA|NT|VIC|WA)(\s)*)$/);return value=a.trim(String(b)),""!==value&&value.match(c)?!0:!1}function f(){a(document).ready(function(){g=a("#travel_email"),j=a("#travel_marketing"),h=a(".postcodeDetails"),i=h.find("#travel_location"),k=l.modules.tracking.getCurrentJourney(),7!=k&&g.removeAttr("required"),b()})}{var g,h,i,j,k,l=window.meerkat;l.modules.events,l.logging.info}l.modules.register("travelContactDetails",{init:f,setLocation:d})}(jQuery),function(a){function b(){var a=g.modules.tracking.getCurrentJourney();if(2==a||3==a||4==a){d(a);var b={enabled:!0,tabCount:3,activeTabSet:e(),hasMultipleTabTypes:!0,verticalMapping:c()};g.modules.coverLevelTabs.initCoverLevelTabs(b)}}function c(){return{DEFAULT:"DEFAULT",C:"Comprehensive",M:"Mid Range",B:"Basic",I:"International",D:"Domestic"}}function d(a){switch(i[0].defaultTab=!1,i[1].defaultTab=!1,i[2].defaultTab=!1,a){case"2":i[0].defaultTab=!0;break;case"3":i[1].defaultTab=!0;break;case"4":i[2].defaultTab=!0}}function e(){switch(a("input[name=travel_policyType]:checked").val()){case"A":return j;case"S":return i}}function f(){g.modules.coverLevelTabs.isEnabled()&&g.modules.coverLevelTabs.resetView(e())}var g=window.meerkat,h=(g.modules.events,g.logging.info,{travelCoverLevelTabs:{}}),i=(h.travelCoverLevelTabs,[{label:"Comprehensive <span class='hidden-xs'>Cover</span>",rankingFilter:"C",defaultTab:!0,disableAnimationsBetweenTabs:!0,showCount:!0,filter:function(){Results.filterBy("coverLevel","value",{equals:"C"},!0)}},{label:"Mid Range <span class='hidden-xs'>Cover</span>",rankingFilter:"M",defaultTab:!1,showCount:!0,filter:function(){Results.filterBy("coverLevel","value",{equals:"M"},!0)}},{label:"Basic <span class='hidden-xs'>Cover</span>",rankingFilter:"B",showCount:!0,defaultTab:!1,filter:function(){Results.filterBy("coverLevel","value",{equals:"B"},!0)}}]),j=[{label:"International <span class='hidden-xs'>Cover</span>",rankingFilter:"I",defaultTab:!0,showCount:!0,filter:function(){Results.filterBy("coverLevel","value",{equals:"I"},!0)}},{label:"Domestic <span class='hidden-xs'>Cover</span>",rankingFilter:"D",defaultTab:!1,showCount:!0,filter:function(){Results.filterBy("coverLevel","value",{equals:"D"},!0)}}];g.modules.register("travelCoverLevelTabs",{initTravelCoverLevelTabs:b,events:h,updateSettings:f})}(jQuery),function(a){"use strict";function b(a,b){function c(a){return 10>a?"0"+a:a}"undefined"==typeof b&&(b=!1);var d=new Date(a);return b?[d.getFullYear(),c(d.getMonth()+1),c(d.getDate())].join("-"):[c(d.getDate()),c(d.getMonth()+1),d.getFullYear()].join("/")}function c(){l=s,m=new Date(l.toString()),m.setYear(parseInt(m.getFullYear())+1),p=s,q=new Date(p.toString()),q.setYear(parseInt(q.getFullYear())+1)}function d(){c(),i.datepicker({startDate:l,endDate:m}),i.siblings(".dateinput-nativePicker").find("input").attr("min",b(l,!0)).attr("max",b(m,!0)),j.datepicker({startDate:p,endDate:q}),j.siblings(".dateinput-nativePicker").find("input").attr("min",b(p,!0)).attr("max",b(q,!0))}function e(){k=i.datepicker("getDate"),"Invalid Date"!==k.toString()&&(p=new Date(k.toString()),q=new Date(p.toString()),q.setYear(parseInt(q.getFullYear())+1),j.datepicker("setStartDate",p).datepicker("setEndDate",q),j.siblings(".dateinput-nativePicker").find("input").attr("min",b(p,!0)).attr("max",b(q,!0)),j.rules("remove","maxDateEUR"),j.rules("add",{maxDateEUR:b(q),messages:{maxDateEUR:"The return date should be equal to or before one year after the departure date (i.e. "+b(q)+")"}}))}function f(){k=i.datepicker("getDate"),o=j.datepicker("getDate"),n=new Date(k.toString()),n.setYear(parseInt(n.getFullYear())+1),o>n&&(r.modules.formDateInput.populate(j,b(n)),j.datepicker("update",n))}function g(){i.on("hide serialised.meerkat.formDateInput",function(){f(),e()}),j.on("hide serialised.meerkat.formDateInput",function(){i.blur()})}function h(){a(document).ready(function(){i=a("#travel_dates_fromDate"),j=a("#travel_dates_toDate"),i.datepicker({orientation:"top right"}),j.datepicker({orientation:"top right"}),d(),g()})}var i,j,k,l,m,n,o,p,q,r=window.meerkat,s=(r.modules.events,r.logging.info,new Date);r.modules.register("datesSelection",{init:h})}(jQuery),function(a){function b(){var b={container:n,modalOptions:{className:"modal-breakpoint-wide modal-tight bridgingContainer",openOnHashChange:!1,leftBtn:{label:"All Products",icon:'<span class="icon icon-arrow-left"></span>',callback:function(b){a(b.currentTarget).closest(".modal").modal("hide")}}},runDisplayMethod:d,onBeforeShowBridgingPage:null,onBeforeShowTemplate:null,onBeforeShowModal:f,onAfterShowModal:j,onAfterShowTemplate:null,onBeforeHideTemplate:null,onAfterHideTemplate:null,onClickApplyNow:i,onBeforeApply:null,onApplySuccess:null,retrieveExternalCopy:g};l.modules.moreInfo.initMoreInfo(b),e(),c()}function c(){}function d(){l.modules.moreInfo.showModal(),l.modules.address.appendToHash("moreinfo")}function e(){l.messaging.subscribe(m.device.STATE_ENTER_XS,function(){l.modules.moreInfo.isModalOpen()&&l.modules.moreInfo.close()}),l.messaging.subscribe(m.device.STATE_LEAVE_XS,function(){l.modules.moreInfo.isModalOpen()&&l.modules.moreInfo.close()})}function f(a){var b={additionalTrackingData:{productBrandCode:a.provider,productName:a.name,verticalFilter:l.modules.travel.getVerticalFilter()}};l.modules.moreInfo.updateSettings(b)}function g(b){return a.Deferred(function(c){var d=[],e={},f=[];return f=h(b),a.each(b.info,function(c){""!==this.order&&(e[this.order]=c),-1==a.inArray(c,f)&&d.push([b.info[c].desc,c])}),b.sorting=l.modules.travelMoreInfo.arraySort(e,d),l.modules.moreInfo.setDataResult(b),c.resolveWith(this,[b]).promise()})}function h(b){var c=[];return"undefined"!=typeof b.exemptedBenefits&&a.each(b.exemptedBenefits,function(a){c.push(b.exemptedBenefits[a])}),c}function i(a,b){var c={product:a,applyNowCallback:b};l.modules.partnerTransfer.transferToPartner(c)}function j(){l.messaging.publish(m.tracking.EXTERNAL,{method:"trackQuoteForms",object:_.bind(l.modules.travel.getTrackingFieldsObject,this,!0)})}function k(b,c){var d=[];return b.length>0?(a.each(b,function(e){a.each(c,function(a){b[e]==c[a][1]&&d.push([c[a][0],c[a][1]])})}),d):(c.sort(),c)}{var l=window.meerkat,m=l.modules.events,n=a(".bridgingContainer"),o={travelMoreInfo:{}};o.travelMoreInfo}l.modules.register("travelMoreInfo",{initMoreInfo:b,events:o,runDisplayMethod:d,arraySort:k})}(jQuery),function(a){function b(){u="bottom",w="xs"==p.modules.deviceMediaState.get(),a(document).ready(function(){r||c(),d(),g()})}function c(){k.fadeIn("slow"),r=!0,a(document.body).on("click",".morePromptLink",function(){var b=a("#footer"),c=0;"bottom"==u&&(c=b.offset().top-a(window).height()),f(),a("body,html").stop(!0,!0).animate({scrollTop:c},1e3,"linear")})}function d(){p.messaging.subscribe(q.device.STATE_CHANGE,function(){w="xs"==p.modules.deviceMediaState.get(),v||(g(),_.defer(e))}),"undefined"!=typeof q.coverLevelTabs&&p.messaging.subscribe(q.coverLevelTabs.CHANGE_COVER_TAB,function(a){"D"==a.activeTab?(k.hide(),v=!0):(f(),g(),k.removeAttr("style"),v=!1,e())}),a(document).on("results.view.animation.end",function(){f()}),p.messaging.subscribe(q.RESIZE_DEBOUNCED,function(){f()}),a(window).off("scroll.viewMorePrompt").on("scroll.viewMorePrompt",function(){e()})}function e(){if(!v&&"undefined"!=typeof o&&o.length){var b=a(document).height(),c=a(window).height(),d=o.offset().top+o.outerHeight(!0)+15,e=d-a(document).scrollTop(),f=b-(b-d),g=f-c;if(g<=a(this).scrollTop()){if(!w){var i=c-e;a(".morePromptLink").css("bottom",i+"px")}"top"!=u&&h("up")}else a(".morePromptLink").css("bottom",0),"bottom"!=u&&h("down")}}function f(){o=a("div.results-table .available.notfiltered").last()}function g(){_.defer(function(){f(),h("down"),k.removeAttr("style")})}function h(a){switch(a){case"up":u="top",n.html(t),m.removeClass("icon-angle-down").addClass("icon-angle-up");break;default:u="bottom",n.html(s),m.removeClass("icon-angle-up").addClass("icon-angle-down")}}function i(){a(window).off("scroll.viewMorePrompt"),k.hide()}function j(){k=a(".morePromptContainer"),l=a(".morePromptContainer"),m=k.find(".icon"),n=k.find(".morePromptLinkText"),p.messaging.subscribe(q.RESULTS_DATA_READY,function(){b()})}var k,l,m,n,o,p=window.meerkat,q=p.modules.events,r=!1,s="Go to Bottom",t="Go to Top",u="bottom",v=!1,w=!1;p.modules.register("travelMorePrompt",{initTravelMorePrompt:j,resetMorePromptBar:g,disablePromptBar:i})}(jQuery),function(){function a(){}function b(){var a=d(window.location.search),b="vertical=travel&action=load&id="+a.id+"&hash="+a.hash+"&type="+a.type+"&vertical=TRAVEL&transactionId="+a.id;"undefined"==typeof e.modules.transactionId.get()&&e.modules.transactionId.set(a.id),e.modules.comms.post({url:"ajax/json/remote_load_quote.jsp",data:b,cache:!1,useDefaultErrorHandling:!1,errorLevel:"fatal",timeout:3e4,onError:c,onSuccess:function(a){e.modules.leavePageWarning.disable(),window.location=a.result.destUrl+"&ts="+Number(new Date)}})}function c(a,b,c,d,g){stateSubmitInProgress=!1,e.modules.errorHandling.error({message:"An error occurred when attempting to retrieve your quotes",page:"travelReloadQuote.js:loadQuote()",errorLevel:"warning",description:"Ajax request to remote_load_quote.jsp failed to return a valid response: "+c,data:g}),e.messaging.publish(f.WEBAPP_UNLOCK,{source:"loadQuote"})}function d(a){if(a.length>1){for(var b,c={},d=0,e=a.substr(1).split("&");d<e.length;d++)b=e[d].split("="),c[decodeURIComponent(b[0])]=b.length>1?decodeURIComponent(b[1]):"";return c}}var e=window.meerkat,f=e.modules.events;e.modules.register("travelReloadQuote",{init:a,loadQuote:b})}(jQuery),function(a){function b(){c(),e()}function c(){try{Results.init({url:"ajax/json/travel_quote_results.jsp",runShowResultsPage:!1,paths:{results:{list:"results.price"},productId:"productId",productName:"name",productBrandCode:"provider",coverLevel:"info.coverLevel",price:{premium:"price"},benefits:{cxdfee:"info.cxdfee.value",excess:"info.excess.value",medical:"info.medical.value",luggage:"info.luggage.value"},availability:{product:"available"}},show:{nonAvailableProducts:!1,unavailableCombined:!0},availability:{product:["equals","Y"]},render:{templateEngine:"_",dockCompareBar:!1},displayMode:"price",pagination:{touchEnabled:!1},sort:{sortBy:"price.premium",sortDir:"asc"},frequency:"premium",animation:{results:{individual:{active:!1},delay:500,options:{easing:"swing",duration:1e3}},shuffle:{active:!0,options:{easing:"swing",duration:1e3}},filter:{reposition:{options:{easing:"swing"}}}},rankings:{triggers:["RESULTS_DATA_READY"],callback:m.modules.travelResults.rankingCallback,forceIdNumeric:!1,filterUnavailableProducts:!0}})}catch(a){Results.onError("Sorry, an error occurred initialising page","results.tag","meerkat.modules.travelResults.initResults(); "+a.message,a)}}function d(b){if(m.modules.coverLevelTabs.isEnabled()!==!0)return b;var c=m.modules.travel.getVerticalFilter();return _.each(b,function(b){if("object"==typeof b.info){var d=b.info;if("Single Trip"==c){var e=5e6,f=a("#travel_destinations").val();"AUS"==f&&(e=0),d.excess.value<=250&&d.medical.value>=e&&d.cxdfee.value>=7500&&d.luggage.value>=7500?(d.coverLevel="C",m.modules.coverLevelTabs.incrementCount("C")):d.excess.value<=250&&d.medical.value>=e&&d.cxdfee.value>=2500&&d.luggage.value>=2500?(d.coverLevel="M",m.modules.coverLevelTabs.incrementCount("M")):(d.coverLevel="B",m.modules.coverLevelTabs.incrementCount("B"))}else-1==b.des.indexOf("Australia")?(d.coverLevel="I",m.modules.coverLevelTabs.incrementCount("I")):(d.coverLevel="D",m.modules.coverLevelTabs.incrementCount("D"))}}),b}function e(){m.messaging.subscribe(Results.model.moduleEvents.RESULTS_MODEL_UPDATE_BEFORE_FILTERSHOW,function(){Results.model.returnedProducts=d(Results.model.returnedProducts),Results.model.sortedProducts=Results.model.returnedProducts}),m.messaging.subscribe(n.affix.AFFIXED,function(){l.css("margin-top","8px")}),m.messaging.subscribe(n.affix.UNAFFIXED,function(){l.css("margin-top","0")}),a(Results.settings.elements.resultsContainer).on("noFilteredResults",function(){Results.view.show()}),m.messaging.subscribe(o.RESULTS_ERROR,function(){_.delay(function(){m.modules.journeyEngine.gotoPath("previous")},1e3)}),a(document).on("resultsReturned",function(){m.modules.utilities.scrollPageTo(a("header")),a(".featuresHeaders .expandable.expanded").removeClass("expanded").addClass("collapsed")}),a(document).on("resultsFetchStart",function(){m.modules.journeyEngine.loadingShow("...getting your quotes..."),l.removeClass("hidden"),Results.pagination.hide()}),a(document).on("resultsFetchFinish",function(){a(Results.settings.elements.page).show(),m.modules.journeyEngine.loadingHide(),"price"!==Results.getDisplayMode()?Results.pagination.show():a(document.body).removeClass("priceMode").addClass("priceMode");var b=0;a.each(Results.model.returnedProducts,function(){"Y"===this.available&&"CURR"!==this.productId&&b++}),0!==b||Results.model.hasValidationErrors||i()}),a(Results.settings.elements.resultsContainer).on("click",".result-row",g)}function f(a,b){var c={};return c["rank_premium"+b]=a.price,c["rank_productId"+b]=a.productId,"undefined"!=typeof a.info.coverLevel&&0===b&&(c["coverLevelType"+b]=a.info.coverLevel),_.isNumber(p)&&p>b&&(c["best_price"+b]=1,c["best_price_providerName"+b]=a.provider,c["best_price_productName"+b]=a.name,c["best_price_excess"+b]="undefined"!=typeof a.info.excess?a.info.excess.text:0,c["best_price_medical"+b]="undefined"!=typeof a.info.medical?a.info.medical.text:0,c["best_price_cxdfee"+b]="undefined"!=typeof a.info.cxdfee?a.info.cxdfee.text:0,c["best_price_luggage"+b]="undefined"!=typeof a.info.luggage?a.info.luggage.text:0,c["best_price_price"+b]=a.priceText,c["best_price_service"+b]=a.service,c["best_price_url"+b]=a.quoteUrl),_.isNumber(q)&&q>b&&b>=p&&(c["best_price"+b]=1,c["best_price_price"+b]=a.priceText),c}function g(b){if(a(Results.settings.elements.resultsContainer).hasClass("priceMode")!==!1&&"xs"===m.modules.deviceMediaState.get()){var c=a(b.target);c.hasClass("result-row")===!1&&(c=c.parents(".result-row")),"undefined"!=typeof c.attr("data-available")&&"Y"===c.attr("data-available")&&(m.modules.moreInfo.setProduct(Results.getResult("productId",c.attr("data-productId"))),m.modules.travelMoreInfo.runDisplayMethod())}}function h(){Results.get()}function i(){m.modules.dialogs.show({htmlContent:a("#no-results-content")[0].outerHTML})}function j(b){b="undefined"==typeof b?{}:b,m.messaging.publish(n.resultsTracking.TRACK_QUOTE_RESULTS_LIST,{additionalData:a.extend({sortBy:Results.getSortBy()+"-"+Results.getSortDir()},b),onAfterEventMode:"Refresh"})}function k(){a(document).ready(function(){l=a("#resultsPage");var b=m.modules.tracking.getCurrentJourney();2!=b&&3!=b&&4!=b&&m.messaging.subscribe(n.RESULTS_RANKING_READY,j)})}var l,m=window.meerkat,n=m.modules.events,o=(m.logging.info,{RESULTS_ERROR:"RESULTS_ERROR"}),p=5,q=10;m.modules.register("travelResults",{init:k,initPage:b,get:h,showNoResults:i,rankingCallback:f,publishExtraSuperTagEvents:j})}(jQuery),function(a){function b(a){var b=a.attr("data-sort-type"),c=a.attr("data-sort-dir");if("undefined"!=typeof b&&"undefined"!=typeof c){b===Results.getSortBy()&&c===Results.getSortDir()&&(c="asc"===c?"desc":"asc",a.attr("data-sort-dir",c));var d=Results.sortBy(b,c);d?(g.parent("li").removeClass("active"),a.parent("li").addClass("active"),h.modules.resultsTracking.setResultsEventMode("Refresh"),h.modules.travelResults.publishExtraSuperTagEvents({products:[],recordRanking:"N"})):j("[travelSorting]","The sortBy or sortDir could not be set",setSortByReturn,setSortDirReturn)}else j("[travelSorting]","No data on sorting element")}function c(){h.messaging.subscribe(i.RESULTS_SORTED,function(){h.messaging.publish(i.WEBAPP_UNLOCK)}),g.on("click",function(c){$clicked=a(c.target),$clicked.is("a")||($clicked=$clicked.closest("a")),$clicked.hasClass("disabled")||(h.messaging.publish(i.WEBAPP_LOCK),_.defer(function(){$clicked.parent().hasClass("active")||d($clicked),b($clicked)}))}),h.messaging.subscribe(i.WEBAPP_LOCK,function(){g.addClass("inactive").addClass("disabled")}),h.messaging.subscribe(i.WEBAPP_UNLOCK,function(){g.removeClass("inactive").removeClass("disabled")})}function d(a){var b=a.attr("data-sort-type");a.attr("data-sort-dir",k[b])}function e(){a(document).ready(function(){g=a("[data-sort-type]"),"undefined"==typeof Results&&h.logging.exception("[travelSorting]","No Results Object Found!")})}function f(){var b=a("[data-sort-type='price.premium']"),c=Results.getSortBy(),d="price.premium";(c!=d||"desc"==b.attr("data-sort-dir")&&c==d)&&(b.parent("li").siblings().removeClass("active").end().addClass("active").end().attr("data-sort-dir","asc"),Results.setSortBy("price.premium"),Results.setSortDir("asc"))}{var g,h=window.meerkat,i=h.modules.events,j=(h.logging.info,h.logging.error),k={"benefits.excess":"asc","benefits.medical":"desc","benefits.cxdfee":"desc","benefits.luggage":"desc","price.premium":"asc"},l={travelSortings:{}};l.travelSorting}h.modules.register("travelSorting",{init:e,initSorting:c,events:l,resetToDefaultSort:f})}(jQuery),function(a){function b(){var b='<span class="highlight">',c=j.val(),d=k.val();if(b+=c+" adult"+(1==c?"":"s"),d>0&&(b+=" and "+d+" child"+(1==d?"":"ren")),"S"==a("input[name=travel_policyType]:checked").val()){m.html("Your quote is based on"),b+='</span> <span class="optional">travelling</span> <span class="sm-md-block">to <span class="highlight">',b+=1==n.children().length?n.find(".selected-tag span").text():"multiple destinations";var e=g.val().split("/"),i=h.val().split("/"),l=new Date(e[2],e[1]-1,e[0]),o=new Date(i[2],i[1]-1,i[0]),p=864e5,q=1+Math.ceil((o.getTime()-l.getTime())/p);b+="</span> for <span class='highlight'>"+q+" days</span>"}else{m.html("Your Annual Multi Trip (AMT) quote is based on");var r=d>1?"sm-md-block":"sm-block";b+="</span> travelling <span class='highlight "+r+"'>multiple times in one year"}f.html(b+"</span>").fadeIn()}function c(){f=a(".resultsSummaryPlaceholder"),g=a("#travel_dates_fromDate"),h=a("#travel_dates_toDate"),i=a("#travel_destinations_do_do"),j=a("#travel_adults"),k=a("#travel_children"),l=a("#travel_policyType"),m=a(".resultsSummaryContainer h5"),n=a(".selected-tags"),d()}function d(){o.messaging.subscribe(p.device.STATE_ENTER_SM,function(){"results"===o.modules.journeyEngine.getCurrentStep().navigationId&&b()}),o.messaging.subscribe(p.device.STATE_ENTER_MD,function(){"results"===o.modules.journeyEngine.getCurrentStep().navigationId&&b()})}function e(){}{var f,g,h,i,j,k,l,m,n,o=window.meerkat,p=o.modules.events;o.logging.info}o.modules.register("travelSummaryText",{init:e,initSummaryText:c,updateText:b})}(jQuery),function(a){function b(){a(document.body).on("click",".btn-view-brands",d),f=a("#destinationsfs"),g=a("#datestravellersfs"),h=a("#travel_policyType_S"),i=a("#travel_policyType_A"),j=a("#travel_dates_fromDate_row"),k=a("#travel_dates_toDate_row"),l=a("#detailsForm"),m=a(".resultsContainer"),f.hide(),g.hide(),k.hide(),j.hide(),l.find(".well-chatty > .amt, .well-chatty > .single").hide(),n.messaging.subscribe(o.traveldetails.COVER_TYPE_CHANGE,e),c()}function c(){n.messaging.subscribe(o.device.STATE_ENTER_XS,function(){n.modules.dialogs.isDialogOpen(p)&&n.modules.dialogs.close(p)})}function d(){var b=_.template(a("#brands-template").html());return p=n.modules.dialogs.show({title:a(this).attr("title"),hashId:"travel-brands",className:"travel-brands-modal",htmlContent:b(),closeOnHashChange:!0,openOnHashChange:!1}),!1}function e(){m.attr("policytype",a("input[name=travel_policyType]:checked").val()),n.modules.journeyEngine.sessionCamRecorder({navigationId:"PolicyType-"+a("input[name=travel_policyType]:checked").val()}),h.is(":checked")?(l.find(".well-info, .well-chatty > .single").show(),l.find(".well-chatty > .amt, .well-chatty > .default").hide(),f.slideDown(),g.slideDown(),j.slideDown(),k.slideDown(),g.find("h2").text("Dates & Travellers")):(l.find(".well-info, .well-chatty > .single, .well-chatty > .default").hide(),l.find(".well-chatty > .amt").show(),f.is(":visible")?(f.slideUp(),k.slideUp(),j.slideUp()):g.slideDown(),g.find("h2").text("Travellers"))}var f,g,h,i,j,k,l,m,n=window.meerkat,o=n.modules.events,p=(n.logging.info,null);n.modules.register("travelYourCover",{initTravelCover:b,toggleDetailsFields:e})}(jQuery);
//# sourceMappingURL=travel.modules.ctm.min.map