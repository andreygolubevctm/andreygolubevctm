/*!
 * CTM-Platform v0.8.3
 * Copyright 2014 Compare The Market Pty Ltd
 * http://www.comparethemarket.com.au/
 */


function returnAge(a,b){var c=new Date;c.setHours(0,0,0);var d=returnDate(a),e=c.getFullYear()-d.getFullYear();if(1>e)return(c-d)/31536e6;var f=e-c.getFullYear()%4;f=(f-f%4)/4;var g,h=(366*f+365*(e-f))/e;g=d.getMonth()==c.getMonth()&&d.getDate()>c.getDate()?-.005:.005;var i=(c-d)/(864e5*h)+g;return b?Math.floor(i):i}function returnDate(a){if(""===a)return null;var b=a.split("/");return b.length<3?null:new Date(b[2],b[1]-1,b[0])}function isLessThan31Or31AndBeforeJuly1(a){if(""===a)return!1;var b=Math.floor(returnAge(a));if(31>b)return!1;if(31==b){var c=returnDate(a),d=returnDate(a);d.setFullYear(c.getFullYear()+31);var e=new Date;return c.getMonth()+1<7&&(e.getMonth()+1>=7||e.getFullYear()>d.getFullYear())?!0:c.getMonth()+1>=7&&e.getMonth()+1>=7&&e.getFullYear()>d.getFullYear()?!0:!1}return b>31?!0:!1}function resetRadio(a,b){a.val()!=b&&(a.find("input").prop("checked",!1),a.find("label").removeClass("active"),null!=b&&(a.find("input[value="+b+"]").prop("checked","checked"),a.find("input[value="+b+"]").parent().addClass("active")))}function leadingZero(a){return 10>a&&(a="0"+a),a}function formatMoney(a){var b=a.toString().split(".");return b[0]=b[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),b.join(".")}var healthFunds_HCF={set:function(){},unset:function(){}},healthFunds_AHM={set:function(){var a="ahm Health Insurance provides cover for your children up to the age of 21 plus students who are single and studying full time aged between 21 and 25. Adult dependants outside this criteria can be covered by an additional premium on certain covers";""!==meerkat.site.content.callCentreNumber?(a+=" so please call "+meerkat.site.content.brandDisplayName+" on "+meerkat.site.content.callCentreNumber,meerkat.site.liveChat.enabled&&(a+=" or chat to our consultants online"),a+=" to discuss your health cover needs."):a+=".",healthFunds._dependants(a),healthDependents.maxAge=25,$.extend(healthDependents.config,{school:!0,schoolMin:21,schoolMax:24,schoolID:!0,schoolIDMandatory:!0,schoolDate:!0,schoolDateMandatory:!0});var b='<select class="form-control"><option value="">Please choose...</option>';b+='<option value="ACP">Australian College of Phys. Ed</option>',b+='<option value="ACT">Australian College of Theology</option>',b+='<option value="ACTH">ACT High Schools</option>',b+='<option value="ACU">Australian Catholic University</option>',b+='<option value="ADA">Australian Defence Force Academy</option>',b+='<option value="AFTR">Australian Film, TV &amp; Radio School</option>',b+='<option value="AIR">Air Academy, Brit Aerospace Flight Trng</option>',b+='<option value="AMC">Austalian Maritime College</option>',b+='<option value="ANU">Australian National University</option>',b+='<option value="AVO">Avondale College</option>',b+='<option value="BC">Batchelor College</option>',b+='<option value="BU">Bond University</option>',b+='<option value="CQU">Central Queensland Universty</option>',b+='<option value="CSU">Charles Sturt University</option>',b+='<option value="CUT">Curtin University of Technology</option>',b+='<option value="DU">Deakin University</option>',b+='<option value="ECU">Edith Cowan University</option>',b+='<option value="EDUC">Education Institute Default</option>',b+='<option value="FU">Flinders University of SA</option>',b+='<option value="GC">Gatton College</option>',b+='<option value="GU">Griffith University</option>',b+='<option value="JCUNQ">James Cook University of Northern QLD</option>',b+='<option value="KVBVC">KvB College of Visual Communication</option>',b+='<option value="LTU">La Trobe University</option>',b+='<option value="MAQ">Maquarie University</option>',b+='<option value="MMCM">Melba Memorial Conservatorium of Music</option>',b+='<option value="MTC">Moore Theological College</option>',b+='<option value="MU">Monash University</option>',b+='<option value="MURUN">Murdoch University</option>',b+="<option value=\"NAISD\">Natn'l Aborign'l &amp; Islander Skills Dev Ass.</option>",b+='<option value="NDUA">Notre Dame University Australia</option>',b+='<option value="NIDA">National Institute of Dramatic Art</option>',b+='<option value="NSWH">NSW High Schools</option>',b+='<option value="NSWT">NSW TAFE</option>',b+='<option value="NT">Northern Territory High Schools</option>',b+='<option value="NTT">NT TAFE</option>',b+='<option value="NTU">Northern Territory University</option>',b+='<option value="OLA">Open Learnng Australia</option>',b+='<option value="OTHER">Other Registered Tertiary Institutions</option>',b+='<option value="PSC">Photography Studies College</option>',b+='<option value="QCM">Queensland Conservatorium of Music</option>',b+='<option value="QCU">Queensland College of Art</option>',b+='<option value="QLDH">QLD High Schools</option>',b+='<option value="QLDT">QLD TAFE</option>',b+='<option value="QUT">Queensland University of Technology</option>',b+='<option value="RMIT">Royal Melbourne Institute of Techn.</option>',b+='<option value="SA">South Australian High Schools</option>',b+='<option value="SAT">SA TAFE</option>',b+='<option value="SCD">Sydney College of Divinity</option>',b+='<option value="SCM">Sydney Conservatorium of Music</option>',b+='<option value="SCU">Southern Cross University</option>',b+='<option value="SCUC">Sunshine Coast University College</option>',b+='<option value="SIT">Swinburn Institute of Technology</option>',b+='<option value="SJC">St Johns College</option>',b+='<option value="SYD">University of Sydney</option>',b+='<option value="TAS">TAS High Schools</option>',b+='<option value="TT">TAS TAFE</option>',b+='<option value="UA">University of Adelaide</option>',b+='<option value="UB">University of Ballarat</option>',b+='<option value="UC">University of Canberra</option>',b+='<option value="UM">University of Melbourne</option>',b+='<option value="UN">University of Newcastle</option>',b+='<option value="UNC">University of Capricornia Rockhampton</option>',b+='<option value="UNE">University of New England</option>',b+='<option value="UNSW">University Of New South Wales</option>',b+='<option value="UQ">University of Queensland</option>',b+='<option value="USA">University of South Australia</option>',b+='<option value="USQ">University of Southern Queensland</option>',b+='<option value="UT">University of Tasmania</option>',b+='<option value="UTS">University of Technlogy Sydney</option>',b+='<option value="UW">University of Wollongong</option>',b+='<option value="UWA">University of Western Australia</option>',b+='<option value="UWS">University of Western Sydney</option>',b+='<option value="VCAH">VIC College of Agriculture &amp; Horticulture</option>',b+='<option value="VIC">Victorian High Schools</option>',b+='<option value="VICT">VIC TAFE</option>',b+='<option value="VU">Victoria University</option>',b+='<option value="VUT">Victoria University of Technology</option>',b+='<option value="WA">Western Australia-High Schools</option>',b+='<option value="WAT">WA TAFE</option>',b+="</select>",$(".health_dependant_details_schoolGroup .row-content").each(function(a){var c=$(this).find("input").attr("name"),d=$(this).find("input").attr("id");$(this).append(b),$(this).find("select").attr("name",c).attr("id",d+"select"),$(this).find("select").rules("add",{required:!0,messages:{required:"Please select dependant "+(a+1)+"'s school"}})}),$(".health_dependant_details_schoolIDGroup input").attr("maxlength","10"),healthFunds_AHM.tmpSchoolLabel=$(".health_dependant_details_schoolGroup .control-label").html(),$(".health_dependant_details_schoolGroup .control-label").html("Tertiary Institution this dependant is attending"),$(".health_dependant_details_schoolGroup .help_icon").hide(),$("#health_previousfund_primary_authority").rules("add",{required:!0,messages:{required:"AHM require authorisation to contact your previous fund"}}),$("#health_previousfund_partner_authority").rules("add",{required:!0,messages:{required:"AHM require authorisation to contact your partner's previous fund"}}),$("#health_previousfund_primary_memberID").attr("maxlength","10"),$("#health_previousfund_partner_memberID").attr("maxlength","10"),healthFunds._previousfund_authority(!0),meerkat.modules.healthPaymentStep.overrideSettings("bank",{weekly:!0,fortnightly:!0,monthly:!0,quarterly:!1,halfyearly:!1,annually:!0}),meerkat.modules.healthPaymentStep.overrideSettings("credit",{weekly:!0,fortnightly:!0,monthly:!0,quarterly:!1,halfyearly:!1,annually:!0}),meerkat.modules.healthPaymentStep.overrideSettings("creditBankSupply",!0),meerkat.modules.healthPaymentStep.overrideSettings("creditBankQuestions",!0),creditCardDetails.config={visa:!0,mc:!0,amex:!1,diners:!1},creditCardDetails.render(),$("#update-premium").on("click.AHM",function(){var a=meerkat.modules.healthPaymentStep.getSelectedFrequency();healthFunds._payments="weekly"==a||"fortnightly"==a?{min:3,max:8,weekends:!1}:{min:3,max:32,weekends:!0};var b=healthFunds._paymentDays($("#health_payment_details_start").val());healthFunds._paymentDaysRender($(".health-bank_details-policyDay"),b),healthFunds._paymentDaysRender($(".health-credit-card_details-policyDay"),b),("monthly"==a||"annually"==a)&&$(".health-bank_details-policyDay option, .health-credit-card_details-policyDay option").each(function(){if(this.value.length>=3){var a=this.value.substring(this.value.length-3);("-29"==a||"-30"==a||"-31"==a)&&$(this).remove()}})}),$(".health-credit_card_details .fieldrow").hide(),meerkat.modules.paymentGateway.setup({paymentEngine:meerkat.modules.healthPaymentGatewayWestpac,name:"health_payment_gateway",src:"ajax/html/health_paymentgateway.jsp",handledType:{credit:!0,bank:!1},paymentTypeSelector:$("input[name='health_payment_details_type']:checked"),clearValidationSelectors:$("#health_payment_details_frequency, #health_payment_details_start ,#health_payment_details_type"),getSelectedPaymentMethod:meerkat.modules.healthPaymentStep.getSelectedPaymentMethod}),meerkat.modules.healthPaymentStep.setCoverStartRange(1,28)},unset:function(){healthFunds._reset(),healthFunds._dependants(!1),$(".health_dependant_details_schoolGroup select").remove(),$(".health_dependant_details_schoolIDGroup input").removeAttr("maxlength"),$(".health_dependant_details_schoolGroup .control-label").html(healthFunds_AHM.tmpSchoolLabel),delete healthFunds_AHM.tmpSchoolLabel,$(".health_dependant_details_schoolGroup .help_icon").show(),$("#health_previousfund_primary_authority").rules("remove","required"),$("#health_previousfund_partner_authority").rules("remove","required"),$("#health_previousfund_primary_memberID").removeAttr("maxlength"),$("#health_previousfund_partner_memberID").removeAttr("maxlength"),healthFunds._previousfund_authority(!1),creditCardDetails.resetConfig(),creditCardDetails.render(),healthFunds._paymentDaysRender($(".health-bank_details-policyDay"),!1),healthFunds._paymentDaysRender($(".health-credit-card_details-policyDay"),!1),$("#update-premium").off("click.AHM"),meerkat.modules.paymentGateway.reset()}},healthFunds_AUF={set:function(){healthFunds._dependants("This policy provides cover for children under the age of 23 or who are aged between 23-25 years and engaged in full time study. Student dependants do not need to be living at home to be added to the policy. Adult dependants outside these criteria can still be covered by applying for a separate singles policy."),$("#clientMemberID").find("input").rules("remove","required"),$("#partnerMemberID").find("input").rules("remove","required"),healthDependents.config.schoolMin=23,meerkat.modules.healthPaymentStep.overrideSettings("bank",{weekly:!1,fortnightly:!1,monthly:!0,quarterly:!0,halfyearly:!1,annually:!0}),meerkat.modules.healthPaymentStep.overrideSettings("credit",{weekly:!1,fortnightly:!1,monthly:!0,quarterly:!0,halfyearly:!1,annually:!0}),meerkat.modules.healthPaymentStep.setCoverStartRange(0,30),healthFunds._payments={min:0,max:5,weekends:!1},$("#update-premium").on("click.AUF",function(){var a=healthFunds._paymentDays($("#health_payment_details_start").val());healthFunds._paymentDaysRender($(".health-bank_details-policyDay"),a),healthFunds._paymentDaysRender($(".health-credit-card_details-policyDay"),a)}),creditCardDetails.config={visa:!0,mc:!0,amex:!0,diners:!1},creditCardDetails.render(),healthFunds.applicationFailed=function(){meerkat.modules.transactionId.getNew()}},unset:function(){healthFunds._reset(),healthFunds._dependants(!1),creditCardDetails.resetConfig(),creditCardDetails.render(),healthFunds._paymentDaysRender($(".health-bank_details-policyDay"),!1),healthFunds._paymentDaysRender($(".health-credit-card_details-policyDay"),!1),$("#update-premium").off("click.AUF"),healthFunds.applicationFailed=function(){return!1}}},healthFunds_FRA={$policyDateCreditMessage:$(".health_credit-card-details_policyDay-message"),$policyDateBankMessage:$(".health_bank-details_policyDay-message"),set:function(){healthFunds._dependants("This policy provides cover for children until their 21st birthday. Adult dependants over 21 years old can be covered by applying for a separate singles policy."),healthFunds._previousfund_authority(!0),healthFunds.$_optionDR=$(".person-title").find("option[value=DR]").first(),$(".person-title").find("option[value=DR]").remove(),$("#update-premium").on("click.FRA",function(){var a=null;a="cc"==meerkat.modules.healthPaymentStep.getSelectedPaymentMethod()?healthFunds_FRA.$policyDateCreditMessage:healthFunds_FRA.$policyDateBankMessage,meerkat.modules.healthPaymentDate.paymentDaysRenderEarliestDay(a,$("#health_payment_details_start").val(),[1,15],7)}),healthDependents.config.school=!1,healthDependents.maxAge=21,$("#clientMemberID input").rules("remove","required"),$("#partnerMemberID input").rules("remove","required"),meerkat.modules.healthPaymentStep.overrideSettings("bank",{weekly:!1,fortnightly:!1,monthly:!0,quarterly:!1,halfyearly:!1,annually:!0}),meerkat.modules.healthPaymentStep.overrideSettings("credit",{weekly:!1,fortnightly:!1,monthly:!0,quarterly:!1,halfyearly:!1,annually:!0}),meerkat.modules.healthPaymentStep.overrideSettings("creditBankQuestions",!0),creditCardDetails.config={visa:!0,mc:!0,amex:!1,diners:!1},creditCardDetails.render(),meerkat.modules.healthPaymentStep.setCoverStartRange(0,30)},unset:function(){healthFunds._reset(),healthFunds._dependants(!1),healthFunds._previousfund_authority(!1),$(".person-title").append(healthFunds.$_optionDR),healthFunds._paymentDaysRender($(".health-credit-card_details-policyDay"),!1),healthFunds._paymentDaysRender($(".health-bank_details-policyDay"),!1),$("#update-premium").off("click.FRA"),creditCardDetails.resetConfig(),creditCardDetails.render()}},healthFunds_GMH={$policyDateHiddenField:$(".health_details-policyDate"),$policyDateCreditMessage:$(".health_credit-card-details_policyDay-message"),paymentDayChange:function(a){healthFunds_GMH.$policyDateHiddenField.val(a)},set:function(){healthFunds._previousfund_authority(!0),healthFunds._dependants("This policy provides cover for children until their 21st birthday. Student dependants aged between 21-24 years who are engaged in full time study, apprenticeships or traineeships can also be added to this policy. Adult dependants outside these criteria can still be covered by applying for a separate singles policy."),healthDependents.config={school:!0,defacto:!1,schoolMin:21,schoolMax:24},healthFunds._schoolLabel=$(".health_dependant_details_schoolGroup").first().find(".control-label").text(),$(".health_dependant_details_schoolGroup").find(".control-label").text("Name of school/employer/educational institution your child is attending"),$("#clientMemberID input").rules("remove","required"),$("#partnerMemberID input").rules("remove","required"),meerkat.modules.healthPaymentStep.overrideSettings("bank",{weekly:!1,fortnightly:!0,monthly:!0,quarterly:!0,halfyearly:!0,annually:!0}),meerkat.modules.healthPaymentStep.overrideSettings("credit",{weekly:!1,fortnightly:!1,monthly:!0,quarterly:!0,halfyearly:!0,annually:!0}),meerkat.modules.healthPaymentStep.overrideSettings("frequency",{weekly:27,fortnightly:27,monthly:27,quarterly:27,halfyearly:27,annually:27}),meerkat.modules.healthPaymentStep.overrideSettings("creditBankQuestions",!0),creditCardDetails.config={visa:!0,mc:!0,amex:!1,diners:!1},creditCardDetails.render(),meerkat.modules.healthPaymentStep.setCoverStartRange(0,30),meerkat.messaging.subscribe(meerkat.modules.healthPaymentDate.events.POLICY_DATE_CHANGE,healthFunds_GMH.paymentDayChange),$("#update-premium").on("click.GMH",function(){"cc"==meerkat.modules.healthPaymentStep.getSelectedPaymentMethod()&&meerkat.modules.healthPaymentDate.paymentDaysRenderEarliestDay(healthFunds_GMH.$policyDateCreditMessage,$("#health_payment_details_start").val(),[1],7)})},unset:function(){meerkat.messaging.unsubscribe(meerkat.modules.healthPaymentDate.events.POLICY_DATE_CHANGE,healthFunds_GMH.paymentDayChange),healthFunds._reset(),healthFunds._previousfund_authority(!1),healthFunds._dependants(!1),$("#mainform").find(".health_dependant_details_schoolGroup").find(".control-label").text(healthFunds._schoolLabel),creditCardDetails.resetConfig(),creditCardDetails.render(),$("#update-premium").off("click.GMH")}},healthFunds_NIB={set:function(){healthApplicationDetails.showHowToSendInfo("NIB",!0),healthFunds._partner_authority(!0),healthFunds._dependants("This policy provides cover for your children up to their 21st birthday and dependants aged between 21 and 25 who are studying full time. Adult dependants outside these criteria can still be covered by applying for a separate policy."),healthDependents.config={school:!0,defacto:!1,schoolMin:21,schoolMax:24},$("#clientMemberID input").rules("remove","required"),$("#partnerMemberID input").rules("remove","required"),healthFunds._previousfund_authority(!0),meerkat.modules.healthPaymentStep.setCoverStartRange(0,29),meerkat.modules.healthPaymentStep.overrideSettings("bank",{weekly:!1,fortnightly:!0,monthly:!0,quarterly:!1,halfyearly:!1,annually:!0}),meerkat.modules.healthPaymentStep.overrideSettings("credit",{weekly:!1,fortnightly:!0,monthly:!0,quarterly:!1,halfyearly:!1,annually:!0}),meerkat.modules.healthPaymentStep.overrideSettings("frequency",{weekly:27,fortnightly:27,monthly:27,quarterly:27,halfyearly:27,annually:27}),meerkat.modules.healthPaymentStep.overrideSettings("creditBankSupply",!0),meerkat.modules.healthPaymentStep.overrideSettings("creditBankQuestions",!0),creditCardDetails.config={visa:!0,mc:!0,amex:!0,diners:!1},creditCardDetails.render(),$("#update-premium").on("click.NIB",function(){var a=meerkat.modules.healthPaymentStep.getSelectedFrequency();healthFunds._payments="fortnightly"==a?{min:0,max:10,weekends:!1,countFrom:"effectiveDate"}:{min:0,max:27,weekends:!0,countFrom:"today",maxDay:27};var b=healthFunds._paymentDays($("#health_payment_details_start").val());healthFunds._paymentDaysRender($(".health-bank_details-policyDay"),b),healthFunds._paymentDaysRender($(".health-credit-card_details-policyDay"),b)})},unset:function(){$("#update-premium").off("click.NIB"),healthFunds._paymentDaysRender($(".health-credit-card_details-policyDay"),!1),healthFunds._paymentDaysRender($(".health-bank_details-policyDay"),!1),healthApplicationDetails.hideHowToSendInfo(),healthFunds._reset(),healthFunds._previousfund_authority(!1),healthFunds._dependants(!1),creditCardDetails.resetConfig(),creditCardDetails.render()}},healthFunds_WFD={ajaxJoinDec:!1,set:function(){meerkat.modules.healthPaymentStep.setCoverStartRange(0,30),healthFunds._dependants("As a member of Westfund all children aged up to 21 are covered on a family policy. Children aged between 21-24 are entitled to stay on your cover at no extra charge if they are a full time or part-time student at School, college or University TAFE institution or serving an Apprenticeship or Traineeship."),healthDependents.config={school:!0,defacto:!1,schoolMin:18,schoolMax:24,schoolID:!0};var a="Please note that the LHC amount quoted is an estimate and will be confirmed once Westfund has verified your details.";$(".health-payment-details_premium .row-content").append('<p class="statement" style="margin-top:1em">'+a+"</p>"),$("#health_previousfund_primary_fundName").removeAttr("required"),$("#health_previousfund_partner_fundName").removeAttr("required"),$("#clientMemberID input").rules("remove","required"),$("#partnerMemberID input").rules("remove","required"),healthFunds._previousfund_authority(!0),meerkat.modules.healthPaymentStep.overrideSettings("bank",{weekly:!1,fortnightly:!1,monthly:!0,quarterly:!1,halfyearly:!1,annually:!0}),meerkat.modules.healthPaymentStep.overrideSettings("credit",{weekly:!1,fortnightly:!1,monthly:!0,quarterly:!1,halfyearly:!1,annually:!0}),meerkat.modules.healthPaymentStep.overrideSettings("creditBankQuestions",!0),creditCardDetails.config={visa:!0,mc:!0,amex:!1,diners:!1},creditCardDetails.render(),$("#update-premium").on("click.WFD",function(){var a=returnDate($("#health_payment_details_start").val()),b=4-a.getDay();2>b&&(b+=7),a.setDate(a.getDate()+b);var c=a.getDate(),d=c>10&&20>c;c+=c%10!=1||d?c%10!=2||d?c%10!=3||d?"th":"rd":"nd":"st";var e="Please note that your first or full payment (annual frequency) will be debited from your payment method on "+healthFunds._getDayOfWeek(a)+" "+c+" "+healthFunds._getMonth(a);$(".health_credit-card-details_policyDay-message").text(e),$(".health_bank-details_policyDay-message").text(e);var f=leadingZero(a.getDate()),g=leadingZero(a.getMonth()+1),h=a.getFullYear()+"-"+g+"-"+f;$(".health-credit-card_details-policyDay option").val(h),$(".health-bank_details-policyDay option").val(h)}),healthFunds_WFD.$_dobPrimary=$("#health_application_primary_dob"),healthFunds_WFD.defaultAgeMin=dob_health_application_primary_dob.ageMin,dob_health_application_primary_dob.ageMin=18,healthFunds_WFD.$_dobPrimary.rules("add",{messages:{min_DateOfBirth:healthFunds_WFD.$_dobPrimary.attr("title")+" age cannot be under "+dob_health_application_primary_dob.ageMin}}),healthFunds_WFD.$_dobPartner=$("#health_application_partner_dob"),dob_health_application_partner_dob.ageMin=18,healthFunds_WFD.$_dobPartner.rules("add",{messages:{min_DateOfBirth:healthFunds_WFD.$_dobPartner.attr("title")+" age cannot be under "+dob_health_application_partner_dob.ageMin}}),healthFunds_WFD.joinDecLabelHtml=$("#health_declaration + label").html(),healthFunds_WFD.ajaxJoinDec=$.ajax({url:"health_fund_info/WFD/declaration.html",type:"GET",async:!0,dataType:"html",timeout:2e4,cache:!0,success:function(a){$("#health_declaration + label").html(a),$("a#joinDeclarationDialog_link").remove()},error:function(){}})},unset:function(){$("#update-premium").off("click.WFD"),healthFunds._paymentDaysRender($(".health-credit-card_details-policyDay"),!1),healthFunds._paymentDaysRender($(".health-bank_details-policyDay"),!1),healthFunds._reset(),healthFunds._dependants(!1),healthFunds_WFD.ajaxJoinDec&&healthFunds_WFD.ajaxJoinDec.abort(),$("#health_declaration + label").html(healthFunds_WFD.joinDecLabelHtml),$(".health-payment-details_premium .statement").remove(),$("#health_previousfund_primary_fundName").attr("required","required"),$("#health_previousfund_partner_fundName").attr("required","required"),healthFunds._previousfund_authority(!1),dob_health_application_primary_dob.ageMin=healthFunds_WFD.defaultAgeMin,healthFunds_WFD.$_dobPrimary.rules("add",{messages:{min_DateOfBirth:healthFunds_WFD.$_dobPrimary.attr("title")+" age cannot be under "+dob_health_application_primary_dob.ageMin}}),dob_health_application_partner_dob.ageMin=healthFunds_WFD.defaultAgeMin,healthFunds_WFD.$_dobPrimary.rules("add",{messages:{min_DateOfBirth:healthFunds_WFD.$_dobPartner.attr("title")+" age cannot be under "+dob_health_application_partner_dob.ageMin}}),delete healthFunds_WFD.defaultAgeMin,delete healthFunds_WFD.$_dobPrimary,delete healthFunds_WFD.$_dobPartner}},FatalErrorDialog={display:function(a){FatalErrorDialog.exec(a)},init:function(){},exec:function(a){var b=$.extend({errorLevel:"silent",message:"A fatal error has occurred.",page:"undefined.jsp",description:null,data:null},a);meerkat.modules.errorHandling.error(b)}},Track={splitTest:function(a,b){meerkat.modules.tracking.recordSupertag("splitTesting",{version:a,splitTestName:b})}},healthChoices={_cover:"",_situation:"",_state:"",_benefits:new Object,_performUpdate:!1,initialise:function(a,b){healthChoices.setCover(a,!0,!0);var c=this._performUpdate;healthChoices.setSituation(b,c)},hasSpouse:function(){switch(this._cover){case"C":case"F":return!0;default:return!1}},hasChildren:function(){switch(this._cover){case"F":case"SPF":return!0;default:return!1}},setCover:function(a,b,c){b=b||!1,c=c||!1,healthChoices._cover=a,b||healthChoices.resetRebateForm(),healthChoices.hasSpouse()?$("#partner-health-cover, #partner, .health-person-details-partner, #partnerFund").show():(healthChoices.flushPartnerDetails(),$("#partner-health-cover, #partner, .health-person-details-partner, #partnerFund").hide()),healthChoices.dependants(c),healthCoverDetails.displayHealthFunds(),meerkat.modules.healthTiers.setTiers(c)},setSituation:function(a,b){b!==!1&&(b=!0),a!=healthChoices._situation&&(healthChoices._situation=a),$("#health_benefits_healthSitu, #health_situation_healthSitu").val(a)},isValidLocation:function(a){var b=new RegExp(/^((\s)*([^~,])+\s+)+\d{4}((\s)+(ACT|NSW|QLD|TAS|SA|NT|VIC|WA)(\s)*)$/);return value=$.trim(String(a)),""!=value&&value.match(b)?!0:!1},setLocation:function(a){if(healthChoices.isValidLocation(a)){var b=$.trim(String(a)),c=b.split(" "),d=c.pop(),e=c.pop(),f=c.join(" ");$("#health_situation_state").val(d),$("#health_situation_postcode").val(e).trigger("change"),$("#health_situation_suburb").val(f),healthChoices.setState(d)}else meerkat.site.isFromBrochureSite&&$("#health_situation_location").val("")},setState:function(a){healthChoices._state=a},setDob:function(a,b){""!=a&&b.val(a)},dependants:function(a){healthChoices.hasChildren()&&"Y"==$(".health_cover_details_rebate :checked").val()?a===!0?$(".health_cover_details_dependants").show():$(".health_cover_details_dependants").slideDown():a===!0?$(".health_cover_details_dependants").hide():($("#health_healthCover_dependants option:selected").prop("selected",!1),$("#health_healthCover_income option:selected").prop("selected",!1),$(".health_cover_details_dependants").slideUp())},returnCover:function(){return $("#health_situation_healthCvr option:selected").text()},returnCoverCode:function(){return this._cover},flushPartnerDetails:function(){$("#health_healthCover_partner_dob").val("").change(),$('#partner-health-cover input[name="health_healthCover_partner_cover"]:checked').each(function(){$(this).checked=!1}),resetRadio($("#health_healthCover_partnerCover")),$('#partner-health-cover input[name="health_healthCover_partner_healthCoverLoading"]:checked').each(function(){$(this).checked=!1}),resetRadio($("#health-continuous-cover-partner"))},resetRebateForm:function(){$('#health_healthCover_health_cover_rebate input[name="health_healthCover_rebate"]:checked').each(function(){$(this).checked=!1}),resetRadio($("#health_healthCover_health_cover_rebate")),$("#health_healthCover_dependants option").first().prop("selected",!0),$("#health_healthCover_dependants option:selected").prop("selected",!1),$("#health_healthCover_income option").first().prop("selected",!0),$("#health_healthCover_income option:selected").prop("selected",!1),$("#health_healthCover_incomelabel").val(""),healthCoverDetails.setIncomeBase(),healthChoices.dependants(),meerkat.modules.healthTiers.setTiers(),$(".health_cover_details_dependants").hide(),$("#health_healthCover_tier").hide(),$("#health_rebates_group").hide()}},healthCoverDetails={getRebateChoice:function(){return $("#health_healthCover-selection").find(".health_cover_details_rebate :checked").val()},setIncomeBase:function(a){"S"==healthChoices._cover&&"Y"==healthCoverDetails.getRebateChoice()?a?$("#health_healthCover-selection").find(".health_cover_details_incomeBasedOn").show():$("#health_healthCover-selection").find(".health_cover_details_incomeBasedOn").slideDown():a?$("#health_healthCover-selection").find(".health_cover_details_incomeBasedOn").hide():$("#health_healthCover-selection").find(".health_cover_details_incomeBasedOn").slideUp()},displayHealthFunds:function(){var a=$("#mainform").find(".health-previous_fund"),b=$("#clientFund").find("select"),c=$("#partnerFund").find("select");"NONE"!=b.val()&&""!=b.val()?(a.find("#clientMemberID").slideDown(),a.find(".membership").addClass("onA")):(a.find("#clientMemberID").slideUp(),a.find(".membership").removeClass("onA")),healthChoices.hasSpouse()&&"NONE"!=c.val()&&""!=c.val()?(a.find("#partnerMemberID").slideDown(),a.find(".membership").addClass("onB")):(a.find("#partnerMemberID").slideUp(),a.find(".membership").removeClass("onB"))},setHealthFunds:function(a){var b=$("#health_healthCover_primaryCover").find(":checked").val(),c=$("#health_healthCover_partnerCover").find(":checked").val(),d=$("#clientFund").find("select"),e=$("#partnerFund").find("select");"Y"==b?isLessThan31Or31AndBeforeJuly1($("#health_healthCover_primary_dob").val())?a?$("#health-continuous-cover-primary").show():$("#health-continuous-cover-primary").slideDown():a?$("#health-continuous-cover-primary").hide():$("#health-continuous-cover-primary").slideUp():("N"==b&&resetRadio($("#health-continuous-cover-primary"),"N"),a?$("#health-continuous-cover-primary").hide():$("#health-continuous-cover-primary").slideUp()),"Y"==b&&"NONE"==d.val()?d.val(""):"N"==b&&d.val("NONE"),"Y"==c?isLessThan31Or31AndBeforeJuly1($("#health_healthCover_partner_dob").val())?a?$("#health-continuous-cover-partner").show():$("#health-continuous-cover-partner").slideDown():a?$("#health-continuous-cover-partner").hide():$("#health-continuous-cover-partner").slideUp():("N"==c&&resetRadio($("#health-continuous-cover-partner"),"N"),a?$("#health-continuous-cover-partner").hide():$("#health-continuous-cover-partner").slideUp()),"Y"==c&&"NONE"==e.val()?e.val(""):"N"==c&&e.val("NONE"),healthCoverDetails.displayHealthFunds()},getAgeAsAtLastJuly1:function(a){var b=a.split("/"),c=Number(b[2]),d=Number(b[1])-1,e=Number(b[0]),f=new Date,g=f.getFullYear()-c;return(d>6||6==d&&e>1)&&g--,g}},healthFunds={_fund:!1,name:"the fund",countFrom:{TODAY:"today",NOCOUNT:"",EFFECTIVE_DATE:"effectiveDate"},minType:{FROM_TODAY:"today",FROM_EFFECTIVE_DATE:"effectiveDate"},checkIfNeedToInjectOnAmend:function(a){if($("#health_application_provider").val().length>0){var b=$("#health_application_provider").val(),c="healthFunds_"+b;$(document.body).addClass("injectingFund"),healthFunds.load(b,function(){window[c].processOnAmendQuote&&window[c].processOnAmendQuote===!0&&(window[c].set(),window[c].unset()),$(document.body).removeClass("injectingFund"),a()},!1)}else a()},load:function(a,b,c){if(""==a||!a)return healthFunds.loadFailed("Empty or false"),!1;if(c!==!1&&(c=!0),"undefined"==typeof window["healthFunds_"+a]||0==window["healthFunds_"+a]){var d={transactionId:meerkat.modules.transactionId.get()};return $.ajax({url:"common/js/health/healthFunds_"+a+".jsp",dataType:"script",data:d,async:!0,timeout:3e4,cache:!1,beforeSend:function(a,b){var c=b.url,d="uncache";c=c.replace("?_=","?"+d+"="),c=c.replace("&_=","&"+d+"="),b.url=c},success:function(){c&&healthFunds.process(a),"function"==typeof b&&b(!0)},error:function(c,d){healthFunds.loadFailed(a,d),"function"==typeof b&&b(!1)}}),!1}return a!=healthFunds._fund&&c&&healthFunds.process(a),"function"==typeof b&&b(!0),!0},process:function(a){var b=window["healthFunds_"+a];healthFunds.set=b.set,healthFunds.unset=b.unset,$("body").addClass(a),healthFunds.set(),healthFunds._fund=a},loadFailed:function(a,b){FatalErrorDialog.exec({message:"Unable to load the fund's application questions",page:"health:health_funds.tag",description:"healthFunds.update(). Unable to load fund questions for: "+a,data:b})},unload:function(){healthFunds._fund!==!1&&(healthFunds.unset(),$("body").removeClass(healthFunds._fund),healthFunds._fund=!1,healthFunds.set=function(){},healthFunds.unset=function(){})},set:function(){},unset:function(){},applicationFailed:function(){return!1},_memberIdRequired:function(a){a?($("#clientMemberID").find("input").rules("add","required"),$("#partnerMemberID").find("input").rules("add","required")):($("#clientMemberID").find("input").rules("remove","required"),$("#partnerMemberID").find("input").rules("remove","required"))
},_dependants:function(a){a!==!1?(healthFunds.$_dependantDefinition=$("#mainform").find(".health-dependants").find(".definition"),healthFunds.HTML_dependantDefinition=healthFunds.$_dependantDefinition.html(),healthFunds.$_dependantDefinition.html(a)):(healthFunds.$_dependantDefinition.html(healthFunds.HTML_dependantDefinition),healthFunds.$_dependantDefinition=void 0,healthFunds.HTML_dependantDefinition=void 0)},_previousfund_authority:function(a){a!==!1?(healthFunds.$_authority=$(".health_previous_fund_authority label span"),healthFunds.$_authorityText=healthFunds.$_authority.eq(0).text(),healthFunds.$_authority.text(meerkat.modules.healthResults.getSelectedProduct().info.providerName),$(".health_previous_fund_authority").removeClass("hidden")):"undefined"!=typeof healthFunds.$_authority&&(healthFunds.$_authority.text(healthFunds.$_authorityText),healthFunds.$_authority=void 0,healthFunds.$_authorityText=void 0,$(".health_previous_fund_authority").addClass("hidden"))},_partner_authority:function(a){a===!0?$(".health_person-details_authority_group").removeClass("hidden"):$(".health_person-details_authority_group").addClass("hidden")},_reset:function(){healthApplicationDetails.hideHowToSendInfo(),healthFunds._partner_authority(!1),healthFunds._memberIdRequired(!0),healthDependents.resetConfig()},_paymentDays:function(a){if(""==a)return!1;var b=returnDate(a),c=new Date,d=null;d=healthFunds._payments.countFrom==healthFunds.countFrom.TODAY?c:b;var e=0,f=0,g=healthFunds._payments.max;if(healthFunds._payments.minType==healthFunds.minType.FROM_TODAY){var h=Math.round((b-c)/864e5);h<healthFunds._payments.min&&(f=healthFunds._payments.min-h)}else f=healthFunds._payments.min,g-=healthFunds._payments.min;for(var i='<option value="">Please choose...</option>';g>e;){var j=new Date(d.getTime()+24*f*60*60*1e3),k=j.getDay();if("undefined"!=typeof healthFunds._payments.maxDay&&healthFunds._payments.maxDay<j.getDate())f++;else if(healthFunds._payments.weekends||0!=k&&6!=k){var l=leadingZero(j.getDate()),m=leadingZero(j.getMonth()+1);i+='<option value="'+j.getFullYear()+"-"+m+"-"+l+'">'+healthFunds._getNiceDate(j)+"</option>",f++,e++}else f++}return i},_earliestDays:function(b,c,d){if(!$.isArray(c)||""==b)return!1;var e=returnDate(b);d=7;for(var f=new Date(e.getTime()+24*d*60*60*1e3),g='<option value="">No date has been selected for you</option>',h=0;31>h;h++)for(f=new Date(f.getTime()+864e5),a=0;a<c.length;a++)if(c[a]==f.getDate()){var i=leadingZero(f.getDate()),j=leadingZero(f.getMonth()+1);g='<option value="'+f.getFullYear()+"-"+j+"-"+i+'" selected="selected">'+healthFunds._getNiceDate(f)+"</option>",h=99;break}return g},_paymentDaysRender:function(a,b){b===!1&&(healthFunds._payments={min:0,max:5,weekends:!1},b='<option value="">Please choose...</option>'),a.html(b),a.parent().siblings("p").text("Your payment will be deducted on: "+a.find("option").first().text()),$(".health-bank_details-policyDay, .health-credit-card_details-policyDay").html(b)},_getDayOfWeek:function(a){var b=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];return b[a.getDay()]},_getMonth:function(a){var b=["January","February","March","April","May","June","July","August","September","October","November","December"];return b[a.getMonth()]},_getNiceDate:function(a){var b=a.getDate(),c=a.getFullYear();return healthFunds._getDayOfWeek(a)+", "+b+" "+healthFunds._getMonth(a)+" "+c}},healthApplicationDetails={preloadedValue:$("#contactPointValue").val(),periods:1,init:function(){postalMatchHandler.init("health_application")},showHowToSendInfo:function(a,b){{var c=$("#health_application_contactPoint-group"),d=c.find(".control-label span");d.text()}d.text(a),b?c.find("input").rules("add",{required:!0,messages:{required:"Please choose how you would like "+a+" to contact you"}}):c.find("input").rules("remove","required"),c.removeClass("hidden")},hideHowToSendInfo:function(){var a=$("#health_application_contactPoint-group");a.addClass("hidden")},addOption:function(a,b){var c=$("#health_application_contactPoint");c.append('<label class="btn btn-form-inverse"><input id="health_application_contactPoint_'+b+'" type="radio" data-msg-required="Please choose " value="'+b+'" name="health_application_contactPoint">'+a+"</label>"),0==c.find("input:checked").length&&this.preloadedValue==b&&$("#health_application_contactPoint_"+b).prop("checked",!0)},removeLastOption:function(){var a=$("#health_application_contactPoint");a.find("label").last().remove()},testStatesParity:function(){var a=$("#health_application_address_state");if(a.val()!=$("#health_situation_state").val()){var b=$("#health_application_address_suburbName").val(),c=$("#health_application_address_postCode").val(),d=$("#health_application_address_state").val();if(b.length&&b.indexOf("Please select")<0&&4==c.length&&d.length)return $("#health_application_address_postCode").addClass("error"),!1}return!0}},healthDependents={_dependents:0,_limit:12,maxAge:25,init:function(){healthDependents.resetConfig()},resetConfig:function(){healthDependents.config={school:!0,schoolMin:22,schoolMax:24,schoolID:!1,schoolIDMandatory:!1,schoolDate:!1,schoolDateMandatory:!1,defacto:!1,defactoMin:21,defactoMax:24},healthDependents.maxAge=25},setDependants:function(){var a=$("#mainform").find(".health_cover_details_dependants").find("select").val();return healthDependents._dependents="Y"!=healthCoverDetails.getRebateChoice()||isNaN(a)?1:a,healthChoices.hasChildren()?($("#health_application_dependants-selection").show(),healthDependents.updateDependentOptionsDOM(),void $("#health_application_dependants-selection").find(".health_dependant_details").each(function(){var a=parseInt($(this).attr("data-id"));a>healthDependents._dependents?$(this).hide():$(this).show(),healthDependents.checkDependent(a)})):void $("#health_application_dependants-selection").hide()},addDependent:function(){if(healthDependents._dependents<healthDependents._limit){healthDependents._dependents++;var a=$("#health_application_dependants_dependant"+healthDependents._dependents);a.find("input[type=text], select").val(""),resetRadio(a.find(".health_dependant_details_maritalincomestatus"),""),a.find(".error-field label").remove(),a.find(".has-error, .has-success").removeClass("has-error").removeClass("has-success"),a.show(),healthDependents.updateDependentOptionsDOM(),healthDependents.hasChanged(),$("html").animate({scrollTop:a.offset().top-50},250)}},dropDependent:function(){healthDependents._dependents>0&&($("#health_application_dependants_dependant"+healthDependents._dependents).find("input[type=text]").each(function(){$(this).val("")}),$("#health_application_dependants_dependant"+healthDependents._dependents).find("input[type=radio]:checked").each(function(){this.checked=!1}),$("#health_application_dependants_dependant"+healthDependents._dependents).find("select").each(function(){$(this).removeAttr("selected")}),$("#health_application_dependants_dependant"+healthDependents._dependents).hide(),healthDependents._dependents--,healthDependents.updateDependentOptionsDOM(),healthDependents.hasChanged(),$_obj=$(healthDependents._dependents>0?"#health_application_dependants_dependant"+healthDependents._dependents:"#health_application_dependants-selection"),$("html").animate({scrollTop:$_obj.offset().top-50},250))},updateDependentOptionsDOM:function(){healthDependents._dependents<=0?($("#health_application_dependants-selection").find(".remove-last-dependent").hide(),$("#health_application_dependants_threshold").slideDown()):$("#dependents_list_options").find(".remove-last-dependent").is(":visible")||($("#health_application_dependants_threshold").slideUp(),$("#health_application_dependants-selection").find(".remove-last-dependent").hide(),$("#health_application_dependants-selection .health_dependant_details:visible:last").find(".remove-last-dependent").show()),healthDependents._dependents>=healthDependents._limit?$("#health-dependants").find(".add-new-dependent").hide():$("#health-dependants").find(".add-new-dependent").not(":visible")&&$("#health-dependants").find(".add-new-dependent").show()},checkDependent:function(a){var b=a;isNaN(a)&&"object"==typeof a&&(b=a.data);var c,d=$("#health_application_dependants_dependant"+b+"_dob").val();if(d.length){if(c=healthDependents.getAge(d),isNaN(c))return!1}else c=0;healthDependents.addSchool(b,c),healthDependents.addDefacto(b,c)},getAge:function(a){var b=a.split("/"),c=Number(b[2]),d=Number(b[1])-1,e=Number(b[0]),f=new Date,g=f.getFullYear()-c;return(f.getMonth()<d||f.getMonth()==d&&f.getDate()<e)&&g--,g},addSchool:function(a,b){return healthDependents.config.school===!1?($("#health_application_dependants-selection").find(".health_dependant_details_schoolGroup, .health_dependant_details_schoolIDGroup, .health_dependant_details_schoolDateGroup").hide(),!1):void(b>=healthDependents.config.schoolMin&&b<=healthDependents.config.schoolMax?($("#health_application_dependants-selection").find(".dependant"+a).find(".health_dependant_details_schoolGroup, .health_dependant_details_schoolIDGroup, .health_dependant_details_schoolDateGroup").show(),healthDependents.config.schoolID===!1?$("#health_application_dependants-selection").find(".dependant"+a).find(".health_dependant_details_schoolIDGroup").hide():this.config.schoolIDMandatory===!0?$("#health_application_dependants-selection").find("#health_application_dependants_dependant"+a+"_schoolID").rules("add",{required:!0,messages:{required:"Please enter dependant "+a+"'s student ID"}}):$("#health_application_dependants-selection").find("#health_application_dependants_dependant"+a+"_schoolID").rules("remove","required"),this.config.schoolDate!==!0?$("#health_application_dependants-selection").find(".dependant"+a).find(".health_dependant_details_schoolDateGroup").hide():this.config.schoolDateMandatory===!0?$("#health_application_dependants-selection").find("#health_application_dependants_dependant"+a+"_schoolDate").rules("add",{required:!0,messages:{required:"Please enter date that dependant "+a+" commenced study"}}):$("#health_application_dependants-selection").find("#health_application_dependants_dependant"+a+"_schoolDate").rules("remove","required")):$("#health_application_dependants-selection").find(".dependant"+a).find(".health_dependant_details_schoolGroup, .health_dependant_details_schoolIDGroup, .health_dependant_details_schoolDateGroup").hide())},addDefacto:function(a,b){return healthDependents.config.defacto===!1?!1:void(b>=healthDependents.config.defactoMin&&b<=healthDependents.config.defactoMax?$("#health_application_dependants-selection").find(".dependant"+a).find(".health_dependant_details_maritalincomestatus").show():$("#health_application_dependants-selection").find(".dependant"+a).find(".health_dependant_details_maritalincomestatus").hide())},hasChanged:function(){var a=$("#health_application_dependants-selection").find(".health-dependants-tier");if("N"==healthCoverDetails.getRebateChoice())a.slideUp();else if(healthDependents._dependents>0){$("#health_healthCover_dependants").val(healthDependents._dependents).trigger("change");var b=$("#health_healthCover_tier");a.find("select").html(b.find("select").html()),a.find("#health_application_dependants_incomeMessage").text(b.find("span").text()),a.is(":hidden")&&a.slideDown()}else a.slideUp()}};creditCardDetails={resetConfig:function(){creditCardDetails.config={visa:!0,mc:!0,amex:!0,diners:!1}},render:function(){var a=$("#health_payment_credit_type"),b=$("#health_payment_credit-selection .cards");b.children().hide();var c='<option id="health_payment_credit_type_" value="">Please choose...</option>',d=a.find(":selected").val();creditCardDetails.config.visa===!0&&(c+='<option id="health_payment_credit_type_v" value="v">Visa</option>',b.find(".visa").show()),creditCardDetails.config.mc===!0&&(c+='<option id="health_payment_credit_type_m" value="m">Mastercard</option>',b.find(".mastercard").show()),creditCardDetails.config.amex===!0&&(c+='<option id="health_payment_credit_type_a" value="a">AMEX</option>',b.find(".amex").show()),creditCardDetails.config.diners===!0&&(c+='<option id="health_payment_credit_type_d" value="d">Diners Club</option>',b.find(".diners").show()),a.html(c).find("option[value="+d+"]").attr("selected","selected")},set:function(){creditCardDetails.$_obj=$("#health_payment_credit_number"),creditCardDetails.$_objCCV=$("#health_payment_credit_ccv");var a=creditCardDetails._getType();field_credit_card_validation.set(a,creditCardDetails.$_obj,creditCardDetails.$_objCCV)},_getType:function(){return $("#health_payment_credit_type").find(":selected").val()}},function(a){function b(){if("confirmation"===w.site.pageAction)w.modules.journeyEngine.configure(null);else{d(!1);var a=null;w.site.isFromBrochureSite===!0?a=A.detailsStep.navigationId:w.site.journeyStage.length>0&&"amend"===w.site.pageAction&&(a="apply"===w.site.journeyStage||"payment"===w.site.journeyStage?"results":w.site.journeyStage),w.modules.journeyEngine.configure({startStepId:a,steps:_.toArray(A)});var b=w.modules.transactionId.get();w.messaging.publish(x.tracking.EXTERNAL,{method:"trackQuoteEvent",object:{action:"Start",transactionID:parseInt(b,10)}}),w.site.isNewQuote===!1&&(w.site.isCallCentreUser===!0?w.messaging.publish(x.tracking.EXTERNAL,{method:"contactCentreUser",object:{contactCentreID:w.site.userId,quoteReferenceNumber:b,transactionID:b,productID:w.site.productId}}):w.messaging.publish(x.tracking.EXTERNAL,{method:"trackQuoteEvent",object:{action:"Retrieve",transactionID:b}}))}}function c(){w.messaging.subscribe(x.WEBAPP_LOCK,function(a){var b="undefined"!=typeof a&&a.source&&"submitApplication"===a.source;p(b)}),w.messaging.subscribe(x.WEBAPP_UNLOCK,function(){o()}),a("#health_application-selection").delegate(".changeStateAndQuote","click",m)}function d(a){e(),f(),a&&w.modules.journeyProgressBar.render(!0)}function e(){var b={title:"Your Details",navigationId:"start",slideIndex:0,externalTracking:{method:"trackQuoteForms",object:w.modules.health.getTrackingFieldsObject},onInitialise:function(){a(".health-situation-healthCvr").on("change",function(){healthChoices.setCover(a(this).val())}),a(".health-situation-location").on("change",function(){healthChoices.setLocation(a(this).val())}),""!==a("#health_situation_location").val()&&healthChoices.setLocation(a("#health_situation_location").val()),"Y"===a("#health_privacyoptin").val()&&a(".slide-feature-emailquote").addClass("privacyOptinChecked"),"amend"!==w.site.pageAction&&"start-again"!==w.site.pageAction&&0===w.modules.healthBenefits.getSelectedBenefits().length&&""!==a(".health-situation-healthSitu").val()&&a(".health-situation-healthSitu").change();var b=a(".slide-feature-emailquote");a(".health-contact-details-optin-group .checkbox").on("click",function(){var c=a("#health_privacyoptin");"Y"===c.val()?b.addClass("privacyOptinChecked"):b.removeClass("privacyOptinChecked")}),w.site.isCallCentreUser===!0&&(t(),a("input[name=health_simples_contactType]").on("change",function(){t()}))}},c={title:"Your Details",navigationId:"details",slideIndex:1,tracking:{touchType:"H",touchComment:"HLT detail",includeFormData:!0},externalTracking:{method:"trackQuoteForms",object:w.modules.health.getTrackingFieldsObject},onInitialise:function(){healthCoverDetails.setHealthFunds(!0),healthCoverDetails.setIncomeBase(!0),a("#health_healthCover_dependants").on("change",function(){w.modules.healthTiers.setTiers()}),a("#health_healthCover-selection").find(".health_cover_details_rebate").on("change",function(){healthCoverDetails.setIncomeBase(),healthChoices.dependants(),w.modules.healthTiers.setTiers()}),w.site.isCallCentreUser===!0&&a("#health_healthCover_incomeBase").find("input").on("change",function(){a("#health_healthCover_income").prop("selectedIndex",0),w.modules.healthTiers.setTiers()}),a("#health_healthCover-selection").find(":input").on("change",function(){var b=a(this);b.hasClass("dateinput-day")||b.hasClass("dateinput-month")||b.hasClass("dateinput-year")||(healthCoverDetails.setHealthFunds(),w.site.isCallCentreUser===!0&&l(function(b){a(".health_cover_details_rebate .fieldrow_legend").html("Overall LHC "+b.loading+"%"),h()?(a("#health_healthCover_primaryCover .fieldrow_legend").html("Individual LHC "+b.primaryLoading+"%, overall  LHC "+b.loading+"%"),a("#health_healthCover_partnerCover .fieldrow_legend").html("Individual LHC "+b.partnerLoading+"%, overall  LHC "+b.loading+"%")):a("#health_healthCover_primaryCover .fieldrow_legend").html("Overall  LHC "+b.loading+"%"),w.modules.healthTiers.setTiers()}))}),w.site.isCallCentreUser===!0&&(u(),a("input[name=health_healthCover_rebate]").on("change",function(){u()}))},onBeforeLeave:function(){var b=a("#health_healthCover_income :selected").val().length>0?a("#health_healthCover_income :selected").text():"";a("#health_healthCover_incomelabel").val(b)}},d={title:"Your Cover",navigationId:"benefits",slideIndex:2,slideScrollTo:"#navbar-main",tracking:{touchType:"H",touchComment:"HLT benefi",includeFormData:!0},externalTracking:{method:"trackQuoteForms",object:w.modules.health.getTrackingFieldsObject},validation:{validate:!1},onInitialise:function(){w.modules.healthResults.initPage()},onBeforeEnter:function(){w.modules.healthBenefits.close(),w.modules.navMenu.disable()},onAfterEnter:function(b){"xs"===w.modules.deviceMediaState.get()&&w.modules.utilities.scrollPageTo("html",0,1),w.site.isCallCentreUser===!0&&a("#journeyEngineSlidesContainer .journeyEngineSlide").eq(w.modules.journeyEngine.getCurrentStepIndex()).find(".simples-dialogue").hide(),b.isStartMode===!1&&_.defer(function(){w.modules.healthBenefits.open("journey-mode")})},onAfterLeave:function(){var a=w.modules.healthBenefits.getSelectedBenefits();w.modules.healthResults.onBenefitsSelectionChange(a),w.modules.navMenu.enable()}},e={title:"Your Results",navigationId:"results",slideIndex:2,validation:{validate:!1,customValidation:function(b){if(w.site.isCallCentreUser===!0){var c=a(".resultsSlide").find(".simples-dialogue.mandatory:visible");c.length!=c.find("input:checked").length&&(w.modules.dialogs.show({htmlContent:"Please complete the mandatory dialogue prompts before applying."}),b(!1))}null===w.modules.healthResults.getSelectedProduct()&&b(!1),b(!0)}},onInitialise:function(){w.modules.healthMoreInfo.initMoreInfo()},onBeforeEnter:function(b){b.isForward&&w.site.isCallCentreUser?a("#journeyEngineSlidesContainer .journeyEngineSlide").eq(w.modules.journeyEngine.getCurrentStepIndex()).find(".simples-dialogue").show():w.modules.healthResults.resetSelectedProduct(),b.isForward&&w.site.isCallCentreUser&&a("#journeyEngineSlidesContainer .journeyEngineSlide").eq(w.modules.journeyEngine.getCurrentStepIndex()).find(".simples-dialogue").show()},onAfterEnter:function(a){a.isBackward===!0&&w.modules.healthResults.onReturnToPage(),a.isForward===!0&&w.modules.healthResults.get(),w.modules.resultsHeaderBar.registerEventListeners()},onAfterLeave:function(){w.modules.healthResults.stopColumnWidthTracking(),w.modules.healthResults.recordPreviousBreakpoint(),w.modules.healthResults.toggleMarketingMessage(!1),w.modules.healthResults.toggleResultsLowNumberMessage(!1),w.modules.healthMoreInfo.close(),w.modules.resultsHeaderBar.removeEventListeners()}},f={title:"Your Application",navigationId:"apply",slideIndex:3,tracking:{touchType:"A"},externalTracking:{method:"trackQuoteForms",object:w.modules.health.getTrackingFieldsObject},onInitialise:function(){healthApplicationDetails.init(),a(".changes-premium :input").on("change",function(){w.messaging.publish(y.health.CHANGE_MAY_AFFECT_PREMIUM)}),a("#health_previousfund_primary_fundName, #health_previousfund_partner_fundName").on("change",function(){healthCoverDetails.displayHealthFunds()}),w.site.isCallCentreUser===!0&&(""!==a("#health_previousfund_primary_fundName").val()&&"NONE"!=a("#health_previousfund_primary_fundName").val()||""!==a("#health_previousfund_partner_fundName").val()&&"NONE"!==a("#health_previousfund_partner_fundName").val()?a(".simples-dialogue-15").first().show():a(".simples-dialogue-15").first().hide(),a("#health_previousfund_primary_fundName, #health_previousfund_partner_fundName").on("change",function(){""!==a(this).val()&&"NONE"!==a(this).val()?a(".simples-dialogue-15").first().show():""!==a("#health_previousfund_primary_fundName").val()&&"NONE"!=a("#health_previousfund_primary_fundName").val()||""!==a("#health_previousfund_partner_fundName").val()&&"NONE"!==a("#health_previousfund_partner_fundName").val()||a(".simples-dialogue-15").first().hide()})),a("#health_application_address_postCode, #health_application_address_streetSearch, #health_application_address_suburb").on("change",function(){healthApplicationDetails.testStatesParity()}),a("#health_application_dependants_income").on("change",function(){a("#mainform").find(".health_cover_details_income").val(a(this).val())}),a(".health_dependant_details .dateinput_container input.serialise").on("change",function(){healthDependents.checkDependent(a(this).closest(".health_dependant_details").attr("data-id"))}),a("#health_application_dependants-selection").find(".remove-last-dependent").on("click",function(){healthDependents.dropDependent()}),a("#health_application_dependants-selection").find(".add-new-dependent").on("click",function(){healthDependents.addDependent()}),a("#health_payment_details_start_calendar").datepicker({clearBtn:!1,format:"dd/mm/yyyy"}).on("changeDate",function(b){a("#health_payment_details_start").val(b.format()),w.messaging.publish(y.health.CHANGE_MAY_AFFECT_PREMIUM)})},onBeforeEnter:function(b){if(b.isForward===!0){var c=w.modules.healthResults.getSelectedProduct();healthFunds.load(c.info.provider);var d=a("#journeyEngineSlidesContainer .journeyEngineSlide").slice(w.modules.journeyEngine.getCurrentStepIndex()-1);d.find(".error-field").remove(),d.find(".has-error").removeClass("has-error"),a("#health_declaration input:checked").prop("checked",!1).change(),healthDependents.setDependants(),""===a("#health_contactDetails_contactNumber_mobile").val()&&""===a("#health_contactDetails_contactNumber_other").val()&&w.site.isCallCentreUser===!1&&a("#health_application_okToCall-group").show();var e=w.modules.healthPaymentStep.getSetting("minStartDate"),f=w.modules.healthPaymentStep.getSetting("maxStartDate");a("#health_payment_details_start_calendar").datepicker("setStartDate",e).datepicker("setEndDate",f)}},onAfterEnter:function(){healthDependents.updateDependentOptionsDOM()}},g={title:"Your Payment",navigationId:"payment",slideIndex:4,tracking:{touchType:"H",touchComment:"HLT paymnt",includeFormData:!0},externalTracking:{method:"trackQuoteForms",object:w.modules.health.getTrackingFieldsObject},onInitialise:function(){a("#joinDeclarationDialog_link").on("click",function(){var a=w.modules.healthResults.getSelectedProduct();w.modules.dialogs.show({title:"Declaration",url:"health_fund_info/"+a.info.provider.toUpperCase()+"/declaration.html"}),w.messaging.publish(x.tracking.EXTERNAL,{method:"trackOfferTerms",object:{productID:a.productId}})}),a("#submit_btn").on("click",function(){var b=w.modules.journeyEngine.isCurrentStepValid();w.site.isCallCentreUser===!0&&a(".agg_privacy").each(function(){var b=a(this);b.find(".error-count").remove();var c=b.find(".error-field label");b.children("button").after('<span class="error-count'+(c.length>0?" error-field":"")+'" style="margin-left:10px">'+c.length+" validation errors in this panel.</span>")}),b&&q()})},onBeforeEnter:function(b){if(b.isForward===!0){var c=w.modules.healthResults.getSelectedProduct();"undefined"!=typeof c.promo.discountText&&""!==c.promo.discountText?a("#health_payment_details-selection").find(".definition").show().html(c.promo.discountText):a("#health_payment_details-selection").find(".definition").hide().empty(),a("#mainform").find(".health_declaration span").text(c.info.providerName);var d=a("#health_payment_medicare_firstName"),e=a("#health_payment_medicare_surname");""===d.val()&&d.val(a("#health_application_primary_firstname").val()),""===e.val()&&e.val(a("#health_application_primary_surname").val());var f=w.modules.healthResults.getSelectedProduct(),g=["GMHBA","Frank","Bupa"];"N"==a("input[name=health_healthCover_rebate]:checked").val()&&-1==a.inArray(f.info.providerName,g)?a("#health_payment_medicare-selection").hide().attr("style","display:none !important"):a("#health_payment_medicare-selection").removeAttr("style")}}};A={startStep:b,detailsStep:c,benefitsStep:d,resultsStep:e,applyStep:f,paymentStep:g}}function f(){w.modules.journeyProgressBar.configure([{label:"Your Details",navigationId:A.startStep.navigationId,matchAdditionalSteps:[A.detailsStep.navigationId]},{label:"Your Cover",navigationId:A.benefitsStep.navigationId},{label:"Your Results",navigationId:A.resultsStep.navigationId},{label:"Your Application",navigationId:A.applyStep.navigationId},{label:"Your Payment",navigationId:A.paymentStep.navigationId}])}function g(){var b=a("#health_contactDetails_optin"),c={name:[{$field:a("#health_contactDetails_name")},{$field:a("#health_application_primary_firstname"),$otherField:a("#health_application_primary_surname")}],dob_primary:[{$field:a("#health_healthCover_primary_dob"),$fieldInput:a("#health_healthCover_primary_dob")},{$field:a("#health_application_primary_dob"),$fieldInput:a("#health_application_primary_dob")}],dob_secondary:[{$field:a("#health_healthCover_partner_dob"),$fieldInput:a("#health_healthCover_partner_dob")},{$field:a("#health_application_partner_dob"),$fieldInput:a("#health_application_partner_dob")}],email:[{$field:a("#health_contactDetails_email"),$optInField:b},{$field:a("#health_application_email"),$optInField:a("#health_application_optInEmail")}],mobile:[{$field:a("#health_contactDetails_contactNumber_mobile"),$fieldInput:a("#health_contactDetails_contactNumber_mobileinput"),$optInField:b},{$field:a("#health_application_mobile"),$fieldInput:a("#health_application_mobileinput")}],otherPhone:[{$field:a("#health_contactDetails_contactNumber_other"),$fieldInput:a("#health_contactDetails_contactNumber_otherinput"),$optInField:b},{$field:a("#health_application_other"),$fieldInput:a("#health_application_otherinput")}],postcode:[{$field:a("#health_situation_postcode")},{$field:a("#health_application_address_postCode"),$fieldInput:a("#health_application_address_postCode")}]};w.modules.contactDetails.configure(c)}function h(){var b=a(':input[name="health_situation_healthCvr"]').val();return"F"==b||"C"==b?!0:!1}function i(){return z}function j(){return null!=z&&z.rebate?z.rebate:0}function k(b){z=b,a("#health_rebate").val(z.rebate||""),a("#health_loading").val(z.loading||""),a("#health_primaryCAE").val(z.primaryCAE||""),a("#health_partnerCAE").val(z.partnerCAE||"")}function l(b){$healthCoverDetails=a(".health-cover_details");var c={dependants:$healthCoverDetails.find(':input[name="health_healthCover_dependants"]').val(),income:$healthCoverDetails.find(':input[name="health_healthCover_income"]').val(),rebate_choice:$healthCoverDetails.find('input[name="health_healthCover_rebate"]:checked').val(),primary_loading:$healthCoverDetails.find('input[name="health_healthCover_primary_healthCoverLoading"]:checked').val(),primary_current:$healthCoverDetails.find('input[name="health_healthCover_primary_cover"]:checked').val(),primary_loading_manual:$healthCoverDetails.find(".primary-lhc").val(),partner_loading:$healthCoverDetails.find('input[name="health_healthCover_partner_healthCoverLoading"]:checked').val(),partner_current:$healthCoverDetails.find('input[name="health_healthCover_partner_cover"]:checked').val(),partner_loading_manual:$healthCoverDetails.find(".partner-lhc").val(),cover:a(':input[name="health_situation_healthCvr"]').val()};""===a("#health_application_provider, #health_application_productId").val()?(c.primary_dob=$healthCoverDetails.find('input[name="health_healthCover_primary_dob"]').val(),c.partner_dob=$healthCoverDetails.find('input[name="health_healthCover_partner_dob"]').val()):(c.primary_dob=a("#health_application_primary_dob").val(),c.partner_dob=a("#health_application_partner_dob").val(),c.primary_current="NONE"==a("#clientFund").find(":selected").val()?"N":"Y",c.partner_current="NONE"==a("#partnerFund").find(":selected").val()?"N":"Y");var d=h();if(""===c.cover)return!1;if(""===c.rebate_choice)return!1;if(""===c.primary_dob)return!1;if(d&&""===c.partner_dob)return!1;if(returnAge(c.primary_dob)<0)return!1;if(d&&returnAge(c.partner_dob)<0)return!1;if("Y"===c.rebate_choice&&""===c.income)return!1;var e=/^(\d{1,2})\/(\d{1,2})\/(\d{4})$/;return c.primary_dob.match(e)?d&&!c.partner_dob.match(e)?!1:void w.modules.comms.post({url:"ajax/json/health_rebate.jsp",data:c,cache:!0,errorLevel:"warning",onSuccess:function(a){k(a),null!=b&&b(a)}}):!1}function m(b){b.preventDefault();var c=a("#health_application_address_suburbName").val(),d=a("#health_application_address_postCode").val(),e=a("#health_application_address_state").val();a("#health_situation_location").val([c,d,e].join(" ")),a("#health_situation_suburb").val(c),a("#health_situation_postcode").val(d),a("#health_situation_state").val(e),healthChoices.setState(e),window.location=this.href;var f=w.messaging.subscribe(x.journeyEngine.STEP_CHANGED,function(){w.messaging.unsubscribe(x.journeyEngine.STEP_CHANGED,f),w.modules.healthResults.get()})}function n(){try{var b=a("#health_situation_state").val(),c=a("#health_application_address_state").val();c.length&&c!=b&&(b=c);var d=null,e=a("input[name=health_application_primary_gender]:checked");e&&("M"==e.val()?d="Male":"F"==e.val()&&(d="Female"));var f="",g=a("#health_healthCover_primary_dob").val();g.length&&(f=g.split("/")[2]);var h="Y"===a("input[name=health_contactDetails_call]","#mainform").val()?"Y":"N",i="Y"===a("input[name=health_application_optInEmail]:checked","#mainform").val()?"Y":"N",j=a("#health_contactDetails_email").val(),k=a("#health_application_email").val();k.length>0&&(j=k);var l=w.modules.transactionId.get(),m=w.modules.journeyEngine.getCurrentStepIndex(),n=w.modules.journeyEngine.getFurtherestStepIndex(),o="";switch(m){case 0:o="health situation";break;case 1:o="health details";break;case 2:o="health cover";break;case 4:o="health application";break;case 5:o="health payment";break;case 6:o="health confirmation"}var p={vertical:"Health",actionStep:o,transactionID:l,quoteReferenceNumber:l,postCode:null,state:null,healthCoverType:null,healthSituation:null,gender:null,yearOfBirth:null,email:null,emailID:null,marketOptIn:null,okToCall:null};return n>w.modules.journeyEngine.getStepIndex("start")&&a.extend(p,{postCode:a("#health_application_address_postCode").val(),state:b,healthCoverType:a("#health_situation_healthCvr").val(),healthSituation:a("#health_situation_healthSitu").val()}),n>w.modules.journeyEngine.getStepIndex("details")&&a.extend(p,{yearOfBirth:f,email:j,marketOptIn:i,okToCall:h}),n>w.modules.journeyEngine.getStepIndex("apply")&&a.extend(p,{gender:d}),p}catch(q){return!1}}function o(){var b=a("#submit_btn");b.removeClass("disabled"),w.modules.loadingAnimation.hide(b)}function p(b){var c=a("#submit_btn");c.addClass("disabled"),b===!0&&w.modules.loadingAnimation.showAfter(c)}function q(){if(B===!0)return void alert("Your application is still being submitted. Please wait.");B=!0,w.messaging.publish(y.WEBAPP_LOCK,{source:"submitApplication"});try{var b=a("#health_payment_details_frequency").val(),c=w.modules.healthResults.getSelectedProductPremium(b),d=w.modules.healthResults.getNumberOfPeriodsForFrequency(b);a("#health_application_paymentAmt").val(c.value*d),a("#health_application_paymentFreq").val(c.value),a("#health_application_paymentHospital").val(c.hospitalValue*d);var e=w.modules.journeyEngine.getFormData();w.messaging.publish(y.WEBAPP_LOCK,{source:"submitApplication",disableFields:!0}),w.modules.comms.post({url:"ajax/json/health_application.jsp",data:e,cache:!1,useDefaultErrorHandling:!1,errorLevel:"silent",timeout:25e4,onSuccess:function(a){w.modules.leavePageWarning.disable();var b="health_confirmation.jsp?action=confirmation&transactionId="+w.modules.transactionId.get()+"&token=",c="";
""!==w.site.utm_source&&""!==w.site.utm_medium&&""!==w.site.utm_campaign&&(c="&utm_source="+w.site.utm_source+"&utm_medium="+w.site.utm_medium+"&utm_campaign="+w.site.utm_campaign),a.result&&a.result.success?window.location.replace(b+a.result.confirmationID+c):a.result&&a.result.pendingID&&a.result.pendingID.length>0&&(!a.result.callcentre||a.result.callcentre!==!0)?window.location.replace(b+a.result.pendingID+c):(w.messaging.publish(y.WEBAPP_UNLOCK,{source:"submitApplication"}),s(a))},onError:r,onComplete:function(){B=!1}})}catch(f){B=!1,r()}}function r(a,b,c,d,e){w.messaging.publish(y.WEBAPP_UNLOCK,{source:"submitApplication"}),B=!1,c==w.modules.comms.getCheckAuthenticatedLabel()||s("Server generated error"==b?c:e)}function s(b){var c=b;b.hasOwnProperty("error")&&"object"==typeof b.error&&(c=b.error);var d="",e=!1;try{if(b.result&&b.result.errors){var f=b.result.errors;a.isArray(f.error)&&(f=f.error),a.each(f,function(a,b){d+="<p>",d+="[Code: "+b.code+"] "+b.text,d+="</p>"}),""===d&&(d="An unhandled error was received.")}else if(c&&c.hasOwnProperty("type"))switch(c.type){case"validation":e=!0;break;case"timeout":d="Fund application service timed out.";break;case"parsing":d="Error parsing the XML request - report issue to developers.";break;case"confirmed":d=c.message;break;case"transaction":d=c.message;break;case"submission":d=c.message;break;default:d="["+c.code+"] "+c.message+" (Please report to IT before continuing)"}else d="An unhandled error was received."}catch(g){d="Application unsuccessful. Failed to handle response: "+g.message}e?(w.modules.serverSideValidationOutput.outputValidationErrors({validationErrors:c.errorDetails.validationErrors,startStage:"payment"}),"undefined"!=typeof c.transactionId&&w.modules.transactionId.set(c.transactionId)):(w.site.isCallCentreUser===!1&&(d="Please contact us on "+w.site.content.callCentreHelpNumber+" for assistance."),w.modules.errorHandling.error({message:"<strong>Application failed:</strong><br/>"+d,page:"health.js",errorLevel:"warning",description:"handleSubmittedApplicationErrors(). Submit failed: "+d,data:b}),healthFunds.applicationFailed&&healthFunds.applicationFailed())}function t(){a("#health_simples_contactType_inbound").is(":checked")?(a(".follow-up-call").addClass("hidden"),a(".simples-privacycheck-statement, .new-quote-only").removeClass("hidden")):a("#health_simples_contactType_outbound").is(":checked")&&(a(".follow-up-call").removeClass("hidden"),a(".simples-privacycheck-statement, .new-quote-only").addClass("hidden"))}function u(){a("#health_healthCover_rebate_Y").is(":checked")?a(".simples-dialogue-37").removeClass("hidden"):a("#health_healthCover_rebate_N").is(":checked")&&a(".simples-dialogue-37").addClass("hidden")}function v(){a(document).ready(function(){return"health"!==w.site.vertical?!1:(b(),"confirmation"===w.site.pageAction?!1:(w.site.isCallCentreUser===!1&&setInterval(function(){var b=a("#chat-health-insurance-sales").html();""===b||"<span></span>"===b?a("#contact-panel").removeClass("hasButton"):a("#contact-panel").addClass("hasButton")},5e3),c(),g(),("amend"===w.site.pageAction||"load"===w.site.pageAction||"start-again"===w.site.pageAction)&&("undefined"!=typeof healthFunds&&healthFunds.checkIfNeedToInjectOnAmend?healthFunds.checkIfNeedToInjectOnAmend(function(){w.modules.form.markInitialFieldsWithValue(a("#mainform"))}):w.modules.form.markInitialFieldsWithValue(a("#mainform"))),a("#health_contactDetails_optin").on("click",function(){a("#health_contactDetails_optInEmail").val(a(this).is(":checked")?"Y":"N"),a("#health_contactDetails_call").val(a(this).is(":checked")?"Y":"N")}),"Y"===a('input[name="health_directApplication"]').val()&&(a("#health_application_productId").val(w.site.loadProductId),a("#health_application_productTitle").val(w.site.loadProductTitle)),void healthDependents.init()))})}var w=window.meerkat,x=w.modules.events,y={health:{CHANGE_MAY_AFFECT_PREMIUM:"CHANGE_MAY_AFFECT_PREMIUM"},WEBAPP_LOCK:"WEBAPP_LOCK",WEBAPP_UNLOCK:"WEBAPP_UNLOCK"},z=null,A=null,B=!1;w.modules.register("health",{init:v,events:y,initProgressBar:d,getTrackingFieldsObject:n,getRates:i,getRebate:j,loadRates:l})}(jQuery),function(a){function b(){var b=a("#health_benefits_benefitsExtras_Hospital").is(":checked"),c=a("#health_benefits_benefitsExtras_GeneralHealth").is(":checked");return b>0&&c?"Combined":b?"Hospital":c?"GeneralHealth":"None"}function c(a,b,c){return E?void 0:""===a?(e([],b),void("function"==typeof c&&c())):void C.modules.comms.post({url:"ajax/csv/get_benefits.jsp",data:{situation:a},errorLevel:"silent",cache:!0,onSuccess:function(a){defaultBenefits=a.split(","),e(defaultBenefits,b),"function"==typeof c&&c()}})}function d(){a("#mainform input[type='hidden'].benefit-item").val("")}function e(b,c){c&&d();for(var e=0;e<b.length;e++){var f=b[e];a("#mainform input[name='health_benefits_benefitsExtras_"+f+"'].benefit-item").val("Y")}}function f(){z.find(".benefits-list input[type='checkbox']").prop("checked",!1),B&&z.find(".benefits-list input[type='checkbox']").change()}function g(){f(),a("#mainform input.benefit-item").each(function(b,c){var d=a(c);if("Y"==d.val()){var e=d.attr("name");z.find(".benefits-list :input[name='"+e+"']").prop("checked",!0),B&&z.find(".benefits-list :input[name='"+e+"']").change()}}),z.find("input.checkbox-switch").bootstrapSwitch("setState"),z.find("input.hasChildren").each(function(a,b){i(b)})}function h(){0===z.find(":input.hasChildren:checked").length?(z.find(".btn-save").prop("disabled",!0),z.find("a.btn-save").addClass("disabled")):(z.find(".btn-save").prop("disabled",!1),z.find("a.btn-save").removeClass("disabled")),i(a(this))}function i(b){var c=a(b),d=!c.is(":checked"),e=c.parents(".short-list-item").first(),f=e.find(".children :input");f.prop("disabled",d),d===!0?(e.addClass("disabled"),f.prop("checked",!1)):e.removeClass("disabled"),B&&f.change()}function j(){var b=[];return a("#mainform input.benefit-item").each(function(c,d){var e=a(d);if("Y"==e.val()){var f=e.attr("data-skey");b.push(f)}}),b}function k(){d();var b=[];return z.find(":input:checked").each(function(c,d){var e=a("#mainform input[name='"+a(d).attr("name")+"'].benefit-item");e.val("Y"),b.push(e.attr("data-skey"))}),_.contains(b,"Hospital")?a("#filter-tierHospital").removeClass("hidden"):(a("#filter-tierHospital").addClass("hidden"),a("#filters_tierHospital").val(""),a("#health_filter_tierHospital").val("")),_.contains(b,"GeneralHealth")?a("#filter-tierExtras").removeClass("hidden"):(a("#filter-tierExtras").addClass("hidden"),a("#filters_tierExtras").val(""),a("#health_filter_tierExtras").val("")),b}function l(){var a="";C.modules.journeyEngine.getCurrentStep()&&(a=C.modules.journeyEngine.getCurrentStep().navigationId),("benefits"===a||"results"===a)&&C.modules.journeyEngine.loadingShow("getting your quotes",!0),s(),_.defer(function(){var a=k();A===I?C.modules.journeyEngine.gotoPath("next"):C.messaging.publish(G.CHANGED,a),C.site.isCallCentreUser===!0&&(E=!0)})}function m(b){$target=a(b.currentTarget),$target.find("input").prop("disabled")===!0&&($target.parents(".hasShortlistableChildren").first().find(".title").first().find(":input").prop("checked",!0),z.find("input.checkbox-switch").bootstrapSwitch("setState"))}function n(){var b=a("#health_situation_healthSitu").val(),d=o();""===d||"ATP"===b?c(b,!0):c(b,!0,function(){c(d,!1)})}function o(){var b=a("#health_situation_healthCvr").val(),c=a("#health_healthCover_primary_dob").val(),d=a("#health_healthCover_partner_dob").val(),e=0,f=0,g=0,h="";return"F"===b||"SPF"===b?h="FAM":"S"===b&&""!==c?(g=returnAge(c,!0),h=p(g)):"C"===b&&""!==c&&""!==d&&(e=returnAge(c),f=returnAge(d),e>=16&&120>=e&&f>=16&&120>=f&&(g=Math.floor((e+f)/2),h=p(g))),h}function p(a){return a>=16&&30>=a?"YOU":a>=31&&55>=a?"MID":a>=56&&120>=a?"MAT":""}function q(a){A=a,C.modules.navMenu.open(),y.hasClass("open")===!1&&(z.addClass(A),y.find(".activator").dropdown("toggle"))}function r(){z.find(":input.hasChildren").on("change.benefits",h),z.find(".btn-save").on("click.benefits",l),z.find(".btn-cancel").on("click.benefits",s),z.find(".categoriesCell .checkbox").on("click.benefits",m)}function s(){y.hasClass("open")&&(v()?(x(),y.find(".activator").dropdown("toggle"),w()):y.find(".activator").dropdown("toggle"),C.modules.navMenu.close())}function t(){z.find("input.hasChildren").off("change.benefits"),z.find(".btn-save").off("click.benefits"),z.find(".btn-cancel").off("click.benefits"),z.find(".categoriesCell .checkbox").off("click.benefits",m),z.removeClass("journey-mode"),z.removeClass("popover-mode"),A=null}function u(){a(document).ready(function(){return"health"!==C.site.vertical||"confirmation"===C.site.pageAction?!1:(y=a("#benefits-dropdown"),z=a(".benefits-component"),B=C.modules.performanceProfiling.isIE8(),y.on("show.bs.dropdown",function(){null===A&&(A=H),r(),g()}),y.on("hide.bs.dropdown",function(a){2==C.modules.journeyEngine.getCurrentStepIndex()&&(a.preventDefault(),C.modules.dropdownInteractive.addBackdrop(y))}),y.on("hidden.bs.dropdown",function(){t()}),C.messaging.subscribe(D.journeyEngine.STEP_CHANGED,function(a){"benefits"!==a.navigationId&&C.modules.healthBenefits.close()}),a("[data-benefits-control='Y']").click(function(a){a.preventDefault(),a.stopPropagation(),q(H)}),a("#health_situation_healthSitu").add("#health_healthCover_primary_dob").add("#health_healthCover_partner_dob").add("#health_situation_healthCvr").on("change",function(){n()}),C.messaging.subscribe(D.WEBAPP_LOCK,w),void C.messaging.subscribe(D.WEBAPP_UNLOCK,x))})}function v(){return y.children(".activator").hasClass("disabled")}function w(){y.children(".activator").addClass("inactive").addClass("disabled")}function x(){y.children(".activator").removeClass("inactive").removeClass("disabled")}var y,z,A,B,C=window.meerkat,D=C.modules.events,E=(C.logging.info,!1),F={healthBenefits:{CHANGED:"HEALTH_BENEFITS_CHANGED"}},G=F.healthBenefits,H="popover-mode",I="journey-mode";C.modules.register("healthBenefits",{init:u,events:F,open:q,close:s,getProductCategory:b,getSelectedBenefits:j,getBenefitsForSituation:c})}(jQuery),function(a,b){function c(){jQuery(document).ready(function(a){"undefined"!=typeof e.site&&"confirmation"===e.site.pageAction&&(e.modules.health.initProgressBar(!0),e.modules.journeyProgressBar.setComplete(),e.modules.journeyProgressBar.disable(),result.hasOwnProperty("data")===!1||"OK"!=result.data.status||""===result.data.product?e.modules.errorHandling.error({message:result.data.message,page:"healthConfirmation.js module",description:"Trying to load the confirmation page failed",data:null,errorLevel:"warning"}):(g=a.extend({},result.data),g.mode="lhcInc",g.product?(g.pending=!1,g.product=a.parseJSON(g.product),g.product.price&&_.isArray(g.product.price)&&(g.product=g.product.price[0]),a.extend(g,g.product),delete g.product):"object"==typeof sessionProduct?(sessionProduct.price&&_.isArray(sessionProduct.price)&&(sessionProduct=sessionProduct.price[0]),g.transID===sessionProduct.transactionId?a.extend(g,sessionProduct):sessionProduct=b,g.pending=!0):g.pending=!0,e.modules.healthMoreInfo.setProduct(g),e.modules.healthMoreInfo.prepareCover(),1==g.frequency.length&&(g.frequency=e.modules.healthResults.getFrequencyInWords(g.frequency)),g._selectedFrequency=g.frequency,d(),e.modules.healthMoreInfo.applyEventListeners(),e.messaging.publish(f.tracking.EXTERNAL,{method:"completedApplication",object:{productID:g.productId}})))})}function d(){var b=a("#confirmation-template").html(),c=_.template(b),d=c(g);a("#confirmation").html(d),e.messaging.subscribe(f.healthPriceComponent.INIT,function(){e.modules.healthPriceComponent.updateProductSummaryHeader(g,g.frequency,!0),e.modules.healthPriceComponent.updateProductSummaryDetails(g,g.startDate,!1)}),""===g.about&&e.modules.healthMoreInfo.prepareExternalCopy(function(){a(".aboutFund").append(g.aboutFund).parents(".displayNone").first().removeClass("displayNone")})}var e=window.meerkat,f=e.modules.events,g=(e.logging.info,null);e.modules.register("healthConfirmation",{init:c})}(jQuery),function(a){function b(){c("value")}function c(b,c){var d=b||"value";n.find("[data-filter-type]").each(function(){var b=a(this),e=b.attr("data-filter-type"),f=b.attr("id"),g="";if("undefined"!=typeof f){if("slider"===e&&(b.find(".slider-control").trigger("UPDATE"),g=b.find(".slider").val()),"radio"===e&&(g=b.find(":checked").val()||"",c!==!0))if("filter-frequency"===f){try{g=Results.getFrequency()}catch(h){}g=p.modules.healthResults.getFrequencyInLetters(g)||"A",b.find('input[value="'+g+'"]').prop("checked",!0).change()}else if("filter-sort"===f){try{g=Results.getSortBy()}catch(h){}g=g.indexOf("price")>-1?"L":"B",b.find('input[value="'+g+'"]').prop("checked",!0).change()}if("select"===e&&(g=b.find(":selected").val()||"",c!==!0&&("filter-tierHospital"===f?(g=a("#health_filter_tierHospital").val(),b.find("select").val(g)):"filter-tierExtras"===f&&(g=a("#health_filter_tierExtras").val(),b.find("select").val(g)))),"checkbox"===e){var i=[];i="filter-provider"===f?b.find("[type=checkbox]:not(:checked)").map(function(){return this.value}):b.find("[type=checkbox]:checked").map(function(){return this.value}),g=i.get().join(s),c!==!0&&"filter-provider"===f&&(g=a("#health_filter_providerExclude").val(),i=g.split(s),b.find(":checkbox").each(function(){var b=a(this);a.inArray(b.attr("value"),i)<0?b.prop("checked",!0).change():b.prop("checked",!1).change()}))}r.hasOwnProperty(f)||(r[f]={}),r[f].type=e,r[f][d]=g}})}function d(){var a,b;for(b in r)if(r.hasOwnProperty(b))switch(a=r[b].value,r[b].type){case"slider":n.find("#"+b+" .slider").val(a);break;case"radio":""===a?n.find("#"+b+" input").prop("checked",!1).change():n.find("#"+b+' input[value="'+a+'"]').prop("checked",!0).change();break;case"select":n.find("#"+b+" select").val(a)}}function e(){var b=o.find("[type=checkbox]:checked").length;return 1>b?(o.find(":checkbox").addClass("has-error"),0===o.find(".alert").length&&o.prepend('<div id="health-filter-alert" class="alert alert-danger">Please select at least 1 brand to compare results</div>'),void(window.location.href="#health-filter-alert")):(o.find(":checkbox").removeClass("has-error"),o.find(".alert").remove(),n.addClass("is-saved"),h(),"xs"===p.modules.deviceMediaState.get()?p.modules.navMenu.close():m.closest(".navbar-collapse").removeClass("in"),void _.defer(function(){var b,d,e,f=!1;c("valueNew",!0);for(e in r)if(r.hasOwnProperty(e)&&r[e].value!==r[e].valueNew&&a("#"+e).attr("data-filter-serverside")){f=!0;break}for(e in r)if(r.hasOwnProperty(e)&&(b=r[e].value,d=r[e].valueNew,b!==d))if("filter-frequency"===e)a("#health_filter_frequency").val(d),d=p.modules.healthResults.getFrequencyInWords(d)||"monthly",f||(refreshView=!0,r.hasOwnProperty("filter-sort")&&"L"===r["filter-sort"].value&&r["filter-sort"].value===r["filter-sort"].valueNew&&(refreshSort=!0)),Results.setFrequency(d,!1);else if("filter-sort"===e){var g="asc";switch(d){case"L":if(r.hasOwnProperty("filter-frequency")){d=p.modules.healthResults.getFrequencyInWords(r["filter-frequency"].valueNew)||"monthly",d="price."+d;break}d="price.monthly";break;default:d="benefitsSort"}Results.setSortBy(d),Results.setSortDir(g)}else"filter-tierHospital"===e?a("#health_filter_tierHospital").val(d):"filter-tierExtras"===e?a("#health_filter_tierExtras").val(d):"filter-provider"===e&&a("#health_filter_providerExclude").val(d);p.messaging.publish(u.CHANGED),f?_.defer(function(){p.modules.journeyEngine.loadingShow("...updating your quotes...",!0),_.delay(function(){p.modules.healthResults.get()},100)}):Results.applyFiltersAndSorts()}))}function f(){m.hasClass("open")===!1&&m.find(".activator").dropdown("toggle")}function g(){n.find(".btn-save").on("click.filters",e),n.find(".btn-cancel").on("click.filters",h)}function h(){m.hasClass("open")&&m.find(".activator").dropdown("toggle")}function i(){n.hasClass("is-saved")?n.removeClass("is-saved"):d(),n.find(".btn-save").off("click.filters"),n.find(".btn-cancel").off("click.filters"),n.find(":checkbox").removeClass("has-error"),n.find(".alert").remove()}function j(){a(".selectNotRestrictedBrands").on("click",function(){a(".notRestrictedBrands [type=checkbox]:not(:checked)").prop("checked",!0).change()}),a(".unselectNotRestrictedBrands").on("click",function(){a(".notRestrictedBrands [type=checkbox]:checked").prop("checked",!1).change()}),a(".selectRestrictedBrands").on("click",function(){a(".restrictedBrands [type=checkbox]:not(:checked)").prop("checked",!0).change()}),a(".unselectRestrictedBrands").on("click",function(){a(".restrictedBrands [type=checkbox]:checked").prop("checked",!1).change()})}function k(){var b=a("#health_filter_frequency").val();b.length>0&&(a("#filter-fequency").find('input[value="'+b+'"]').prop("checked",!0),p.modules.healthPriceRangeFilter.setUp())}function l(){a(document).ready(function(){return"health"!==p.site.vertical||"confirmation"===p.site.pageAction?!1:(m=a("#filters-dropdown"),n=a(".filters-component"),o=a("#filter-provider"),m.on("show.bs.dropdown",function(){g(),b()}),m.on("hidden.bs.dropdown",function(){i()}),o.find(":checkbox").on("change",function(){a(this).removeClass("has-error"),o.find(".alert").remove()}),j(),k(),p.messaging.subscribe(q.WEBAPP_LOCK,function(){h(),m.children(".activator").addClass("inactive").addClass("disabled")}),void p.messaging.subscribe(q.WEBAPP_UNLOCK,function(){m.children(".activator").removeClass("inactive").removeClass("disabled")}))})}var m,n,o,p=window.meerkat,q=p.modules.events,r=(p.logging.info,{}),s=",",t={healthFilters:{CHANGED:"HEALTH_FILTERS_CHANGED"}},u=t.healthFilters;p.modules.register("healthFilters",{init:l,events:t,open:f,close:h})}(jQuery),function(a){function b(){B=a(".resultsHeadersBg").height()}function c(){A=a(".moreInfoDropdown"),jQuery(document).ready(function(a){return"health"!=C.site.vertical||"confirmation"==C.site.pageAction?!1:(w=a("#more-info-template").html(),void("undefined"!=typeof w&&(x=_.template(w),d(),f())))})}function d(){"undefined"!=typeof Results.settings&&("xs"!=C.modules.deviceMediaState.get()?a(Results.settings.elements.page).on("click",".btn-more-info",n):a(Results.settings.elements.page).on("click",".btn-more-info",j),a(Results.settings.elements.page).on("click",".btn-close-more-info",o)),a(document).on("resultsFetchStart",function(){C.modules.healthMoreInfo.close()}),a(document.body).on("click",".btn-more-info-apply",function(){var b=a(this);b.addClass("inactive").addClass("disabled"),C.modules.loadingAnimation.showInside(b,!0),_.defer(function(){Results.getSelectedProduct()!==!1&&Results.getSelectedProduct().productId!=b.attr("data-productId")&&a("#health_declaration:checked").prop("checked",!1).change(),Results.setSelectedProduct(b.attr("data-productId"));var c=Results.getSelectedProduct();if(c){C.modules.healthResults.setSelectedProduct(c),healthFunds.load(c.info.provider,e);var d=C.modules.transactionId.get();C.messaging.publish(D.tracking.EXTERNAL,{method:"trackHandoverType",object:{type:"Online_R",quoteReferenceNumber:d,transactionID:d,productID:"productID"}})}else e(!1)})}),a(document.body).on("click",".dialogPop",function(){C.modules.dialogs.show({title:a(this).attr("title"),htmlContent:a(this).attr("data-content")})}),a(document.body).on("click",".more-info",function(){p(C.modules.healthResults.getSelectedProduct()),k()})}function e(b){_.delay(function(){a(".btn-more-info-apply").removeClass("inactive").removeClass("disabled"),C.modules.loadingAnimation.hide(a(".btn-more-info-apply"))},1e3),b===!0&&C.modules.address.setHash("apply")}function f(){C.messaging.subscribe(D.device.STATE_CHANGE,function(){b()}),a(document).on("resultPageChange",function(){H&&o()}),C.messaging.subscribe(D.device.STATE_ENTER_XS,function(){H&&o(),a(Results.settings.elements.page).off("click",".btn-more-info"),a(Results.settings.elements.page).on("click",".btn-more-info",j)}),C.messaging.subscribe(D.device.STATE_LEAVE_XS,function(){G&&m(),a(Results.settings.elements.page).off("click",".btn-more-info"),a(Results.settings.elements.page).on("click",".btn-more-info",n)}),C.messaging.subscribe(F.bridgingPage.SHOW,function(a){h(a.isOpen)}),C.messaging.subscribe(F.bridgingPage.HIDE,function(a){h(a.isOpen)})}function g(c){c.html(C.modules.loadingAnimation.getTemplate()).show(),r(function(){var d=x(y);c.find(".spinner").fadeOut(),c.html(d),C.site.emailBrochures.enabled&&l(y,c,a("#resultsForm")),a(".more-info-content .next-info-all").html(a(".more-info-content .next-steps-all-funds-source").html());var e=400,f=250,g=0;H?(c.find(".more-info-content").fadeIn(e),g=e):(C.modules.utilities.scrollPageTo(".resultsHeadersBg",f,-a("#navbar-main").height(),function(){c.find(".more-info-content").slideDown(e)}),g=e+f),H=!0,_.delay(function(){C.messaging.publish(F.bridgingPage.SHOW,{isOpen:H}),H||(b(),c.css({top:B}))},g),C.messaging.publish(D.tracking.EXTERNAL,{method:"trackProductView",object:{productID:y.productId}})})}function h(b){b?a(Results.settings.elements.page).css("overflow","hidden").height(A.outerHeight()):a(Results.settings.elements.page).css("overflow","visible").height("")}function i(b){a(Results.settings.elements.page).find(".result").removeClass("faded"),a(".btn-close-more-info").removeClass("btn-close-more-info").addClass("btn-more-info"),b.slideUp(400,function(){b.html("").hide(),H=!1,C.messaging.publish(F.bridgingPage.CHANGE,{isOpen:H}),C.messaging.publish(F.bridgingPage.HIDE,{isOpen:H})})}function j(){var b=a(this),c=b.attr("data-productId"),d=b.hasClass("more-info-showapply");p(Results.getResult("productId",c),d),k()}function k(){r(function(){var b="<form class='healthMoreInfoModel'>"+x(y)+"</form>";z=C.modules.dialogs.show({htmlContent:b,className:"modal-breakpoint-wide modal-tight",onOpen:function(b){C.site.emailBrochures.enabled&&l(y,a("#"+b),a("#"+b).find(".healthMoreInfoModel"))}}),a(".more-info-content .next-info .next-info-all").html(a(".more-info-content .next-steps-all-funds-source").html()),a(".more-info-content .moreInfoRightColumn > .dualPricing").insertAfter(a(".more-info-content .moreInfoMainDetails")),G=!0,a(".more-info-content").show(),C.messaging.publish(D.tracking.EXTERNAL,{method:"trackProductView",object:{productID:y.productId}})})}function l(a,b,c){var d=b.find(".moreInfoEmailBrochures");d.show(),C.modules.emailBrochures.setup({emailInput:d.find(".sendBrochureEmailAddress"),submitButton:d.find(".btn-email-brochure"),form:c,marketing:d.find(".optInMarketing"),productData:[{name:"hospitalPDSUrl",value:a.promo.hospitalPDF},{name:"extrasPDSUrl",value:a.promo.extrasPDF},{name:"provider",value:a.info.provider},{name:"providerName",value:a.info.providerName},{name:"productName",value:a.info.productTitle},{name:"productId",value:a.productId},{name:"productCode",value:a.info.productCode},{name:"premium",value:a.premium[Results.settings.frequency].lhcfreetext},{name:"premiumText",value:a.premium[Results.settings.frequency].lhcfreepricing}],product:a,identifier:"SEND_BROCHURES"+a.productId,emailResultsSuccessCallback:function(c,d){c.success?(b.find(".formInput").hide(),b.find(".moreInfoEmailBrochuresSuccess").show(),C.modules.emailBrochures.tearDown(d)):C.modules.errorHandling.error({errorLevel:"warning",message:"Oops! Something seems to have gone wrong. Please try again by re-entering your email address or alternatively contact our call centre on "+C.site.content.callCentreHelpNumber+" and they'll be able to assist you further.",page:"healthMoreInfo.js:onSendBrochuresCallback",description:c.message,data:a})}})}function m(){a("#"+z).modal("hide"),G=!1}function n(){var b=a(this);a(Results.settings.elements.page).find(".result").addClass("faded"),a(".btn-close-more-info").removeClass("btn-close-more-info").addClass("btn-more-info"),b.parents(".result").removeClass("faded"),b.removeClass("btn-more-info").addClass("btn-close-more-info");var c=b.attr("data-productId"),d=b.hasClass("more-info-showapply");p(Results.getResult("productId",c),d),C.modules.resultsHeaderBar.disableAffixMode(),g(A)}function o(){i(A),C.modules.resultsHeaderBar.enableAffixMode(),G&&m()}function p(a,b){return y=a,y!==!1&&(y.showApply=b===!0?!0:!1),y}function q(){return H===!1?null:y}function r(a){s(),t(a)}function s(){"undefined"==typeof y.hospitalCover&&"undefined"!=typeof y.hospital&&"undefined"!=typeof y.hospital.benefits&&(u("hospital.benefits","hospitalCover"),v(y.hospital.inclusions.publicHospital,"hospitalCover","Public Hospital"),v(y.hospital.inclusions.privateHospital,"hospitalCover","Private Hospital")),"undefined"==typeof y.extrasCover&&"undefined"!=typeof y.extras&&"object"==typeof y.extras&&u("extras","extrasCover")}function t(b){y.aboutFund="<p>Apologies. This information did not download successfully.</p>",y.whatHappensNext="<p>Apologies. This information did not download successfully.</p>",a.when(C.modules.comms.get({url:"health_fund_info/"+y.info.provider+"/about.html",cache:!0,errorLevel:"silent",onSuccess:function(a){y.aboutFund=a}}),C.modules.comms.get({url:"health_fund_info/"+y.info.provider+"/next_info.html",cache:!0,errorLevel:"silent",onSuccess:function(a){y.whatHappensNext=a}})).then(b,b)}function u(a,b){y[b]={inclusions:[],restrictions:[],exclusions:[]};var c,d;_.each(Object.byString(y,a),function(e,f){c=a+"."+f+".covered",foundObject=_.findWhere(resultLabels,{p:c}),"undefined"!=typeof foundObject&&(d=foundObject.n,v(e.covered,b,d))})}function v(a,b,c){switch(a){case"Y":y[b].inclusions.push(c);break;case"R":y[b].restrictions.push(c);break;case"N":y[b].exclusions.push(c)}}var w,x,y,z,A,B,C=window.meerkat,D=C.modules.events,E={healthMoreInfo:{bridgingPage:{CHANGE:"BRIDGINGPAGE_CHANGE",SHOW:"BRIDGINGPAGE_SHOW",HIDE:"BRIDGINGPAGE_HIDE"}}},F=E.healthMoreInfo,G=!1,H=!1;C.modules.register("healthMoreInfo",{initMoreInfo:c,events:E,setProduct:p,prepareProduct:r,prepareCover:s,prepareExternalCopy:t,getOpenProduct:q,close:o,applyEventListeners:d})}(jQuery),function(a){function b(){a(document).ready(function(){d=a(".health_payment_day"),e=a(".health_details-policyDate"),d.on("change",function(){f.messaging.publish(g.POLICY_DATE_CHANGE,a(this).val())})})}function c(a,b,c,d){"undefined"==typeof d&&(d=7),("undefined"==typeof c||c.length<1)&&(c=[1]);var g=null;g="undefined"==typeof b||""===b?new Date:f.modules.utilities.returnDate(b),g=new Date(g.getTime()+24*d*60*60*1e3);for(var h=0,i=!1;31>h&&!i;)g=new Date(g.getTime()+864e5),i=_.contains(c,g.getDate()),h++;e.val(f.modules.utilities.returnDateValue(g)),a.text("Your payment will be deducted on: "+healthFunds._getNiceDate(g))}var d,e,f=window.meerkat,g={POLICY_DATE_CHANGE:"POLICY_DATE_CHANGE"};f.modules.register("healthPaymentDate",{init:b,events:g,paymentDaysRenderEarliestDay:c})}(jQuery),function(a){function b(a){return a.origin!==q.origin?void console.error("domain name mismatch"):void("string"==typeof a.data&&"page loaded"===a.data?clearTimeout(u):e(a.data))}function c(){}function d(b){q=b,j=a("#"+q.name+"_nab_cardNumber"),k=a("#"+q.name+"_nab_crn"),l=a("#"+q.name+"_nab_rescode"),m=a("#"+q.name+"_nab_restext"),n=a("#"+q.name+"_nab_expiryMonth"),o=a("#"+q.name+"_nab_expiryYear"),p=a("#"+q.name+"_nab_cardType"),a(".gatewayProvider").text("NAB")}function e(a){var b=JSON.parse(a);f(b)?r.messaging.publish(r.modules.events.paymentGateway.SUCCESS,b):r.messaging.publish(r.modules.events.paymentGateway.FAIL,b)}function f(a){var b=a&&a.CRN&&""!==a.CRN;return b=b&&"00"==a.rescode}function g(a){return j.val(a.pan),k.val(a.CRN),l.val(a.rescode),m.val(a.restext),n.val(a.expMonth),o.val(a.expYear),p.val(a.cardType),!0}function h(a){"undefined"!=typeof a&&(l.val(a.rescode),m.val(a.restext)),j.val(""),k.val(""),l.val(""),m.val(""),n.val(""),o.val(""),p.val("")}function i(a){clearTimeout(u),u=_.delay(function(){r.messaging.publish(s.paymentGateway.FAIL)},45e3);var c='<iframe width="100%" height="390" frameBorder="0" src="'+q.src+"external/hambs/nab_ctm_iframe.jsp?src="+q.hambsIframe.src+"&remote="+q.hambsIframe.remote+"&b="+q.brandCode+'"></iframe>';r.modules.dialogs.changeContent(a,c),window.addEventListener?window.addEventListener("message",b,!1):window.attachEvent&&window.attachEvent("onmessage",b)}var j,k,l,m,n,o,p,q,r=window.meerkat,s=r.modules.events,t=(r.logging.info,{healthPaymentGatewayNAB:{}}),u=(t.healthPaymentGatewayNAB,!1);r.modules.register("healthPaymentGatewayNAB",{init:c,success:g,fail:h,onOpen:i,setup:d})}(jQuery),function(a){function b(){}function c(b){l=b,g=a("#"+l.name+"-registered"),h=a("#"+l.name+"_number"),i=a("#"+l.name+"_type"),j=a("#"+l.name+"_expiry"),k=a("#"+l.name+"_name"),a(".gatewayProvider").text("Westpac")}function d(a){return a&&a.number&&a.type&&a.expiry&&a.name?(h.val(a.number),i.val(a.type),j.val(a.expiry),void k.val(a.name)):(m.messaging.publish(m.modules.events.paymentGateway.FAIL,"Registration response parameters invalid"),!1)}function e(){g.val(""),h.val(""),i.val(""),j.val(""),k.val("")}function f(a){clearTimeout(n),n=setTimeout(function(){m.modules.dialogs.changeContent(a,'<iframe width="100%" height="340" frameBorder="0" src="'+l.src+"?transactionId="+m.modules.transactionId.get()+'"></iframe>')},1e3)}var g,h,i,j,k,l,m=window.meerkat,n=!1;m.modules.register("healthPaymentGatewayWestpac",{success:d,fail:e,onOpen:f,init:b,setup:c})}(jQuery),function(a){function b(){a(document).ready(function(){a('[data-provide="payment-ipp"]').each(function(){var b=a(this);r=b.find(".payment-ipp-tokenisation"),s=a("#health_payment_credit_type"),q=b.find(".payment-ipp-maskedNumber"),q.prop("readonly",!0),q.css("cursor","pointer"),q.on("click",function(){e()})})})}function c(){a('[data-provide="payment-ipp"]').removeClass("hidden")}function d(){a('[data-provide="payment-ipp"]').addClass("hidden")}function e(){q.is(":visible")&&i()&&(h(t),k()||f())}function f(){return u===!0||k()?!1:(u=!0,q.val("Loading..."),l(),void p.modules.comms.post({url:"ajax/json/ipp/ipp_payment.jsp?ts="+(new Date).getTime(),dataType:"json",cache:!1,errorLevel:"silent",data:{transactionId:p.modules.transactionId.get()},onSuccess:g,onError:function(){j("IPP Token Session Request http")},onComplete:function(){u=!1}}))}function g(a){if(k())return!1;if(!a||!a.result||a.result.success!==!0)return void j("IPP Token Session Request fail");var b=a.result.url+"?SessionId="+a.result.refId+"&sst="+a.result.sst+"&cardType="+m()+"&registerError=false&resultPage=0",c='<p class="message"></p>';htmlContent=c+'<iframe width="100%" height="110" frameBorder="0" src="'+b+'" tabindex="" id="cc-frame"></iframe>',p.modules.dialogs.changeContent(o,htmlContent)}function h(a){v=(new Date).getTime(),("undefined"==typeof a||0===a.length)&&(a=p.modules.loadingAnimation.getTemplate()),o=p.modules.dialogs.show({htmlContent:a,title:"Credit Card Number",buttons:[{label:"Cancel",className:"btn-default",closeWindow:!0}],onOpen:function(){p.modules.tracking.recordSupertag("trackCustomPage","Payment gateway popup")},onClose:function(){j("User closed process")}})}function i(){return s.valid()}function j(a){if(""===r.val()){p.modules.dialogs.changeContent(o,"<p>We're sorry but our system is down and we are unable to process your credit card details right now.</p><p>Continue with your application and we can collect your details after you join.</p>");var b=", "+Math.round(((new Date).getTime()-v)/1e3)+" seconds";r.val("fail, "+a+b),q.val("Try again or continue"),t=""}}function k(){return""===t?!1:!0}function l(){r.val(""),q.val(""),t=""}function m(){switch(s.find("option:selected").val()){case"v":return"Visa";case"a":return"Amex";case"m":return"Mastercard";case"d":return"Diners";default:return"Unknown"}}function n(a){a.transactionId=p.modules.transactionId.get(),p.modules.comms.post({url:"ajax/json/ipp/ipp_log.jsp?ts="+(new Date).getTime(),data:a,dataType:"json",cache:!1,errorLevel:"silent",onSuccess:function(b){return b&&b.result&&b.result.success===!0?(r.val(a.sessionid),q.val(a.maskedcardno),t="",void p.modules.dialogs.close(o)):void j("IPP Token Log false")},onError:function(){j("IPP Token Log http")}})}var o,p=window.meerkat,q=[],r=[],s=[],t="",u=!1,v=0;p.modules.register("healthPaymentIPP",{init:b,show:c,hide:d,fail:j,register:n})}(jQuery),function(a){function b(){a(document).ready(function(){return"health"!==A.site.vertical||"confirmation"===A.site.pageAction?!1:($coverStateDate=a("#health_payment_details_start"),$coverStateDateCalendar=a("#health_payment_details_start_calendar"),s=a("#health_payment_details_type"),w=a("#health_payment_details_frequency"),$bankAccountDetailsRadioGroup=a("#health_payment_details_claims"),$sameBankAccountRadioGroup=a("#health_payment_bank_claims"),u=a(".health-payment-details_update"),v=a("#update-content"),t=a(".health-payment-details_premium"),x=t.find(".amount"),y=t.find(".frequencyText"),z=t.find(".lhcText"),A.messaging.subscribe(B.WEBAPP_LOCK,function(a){var b="undefined"!=typeof a&&a.source&&"healthPaymentStep"===a.source,c="undefined"!=typeof a&&a.disableFields&&a.disableFields===!0;
l(b,c)}),A.messaging.subscribe(B.WEBAPP_UNLOCK,function(){k()}),A.messaging.subscribe(B.health.CHANGE_MAY_AFFECT_PREMIUM,c),A.messaging.subscribe(B.healthResults.SELECTED_PRODUCT_RESET,function(){c(),d()}),s.find("input").on("change",j),a("#update-premium").on("click",m),a("#health_payment_credit_type").on("change",creditCardDetails.set),creditCardDetails.set(),$bankAccountDetailsRadioGroup.find("input").on("click",n),$sameBankAccountRadioGroup.find("input").on("click",n),d(),t.hide(),u.show(),void v.hide())})}function c(){t.hide(),u.show(),v.hide(),a("#health_declaration-selection").hide(),a("#confirm-step").hide(),a("#update-premium").removeClass("hasAltPremium")}function d(){D.bank={weekly:!1,fortnightly:!0,monthly:!0,quarterly:!1,halfyearly:!1,annually:!0},D.credit={weekly:!1,fortnightly:!1,monthly:!0,quarterly:!1,halfyearly:!1,annually:!0},D.frequency={weekly:27,fortnightly:31,monthly:27,quarterly:27,halfyearly:27,annually:27},D.creditBankSupply=!1,D.creditBankQuestions=!1,creditCardDetails.resetConfig(),a("#health_payment_details_start").val(""),s.find("input").prop("checked",!1).change(),s.find("label").removeClass("active"),w.val(""),a("#health_payment_details_claims input").prop("checked",!1).change(),a("#health_payment_details_claims input").find("label").removeClass("active"),i(0,90)}function e(a,b){D[a]=b}function f(a){return D[a]}function g(){return s.find("input:checked").val()}function h(){return w.val()}function i(a,b){D.minStartDateOffset=a,D.maxStartDateOffset=b;var c=A.modules.utilities.getUTCToday(),d=0,e=0,f=36e5;c+=10*f,d=c,a>0&&(d+=24*a*f),e=c+24*b*f,c=new Date(d),D.minStartDate=c.getUTCDate()+"/"+(c.getUTCMonth()+1)+"/"+c.getUTCFullYear(),c=new Date(e),D.maxStartDate=c.getUTCDate()+"/"+(c.getUTCMonth()+1)+"/"+c.getUTCFullYear()}function j(){var a=g(),b=h(),c=A.modules.healthResults.getSelectedProduct(),d='<option id="health_payment_details_frequency_" value="">Please choose...</option>';if(""===a||null===c)return!1;var e;if("cc"===a)e=D.credit;else{if("ba"!==a)return!1;e=D.bank}var f=c.premium;e.weekly===!0&&f.weekly.value>0&&(d+='<option id="health_payment_details_frequency_W" value="weekly">Weekly</option>'),e.fortnightly===!0&&f.fortnightly.value>0&&(d+='<option id="health_payment_details_frequency_F" value="fortnightly">Fortnightly</option>'),e.monthly===!0&&f.monthly.value>0&&(d+='<option id="health_payment_details_frequency_M" value="monthly">Monthly</option>'),e.quarterly===!0&&f.quarterly.value>0&&(d+='<option id="health_payment_details_frequency_Q" value="quarterly">Quarterly</option>'),e.halfyearly===!0&&f.halfyearly.value>0&&(d+='<option id="health_payment_details_frequency_H" value="halfyearly">Half-yearly</option>'),e.annually===!0&&f.annually.value>0&&(d+='<option id="health_payment_details_frequency_A" value="annually">Annually</option>'),w.html(d).find("option[value="+b+"]").attr("selected","SELECTED")}function k(){var b=a("#update-premium");b.removeClass("disabled");var c=a("#health_payment_details-selection");c.find(":input").not(".disabled-by-fund").prop("disabled",!1),c.find(".select").not(".disabled-by-fund").removeClass("disabled"),c.find(".btn-group label").not(".disabled-by-fund").removeClass("disabled"),a("#health_payment_details_start").parent().find(".datepicker").children().css("visibility","visible"),A.modules.loadingAnimation.hide(b)}function l(b,c){var d=a("#update-premium");if(d.addClass("disabled"),c===!0){var e=a("#health_payment_details-selection");e.find(":input").prop("disabled",!0),e.find(".select").addClass("disabled"),e.find(".btn-group label").addClass("disabled"),a("#health_payment_details_start").parent().find(".datepicker").children().css("visibility","hidden")}b===!0&&A.modules.loadingAnimation.showAfter(d)}function m(){return A.modules.journeyEngine.isCurrentStepValid()===!1?!1:(A.messaging.publish(C.WEBAPP_LOCK,{source:"healthPaymentStep",disableFields:!0}),void _.defer(function(){A.modules.healthResults.getProductData(function(b){if(null===b){var c="<p>Unfortunately this policy is not currently available. Please select another policy or call our Health Insurance Specialists on "+A.site.content.callCentreHelpNumber+' for assistance.</p><div class="col-sm-offset-4 col-xs-12 col-sm-4"><a class="btn btn-next btn-block" id="select-another-product" href="javascript:;">Select Another Product</a><a class="btn btn-cta btn-block visible-xs" href="tel:'+A.site.content.callCentreHelpNumber+'">Call Us Now</a></div>';r=A.modules.dialogs.show({title:"Policy not available",htmlContent:c}),a("#select-another-product").on("click",function(){A.modules.dialogs.close(r),A.modules.journeyEngine.gotoPath("results")})}else _.isArray(b)&&(b=b[0]),A.modules.healthResults.setSelectedProduct(b,!0),t.slideDown(),u.hide(),v.show(),"cc"===g()?(a("#health_payment_credit-selection").slideDown(),a("#health_payment_bank-selection").hide()):(a("#health_payment_bank-selection").slideDown(),a("#health_payment_credit-selection").hide()),a("#health_declaration-selection").slideDown(),n(),o(),a("#confirm-step").show();A.messaging.publish(C.WEBAPP_UNLOCK,{source:"healthPaymentStep"})})}))}function n(){var a=g();"ba"==a?(p("Y"==$bankAccountDetailsRadioGroup.find("input:checked").val()||D.creditBankQuestions===!0&&$bankAccountDetailsRadioGroup.is(":visible")===!1?!0:!1),q("N"==$sameBankAccountRadioGroup.find("input:checked").val()?!0:!1)):"cc"==a&&(p(!1),q("Y"==$bankAccountDetailsRadioGroup.find("input:checked").val()||D.creditBankQuestions===!0&&$bankAccountDetailsRadioGroup.is(":visible")===!1?!0:!1))}function o(){var b=a("#health_payment_bank_day").val(),c=a("#health_payment_credit_day").val();a("#health_payment_bank_day").empty().append("<option id='health_payment_bank_day_' value='' >Please choose...</option>"),a("#health_payment_credit_day").empty().append("<option id='health_payment_credit_day_' value='' >Please choose...</option>");var d,e=h();d=""!==e?D.frequency[h()]:27;for(var f=1;d>=f;f++)a("#health_payment_bank_day").append("<option id='health_payment_bank_day_"+f+"' value='"+f+"'>"+f+"</option>"),a("#health_payment_credit_day").append("<option id='health_payment_credit_day_"+f+"' value='"+f+"'>"+f+"</option>");b&&a("#health_payment_bank_day").val(b),c&&a("#health_payment_credit_day").val(c)}function p(b){b?a(".health_bank-details_claims_group").slideDown():a(".health_bank-details_claims_group").slideUp()}function q(b){b?a(".health-bank_claim_details").slideDown():a(".health-bank_claim_details").slideUp()}var r,s,t,u,v,w,x,y,z,A=window.meerkat,B=A.modules.events,C={WEBAPP_LOCK:"WEBAPP_LOCK",WEBAPP_UNLOCK:"WEBAPP_UNLOCK"},D={bank:[],credit:[],frequency:[],creditBankSupply:!1,creditBankQuestions:!1,minStartDateOffset:0,maxStartDateOffset:90,minStartDate:"",maxStartDate:""};A.modules.register("healthPaymentStep",{init:b,events:C,getSetting:f,overrideSettings:e,setCoverStartRange:i,getSelectedFrequency:h,getSelectedPaymentMethod:g})}(jQuery),function(){function a(){jQuery(document).ready(function(a){return"health"!==k.site.vertical?!1:(e=a("#logo-price-template").html(),f=a(".policySummaryContainer"),g=a(".policySummaryTemplateHolder"),h=a(".productSummaryDetails"),o=a(".policySummary.dualPricing .productSummary"),"confirmation"!=k.site.pageAction&&(i=a("#health_payment_details_frequency"),j=a("#health_payment_details_start"),k.messaging.subscribe(l.healthResults.SELECTED_PRODUCT_CHANGED,function(a){b(a,!1)}),k.messaging.subscribe(l.healthResults.PREMIUM_UPDATED,function(a){b(a,!0)}),k.messaging.subscribe(l.health.CHANGE_MAY_AFFECT_PREMIUM,function(){f.find(".policyPriceWarning").show()})),void k.messaging.publish(n.INIT))})}function b(a,b){var e=i.val();""===e&&(e=Results.getFrequency()),c(a,e,b);var f="Please confirm";""!==j.val()&&(f=j.val()),d(a,f)}function c(a,b,c){a._selectedFrequency=b,a.mode=c?"lhcInc":"",a.showAltPremium=!1;var d=_.template(e),h=d(a);g.html(h),f.find(".policyPriceWarning").hide(),o.length>0&&(a.showAltPremium=!0,h=d(a),o.html(h))}function d(a,b,c){h.find(".name").text(a.info.providerName+" "+a.info.name),h.find(".startDate").text(b),"undefined"!=typeof a.hospital.inclusions&&(h.find(".excess").html(a.hospital.inclusions.excess),h.find(".excessWaivers").html(a.hospital.inclusions.waivers),h.find(".copayment").html(a.hospital.inclusions.copayment)),h.find(".footer").removeClass("hidden"),h.find(".excess").parent().removeClass("hidden"),h.find(".excessWaivers").parent().removeClass("hidden"),h.find(".copayment").parent().removeClass("hidden"),"undefined"!=typeof c&&c===!1&&h.find(".footer").addClass("hidden"),("undefined"==typeof a.hospital.inclusions||""===a.hospital.inclusions.excess)&&h.find(".excess").parent().addClass("hidden"),("undefined"==typeof a.hospital.inclusions||""===a.hospital.inclusions.waivers)&&h.find(".excessWaivers").parent().addClass("hidden"),("undefined"==typeof a.hospital.inclusions||""===a.hospital.inclusions.copayment)&&h.find(".copayment").parent().addClass("hidden")}var e,f,g,h,i,j,k=window.meerkat,l=k.modules.events,m=(k.logging.info,{healthPriceComponent:{INIT:"PRICE_COMPONENT_INITED"}}),n=m.healthPriceComponent,o=[];k.modules.register("healthPriceComponent",{init:a,events:m,updateProductSummaryHeader:c,updateProductSummaryDetails:d})}(jQuery),function(a){function b(){a("#filter-frequency input").on("change",d),a(document).on("resultsDataReady",e)}function c(){var b=h.modules.healthResults.getFrequencyInWords(a("#health_filter_frequency").val());a(".health-filter-price .slider-control").trigger(i.sliders.EVENT_UPDATE_RANGE,g(b,!1))}function d(){a(".health-filter-price .slider-control").trigger(i.sliders.EVENT_UPDATE_RANGE,g(f(),!0))}function e(){a(".health-filter-price .slider-control").trigger(i.sliders.EVENT_UPDATE_RANGE,g(f(),!1))}function f(){var b=h.modules.healthResults.getFrequencyInWords(a("#filter-frequency input:checked").val());return b||(b=Results.getFrequency()),b}function g(a,b){var c=Results.getReturnedGeneral();premiumsRange=c&&c.premiumRange?c.premiumRange:j;var d={};switch(a){case"fortnightly":premiumsRange.fortnightly.max<=0&&(premiumsRange.fortnightly.max=j.fortnightly.max),d=premiumsRange.fortnightly;break;case"monthly":premiumsRange.monthly.max<=0&&(premiumsRange.monthly.max=j.monthly.max),d=premiumsRange.monthly;break;case"annually":premiumsRange.yearly.max<=0&&(premiumsRange.yearly.max=j.yearly.max),d=premiumsRange.yearly;break;default:d=premiumsRange.monthly}return[Number(d.min),Number(d.max),b]}var h=window.meerkat,i=h.modules.events,j=(h.logging.info,{fortnightly:{min:1,max:300},monthly:{min:1,max:560},yearly:{min:1,max:4e3}});h.modules.register("healthPriceRangeFilter",{init:b,setUp:c})}(jQuery),function(a){function b(){d(),e(),Features.init(),i(),j()}function c(){j(),G!==H.modules.deviceMediaState.get()&&(Results.view.calculateResultsContainerWidth(),Features.clearSetHeights(),Features.balanceVisibleRowsHeight()),Results.pagination.refresh()}function d(){a(".adjustFilters").on("click",function(a){a.preventDefault(),a.stopPropagation(),H.modules.healthFilters.open()}),E=a(".resultsLowNumberMessage, .resultsMarketingMessages");var b=a("#health_filter_frequency").val();b=H.modules.healthResults.getFrequencyInWords(b)||"monthly";try{Results.init({url:"ajax/json/health_quote_results.jsp",runShowResultsPage:!1,paths:{results:{list:"results.price",info:"results.info"},brand:"info.Name",productId:"productId",productTitle:"info.productTitle",price:{annually:"premium.annually.lhcfreevalue",monthly:"premium.monthly.lhcfreevalue",fortnightly:"premium.fortnightly.lhcfreevalue"},availability:{price:{annually:"premium.annual.lhcfreevalue",monthly:"premium.monthly.lhcfreevalue",fortnightly:"premium.fortnightly.lhcfreevalue"}},benefitsSort:"info.rank"},show:{nonAvailablePrices:!1},availability:{price:["notEquals",0]},render:{templateEngine:"_",features:{mode:"populate",headers:!1,numberOfXSColumns:2},dockCompareBar:!1},displayMode:"features",paginationMode:"page",paginationTouchEnabled:Modernizr.touch,sort:{sortBy:"benefitsSort"},frequency:b,animation:{results:{individual:{active:!1},delay:500,options:{easing:"swing",duration:1e3}},shuffle:{active:!1,options:{easing:"swing"}},filter:{reposition:{options:{easing:"swing"}}}},elements:{features:{values:".content",extras:".children"}},dictionary:{valueMap:[{key:"Y",value:"<span class='icon-tick'></span>"},{key:"N",value:"<span class='icon-cross'></span>"},{key:"R",value:"Restricted"},{key:"-",value:"&nbsp;"}]},rankings:{triggers:["RESULTS_DATA_READY"],callback:H.modules.healthResults.rankingCallback,forceIdNumeric:!0}})}catch(c){Results.onError("Sorry, an error occurred initialising page","results.tag","meerkat.modules.healthResults.init(); "+c.message,c)}}function e(){var b={compareBarRenderer:ListModeCompareBarRenderer,elements:{button:".compareBtn",bar:".compareBar",boxes:".compareBox"},dictionary:{compareLabel:'Compare <span class="icon icon-arrow-right"></span>',clearBasketLabel:'Clear Shortlist <span class="icon icon-arrow-right"></span>'}};Compare.init(b),$compareBasket=a(Compare.settings.elements.bar),$compareBasket.on("compareAdded",function(b,c){null!==H.modules.healthMoreInfo.getOpenProduct()&&H.modules.healthMoreInfo.getOpenProduct().productId!==c&&H.modules.healthMoreInfo.close(),$compareBasket.addClass("active"),a(Results.settings.elements.resultsContainer+" "+Results.settings.elements.rows+"[data-productId="+c+"]").addClass("compared"),Compare.view.resultsFiltered===!1&&Compare.model.products.length===Compare.settings.maximum&&(a(".compareBtn").addClass("compareInActive"),_.delay(function(){g()},250))}),$compareBasket.on("compareRemoved",function(b,c){Compare.view.resultsFiltered&&Compare.model.products.length>=Compare.settings.minimum&&g(),$element=a(Results.settings.elements.resultsContainer+" "+Results.settings.elements.rows+"[data-productId="+c+"]"),$element.removeClass("compared"),$element.find(".compareCheckbox input").prop("checked",!1),0===Compare.model.products.length&&(a(".compareBar").removeClass("active"),z(!1),A(!0))}),$compareBasket.on("compareNonAvailable",function(){Compare.view.resultsFiltered&&f()}),$compareBasket.on("compareBucketFull",function(){a(".result .compareCheckbox :input").not(":checked").prop("disabled",!0)}),$compareBasket.on("compareBucketAvailable",function(){a(".result .compareCheckbox :input").prop("disabled",!1)}),$compareBasket.on("compareClick",function(){Compare.view.resultsFiltered?f():g()}),H.messaging.subscribe(I.healthFilters.CHANGED,function(){f()}),H.messaging.subscribe(I.device.STATE_ENTER_XS,function(){f()})}function f(){$container=a(Results.settings.elements.container),Results.settings.animation.filter.active?$container.find(".compared").removeClass("compared"):$container.find(".compared").removeClass("compared notfiltered").addClass("filtered"),$container.find(".compareCheckbox input").prop("checked",!1),a(".compareBtn").addClass("compareInActive"),_.defer(function(){Compare.unfilterResults(),_.defer(function(){Compare.reset()})})}function g(){_.defer(function(){Compare.filterResults(),_.defer(function(){z(!0,5-Results.getFilteredResults().length),A(!1),_.delay(function(){Results.settings.render.features.expandRowsOnComparison&&(a(".featuresHeaders .featuresList > .section.expandable.collapsed > .content").trigger("click"),a(".featuresHeaders .featuresList > .selectionHolder > .children > .category.expandable.collapsed > .content").trigger("click")),null!==H.modules.healthMoreInfo.getOpenProduct()&&H.modules.healthMoreInfo.close(),H.messaging.publish(I.tracking.TOUCH,{touchType:"H",touchComment:"ResCompare"});for(var b=[],c=Results.getFilteredResults(),d=0;d<c.length;d++){var e=c[d];b.push({productID:e.productId})}H.messaging.publish(I.tracking.EXTERNAL,{method:"trackQuoteComparison",object:{products:b}})},Results.settings.animation.features.scroll.duration+100)})})}function h(){var b=Results.getFilteredResults().length,c=b+" product";1!=b&&(c+="s"),a(".compareBar .productCount").text(c)}function i(){a(Results.settings.elements.resultsContainer).on("featuresDisplayMode",function(){Features.buildHtml()}),a(document).on("generalReturned",function(){var b=Results.getReturnedGeneral();b.pricesHaveChanged&&(H.modules.dialogs.show({title:"Just a quick note",htmlContent:a("#quick-note").html(),buttons:[{label:"Show latest results",className:"btn btn-next",closeWindow:!0}]}),a("input[name='health_retrieve_savedResults']").val("N"))}),a(document).on("resultsLoaded",x),a(document).on("resultsReturned",function(){Compare.reset(),H.modules.utilities.scrollPageTo(a("header")),a(".featuresHeaders .expandable.expanded").removeClass("expanded").addClass("collapsed")}),a(document).on("resultsDataReady",function(){h(),H.site.isCallCentreUser&&y()}),a(document).on("resultsFetchStart",function(){z(!1),A(!1),H.modules.journeyEngine.loadingShow("getting your quotes"),a("header .slide-feature-pagination, header a[data-results-pagination-control]").addClass("hidden")}),a(document).on("resultsFetchFinish",function(){if(A(!0),_.defer(function(){a("header .slide-feature-pagination, header a[data-results-pagination-control]").removeClass("hidden"),Results.pagination.setupNativeScroll()}),H.modules.journeyEngine.loadingHide(),!H.site.isNewQuote&&!Results.getSelectedProduct()&&H.site.isCallCentreUser){Results.setSelectedProduct(a(".health_application_details_productId").val());var b=Results.getSelectedProduct();b&&H.modules.healthResults.setSelectedProduct(b)}if("Y"===a('input[name="health_directApplication"]').val()){Results.setSelectedProduct(H.site.loadProductId);var c=Results.getSelectedProduct();if(c)H.modules.healthResults.setSelectedProduct(c),H.modules.journeyEngine.gotoPath("next");else{var d=Results.getResult("productTitle",H.site.loadProductTitle),e="";d?(H.modules.healthResults.setSelectedProduct(d),e="Thanks for visiting "+H.site.content.brandDisplayName+". Please note that for this particular product, the price and/or features have changed since the last time you were comparing. If you need further assistance, you can chat to one of our Health Insurance Specialists on "+H.site.content.callCentreHelpNumber+", and they will be able to help you with your options."):(a("#health_application_productId").val(""),a("#health_application_productTitle").val(""),e="Thanks for visiting "+H.site.content.brandDisplayName+". Unfortunately the product you're looking for is no longer available. Please head to your results page to compare available policies or alternatively, chat to one of our Health Insurance Specialists on "+H.site.content.callCentreHelpNumber+", and they will be able to help you with your options."),H.modules.dialogs.show({title:"Just a quick note",htmlContent:e,buttons:[{label:"Show latest results",className:"btn btn-next",closeWindow:!0}]})}H.site.loadProductId="",H.site.loadProductTitle="",a('input[name="health_directApplication"]').val("")}a(Results.settings.elements.page).show()}),a(document).on("populateFeaturesStart",function(){H.modules.performanceProfiling.startTest("results")}),a(Results.settings.elements.resultsContainer).on("populateFeaturesEnd",function(){var a,b=H.modules.performanceProfiling.endTest("results");a=800>b?H.modules.performanceProfiling.PERFORMANCE.HIGH:8e3>b&&H.modules.performanceProfiling.isIE8()===!1?H.modules.performanceProfiling.PERFORMANCE.MEDIUM:H.modules.performanceProfiling.PERFORMANCE.LOW,Results.setPerformanceMode(a)}),a(document).on("resultPageChange",function(a){var b=a.pageData;if(null===b.measurements)return!1;var c=b.measurements.numberOfPages,d=Results.getFilteredResults().length,e=b.measurements.columnsPerPage,f=e*c-d;if(f>1&&1===c)A(!0),z(!1);else if(A(!1),Compare.view.resultsFiltered===!1){if(b.pageNumber===b.measurements.numberOfPages&&f>2)return z(!0,f),!0;z(!1)}}),a(document).on("FeaturesRendered",function(){a(Features.target+" .expandable > "+Results.settings.elements.features.values).on("mouseenter",function(){var b=a(this).attr("data-featureId"),c=a(Features.target+' [data-featureId="'+b+'"]');c.addClass(Results.settings.elements.features.expandableHover.replace(/[#\.]/g,""))}).on("mouseleave",function(){var b=a(this).attr("data-featureId"),c=a(Features.target+' [data-featureId="'+b+'"]');c.removeClass(Results.settings.elements.features.expandableHover.replace(/[#\.]/g,""))})})}function j(){"xs"==H.modules.deviceMediaState.get()&&k(),H.messaging.subscribe(I.device.STATE_ENTER_XS,function(){"results"===H.modules.journeyEngine.getCurrentStep().navigationId&&k()}),H.messaging.subscribe(I.device.STATE_LEAVE_XS,function(){l()})}function k(){Results.view.startColumnWidthTracking(a(window),Results.settings.render.features.numberOfXSColumns,!1)}function l(){Results.view.stopColumnWidthTracking()}function m(){G=H.modules.deviceMediaState.get()}function n(){H.messaging.publish(L.WEBAPP_LOCK,{source:"healthLoadRates"}),H.modules.health.loadRates(function(){H.messaging.publish(L.WEBAPP_UNLOCK,{source:"healthLoadRates"}),Results.get()})}function o(){return M}function p(a){var b=o();return b.premium[a]}function q(a){switch(a){case"weekly":return"W";case"fortnightly":return"F";case"monthly":return"M";case"quarterly":return"Q";case"halfyearly":return"H";case"annually":return"A";default:return!1}}function r(a){switch(a){case"W":return"weekly";case"F":return"fortnightly";case"M":return"monthly";case"Q":return"quarterly";case"H":return"halfyearly";case"A":return"annually";default:return!1}}function s(a){switch(a){case"weekly":return 52;case"fortnightly":return 26;case"quarterly":return 4;case"halfyearly":return 2;case"annually":return 1;default:return 12}}function t(b,c){M=b;var d=a("#mainform");if(null===b)d.find(".health_application_details_provider").val(""),d.find(".health_application_details_productId").val(""),d.find(".health_application_details_productNumber").val(""),d.find(".health_application_details_productTitle").val("");else if(d.find(".health_application_details_provider").val(M.info.provider),d.find(".health_application_details_productId").val(M.productId),d.find(".health_application_details_productNumber").val(M.info.productCode),d.find(".health_application_details_productTitle").val(M.info.productTitle),c===!0)H.messaging.publish(L.healthResults.PREMIUM_UPDATED,M);else{H.messaging.publish(L.healthResults.SELECTED_PRODUCT_CHANGED,M),a(Results.settings.elements.rows).removeClass("active");var e=a(Results.settings.elements.rows+"[data-productid="+M.productId+"]"),f=e.data("position")+1;e.addClass("active"),Results.pagination.gotoPosition(f,!0,!1)}}function u(){healthFunds.unload(),t(null),H.messaging.publish(L.healthResults.SELECTED_PRODUCT_RESET)}function v(b){H.modules.health.loadRates(function(c){if(null===c)b(null);else{var d=H.modules.journeyEngine.getFormData();_.findWhere(d,{name:"health_showAll"}).value="N",_.findWhere(d,{name:"health_onResultsPage"}).value="N",_.findWhere(d,{name:"health_incrementTransactionId"}).value="N",d.push({name:"health_payment_details_start",value:a("#health_payment_details_start").val()}),d.push({name:"health_payment_details_type",value:H.modules.healthPaymentStep.getSelectedPaymentMethod()}),d.push({name:"health_payment_details_frequency",value:H.modules.healthPaymentStep.getSelectedFrequency()}),H.modules.comms.post({url:"ajax/json/health_quote_results.jsp",data:d,cache:!1,errorLevel:"warning",onSuccess:function(a){Results.model.updateTransactionIdFromResult(a),b(a.results&&a.results.price&&"N"!==a.results.price.available?a.results.price:null)},onError:function(){b(null)}})}})}function w(b,c){F.find(".featuresTemplateComponent .selectionHolder [data-skey]").each(function(b,c){var d=a(c),e=d.attr("data-skey"),f=d.attr("data-par-skey"),g=Number(d.attr("data-index"));if($parentFeatureList=d.parents(".featuresTemplateComponent").first(),0===g){var h=$parentFeatureList.find('div[data-skey="'+f+'"].hasShortlistableChildren .children').first();h.attr("data-skey")===e?h.after(d):h.prepend(d)}else{var i=g-1;$parentFeatureList.find('.hasShortlistableChildren div[data-par-skey="'+f+'"][data-index="'+i+'"]').first().after(d)}});for(var d=0;d<b.length;d++){var e=b[d];F.find('.featuresTemplateComponent div[data-skey="'+e+'"]').each(function(b,c){var d=a(c),e=d.attr("data-par-skey");null!=e&&($parentFeatureList=d.parents(".featuresTemplateComponent").first(),$parentFeatureList.find(".selection_"+e+" .children").first().append(d))})}F.find(".featuresTemplateComponent > .section.hasShortlistableChildren").each(function(c,d){var e=a(d),f=e.attr("data-skey"),g=F.find(".cell.selection_"+f);if(-1===b.indexOf(f))e.hide(),g.hide();else{e.show();var h=F.find(".featuresHeaders .selection_"+f+"> .children > .cell").length;if(0===h)g.hide();else{g.show();var i=F.find('.featuresHeaders div[data-skey="'+f+'"]'),j=h+i.find("> .children > .cell").length;g.find(".content .extraText .selectedCount").text(h),g.find(".content .extraText .availableCount").text(j)}}}),"undefined"==typeof c?3===H.modules.journeyEngine.getCurrentStepIndex()&&n():c()}function x(){"xs"==H.modules.deviceMediaState.get()&&k(),h();try{a("#resultsPage .compare").unbind().on("click",function(){var b=a(this),c=b.parents(Results.settings.elements.rows).attr("data-productId"),d=Results.getResult("productId",c),e={id:c,object:d};b.is(":checked")?Compare.add(e):Compare.remove(c)})}catch(b){Results.onError("Sorry, an error occurred processing results","results.tag","FeaturesResults.setResultsActions(); "+b.message,b)}H.site.isCallCentreUser&&y()}function y(){a("#resultsPage .price").each(function(){var b=a(this),c=b.parents(Results.settings.elements.rows).attr("data-productId"),d=Results.getResultByProductId(c);if(d.hasOwnProperty("premium")){var e=_.template(K.premiumsPopOver),f=e({product:d,frequency:Results.getFrequency()});H.modules.popovers.create({element:b,contentValue:f,contentType:"content",showEvent:"mouseenter click",position:{my:"top center",at:"bottom center"},style:{classes:"priceTooltips"}})}else H.modules.errorHandling.error({message:"product does not have property premium",page:"healthResults.js",description:"createPremiumsPopOver()",errorLevel:"silent",data:d})})}function z(b,c){b?(a(".resultsMarketingMessage").addClass("show"),a(".resultsMarketingMessage").attr("data-columns",c)):a(".resultsMarketingMessage").removeClass("show")}function A(a){var b;if(a){var c=Results.pagination.calculatePageMeasurements();if(null==c)a=!1;else{var d=Results.getFilteredResults().length;b=c.columnsPerPage-d,(2>b||1!==c.numberOfPages)&&(a=!1)}}return a?(E.addClass("show"),E.attr("data-columns",b)):E.removeClass("show"),a}function B(a,b){var c={},d=Results.getFrequency(),e=a.productId.replace("PHIO-HEALTH-","");return c["rank_productId"+b]=e,c["rank_price_actual"+b]=a.premium[d].value.toFixed(2),c["rank_price_shown"+b]=a.premium[d].lhcfreevalue.toFixed(2),c["rank_frequency"+b]=d,c["rank_lhc"+b]=a.premium[d].lhc,c["rank_rebate"+b]=a.premium[d].rebate,c["rank_discounted"+b]=a.premium[d].discounted,_.isNumber(N)&&N>b&&(c["rank_provider"+b]=a.info.provider,c["rank_providerName"+b]=a.info.providerName,c["rank_productName"+b]=a.info.productTitle,c["rank_productCode"+b]=a.info.productCode,c["rank_premium"+b]=a.premium[Results.settings.frequency].lhcfreetext,c["rank_premiumText"+b]=a.premium[Results.settings.frequency].lhcfreepricing),c}function C(){var b=Results.getFrequency(),c="benefitsSort"===Results.getSortBy()?"Benefits":"Lowest Price",d="ALL";switch(a("#health_excess").val()){case"1":d="0";break;case"2":d="1-250";break;case"3":d="251-500";break;default:d="ALL"}H.messaging.publish(I.tracking.EXTERNAL,{method:"trackQuoteList",object:{preferredExcess:d,sortPaymentFrequency:b,sortHealthRanking:c,event:J}}),J="Refresh"}function D(){F=a("#resultsPage"),H.messaging.subscribe(I.healthBenefits.CHANGED,w),H.messaging.subscribe(I.RESULTS_RANKING_READY,C)}var E,F,G,H=window.meerkat,I=H.modules.events,J=(H.logging.info,"Load"),K={premiumsPopOver:"{{ if(product.premium.hasOwnProperty(frequency)) { }}<strong>Total Price including rebate and LHC: </strong><span class=\"highlighted\">{{= product.premium[frequency].text }}</span><br/> <strong>Price including rebate but no LHC: </strong>{{=product.premium[frequency].lhcfreetext}}<br/> <strong>Price including LHC but no rebate: </strong>{{= product.premium[frequency].baseAndLHC }}<br/> <strong>Base price: </strong>{{= product.premium[frequency].base }}<br/> {{ } }}<hr/> {{ if(product.premium.hasOwnProperty('fortnightly')) { }}<strong>Fortnightly (ex LHC): </strong>{{=product.premium.fortnightly.lhcfreetext}}<br/> {{ } }}{{ if(product.premium.hasOwnProperty('monthly')) { }}<strong>Monthly (ex LHC): </strong>{{=product.premium.monthly.lhcfreetext}}<br/> {{ } }}{{ if(product.premium.hasOwnProperty('annually')) { }}<strong>Annually (ex LHC): </strong>{{= product.premium.annually.lhcfreetext}}<br/> {{ } }}<hr/> {{ if(product.hasOwnProperty('info')) { }}<strong>Name: </strong>{{=product.info.productTitle}}<br/> <strong>Product Code: </strong>{{=product.info.productCode}}<br/> <strong>Product ID: </strong>{{=product.productId}}<br/><strong>State: </strong>{{=product.info.State}}<br/> <strong>Membership Type: </strong>{{=product.info.Category}}{{ } }}"},L={healthResults:{SELECTED_PRODUCT_CHANGED:"SELECTED_PRODUCT_CHANGED",SELECTED_PRODUCT_RESET:"SELECTED_PRODUCT_RESET",PREMIUM_UPDATED:"PREMIUM_UPDATED"},WEBAPP_LOCK:"WEBAPP_LOCK",WEBAPP_UNLOCK:"WEBAPP_UNLOCK"},M=null,N=5;H.modules.register("healthResults",{init:D,events:L,initPage:b,onReturnToPage:c,get:n,getSelectedProduct:o,setSelectedProduct:t,resetSelectedProduct:u,getProductData:v,getSelectedProductPremium:p,getNumberOfPeriodsForFrequency:s,getFrequencyInLetters:q,getFrequencyInWords:r,stopColumnWidthTracking:l,toggleMarketingMessage:z,toggleResultsLowNumberMessage:A,onBenefitsSelectionChange:w,recordPreviousBreakpoint:m,rankingCallback:B,doCustomExternalTracking:C})}(jQuery),function(a){var b,c,d,e,f,g,h=window.meerkat,i=(h.modules.events,h.logging.info,{single:{incomeBaseTier:9e4,incomeTier1:{from:90001,to:105e3},incomeTier2:{from:105001,to:14e4},incomeTier3:140001},familyOrCouple:{incomeBaseTier:18e4,incomeTier1:{from:180001,to:21e4},incomeTier2:{from:210001,to:28e4},incomeTier3:280001}});init=function(){b=a("#health_healthCover_dependants"),c=a("#health_healthCover_incomeMessage"),d=a("#health_healthCover_incomeBase"),e=a("#health_healthCover_income"),f=a("#health_healthCover_tier"),g=a(".health-medicare_details")},setTiers=function(j){var k=b.val()-1;k>0?(k=1500*k,c.text("this includes an adjustment for your dependants")):(k=0,c.text(""));var l;l=d.is(":visible")&&a("#health_healthCover_incomeBase").find(":checked").length>0?d.find(":checked").val():healthChoices.returnCoverCode(),e.find("option").each(function(){var b=a(this),c=b.val(),d="";if(_ageBonus=null===h.modules.health.getRates()?0:parseInt(h.modules.health.getRates().ageBonus),"S"===l||""===l)switch(c){case"0":d="$"+formatMoney(i.single.incomeBaseTier+k)+" or less";break;case"1":d="$"+formatMoney(i.single.incomeTier1.from+k)+" - $"+formatMoney(i.single.incomeTier1.to+k);break;case"2":d="$"+formatMoney(i.single.incomeTier2.from+k)+" - $"+formatMoney(i.single.incomeTier2.to+k);break;case"3":d="$"+formatMoney(i.single.incomeTier3+k)+"+ (no rebate)"}else switch(c){case"0":d="$"+formatMoney(i.familyOrCouple.incomeBaseTier+k)+" or less";break;case"1":d="$"+formatMoney(i.familyOrCouple.incomeTier1.from+k)+" - $"+formatMoney(i.familyOrCouple.incomeTier1.to+k);break;case"2":d="$"+formatMoney(i.familyOrCouple.incomeTier2.from+k)+" - $"+formatMoney(i.familyOrCouple.incomeTier2.to+k);break;case"3":d="$"+formatMoney(i.familyOrCouple.incomeTier3+k)+"+ (no rebate)"}""!==d&&b.text(d),"N"!=healthCoverDetails.getRebateChoice()&&healthCoverDetails.getRebateChoice()?(j?f.show():f.slideDown(),g.show()):(j?f.hide():f.slideUp(),g.hide())})},h.modules.register("healthTiers",{init:init,setTiers:setTiers})}(jQuery);
//# sourceMappingURL=health.modules.ctm.min.map