/*!
 * CTM-Platform v0.8.3
 * Copyright 2014 Compare The Market Pty Ltd
 * http://www.comparethemarket.com.au/
 */


function returnAge(a,b){var c=new Date;c.setHours(0,0,0);var d=returnDate(a),e=c.getFullYear()-d.getFullYear();if(1>e)return(c-d)/31536e6;var f=e-c.getFullYear()%4;f=(f-f%4)/4;var g,h=(366*f+365*(e-f))/e;g=d.getMonth()==c.getMonth()&&d.getDate()>c.getDate()?-.005:.005;var i=(c-d)/(864e5*h)+g;return b?Math.floor(i):i}function returnDate(a){if(""===a)return null;var b=a.split("/");return b.length<3?null:new Date(b[2],b[1]-1,b[0])}function isLessThan31Or31AndBeforeJuly1(a){if(""===a)return!1;var b=Math.floor(returnAge(a));if(31>b)return!1;if(31==b){var c=returnDate(a),d=returnDate(a);d.setFullYear(c.getFullYear()+31);var e=new Date;return c.getMonth()+1<7&&(e.getMonth()+1>=7||e.getFullYear()>d.getFullYear())?!0:c.getMonth()+1>=7&&e.getMonth()+1>=7&&e.getFullYear()>d.getFullYear()?!0:!1}return b>31?!0:!1}function resetRadio(a,b){a.val()!=b&&(a.find("input").prop("checked",!1),a.find("label").removeClass("active"),null!=b&&(a.find("input[value="+b+"]").prop("checked","checked"),a.find("input[value="+b+"]").parent().addClass("active")))}function leadingZero(a){return 10>a&&(a="0"+a),a}var healthFunds_HCF={set:function(){},unset:function(){}},healthFunds_AHM={set:function(){healthFunds._dependants("ahm Health Insurance provides cover for your children up to the age of 21 plus students who are single and studying full time aged between 21 and 25. Adult dependants outside this criteria can be covered by an additional premium on certain covers so please call Compare the Market on 1800777712 or chat to our consultants online to discuss your health cover needs."),healthDependents.maxAge=25,$.extend(healthDependents.config,{school:!0,schoolMin:21,schoolMax:24,schoolID:!0,schoolIDMandatory:!0,schoolDate:!0,schoolDateMandatory:!0});var a='<select class="form-control"><option value="">Please choose...</option>';a+='<option value="ACP">Australian College of Phys. Ed</option>',a+='<option value="ACT">Australian College of Theology</option>',a+='<option value="ACTH">ACT High Schools</option>',a+='<option value="ACU">Australian Catholic University</option>',a+='<option value="ADA">Australian Defence Force Academy</option>',a+='<option value="AFTR">Australian Film, TV &amp; Radio School</option>',a+='<option value="AIR">Air Academy, Brit Aerospace Flight Trng</option>',a+='<option value="AMC">Austalian Maritime College</option>',a+='<option value="ANU">Australian National University</option>',a+='<option value="AVO">Avondale College</option>',a+='<option value="BC">Batchelor College</option>',a+='<option value="BU">Bond University</option>',a+='<option value="CQU">Central Queensland Universty</option>',a+='<option value="CSU">Charles Sturt University</option>',a+='<option value="CUT">Curtin University of Technology</option>',a+='<option value="DU">Deakin University</option>',a+='<option value="ECU">Edith Cowan University</option>',a+='<option value="EDUC">Education Institute Default</option>',a+='<option value="FU">Flinders University of SA</option>',a+='<option value="GC">Gatton College</option>',a+='<option value="GU">Griffith University</option>',a+='<option value="JCUNQ">James Cook University of Northern QLD</option>',a+='<option value="KVBVC">KvB College of Visual Communication</option>',a+='<option value="LTU">La Trobe University</option>',a+='<option value="MAQ">Maquarie University</option>',a+='<option value="MMCM">Melba Memorial Conservatorium of Music</option>',a+='<option value="MTC">Moore Theological College</option>',a+='<option value="MU">Monash University</option>',a+='<option value="MURUN">Murdoch University</option>',a+="<option value=\"NAISD\">Natn'l Aborign'l &amp; Islander Skills Dev Ass.</option>",a+='<option value="NDUA">Notre Dame University Australia</option>',a+='<option value="NIDA">National Institute of Dramatic Art</option>',a+='<option value="NSWH">NSW High Schools</option>',a+='<option value="NSWT">NSW TAFE</option>',a+='<option value="NT">Northern Territory High Schools</option>',a+='<option value="NTT">NT TAFE</option>',a+='<option value="NTU">Northern Territory University</option>',a+='<option value="OLA">Open Learnng Australia</option>',a+='<option value="OTHER">Other Registered Tertiary Institutions</option>',a+='<option value="PSC">Photography Studies College</option>',a+='<option value="QCM">Queensland Conservatorium of Music</option>',a+='<option value="QCU">Queensland College of Art</option>',a+='<option value="QLDH">QLD High Schools</option>',a+='<option value="QLDT">QLD TAFE</option>',a+='<option value="QUT">Queensland University of Technology</option>',a+='<option value="RMIT">Royal Melbourne Institute of Techn.</option>',a+='<option value="SA">South Australian High Schools</option>',a+='<option value="SAT">SA TAFE</option>',a+='<option value="SCD">Sydney College of Divinity</option>',a+='<option value="SCM">Sydney Conservatorium of Music</option>',a+='<option value="SCU">Southern Cross University</option>',a+='<option value="SCUC">Sunshine Coast University College</option>',a+='<option value="SIT">Swinburn Institute of Technology</option>',a+='<option value="SJC">St Johns College</option>',a+='<option value="SYD">University of Sydney</option>',a+='<option value="TAS">TAS High Schools</option>',a+='<option value="TT">TAS TAFE</option>',a+='<option value="UA">University of Adelaide</option>',a+='<option value="UB">University of Ballarat</option>',a+='<option value="UC">University of Canberra</option>',a+='<option value="UM">University of Melbourne</option>',a+='<option value="UN">University of Newcastle</option>',a+='<option value="UNC">University of Capricornia Rockhampton</option>',a+='<option value="UNE">University of New England</option>',a+='<option value="UNSW">University Of New South Wales</option>',a+='<option value="UQ">University of Queensland</option>',a+='<option value="USA">University of South Australia</option>',a+='<option value="USQ">University of Southern Queensland</option>',a+='<option value="UT">University of Tasmania</option>',a+='<option value="UTS">University of Technlogy Sydney</option>',a+='<option value="UW">University of Wollongong</option>',a+='<option value="UWA">University of Western Australia</option>',a+='<option value="UWS">University of Western Sydney</option>',a+='<option value="VCAH">VIC College of Agriculture &amp; Horticulture</option>',a+='<option value="VIC">Victorian High Schools</option>',a+='<option value="VICT">VIC TAFE</option>',a+='<option value="VU">Victoria University</option>',a+='<option value="VUT">Victoria University of Technology</option>',a+='<option value="WA">Western Australia-High Schools</option>',a+='<option value="WAT">WA TAFE</option>',a+="</select>",$(".health_dependant_details_schoolGroup .row-content").each(function(b){var c=$(this).find("input").attr("name"),d=$(this).find("input").attr("id");$(this).append(a),$(this).find("select").attr("name",c).attr("id",d+"select"),$(this).find("select").rules("add",{required:!0,messages:{required:"Please select dependant "+(b+1)+"'s school"}})}),$(".health_dependant_details_schoolIDGroup input").attr("maxlength","10"),healthFunds_AHM.tmpSchoolLabel=$(".health_dependant_details_schoolGroup .control-label").html(),$(".health_dependant_details_schoolGroup .control-label").html("Tertiary Institution this dependant is attending"),$(".health_dependant_details_schoolGroup .help_icon").hide(),$("#health_previousfund_primary_authority").rules("add",{required:!0,messages:{required:"AHM require authorisation to contact your previous fund"}}),$("#health_previousfund_partner_authority").rules("add",{required:!0,messages:{required:"AHM require authorisation to contact your partner's previous fund"}}),$("#health_previousfund_primary_memberID").attr("maxlength","10"),$("#health_previousfund_partner_memberID").attr("maxlength","10"),healthFunds._previousfund_authority(!0),meerkat.modules.healthPaymentStep.overrideSettings("bank",{weekly:!0,fortnightly:!0,monthly:!0,quarterly:!1,halfyearly:!1,annually:!0}),meerkat.modules.healthPaymentStep.overrideSettings("credit",{weekly:!0,fortnightly:!0,monthly:!0,quarterly:!1,halfyearly:!1,annually:!0}),meerkat.modules.healthPaymentStep.overrideSettings("creditBankSupply",!0),meerkat.modules.healthPaymentStep.overrideSettings("creditBankQuestions",!0),creditCardDetails.config={visa:!0,mc:!0,amex:!1,diners:!1},creditCardDetails.render(),$("#update-premium").on("click.AHM",function(){var a=meerkat.modules.healthPaymentStep.getSelectedFrequency();healthFunds._payments="weekly"==a||"fortnightly"==a?{min:3,max:8,weekends:!1}:{min:3,max:32,weekends:!0};var b=healthFunds._paymentDays($("#health_payment_details_start").val());healthFunds._paymentDaysRender($(".health-bank_details-policyDay"),b),healthFunds._paymentDaysRender($(".health-credit-card_details-policyDay"),b),("monthly"==a||"annually"==a)&&$(".health-bank_details-policyDay option, .health-credit-card_details-policyDay option").each(function(){if(this.value.length>=3){var a=this.value.substring(this.value.length-3);("-29"==a||"-30"==a||"-31"==a)&&$(this).remove()}})}),$("#health_payment_details_frequency, #health_payment_details_start ,#health_payment_details_type").on("change.AHM",function(){healthFunds.paymentGateway.clearValidation()}),meerkat.modules.healthPaymentStep.setCoverStartRange(1,28),healthFunds.paymentGateway=paymentGateway,healthFunds.paymentGateway.src="ajax/html/health_paymentgateway.jsp",healthFunds.paymentGateway.init("health_payment_gateway"),healthFunds.paymentGateway.handledType.credit=!0,healthFunds.paymentGateway.handledType.bank=!1},unset:function(){healthFunds._reset(),healthFunds._dependants(!1),$(".health_dependant_details_schoolGroup select").remove(),$(".health_dependant_details_schoolIDGroup input").removeAttr("maxlength"),$(".health_dependant_details_schoolGroup .control-label").html(healthFunds_AHM.tmpSchoolLabel),delete healthFunds_AHM.tmpSchoolLabel,$(".health_dependant_details_schoolGroup .help_icon").show(),$("#health_previousfund_primary_authority").rules("remove","required"),$("#health_previousfund_partner_authority").rules("remove","required"),$("#health_previousfund_primary_memberID").removeAttr("maxlength"),$("#health_previousfund_partner_memberID").removeAttr("maxlength"),healthFunds._previousfund_authority(!1),creditCardDetails.resetConfig(),creditCardDetails.render(),healthFunds._paymentDaysRender($(".health-bank_details-policyDay"),!1),healthFunds._paymentDaysRender($(".health-credit-card_details-policyDay"),!1),$("#update-premium").off("click.AHM"),healthFunds.paymentGateway.reset()}},healthFunds_AUF={set:function(){healthFunds._dependants("This policy provides cover for children under the age of 23 or who are aged between 23-25 years and engaged in full time study. Student dependants do not need to be living at home to be added to the policy. Adult dependants outside these criteria can still be covered by applying for a separate singles policy."),$("#clientMemberID").find("input").rules("remove","required"),$("#partnerMemberID").find("input").rules("remove","required"),healthDependents.config.schoolMin=23,meerkat.modules.healthPaymentStep.overrideSettings("bank",{weekly:!1,fortnightly:!1,monthly:!0,quarterly:!0,halfyearly:!1,annually:!0}),meerkat.modules.healthPaymentStep.overrideSettings("credit",{weekly:!1,fortnightly:!1,monthly:!0,quarterly:!0,halfyearly:!1,annually:!0}),meerkat.modules.healthPaymentStep.setCoverStartRange(0,30),healthFunds._payments={min:0,max:5,weekends:!1},$("#update-premium").on("click.AUF",function(){var a=healthFunds._paymentDays($("#health_payment_details_start").val());healthFunds._paymentDaysRender($(".health-bank_details-policyDay"),a),healthFunds._paymentDaysRender($(".health-credit-card_details-policyDay"),a)}),creditCardDetails.config={visa:!0,mc:!0,amex:!0,diners:!1},creditCardDetails.render(),healthFunds.applicationFailed=function(){meerkat.modules.transactionId.getNew()}},unset:function(){healthFunds._reset(),healthFunds._dependants(!1),creditCardDetails.resetConfig(),creditCardDetails.render(),healthFunds._paymentDaysRender($(".health-bank_details-policyDay"),!1),healthFunds._paymentDaysRender($(".health-credit-card_details-policyDay"),!1),$("#update-premium").off("click.AUF"),healthFunds.applicationFailed=function(){return!1}}},healthFunds_FRA={set:function(){healthFunds._dependants("This policy provides cover for children until their 21st birthday. Adult dependants over 21 years old can be covered by applying for a separate singles policy."),healthFunds._previousfund_authority(!0),healthFunds.$_optionDR=$(".person-title").find("option[value=DR]").first(),$(".person-title").find("option[value=DR]").remove(),$("#update-premium").on("click.FRA",function(){var a=healthFunds._earliestDays($("#health_payment_details_start").val(),new Array(1,15),7);healthFunds._paymentDaysRender($(".health-bank_details-policyDay"),a),healthFunds._paymentDaysRender($(".health-credit-card_details-policyDay"),a)}),healthDependents.config.school=!1,healthDependents.maxAge=21,$("#clientMemberID input").rules("remove","required"),$("#partnerMemberID input").rules("remove","required"),meerkat.modules.healthPaymentStep.overrideSettings("bank",{weekly:!1,fortnightly:!1,monthly:!0,quarterly:!1,halfyearly:!1,annually:!0}),meerkat.modules.healthPaymentStep.overrideSettings("credit",{weekly:!1,fortnightly:!1,monthly:!0,quarterly:!1,halfyearly:!1,annually:!0}),meerkat.modules.healthPaymentStep.overrideSettings("creditBankQuestions",!0),creditCardDetails.config={visa:!0,mc:!0,amex:!1,diners:!1},creditCardDetails.render(),meerkat.modules.healthPaymentStep.setCoverStartRange(0,30)},unset:function(){healthFunds._reset(),healthFunds._dependants(!1),healthFunds._previousfund_authority(!1),$(".person-title").append(healthFunds.$_optionDR),healthFunds._paymentDaysRender($(".health-credit-card_details-policyDay"),!1),healthFunds._paymentDaysRender($(".health-bank_details-policyDay"),!1),$("#update-premium").off("click.FRA"),creditCardDetails.resetConfig(),creditCardDetails.render()}},healthFunds_GMF={set:function(){healthFunds._dependants("This policy provides cover for your children up to their 21st birthday. Dependants aged under 25 may also be added to the policy provided they are not married or in a defacto relationship and earn less than $20,500 p/annum. Adult dependants outside these criteria can still be covered by applying for a separate policy."),healthDependents.config={school:!1,defacto:!0,defactoMin:21,defactoMax:24},$("#clientMemberID input").rules("remove","required"),$("#partnerMemberID input").rules("remove","required"),healthFunds_GMF.$_medicareMessage=$("#health_medicareDetails_message"),healthFunds_GMF.$_medicareMessage.text("GMF will send you an email shortly so that your rebate can be applied to the premium"),""!==healthFunds_GMF.$_medicareMessage.siblings("input").val()?healthFunds_GMF.$_medicareMessage.fadeIn():(healthFunds_GMF.$_medicareMessage.hide(),healthFunds_GMF.$_medicareMessage.siblings("input").on("change.GMF",function(){""!==$(this).val()&&healthFunds_GMF.$_medicareMessage.fadeIn()})),meerkat.modules.healthPaymentStep.setCoverStartRange(0,30),meerkat.modules.healthPaymentStep.overrideSettings("bank",{weekly:!1,fortnightly:!0,monthly:!0,quarterly:!0,halfyearly:!1,annually:!0}),meerkat.modules.healthPaymentStep.overrideSettings("credit",{weekly:!1,fortnightly:!0,monthly:!0,quarterly:!0,halfyearly:!1,annually:!0}),meerkat.modules.healthPaymentStep.overrideSettings("frequency",{weekly:28,fortnightly:28,monthly:28,quarterly:28,halfyearly:28,annually:28}),meerkat.modules.healthPaymentStep.overrideSettings("creditBankQuestions",!0),creditCardDetails.config={visa:!0,mc:!0,amex:!1,diners:!1},creditCardDetails.render()},unset:function(){healthFunds._reset(),healthFunds._dependants(!1),healthFunds_GMF.$_medicareMessage.text("").hide(),healthFunds_GMF.$_medicareMessage.siblings("input").unbind("change.GMF"),delete healthFunds_GMF.$_medicareMessage,creditCardDetails.resetConfig(),creditCardDetails.render()}},healthFunds_GMH={set:function(){healthFunds._previousfund_authority(!0),healthFunds._dependants("This policy provides cover for children until their 21st birthday. Student dependants aged between 21-24 years who are engaged in full time study, apprenticeships or traineeships can also be added to this policy. Adult dependants outside these criteria can still be covered by applying for a separate singles policy."),healthDependents.config={school:!0,defacto:!1,schoolMin:21,schoolMax:24},healthFunds._schoolLabel=$(".health_dependant_details_schoolGroup").first().find(".control-label").text(),$(".health_dependant_details_schoolGroup").find(".control-label").text("Name of school/employer/educational institution your child is attending"),$("#clientMemberID input").rules("remove","required"),$("#partnerMemberID input").rules("remove","required"),meerkat.modules.healthPaymentStep.overrideSettings("bank",{weekly:!1,fortnightly:!0,monthly:!0,quarterly:!0,halfyearly:!0,annually:!0}),meerkat.modules.healthPaymentStep.overrideSettings("credit",{weekly:!1,fortnightly:!1,monthly:!0,quarterly:!0,halfyearly:!0,annually:!0}),meerkat.modules.healthPaymentStep.overrideSettings("frequency",{weekly:27,fortnightly:27,monthly:27,quarterly:27,halfyearly:27,annually:27}),meerkat.modules.healthPaymentStep.overrideSettings("creditBankQuestions",!0),creditCardDetails.config={visa:!0,mc:!0,amex:!1,diners:!1},creditCardDetails.render(),meerkat.modules.healthPaymentStep.setCoverStartRange(0,30),$("#update-premium").on("click.GMH",function(){var a=healthFunds._earliestDays($("#health_payment_details_start").val(),[1],7);healthFunds._paymentDaysRender($(".health-credit-card_details-policyDay"),a)})},unset:function(){healthFunds._reset(),healthFunds._previousfund_authority(!1),healthFunds._dependants(!1),$("#mainform").find(".health_dependant_details_schoolGroup").find(".control-label").text(healthFunds._schoolLabel),creditCardDetails.resetConfig(),creditCardDetails.render(),healthFunds._paymentDaysRender($(".health-credit-card_details-policyDay"),!1),$("#update-premium").off("click.GMH")}},healthFunds_NIB={set:function(){healthApplicationDetails.showHowToSendInfo("NIB",!0),healthFunds._partner_authority(!0),healthFunds._dependants("This policy provides cover for your children up to their 21st birthday and dependants aged between 21 and 24 who are studying full time. Adult dependants outside these criteria can still be covered by applying for a separate policy."),healthDependents.config={school:!0,defacto:!1,schoolMin:21,schoolMax:24},$("#clientMemberID input").rules("remove","required"),$("#partnerMemberID input").rules("remove","required"),healthFunds._previousfund_authority(!0),meerkat.modules.healthPaymentStep.setCoverStartRange(0,29),meerkat.modules.healthPaymentStep.overrideSettings("bank",{weekly:!1,fortnightly:!0,monthly:!0,quarterly:!1,halfyearly:!1,annually:!0}),meerkat.modules.healthPaymentStep.overrideSettings("credit",{weekly:!1,fortnightly:!0,monthly:!0,quarterly:!1,halfyearly:!1,annually:!0}),meerkat.modules.healthPaymentStep.overrideSettings("frequency",{weekly:27,fortnightly:27,monthly:27,quarterly:27,halfyearly:27,annually:27}),meerkat.modules.healthPaymentStep.overrideSettings("creditBankSupply",!0),meerkat.modules.healthPaymentStep.overrideSettings("creditBankQuestions",!0),creditCardDetails.config={visa:!0,mc:!0,amex:!0,diners:!1},creditCardDetails.render(),$("#update-premium").on("click.NIB",function(){var a=meerkat.modules.healthPaymentStep.getSelectedFrequency();healthFunds._payments="fortnightly"==a?{min:0,max:10,weekends:!1,countFrom:"effectiveDate"}:{min:0,max:27,weekends:!0,countFrom:"today",maxDay:27};var b=healthFunds._paymentDays($("#health_payment_details_start").val());healthFunds._paymentDaysRender($(".health-bank_details-policyDay"),b),healthFunds._paymentDaysRender($(".health-credit-card_details-policyDay"),b)})},unset:function(){$("#update-premium").off("click.NIB"),healthFunds._paymentDaysRender($(".health-credit-card_details-policyDay"),!1),healthFunds._paymentDaysRender($(".health-bank_details-policyDay"),!1),healthApplicationDetails.hideHowToSendInfo(),healthFunds._reset(),healthFunds._previousfund_authority(!1),healthFunds._dependants(!1),creditCardDetails.resetConfig(),creditCardDetails.render()}},healthFunds_WFD={set:function(){meerkat.modules.healthPaymentStep.setCoverStartRange(0,30),healthFunds._dependants("As a member of Westfund, your children aged between 18-24 are entitled to stay on your cover at no extra charge if they are a full time or part-time student at School, college or University TAFE institution or serving an Apprenticeship or Traineeship."),healthDependents.config={school:!0,defacto:!1,schoolMin:18,schoolMax:24,schoolID:!0},healthFunds_WFD.$_declaration=$("#health_declaration-selection"),healthFunds_WFD.$_declaration.addClass("hidden");var a="Please note that the LHC amount quoted is an estimate and will be confirmed once Westfund has verified your details.";$(".health-payment-details_premium .row-content").append('<p class="statement" style="margin-top:1em">'+a+"</p>"),$("#health_previousfund_primary_fundName").removeAttr("required"),$("#health_previousfund_partner_fundName").removeAttr("required"),$("#clientMemberID input").rules("remove","required"),$("#partnerMemberID input").rules("remove","required"),healthFunds._previousfund_authority(!0),meerkat.modules.healthPaymentStep.overrideSettings("bank",{weekly:!1,fortnightly:!1,monthly:!0,quarterly:!1,halfyearly:!1,annually:!0}),meerkat.modules.healthPaymentStep.overrideSettings("credit",{weekly:!1,fortnightly:!1,monthly:!0,quarterly:!1,halfyearly:!1,annually:!0}),meerkat.modules.healthPaymentStep.overrideSettings("creditBankQuestions",!0),creditCardDetails.config={visa:!0,mc:!0,amex:!1,diners:!1},creditCardDetails.render(),$("#update-premium").on("click.WFD",function(){var a=returnDate($("#health_payment_details_start").val()),b=4-a.getDay();2>b&&(b+=7),a.setDate(a.getDate()+b);var c=a.getDate(),d=c>10&&20>c;c+=c%10!=1||d?c%10!=2||d?c%10!=3||d?"th":"rd":"nd":"st";var e="Please note that your first or full payment (annual frequency) will be debited from your payment method on "+healthFunds._getDayOfWeek(a)+" "+c+" "+healthFunds._getMonth(a);$(".health_credit-card-details_policyDay-message").text(e),$(".health_bank-details_policyDay-message").text(e);var f=leadingZero(a.getDate()),g=leadingZero(a.getMonth()+1),h=a.getFullYear()+"-"+g+"-"+f;$(".health-credit-card_details-policyDay option").val(h),$(".health-bank_details-policyDay option").val(h)}),healthFunds_WFD.$_dobPrimary=$("#health_application_primary_dob"),healthFunds_WFD.defaultAgeMin=dob_health_application_primary_dob.ageMin,dob_health_application_primary_dob.ageMin=18,healthFunds_WFD.$_dobPrimary.rules("add",{messages:{min_DateOfBirth:healthFunds_WFD.$_dobPrimary.attr("title")+" age cannot be under "+dob_health_application_primary_dob.ageMin}}),healthFunds_WFD.$_dobPartner=$("#health_application_partner_dob"),dob_health_application_partner_dob.ageMin=18,healthFunds_WFD.$_dobPartner.rules("add",{messages:{min_DateOfBirth:healthFunds_WFD.$_dobPartner.attr("title")+" age cannot be under "+dob_health_application_partner_dob.ageMin}})},unset:function(){$("#update-premium").off("click.WFD"),healthFunds._paymentDaysRender($(".health-credit-card_details-policyDay"),!1),healthFunds._paymentDaysRender($(".health-bank_details-policyDay"),!1),healthFunds._reset(),healthFunds._dependants(!1),healthFunds_WFD.$_declaration.removeClass("hidden"),healthFunds_WFD.$_declaration=void 0,$(".health-payment-details_premium .statement").remove(),$("#health_previousfund_primary_fundName").attr("required","required"),$("#health_previousfund_partner_fundName").attr("required","required"),healthFunds._previousfund_authority(!1),dob_health_application_primary_dob.ageMin=healthFunds_WFD.defaultAgeMin,healthFunds_WFD.$_dobPrimary.rules("add",{messages:{min_DateOfBirth:healthFunds_WFD.$_dobPrimary.attr("title")+" age cannot be under "+dob_health_application_primary_dob.ageMin}}),dob_health_application_partner_dob.ageMin=healthFunds_WFD.defaultAgeMin,healthFunds_WFD.$_dobPrimary.rules("add",{messages:{min_DateOfBirth:healthFunds_WFD.$_dobPartner.attr("title")+" age cannot be under "+dob_health_application_partner_dob.ageMin}}),delete healthFunds_WFD.defaultAgeMin,delete healthFunds_WFD.$_dobPrimary,delete healthFunds_WFD.$_dobPartner}},FatalErrorDialog={display:function(a){FatalErrorDialog.exec(a)},init:function(){},exec:function(a){var b=$.extend({errorLevel:"silent",message:"A fatal error has occurred.",page:"undefined.jsp",description:null,data:null},a);meerkat.modules.errorHandling.error(b)}},Track={splitTest:function(a,b){meerkat.modules.tracking.recordSupertag("splitTesting",{version:a,splitTestName:b})}},healthChoices={_cover:"",_situation:"",_state:"",_benefits:new Object,_performUpdate:!1,initialise:function(a,b){healthChoices.setCover(a,!0,!0);var c=this._performUpdate;healthChoices.setSituation(b,c)},hasSpouse:function(){switch(this._cover){case"C":case"F":return!0;default:return!1}},hasChildren:function(){switch(this._cover){case"F":case"SPF":return!0;default:return!1}},setCover:function(a,b,c){b=b||!1,c=c||!1,healthChoices._cover=a,b||healthChoices.resetRebateForm(),healthChoices.hasSpouse()?$("#partner-health-cover, #partner, .health-person-details-partner, #partnerFund").show():(healthChoices.flushPartnerDetails(),$("#partner-health-cover, #partner, .health-person-details-partner, #partnerFund").hide()),healthChoices.dependants(c),healthCoverDetails.displayHealthFunds(),healthCoverDetails.setTiers(c),"undefined"!=typeof priceMinSlider&&priceMinSlider.reset()},setSituation:function(a,b){b!==!1&&(b=!0),a!=healthChoices._situation&&(healthChoices._situation=a),$("#health_benefits_healthSitu, #health_situation_healthSitu").val(a)},isValidLocation:function(a){var b=new RegExp(/^((\s)*([^~,])+\s+)+\d{4}((\s)+(ACT|NSW|QLD|TAS|SA|NT|VIC|WA)(\s)*)$/);return value=$.trim(String(a)),""!=value&&value.match(b)?!0:!1},setLocation:function(a){if(healthChoices.isValidLocation(a)){var b=$.trim(String(a)),c=b.split(" "),d=c.pop(),e=c.pop(),f=c.join(" ");$("#health_situation_state").val(d),$("#health_situation_postcode").val(e).trigger("change"),$("#health_situation_suburb").val(f),healthChoices.setState(d)}else HealthSettings.isFromBrochureSite&&$("#health_situation_location").val("")},setState:function(a){healthChoices._state=a},setDob:function(a,b){""!=a&&b.val(a)},dependants:function(a){healthChoices.hasChildren()&&"Y"==$(".health_cover_details_rebate :checked").val()?a===!0?$(".health_cover_details_dependants").show():$(".health_cover_details_dependants").slideDown():a===!0?$(".health_cover_details_dependants").hide():($("#health_healthCover_dependants option:selected").prop("selected",!1),$("#health_healthCover_income option:selected").prop("selected",!1),$(".health_cover_details_dependants").slideUp())},returnCover:function(){return $("#health_situation_healthCvr option:selected").text()},returnCoverCode:function(){return this._cover},flushPartnerDetails:function(){$("#health_healthCover_partner_dob").val("").change(),$('#partner-health-cover input[name="health_healthCover_partner_cover"]:checked').each(function(){$(this).checked=!1}),resetRadio($("#health_healthCover_partnerCover")),$('#partner-health-cover input[name="health_healthCover_partner_healthCoverLoading"]:checked').each(function(){$(this).checked=!1}),resetRadio($("#health-continuous-cover-partner"))},resetRebateForm:function(){$('#health_healthCover_health_cover_rebate input[name="health_healthCover_rebate"]:checked').each(function(){$(this).checked=!1}),resetRadio($("#health_healthCover_health_cover_rebate")),$("#health_healthCover_dependants option").first().prop("selected",!0),$("#health_healthCover_dependants option:selected").prop("selected",!1),$("#health_healthCover_income option").first().prop("selected",!0),$("#health_healthCover_income option:selected").prop("selected",!1),$("#health_healthCover_incomelabel").val(""),healthCoverDetails.setIncomeBase(),healthChoices.dependants(),healthCoverDetails.setTiers(),$(".health_cover_details_dependants").hide(),$("#health_healthCover_tier").hide(),$("#health_rebates_group").hide()}},healthCoverDetails={getRebateChoice:function(){return $("#health_healthCover-selection").find(".health_cover_details_rebate :checked").val()},setIncomeBase:function(a){"S"==healthChoices._cover&&"Y"==healthCoverDetails.getRebateChoice()?a?$("#health_healthCover-selection").find(".health_cover_details_incomeBasedOn").show():$("#health_healthCover-selection").find(".health_cover_details_incomeBasedOn").slideDown():a?$("#health_healthCover-selection").find(".health_cover_details_incomeBasedOn").hide():$("#health_healthCover-selection").find(".health_cover_details_incomeBasedOn").slideUp()},displayHealthFunds:function(){var a=$("#mainform").find(".health-previous_fund"),b=$("#clientFund").find("select"),c=$("#partnerFund").find("select");"NONE"!=b.val()&&""!=b.val()?(a.find("#clientMemberID").slideDown(),a.find(".membership").addClass("onA")):(a.find("#clientMemberID").slideUp(),a.find(".membership").removeClass("onA")),healthChoices.hasSpouse()&&"NONE"!=c.val()&&""!=c.val()?(a.find("#partnerMemberID").slideDown(),a.find(".membership").addClass("onB")):(a.find("#partnerMemberID").slideUp(),a.find(".membership").removeClass("onB"))},setHealthFunds:function(a){var b=$("#health_healthCover_primaryCover").find(":checked").val(),c=$("#health_healthCover_partnerCover").find(":checked").val(),d=$("#clientFund").find("select"),e=$("#partnerFund").find("select");"Y"==b?isLessThan31Or31AndBeforeJuly1($("#health_healthCover_primary_dob").val())?a?$("#health-continuous-cover-primary").show():$("#health-continuous-cover-primary").slideDown():a?$("#health-continuous-cover-primary").hide():$("#health-continuous-cover-primary").slideUp():("N"==b&&resetRadio($("#health-continuous-cover-primary"),"N"),a?$("#health-continuous-cover-primary").hide():$("#health-continuous-cover-primary").slideUp()),"Y"==b&&"NONE"==d.val()?d.val(""):"N"==b&&d.val("NONE"),"Y"==c?isLessThan31Or31AndBeforeJuly1($("#health_healthCover_partner_dob").val())?a?$("#health-continuous-cover-partner").show():$("#health-continuous-cover-partner").slideDown():a?$("#health-continuous-cover-partner").hide():$("#health-continuous-cover-partner").slideUp():("N"==c&&resetRadio($("#health-continuous-cover-partner"),"N"),a?$("#health-continuous-cover-partner").hide():$("#health-continuous-cover-partner").slideUp()),"Y"==c&&"NONE"==e.val()?e.val(""):"N"==c&&e.val("NONE"),healthCoverDetails.displayHealthFunds()},setTiers:function(a){var b=$("#health_healthCover_dependants").val()-1;b>0?(b=1500*b,$("#health_healthCover_incomeMessage").text("this includes an adjustment for your dependants")):(b=0,$("#health_healthCover_incomeMessage").text(""));var c;c=$("#health_healthCover_incomeBase").is(":visible")&&$("#health_healthCover_incomeBase").find(":checked").length>0?$("#health_healthCover_incomeBase").find(":checked").val():healthChoices.returnCoverCode(),$("#health_healthCover_income").find("option").each(function(){var d=$(this),e=d.val(),f="";if(_ageBonus=null===meerkat.modules.health.getRates()?0:parseInt(meerkat.modules.health.getRates().ageBonus),"S"==c||""==c)switch(e){case"0":f="$"+(88e3+b)+" or less";break;case"1":f="$"+(88001+b)+" - $"+(102e3+b);break;case"2":f="$"+(102001+b)+" - $"+(136e3+b);break;case"3":f="$"+(136001+b)+"+ (no rebate)"}else switch(e){case"0":f="$"+(176e3+b)+" or less";break;case"1":f="$"+(176001+b)+" - $"+(204e3+b);break;case"2":f="$"+(204001+b)+" - $"+(272e3+b);break;case"3":f="$"+(272e3+b)+"+ (no rebate)"}""!=f&&d.text(f),"N"!=healthCoverDetails.getRebateChoice()&&healthCoverDetails.getRebateChoice()?(a?$("#health_healthCover_tier").show():$("#health_healthCover_tier").slideDown(),$(".health-medicare_details").show()):(a?$("#health_healthCover_tier").hide():$("#health_healthCover_tier").slideUp(),$(".health-medicare_details").hide())})},getAgeAsAtLastJuly1:function(a){var b=a.split("/"),c=Number(b[2]),d=Number(b[1])-1,e=Number(b[0]),f=new Date,g=f.getFullYear()-c;
return(d>6||6==d&&e>1)&&g--,g}},healthFunds={_fund:!1,name:"the fund",countFrom:{TODAY:"today",NOCOUNT:"",EFFECTIVE_DATE:"effectiveDate"},minType:{FROM_TODAY:"today",FROM_EFFECTIVE_DATE:"effectiveDate"},checkIfNeedToInjectOnAmend:function(a){if($("#health_application_provider").val().length>0){var b=$("#health_application_provider").val(),c="healthFunds_"+b;$(document.body).addClass("injectingFund"),healthFunds.load(b,function(){window[c].processOnAmendQuote&&window[c].processOnAmendQuote===!0&&(window[c].set(),window[c].unset()),$(document.body).removeClass("injectingFund"),a()},!1)}else a()},load:function(a,b,c){if(""==a||!a)return healthFunds.loadFailed("Empty or false"),!1;if(c!==!1&&(c=!0),"undefined"==typeof window["healthFunds_"+a]||0==window["healthFunds_"+a]){var d={transactionId:meerkat.modules.transactionId.get()};return $.ajax({url:"common/js/health/healthFunds_"+a+".jsp",dataType:"script",data:d,async:!0,timeout:3e4,cache:!1,beforeSend:function(a,b){var c=b.url,d="uncache";c=c.replace("?_=","?"+d+"="),c=c.replace("&_=","&"+d+"="),b.url=c},success:function(){c&&healthFunds.process(a),"function"==typeof b&&b(!0)},error:function(c,d){healthFunds.loadFailed(a,d),"function"==typeof b&&b(!1)}}),!1}return a!=healthFunds._fund&&c&&healthFunds.process(a),"function"==typeof b&&b(!0),!0},process:function(a){var b=window["healthFunds_"+a];healthFunds.set=b.set,healthFunds.unset=b.unset,$("body").addClass(a),healthFunds.set(),healthFunds._fund=a},loadFailed:function(a,b){FatalErrorDialog.exec({message:"Unable to load the fund's application questions",page:"health:health_funds.tag",description:"healthFunds.update(). Unable to load fund questions for: "+a,data:b})},unload:function(){healthFunds._fund!==!1&&(healthFunds.unset(),$("body").removeClass(healthFunds._fund),healthFunds._fund=!1,healthFunds.set=function(){},healthFunds.unset=function(){})},set:function(){},unset:function(){},applicationFailed:function(){return!1},_memberIdRequired:function(a){a?($("#clientMemberID").find("input").rules("add","required"),$("#partnerMemberID").find("input").rules("add","required")):($("#clientMemberID").find("input").rules("remove","required"),$("#partnerMemberID").find("input").rules("remove","required"))},_dependants:function(a){a!==!1?(healthFunds.$_dependantDefinition=$("#mainform").find(".health-dependants").find(".definition"),healthFunds.HTML_dependantDefinition=healthFunds.$_dependantDefinition.html(),healthFunds.$_dependantDefinition.html(a)):(healthFunds.$_dependantDefinition.html(healthFunds.HTML_dependantDefinition),healthFunds.$_dependantDefinition=void 0,healthFunds.HTML_dependantDefinition=void 0)},_previousfund_authority:function(a){a!==!1?(healthFunds.$_authority=$(".health_previous_fund_authority label span"),healthFunds.$_authorityText=healthFunds.$_authority.eq(0).text(),healthFunds.$_authority.text(meerkat.modules.healthResults.getSelectedProduct().info.providerName),$(".health_previous_fund_authority").removeClass("hidden")):"undefined"!=typeof healthFunds.$_authority&&(healthFunds.$_authority.text(healthFunds.$_authorityText),healthFunds.$_authority=void 0,healthFunds.$_authorityText=void 0,$(".health_previous_fund_authority").addClass("hidden"))},_partner_authority:function(a){a===!0?$(".health_person-details_authority_group").removeClass("hidden"):$(".health_person-details_authority_group").addClass("hidden")},_reset:function(){healthApplicationDetails.hideHowToSendInfo(),healthFunds._partner_authority(!1),healthFunds._memberIdRequired(!0),healthDependents.resetConfig()},_paymentDays:function(a){if(""==a)return!1;var b=returnDate(a),c=new Date,d=null;d=healthFunds._payments.countFrom==healthFunds.countFrom.TODAY?c:b;var e=0,f=0,g=healthFunds._payments.max;if(healthFunds._payments.minType==healthFunds.minType.FROM_TODAY){var h=Math.round((b-c)/864e5);h<healthFunds._payments.min&&(f=healthFunds._payments.min-h)}else f=healthFunds._payments.min,g-=healthFunds._payments.min;for(var i='<option value="">Please choose...</option>';g>e;){var j=new Date(d.getTime()+24*f*60*60*1e3),k=j.getDay();if("undefined"!=typeof healthFunds._payments.maxDay&&healthFunds._payments.maxDay<j.getDate())f++;else if(healthFunds._payments.weekends||0!=k&&6!=k){var l=leadingZero(j.getDate()),m=leadingZero(j.getMonth()+1);i+='<option value="'+j.getFullYear()+"-"+m+"-"+l+'">'+healthFunds._getNiceDate(j)+"</option>",f++,e++}else f++}return i},_earliestDays:function(b,c,d){if(!$.isArray(c)||""==b)return!1;var e=returnDate(b);d=7;for(var f=new Date(e.getTime()+24*d*60*60*1e3),g='<option value="">No date has been selected for you</option>',h=0;31>h;h++)for(f=new Date(f.getTime()+864e5),a=0;a<c.length;a++)if(c[a]==f.getDate()){var i=leadingZero(f.getDate()),j=leadingZero(f.getMonth()+1);g='<option value="'+f.getFullYear()+"-"+j+"-"+i+'" selected="selected">'+healthFunds._getNiceDate(f)+"</option>",h=99;break}return g},_paymentDaysRender:function(a,b){b===!1&&(healthFunds._payments={min:0,max:5,weekends:!1},b='<option value="">Please choose...</option>'),a.html(b),a.parent().siblings("p").text("Your payment will be deducted on: "+a.find("option").first().text()),$(".health-bank_details-policyDay, .health-credit-card_details-policyDay").html(b)},_getDayOfWeek:function(a){var b=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];return b[a.getDay()]},_getMonth:function(a){var b=["January","February","March","April","May","June","July","August","September","October","November","December"];return b[a.getMonth()]},_getNiceDate:function(a){var b=a.getDate(),c=a.getFullYear();return healthFunds._getDayOfWeek(a)+", "+b+" "+healthFunds._getMonth(a)+" "+c}},healthApplicationDetails={preloadedValue:$("#contactPointValue").val(),periods:1,init:function(){postalMatchHandler.init("health_application")},showHowToSendInfo:function(a,b){{var c=$("#health_application_contactPoint-group"),d=c.find(".control-label span");d.text()}d.text(a),b?c.find("input").rules("add",{required:!0,messages:{required:"Please choose how you would like "+a+" to contact you"}}):c.find("input").rules("remove","required"),c.removeClass("hidden")},hideHowToSendInfo:function(){var a=$("#health_application_contactPoint-group");a.addClass("hidden")},addOption:function(a,b){var c=$("#health_application_contactPoint");c.append('<label class="btn btn-default"><input id="health_application_contactPoint_'+b+'" type="radio" data-msg-required="Please choose " value="'+b+'" name="health_application_contactPoint">'+a+"</label>"),0==c.find("input:checked").length&&this.preloadedValue==b&&$("#health_application_contactPoint_"+b).prop("checked",!0)},removeLastOption:function(){var a=$("#health_application_contactPoint");a.find("label").last().remove()},testStatesParity:function(){var a=$("#health_application_address_state");if(a.val()!=$("#health_situation_state").val()){var b=$("#health_application_address_suburbName").val(),c=$("#health_application_address_postCode").val(),d=$("#health_application_address_state").val();if(b.length&&b.indexOf("Please select")<0&&4==c.length&&d.length)return $("#health_application_address_postCode").addClass("error"),!1}return!0}},paymentGateway={name:"",handledType:{},_hasRegistered:!1,_type:"",_calledBack:!1,_timeout:!1,modalId:"",hasRegistered:function(){return this._hasRegistered},success:function(a){return a&&a.number&&a.type&&a.expiry&&a.name?(this._hasRegistered=!0,this._outcome(!0),$("#"+paymentGateway.name+"-registered").val("1").valid(),$("#"+paymentGateway.name+"_number").val(a.number),$("#"+paymentGateway.name+"_type").val(a.type),$("#"+paymentGateway.name+"_expiry").val(a.expiry),$("#"+paymentGateway.name+"_name").val(a.name),$("."+paymentGateway.name+" .launcher").slideUp(),$("."+paymentGateway.name+" .success").slideDown(),void $("."+paymentGateway.name+" .fail").slideUp()):(this.fail("Registration response parameters invalid"),!1)},fail:function(a){this._outcome(!1),$("#"+paymentGateway.name+"-registered").val(""),$("#"+paymentGateway.name+"_number").val(""),$("#"+paymentGateway.name+"_type").val(""),$("#"+paymentGateway.name+"_expiry").val(""),$("#"+paymentGateway.name+"_name").val(""),$("."+paymentGateway.name+" .launcher").slideDown(),$("."+paymentGateway.name+" .success").slideUp(),$("."+paymentGateway.name+" .fail").slideDown(),a&&a.length>0&&meerkat.modules.errorHandling.error({message:a,errorLevel:"warning",page:"health_quote.jsp",description:"paymentGateway.fail()",silent:!0})},_outcome:function(){this._calledBack=!0,meerkat.modules.dialogs.destroyDialog(paymentGateway.modalId)},setType:function(a){return this._type!=a&&(this._hasRegistered=!1),this._type="cc"==a&&this.handledType.credit||"ba"==a&&this.handledType.bank?a:"",this.togglePanels(),""!=this._type},setTypeFromControl:function(){this.setType(meerkat.modules.healthPaymentStep.getSelectedPaymentMethod()),this.setType($("input[name='health_payment_details_type']:checked").val())},togglePanels:function(){switch(this.hasRegistered()?($("."+paymentGateway.name+" .launcher").slideUp(),$("."+paymentGateway.name+" .success").slideDown(),$("."+paymentGateway.name+" .fail").slideUp()):($("#"+paymentGateway.name+"-registered").val(""),$("."+paymentGateway.name+" .launcher").slideDown(),$("."+paymentGateway.name+" .success").slideUp(),$("."+paymentGateway.name+" .fail").slideUp()),this._type){case"cc":$("."+paymentGateway.name+"-credit").slideDown(),$("#"+paymentGateway.name+"-registered").rules("add",{required:!0,messages:{required:"Please register your credit card details"}});break;default:$("."+paymentGateway.name+"-credit").slideUp("","",function(){$(this).hide()}),$("#"+paymentGateway.name+"-registered").rules("remove","required")}},reset:function(){this.handledType={credit:!1,bank:!1},this._type="",this._hasRegistered=!1,this.togglePanels(),$("body").removeClass(paymentGateway.name+"-active"),this.clearValidation(),$("#"+paymentGateway.name+"-registered").val(""),$("#health_payment_details_claims").find("input").off("change."+paymentGateway.name),$("#update-premium").off("click."+paymentGateway.name),$("#health_payment_details_type").trigger("change")},clearValidation:function(){$("#"+paymentGateway.name+"-registered").rules("remove","required")},init:function(a){paymentGateway.name=a,this.reset(),$("body").addClass(paymentGateway.name+"-active"),$("#update-premium").on("click."+paymentGateway.name,function(){paymentGateway.setTypeFromControl()})},launch:function(){paymentGateway._calledBack=!1,meerkat.modules.tracking.recordSupertag("trackCustomPage","Payment gateway popup"),paymentGateway.modalId=meerkat.modules.dialogs.show({htmlContent:meerkat.modules.loadingAnimation.getTemplate(),onOpen:function(a){clearTimeout(paymentGateway._timeout),paymentGateway._timeout=setTimeout(function(){var b="";"ba"==paymentGateway._type&&(b="DD"),meerkat.modules.dialogs.changeContent(a,'<iframe width="100%" height="340" frameBorder="0" src="ajax/html/health_paymentgateway.jsp?transactionId='+meerkat.modules.transactionId.get()+"&type="+b+'"></iframe>')},1e3)},onClose:function(){clearTimeout(paymentGateway._timeout),paymentGateway._calledBack||paymentGateway.fail()}})}},healthDependents={_dependents:0,_limit:12,maxAge:25,init:function(){healthDependents.resetConfig()},resetConfig:function(){healthDependents.config={school:!0,schoolMin:22,schoolMax:24,schoolID:!1,schoolIDMandatory:!1,schoolDate:!1,schoolDateMandatory:!1,defacto:!1,defactoMin:21,defactoMax:24},healthDependents.maxAge=25},setDependants:function(){var a=$("#mainform").find(".health_cover_details_dependants").find("select").val();return healthDependents._dependents="Y"!=healthCoverDetails.getRebateChoice()||isNaN(a)?1:a,healthChoices.hasChildren()?($("#health_application_dependants-selection").show(),healthDependents.updateDependentOptionsDOM(),void $("#health_application_dependants-selection").find(".health_dependant_details").each(function(){var a=parseInt($(this).attr("data-id"));a>healthDependents._dependents?$(this).hide():$(this).show(),healthDependents.checkDependent(a)})):void $("#health_application_dependants-selection").hide()},addDependent:function(){if(healthDependents._dependents<healthDependents._limit){healthDependents._dependents++;var a=$("#health_application_dependants_dependant"+healthDependents._dependents);a.find("input[type=text], select").val(""),resetRadio(a.find(".health_dependant_details_maritalincomestatus"),""),a.find(".error-field label").remove(),a.find(".has-error, .has-success").removeClass("has-error").removeClass("has-success"),a.show(),healthDependents.updateDependentOptionsDOM(),healthDependents.hasChanged(),$("html").animate({scrollTop:a.offset().top-50},250)}},dropDependent:function(){healthDependents._dependents>0&&($("#health_application_dependants_dependant"+healthDependents._dependents).find("input[type=text]").each(function(){$(this).val("")}),$("#health_application_dependants_dependant"+healthDependents._dependents).find("input[type=radio]:checked").each(function(){this.checked=!1}),$("#health_application_dependants_dependant"+healthDependents._dependents).find("select").each(function(){$(this).removeAttr("selected")}),$("#health_application_dependants_dependant"+healthDependents._dependents).hide(),healthDependents._dependents--,healthDependents.updateDependentOptionsDOM(),healthDependents.hasChanged(),$_obj=$(healthDependents._dependents>0?"#health_application_dependants_dependant"+healthDependents._dependents:"#health_application_dependants-selection"),$("html").animate({scrollTop:$_obj.offset().top-50},250))},updateDependentOptionsDOM:function(){healthDependents._dependents<=0?($("#health_application_dependants-selection").find(".remove-last-dependent").hide(),$("#health_application_dependants_threshold").slideDown()):$("#dependents_list_options").find(".remove-last-dependent").is(":visible")||($("#health_application_dependants_threshold").slideUp(),$("#health_application_dependants-selection").find(".remove-last-dependent").hide(),$("#health_application_dependants-selection .health_dependant_details:visible:last").find(".remove-last-dependent").show()),healthDependents._dependents>=healthDependents._limit?$("#health-dependants").find(".add-new-dependent").hide():$("#health-dependants").find(".add-new-dependent").not(":visible")&&$("#health-dependants").find(".add-new-dependent").show()},checkDependent:function(a){var b=a;isNaN(a)&&"object"==typeof a&&(b=a.data);var c,d=$("#health_application_dependants_dependant"+b+"_dob").val();if(d.length){if(c=healthDependents.getAge(d),isNaN(c))return!1}else c=0;healthDependents.addSchool(b,c),healthDependents.addDefacto(b,c)},getAge:function(a){var b=a.split("/"),c=Number(b[2]),d=Number(b[1])-1,e=Number(b[0]),f=new Date,g=f.getFullYear()-c;return(f.getMonth()<d||f.getMonth()==d&&f.getDate()<e)&&g--,g},addSchool:function(a,b){return healthDependents.config.school===!1?($("#health_application_dependants-selection").find(".health_dependant_details_schoolGroup, .health_dependant_details_schoolIDGroup, .health_dependant_details_schoolDateGroup").hide(),!1):void(b>=healthDependents.config.schoolMin&&b<=healthDependents.config.schoolMax?($("#health_application_dependants-selection").find(".dependant"+a).find(".health_dependant_details_schoolGroup, .health_dependant_details_schoolIDGroup, .health_dependant_details_schoolDateGroup").show(),healthDependents.config.schoolID===!1?$("#health_application_dependants-selection").find(".dependant"+a).find(".health_dependant_details_schoolIDGroup").hide():this.config.schoolIDMandatory===!0?$("#health_application_dependants-selection").find("#health_application_dependants_dependant"+a+"_schoolID").rules("add",{required:!0,messages:{required:"Please enter dependant "+a+"'s student ID"}}):$("#health_application_dependants-selection").find("#health_application_dependants_dependant"+a+"_schoolID").rules("remove","required"),this.config.schoolDate!==!0?$("#health_application_dependants-selection").find(".dependant"+a).find(".health_dependant_details_schoolDateGroup").hide():this.config.schoolDateMandatory===!0?$("#health_application_dependants-selection").find("#health_application_dependants_dependant"+a+"_schoolDate").rules("add",{required:!0,messages:{required:"Please enter date that dependant "+a+" commenced study"}}):$("#health_application_dependants-selection").find("#health_application_dependants_dependant"+a+"_schoolDate").rules("remove","required")):$("#health_application_dependants-selection").find(".dependant"+a).find(".health_dependant_details_schoolGroup, .health_dependant_details_schoolIDGroup, .health_dependant_details_schoolDateGroup").hide())},addDefacto:function(a,b){return healthDependents.config.defacto===!1?!1:void(b>=healthDependents.config.defactoMin&&b<=healthDependents.config.defactoMax?$("#health_application_dependants-selection").find(".dependant"+a).find(".health_dependant_details_maritalincomestatus").show():$("#health_application_dependants-selection").find(".dependant"+a).find(".health_dependant_details_maritalincomestatus").hide())},hasChanged:function(){var a=$("#health_application_dependants-selection").find(".health-dependants-tier");if("N"==healthCoverDetails.getRebateChoice())a.slideUp();else if(healthDependents._dependents>0){$("#health_healthCover_dependants").val(healthDependents._dependents).trigger("change");var b=$("#health_healthCover_tier");a.find("select").html(b.find("select").html()),a.find("#health_application_dependants_incomeMessage").text(b.find("span").text()),a.is(":hidden")&&a.slideDown()}else a.slideUp()}};creditCardDetails={resetConfig:function(){creditCardDetails.config={visa:!0,mc:!0,amex:!0,diners:!1}},render:function(){var a=$("#health_payment_credit_type"),b=$("#health_payment_credit-selection .cards");b.children().hide();var c='<option id="health_payment_credit_type_" value="">Please choose...</option>',d=a.find(":selected").val();creditCardDetails.config.visa===!0&&(c+='<option id="health_payment_credit_type_v" value="v">Visa</option>',b.find(".visa").show()),creditCardDetails.config.mc===!0&&(c+='<option id="health_payment_credit_type_m" value="m">Mastercard</option>',b.find(".mastercard").show()),creditCardDetails.config.amex===!0&&(c+='<option id="health_payment_credit_type_a" value="a">AMEX</option>',b.find(".amex").show()),creditCardDetails.config.diners===!0&&(c+='<option id="health_payment_credit_type_d" value="d">Diners Club</option>',b.find(".diners").show()),a.html(c).find("option[value="+d+"]").attr("selected","selected")},set:function(){creditCardDetails.$_obj=$("#health_payment_credit_number"),creditCardDetails.$_objCCV=$("#health_payment_credit_ccv");var a=creditCardDetails._getType();field_credit_card_validation.set(a,creditCardDetails.$_obj,creditCardDetails.$_objCCV)},_getType:function(){return $("#health_payment_credit_type").find(":selected").val()}},function(a){function b(){if("confirmation"===HealthSettings.pageAction)u.modules.journeyEngine.configure(null);else{d(!1);var a=null;HealthSettings.isFromBrochureSite===!0?a=y.detailsStep.navigationId:HealthSettings.journeyStage.length>0&&"amend"===HealthSettings.pageAction&&(a="apply"===HealthSettings.journeyStage||"payment"===HealthSettings.journeyStage?"results":HealthSettings.journeyStage),u.modules.journeyEngine.configure({startStepId:a,steps:_.toArray(y)});var b=u.modules.transactionId.get();u.messaging.publish(v.tracking.EXTERNAL,{method:"trackQuoteEvent",object:{action:"Start",transactionID:parseInt(b,10)}}),HealthSettings.isNewQuote===!1&&(HealthSettings.isCallCentreUser===!0?u.messaging.publish(v.tracking.EXTERNAL,{method:"contactCentreUser",object:{contactCentreID:HealthSettings.userId,quoteReferenceNumber:b,transactionID:b,productID:HealthSettings.productId}}):u.messaging.publish(v.tracking.EXTERNAL,{method:"trackQuoteEvent",object:{action:"Retrieve",transactionID:b}}))}}function c(){u.messaging.subscribe(v.WEBAPP_LOCK,function(a){var b="undefined"!=typeof a&&a.source&&"submitApplication"===a.source;p(b)}),u.messaging.subscribe(v.WEBAPP_UNLOCK,function(){o()}),a("#health_application-selection").delegate(".changeStateAndQuote","click",m)}function d(a){e(),f(),a&&u.modules.journeyProgressBar.render(!0)}function e(){var b={title:"Your Details",navigationId:"start",slideIndex:0,externalTracking:{method:"trackQuoteForms",object:u.modules.health.getTrackingFieldsObject},onInitialise:function(){a(".health-situation-healthCvr").on("change",function(){healthChoices.setCover(a(this).val())}),a(".health-situation-location").on("change",function(){healthChoices.setLocation(a(this).val())}),""!==a("#health_situation_location").val()&&healthChoices.setLocation(a("#health_situation_location").val()),"Y"===a("#health_privacyoptin").val()&&a(".slide-feature-emailquote").addClass("privacyOptinChecked"),a(".health-situation-healthSitu").on("change",function(){u.modules.healthBenefits.getBenefitsForSituation(a(this).val())}),"amend"!==HealthSettings.pageAction&&"start-again"!==HealthSettings.pageAction&&0===u.modules.healthBenefits.getSelectedBenefits().length&&""!==a(".health-situation-healthSitu").val()&&a(".health-situation-healthSitu").change();var b=a(".slide-feature-emailquote");a(".health-contact-details-optin-group .checkbox").on("click",function(){var c=a("#health_privacyoptin");"Y"===c.val()?b.addClass("privacyOptinChecked"):b.removeClass("privacyOptinChecked")})}},c={title:"Your Details",navigationId:"details",slideIndex:1,tracking:{touchType:"H",touchComment:"HLT detail",includeFormData:!0},externalTracking:{method:"trackQuoteForms",object:u.modules.health.getTrackingFieldsObject},onInitialise:function(){healthCoverDetails.setHealthFunds(!0),healthCoverDetails.setIncomeBase(!0),a("#health_healthCover_dependants").on("change",function(){healthCoverDetails.setTiers()}),a("#health_healthCover-selection").find(".health_cover_details_rebate").on("change",function(){healthCoverDetails.setIncomeBase(),healthChoices.dependants(),healthCoverDetails.setTiers()}),u.site.isCallCentreUser===!0&&a("#health_healthCover_incomeBase").find("input").on("change",function(){a("#health_healthCover_income").prop("selectedIndex",0),healthCoverDetails.setTiers()}),a("#health_healthCover-selection").find(":input").on("change",function(){var b=a(this);b.hasClass("dateinput-day")||b.hasClass("dateinput-month")||b.hasClass("dateinput-year")||(healthCoverDetails.setHealthFunds(),u.site.isCallCentreUser===!0&&l(function(b){a(".health_cover_details_rebate .fieldrow_legend").html("Overall LHC "+b.loading+"%"),h()?(a("#health_healthCover_primaryCover .fieldrow_legend").html("Individual LHC "+b.primaryLoading+"%, overall  LHC "+b.loading+"%"),a("#health_healthCover_partnerCover .fieldrow_legend").html("Individual LHC "+b.partnerLoading+"%, overall  LHC "+b.loading+"%")):a("#health_healthCover_primaryCover .fieldrow_legend").html("Overall  LHC "+b.loading+"%"),healthCoverDetails.setTiers()}))})},onBeforeLeave:function(){var b=a("#health_healthCover_income :selected").val().length>0?a("#health_healthCover_income :selected").text():"";a("#health_healthCover_incomelabel").val(b)}},d={title:"Your Cover",navigationId:"benefits",slideIndex:2,slideScrollTo:"#navbar-main",tracking:{touchType:"H",touchComment:"HLT benefi",includeFormData:!0},externalTracking:{method:"trackQuoteForms",object:u.modules.health.getTrackingFieldsObject},validation:{validate:!1},onInitialise:function(){u.modules.healthResults.initPage()},onBeforeEnter:function(){u.modules.healthBenefits.close(),u.modules.navbar.disable()},onAfterEnter:function(b){"xs"===u.modules.deviceMediaState.get()&&u.modules.utilities.scrollPageTo("html",0,1),u.site.isCallCentreUser===!0&&a("#journeyEngineSlidesContainer .journeyEngineSlide").eq(u.modules.journeyEngine.getCurrentStepIndex()).find(".simples-dialogue").hide(),b.isStartMode===!1&&_.defer(function(){u.modules.healthBenefits.open("journey-mode")})},onAfterLeave:function(){var a=u.modules.healthBenefits.getSelectedBenefits();u.modules.healthResults.onBenefitsSelectionChange(a),u.modules.navbar.enable()}},e={title:"Your Results",navigationId:"results",slideIndex:2,validation:{validate:!1,customValidation:function(b){if(u.site.isCallCentreUser===!0){var c=a(".resultsSlide").find(".simples-dialogue.mandatory");c.length!=c.find("input:checked").length&&(u.modules.dialogs.show({htmlContent:"Please complete the mandatory dialogue prompts before applying."}),b(!1))}null===u.modules.healthResults.getSelectedProduct()&&b(!1),b(!0)}},onInitialise:function(){u.modules.healthMoreInfo.initMoreInfo()},onBeforeEnter:function(b){b.isForward&&u.site.isCallCentreUser?a("#journeyEngineSlidesContainer .journeyEngineSlide").eq(u.modules.journeyEngine.getCurrentStepIndex()).find(".simples-dialogue").show():u.modules.healthResults.resetSelectedProduct()},onAfterEnter:function(a){_.defer(function(){u.modules.kampyle.setFormId("85252")}),a.isBackward===!0&&u.modules.healthResults.onReturnToPage(),a.isForward===!0&&u.modules.healthResults.get(),u.modules.resultsHeaderbar.registerEventListeners()},onAfterLeave:function(){u.modules.healthResults.stopColumnWidthTracking(),u.modules.healthResults.recordPreviousBreakpoint(),u.modules.healthResults.toggleMarketingMessage(!1),u.modules.healthMoreInfo.close(),_.defer(function(){u.modules.kampyle.setFormId("85272")}),u.modules.resultsHeaderbar.removeEventListeners()}},f={title:"Your Application",navigationId:"apply",slideIndex:3,tracking:{touchType:"A"},externalTracking:{method:"trackQuoteForms",object:u.modules.health.getTrackingFieldsObject},onInitialise:function(){healthApplicationDetails.init(),a(".changes-premium :input").on("change",function(){u.messaging.publish(w.health.CHANGE_MAY_AFFECT_PREMIUM)}),a("#health_previousfund_primary_fundName, #health_previousfund_partner_fundName").on("change",function(){healthCoverDetails.displayHealthFunds()}),u.site.isCallCentreUser===!0&&(""!==a("#health_previousfund_primary_fundName").val()&&"NONE"!=a("#health_previousfund_primary_fundName").val()||""!==a("#health_previousfund_partner_fundName").val()&&"NONE"!==a("#health_previousfund_partner_fundName").val()?a(".simples-dialogue-15").first().show():a(".simples-dialogue-15").first().hide(),a("#health_previousfund_primary_fundName, #health_previousfund_partner_fundName").on("change",function(){""!==a(this).val()&&"NONE"!==a(this).val()?a(".simples-dialogue-15").first().show():""!==a("#health_previousfund_primary_fundName").val()&&"NONE"!=a("#health_previousfund_primary_fundName").val()||""!==a("#health_previousfund_partner_fundName").val()&&"NONE"!==a("#health_previousfund_partner_fundName").val()||a(".simples-dialogue-15").first().hide()})),a("#health_application_address_postCode, #health_application_address_streetSearch, #health_application_address_suburb").on("change",function(){healthApplicationDetails.testStatesParity()}),a("#health_application_dependants_income").on("change",function(){a("#mainform").find(".health_cover_details_income").val(a(this).val())}),a(".health_dependant_details .dateinput_container input.serialise").on("change",function(){healthDependents.checkDependent(a(this).closest(".health_dependant_details").attr("data-id"))}),a("#health_application_dependants-selection").find(".remove-last-dependent").on("click",function(){healthDependents.dropDependent()}),a("#health_application_dependants-selection").find(".add-new-dependent").on("click",function(){healthDependents.addDependent()}),a("#health_payment_details_start_calendar").datepicker({clearBtn:!1,format:"dd/mm/yyyy"}).on("changeDate",function(b){a("#health_payment_details_start").val(b.format()),u.messaging.publish(w.health.CHANGE_MAY_AFFECT_PREMIUM)})},onBeforeEnter:function(b){if(b.isForward===!0){var c=u.modules.healthResults.getSelectedProduct();healthFunds.load(c.info.provider);var d=a("#journeyEngineSlidesContainer .journeyEngineSlide").slice(u.modules.journeyEngine.getCurrentStepIndex()-1);d.find(".error-field").remove(),d.find(".has-error").removeClass("has-error"),a("#health_declaration input:checked").prop("checked",!1).change(),healthDependents.setDependants(),""===a("#health_contactDetails_contactNumber_mobile").val()&&""===a("#health_contactDetails_contactNumber_other").val()&&u.site.isCallCentreUser===!1&&a("#health_application_okToCall-group").show();var e=u.modules.healthPaymentStep.getSetting("minStartDate"),f=u.modules.healthPaymentStep.getSetting("maxStartDate");a("#health_payment_details_start_calendar").datepicker("setStartDate",e).datepicker("setEndDate",f)}},onAfterEnter:function(){healthDependents.updateDependentOptionsDOM()}},g={title:"Your Payment",navigationId:"payment",slideIndex:4,tracking:{touchType:"H",touchComment:"HLT paymnt",includeFormData:!0},externalTracking:{method:"trackQuoteForms",object:u.modules.health.getTrackingFieldsObject},onInitialise:function(){a("#joinDeclarationDialog_link").on("click",function(){var a=u.modules.healthResults.getSelectedProduct();u.modules.dialogs.show({title:"Declaration",url:"health_fund_info/"+a.info.provider.toUpperCase()+"/declaration.html"}),u.messaging.publish(v.tracking.EXTERNAL,{method:"trackOfferTerms",object:{productID:a.productId}})}),a("#submit_btn").on("click",function(){var b=u.modules.journeyEngine.isCurrentStepValid();u.site.isCallCentreUser===!0&&a(".agg_privacy").each(function(){var b=a(this);b.find(".error-count").remove();var c=b.find(".error-field label");b.children("button").after('<span class="error-count'+(c.length>0?" error-field":"")+'" style="margin-left:10px">'+c.length+" validation errors in this panel.</span>")}),b&&q()})},onBeforeEnter:function(b){if(b.isForward===!0){var c=u.modules.healthResults.getSelectedProduct();"undefined"!=typeof c.promo.discountText&&""!==c.promo.discountText?a("#health_payment_details-selection").find(".definition").show().html(c.promo.discountText):a("#health_payment_details-selection").find(".definition").hide().empty(),a("#mainform").find(".health_declaration span").text(c.info.providerName);var d=a("#health_payment_medicare_firstName"),e=a("#health_payment_medicare_surname");""===d.val()&&d.val(a("#health_application_primary_firstname").val()),""===e.val()&&e.val(a("#health_application_primary_surname").val());var f=u.modules.healthResults.getSelectedProduct(),g=["GMHBA","Frank","Bupa"];"N"==a("input[name=health_healthCover_rebate]:checked").val()&&-1==a.inArray(f.info.providerName,g)?a("#health_payment_medicare-selection").hide().attr("style","display:none !important"):a("#health_payment_medicare-selection").removeAttr("style")}}};y={startStep:b,detailsStep:c,benefitsStep:d,resultsStep:e,applyStep:f,paymentStep:g}}function f(){u.modules.journeyProgressBar.configure([{label:"Your Details",navigationId:y.startStep.navigationId,matchAdditionalSteps:[y.detailsStep.navigationId]},{label:"Your Cover",navigationId:y.benefitsStep.navigationId},{label:"Your Results",navigationId:y.resultsStep.navigationId},{label:"Your Application",navigationId:y.applyStep.navigationId},{label:"Your Payment",navigationId:y.paymentStep.navigationId}])}function g(){var b=a("#health_contactDetails_optin"),c={name:[{$field:a("#health_contactDetails_name")},{$field:a("#health_application_primary_firstname"),$otherField:a("#health_application_primary_surname")}],dob_primary:[{$field:a("#health_healthCover_primary_dob"),$fieldInput:a("#health_healthCover_primary_dob")},{$field:a("#health_application_primary_dob"),$fieldInput:a("#health_application_primary_dob")}],dob_secondary:[{$field:a("#health_healthCover_partner_dob"),$fieldInput:a("#health_healthCover_partner_dob")},{$field:a("#health_application_partner_dob"),$fieldInput:a("#health_application_partner_dob")}],email:[{$field:a("#health_contactDetails_email"),$optInField:b},{$field:a("#health_application_email"),$optInField:a("#health_application_optInEmail")}],mobile:[{$field:a("#health_contactDetails_contactNumber_mobile"),$fieldInput:a("#health_contactDetails_contactNumber_mobileinput"),$optInField:b},{$field:a("#health_application_mobile"),$fieldInput:a("#health_application_mobileinput")}],otherPhone:[{$field:a("#health_contactDetails_contactNumber_other"),$fieldInput:a("#health_contactDetails_contactNumber_otherinput"),$optInField:b},{$field:a("#health_application_other"),$fieldInput:a("#health_application_otherinput")}],postcode:[{$field:a("#health_situation_postcode")},{$field:a("#health_application_address_postCode"),$fieldInput:a("#health_application_address_postCode")}]};
u.modules.contactDetails.configure(c)}function h(){var b=a(':input[name="health_situation_healthCvr"]').val();return"F"==b||"C"==b?!0:!1}function i(){return x}function j(){return null!=x&&x.rebate?x.rebate:0}function k(b){x=b,a("#health_rebate").val(x.rebate||""),a("#health_loading").val(x.loading||""),a("#health_primaryCAE").val(x.primaryCAE||""),a("#health_partnerCAE").val(x.partnerCAE||"")}function l(b){$healthCoverDetails=a(".health-cover_details");var c={dependants:$healthCoverDetails.find(':input[name="health_healthCover_dependants"]').val(),income:$healthCoverDetails.find(':input[name="health_healthCover_income"]').val(),rebate_choice:$healthCoverDetails.find('input[name="health_healthCover_rebate"]:checked').val(),primary_loading:$healthCoverDetails.find('input[name="health_healthCover_primary_healthCoverLoading"]:checked').val(),primary_current:$healthCoverDetails.find('input[name="health_healthCover_primary_cover"]:checked').val(),primary_loading_manual:$healthCoverDetails.find(".primary-lhc").val(),partner_loading:$healthCoverDetails.find('input[name="health_healthCover_partner_healthCoverLoading"]:checked').val(),partner_current:$healthCoverDetails.find('input[name="health_healthCover_partner_cover"]:checked').val(),partner_loading_manual:$healthCoverDetails.find(".partner-lhc").val(),cover:a(':input[name="health_situation_healthCvr"]').val()};return""===a("#health_application_provider, #health_application_productId").val()?(c.primary_dob=$healthCoverDetails.find('input[name="health_healthCover_primary_dob"]').val(),c.partner_dob=$healthCoverDetails.find('input[name="health_healthCover_partner_dob"]').val()):(c.primary_dob=a("#health_application_primary_dob").val(),c.partner_dob=a("#health_application_partner_dob").val(),c.primary_current="NONE"==a("#clientFund").find(":selected").val()?"N":"Y",c.partner_current="NONE"==a("#partnerFund").find(":selected").val()?"N":"Y"),""===c.cover?!1:""===c.rebate_choice?!1:""===c.primary_dob?!1:h()&&""===c.partner_dob?!1:returnAge(c.primary_dob)<0?!1:h()&&returnAge(c.partner_dob)<0?!1:"Y"===c.rebate_choice&&""===c.income?!1:void u.modules.comms.post({url:"ajax/json/health_rebate.jsp",data:c,cache:!0,errorLevel:"warning",onSuccess:function(a){k(a),null!=b&&b(a)}})}function m(b){b.preventDefault();var c=a("#health_application_address_suburbName").val(),d=a("#health_application_address_postCode").val(),e=a("#health_application_address_state").val();a("#health_situation_location").val([c,d,e].join(" ")),a("#health_situation_suburb").val(c),a("#health_situation_postcode").val(d),a("#health_situation_state").val(e),healthChoices.setState(e),window.location=this.href;var f=u.messaging.subscribe(v.journeyEngine.STEP_CHANGED,function(){u.messaging.unsubscribe(v.journeyEngine.STEP_CHANGED,f),u.modules.healthResults.get()})}function n(){try{var b=a("#health_situation_state").val(),c=a("#health_application_address_state").val();c.length&&c!=b&&(b=c);var d="";a("input[name=health_application_primary_gender]:checked","#mainform")&&(d="M"==a("input[name=health_application_primary_gender]:checked","#mainform").val()?"Male":"Female");var e="";a("#health_healthCover_primary_dob").val().length&&(e=a("#health_healthCover_primary_dob").val().split("/")[2]);var f="Y"===a("input[name=health_contactDetails_call]","#mainform").val()?"Y":"N",g="Y"===a("input[name=health_application_optInEmail]:checked","#mainform").val()?"Y":"N",h=a("#health_contactDetails_email").val(),i=a("#health_application_email").val();i.length>0&&(h=i);var j=u.modules.transactionId.get(),k="";switch(u.modules.journeyEngine.getCurrentStepIndex()){case 0:k="health situation";break;case 1:k="health details";break;case 2:k="health cover";break;case 4:k="health application";break;case 5:k="health payment";break;case 6:k="health confirmation"}return{vertical:"Health",actionStep:k,transactionID:j,quoteReferenceNumber:j,yearOfBirth:e,gender:d,postCode:a("#health_application_address_postCode").val(),state:b,email:h,emailID:null,marketOptIn:g===!1?"":g,okToCall:f===!1?"":f,healthCoverType:a("#health_situation_healthCvr").val(),healthSituation:a("#health_situation_healthSitu").val()}}catch(l){return!1}}function o(){var b=a("#submit_btn");b.removeClass("disabled"),u.modules.loadingAnimation.hide(b)}function p(b){var c=a("#submit_btn");c.addClass("disabled"),b===!0&&u.modules.loadingAnimation.showAfter(c)}function q(){if(z===!0)return void alert("Your application is still being submitted. Please wait.");z=!0,u.messaging.publish(w.WEBAPP_LOCK,{source:"submitApplication"});try{var b=a("#health_payment_details_frequency").val(),c=u.modules.healthResults.getSelectedProductPremium(b),d=u.modules.healthResults.getNumberOfPeriodsForFrequency(b);a("#health_application_paymentAmt").val(c.value*d),a("#health_application_paymentFreq").val(c.value),a("#health_application_paymentHospital").val(c.hospitalValue*d);var e=u.modules.journeyEngine.getFormData();u.messaging.publish(w.WEBAPP_LOCK,{source:"submitApplication",disableFields:!0}),u.modules.comms.post({url:"ajax/json/health_application.jsp",data:e,cache:!1,useDefaultErrorHandling:!1,errorLevel:"silent",timeout:25e4,onSuccess:function(a){var b="health_confirmation.jsp?action=confirmation&transactionId="+u.modules.transactionId.get()+"&token=";a.result&&a.result.success?window.location.replace(b+a.result.confirmationID):a.result&&a.result.pendingID&&a.result.pendingID.length>0&&(!a.result.callcentre||a.result.callcentre!==!0)?window.location.replace(b+a.result.pendingID):(u.messaging.publish(w.WEBAPP_UNLOCK,{source:"submitApplication"}),s(a))},onError:r,onComplete:function(){z=!1}})}catch(f){z=!1,r()}}function r(a,b,c,d,e){u.messaging.publish(w.WEBAPP_UNLOCK,{source:"submitApplication"}),s(e)}function s(b){var c="",d=!1;try{if(b.result&&b.result.errors){var e=b.result.errors;a.isArray(e.error)&&(e=e.error),a.each(e,function(a,b){c+="[code "+b.code+"] "+b.original,e.length>1&&a<e.length-1&&(c+="<br />")}),""===c&&(c="An unhandled error was received.")}else if(b.hasOwnProperty("error")&&"object"==typeof b.error&&b.error.hasOwnProperty("type"))switch(b.error.type){case"validation":d=!0;break;case"timeout":c="Fund application service timed out.";break;case"parsing":c="Error parsing the XML request - report issue to developers.";break;case"confirmed":c=b.error.message;break;case"transaction":c=b.error.message;break;default:c="["+b.error.code+"] "+b.error.message+" (Please report to IT before continuing)"}else c="An unhandled error was received."}catch(f){c="Application unsuccessful. Failed to handle response: "+f.message}d?(ServerSideValidation.outputValidationErrors({validationErrors:b.error.errorDetails.validationErrors,startStage:3}),"undefined"!=typeof b.error.transactionId&&u.modules.transactionId.set(b.error.transactionId)):(HealthSettings.isCallCentreUser===!1&&(c="Please contact us on 1800 77 77 12 for assistance."),u.modules.errorHandling.error({message:"<strong>Application failed:</strong><br/>"+c,page:"health.js",errorLevel:"warning",description:"handleSubmittedApplicationErrors(). Submit failed: "+c,data:b}),healthFunds.applicationFailed&&healthFunds.applicationFailed())}function t(){a(document).ready(function(){return"health"!==u.site.vertical?!1:(b(),"confirmation"===HealthSettings.pageAction?!1:(u.site.isCallCentreUser===!1&&setInterval(function(){var b=a("#chat-health-insurance-sales").html();""===b||"<span></span>"===b?a("#contact-panel").removeClass("hasButton"):a("#contact-panel").addClass("hasButton")},5e3),c(),g(),("amend"===HealthSettings.pageAction||"start-again"===HealthSettings.pageAction)&&("undefined"!=typeof healthFunds&&healthFunds.checkIfNeedToInjectOnAmend?healthFunds.checkIfNeedToInjectOnAmend(function(){u.modules.form.markInitialFieldsWithValue(a("#mainform"))}):u.modules.form.markInitialFieldsWithValue(a("#mainform"))),a("#health_contactDetails_optin").on("click",function(){a("#health_contactDetails_optInEmail").val(a(this).is(":checked")?"Y":"N"),a("#health_contactDetails_call").val(a(this).is(":checked")?"Y":"N")}),void healthDependents.init()))})}var u=window.meerkat,v=u.modules.events,w={health:{CHANGE_MAY_AFFECT_PREMIUM:"CHANGE_MAY_AFFECT_PREMIUM"},WEBAPP_LOCK:"WEBAPP_LOCK",WEBAPP_UNLOCK:"WEBAPP_UNLOCK"},x=null,y=null,z=!1;u.modules.register("health",{init:t,events:w,initProgressBar:d,getTrackingFieldsObject:n,getRates:i,getRebate:j,loadRates:l})}(jQuery),function(a){function b(){var b=a("#health_benefits_benefitsExtras_Hospital").is(":checked"),c=a("#health_benefits_benefitsExtras_GeneralHealth").is(":checked");return b>0&&c?"Combined":b?"Hospital":c?"GeneralHealth":"None"}function c(a){return""===a?void e([]):void z.modules.comms.post({url:"ajax/csv/get_benefits.jsp",data:{situation:a},errorLevel:"silent",cache:!0,onSuccess:function(a){defaultBenefits=a.split(","),e(defaultBenefits)}})}function d(){a("#mainform input[type='hidden'].benefit-item").val("")}function e(b){d();for(var c=0;c<b.length;c++){var e=b[c];a("#mainform input[name='health_benefits_benefitsExtras_"+e+"'].benefit-item").val("Y")}}function f(){w.find(".benefits-list input[type='checkbox']").prop("checked",!1),y&&w.find(".benefits-list input[type='checkbox']").change()}function g(){f(),a("#mainform input.benefit-item").each(function(b,c){var d=a(c);if("Y"==d.val()){var e=d.attr("name");w.find(".benefits-list :input[name='"+e+"']").prop("checked",!0),y&&w.find(".benefits-list :input[name='"+e+"']").change()}}),w.find("input.checkbox-switch").bootstrapSwitch("setState"),w.find("input.hasChildren").each(function(a,b){i(b)})}function h(){0===w.find(":input.hasChildren:checked").length?(w.find(".btn-save").prop("disabled",!0),w.find("a.btn-save").addClass("disabled")):(w.find(".btn-save").prop("disabled",!1),w.find("a.btn-save").removeClass("disabled")),i(a(this))}function i(b){var c=a(b),d=!c.is(":checked"),e=c.parents(".short-list-item").first(),f=e.find(".children :input");f.prop("disabled",d),d===!0?(e.addClass("disabled"),f.prop("checked",!1)):e.removeClass("disabled"),y&&f.change()}function j(){var b=[];return a("#mainform input.benefit-item").each(function(c,d){var e=a(d);if("Y"==e.val()){var f=e.attr("data-skey");b.push(f)}}),b}function k(){d();var b=[];return w.find(":input:checked").each(function(c,d){var e=a("#mainform input[name='"+a(d).attr("name")+"'].benefit-item");e.val("Y"),b.push(e.attr("data-skey"))}),b}function l(){var a="";z.modules.journeyEngine.getCurrentStep()&&(a=z.modules.journeyEngine.getCurrentStep().navigationId),("benefits"===a||"results"===a)&&z.modules.journeyEngine.loadingShow("...getting your quotes...",!0),p(),z.modules.navbar.close(),_.defer(function(){var a=k();x===E?z.modules.journeyEngine.gotoPath("next"):z.messaging.publish(C.CHANGED,a)})}function m(b){$target=a(b.currentTarget),$target.find("input").prop("disabled")===!0&&($target.parents(".hasShortlistableChildren").first().find(".title").first().find(":input").prop("checked",!0),w.find("input.checkbox-switch").bootstrapSwitch("setState"))}function n(a){x=a,z.modules.navbar.open(),v.hasClass("open")===!1&&(w.addClass(x),v.find(".activator").dropdown("toggle"))}function o(){w.find(":input.hasChildren").on("change.benefits",h),w.find(".btn-save").on("click.benefits",l),w.find(".btn-cancel").on("click.benefits",p),w.find(".categoriesCell .checkbox").on("click.benefits",m)}function p(){v.hasClass("open")&&(s()?(u(),v.find(".activator").dropdown("toggle"),t()):v.find(".activator").dropdown("toggle"))}function q(){w.find("input.hasChildren").off("change.benefits"),w.find(".btn-save").off("click.benefits"),w.find(".btn-cancel").off("click.benefits"),w.find(".categoriesCell .checkbox").off("click.benefits",m),w.removeClass("journey-mode"),w.removeClass("popover-mode"),x=null}function r(){a(document).ready(function(){return"health"!==z.site.vertical||"confirmation"===HealthSettings.pageAction?!1:(v=a("#benefits-dropdown"),w=a(".benefits-component"),y=z.modules.performanceProfiling.isIE8(),v.on("show.bs.dropdown",function(){null===x&&(x=D),o(),g()}),v.on("hide.bs.dropdown",function(a){2==z.modules.journeyEngine.getCurrentStepIndex()&&(a.preventDefault(),z.modules.dropdownInteractive.addBackdrop(v))}),v.on("hidden.bs.dropdown",function(){q()}),z.messaging.subscribe(A.journeyEngine.STEP_CHANGED,function(a){"benefits"!==a.navigationId&&z.modules.healthBenefits.close()}),a("[data-benefits-control='Y']").click(function(a){a.preventDefault(),a.stopPropagation(),n(D)}),z.messaging.subscribe(A.WEBAPP_LOCK,t),void z.messaging.subscribe(A.WEBAPP_UNLOCK,u))})}function s(){return v.children(".activator").hasClass("disabled")}function t(){v.children(".activator").addClass("inactive").addClass("disabled")}function u(){v.children(".activator").removeClass("inactive").removeClass("disabled")}var v,w,x,y,z=window.meerkat,A=z.modules.events,B=(z.logging.info,{healthBenefits:{CHANGED:"HEALTH_BENEFITS_CHANGED"}}),C=B.healthBenefits,D="popover-mode",E="journey-mode";z.modules.register("healthBenefits",{init:r,events:B,open:n,close:p,getProductCategory:b,getSelectedBenefits:j,getBenefitsForSituation:c})}(jQuery),function(a,b){function c(){jQuery(document).ready(function(a){"undefined"!=typeof HealthSettings&&"confirmation"===HealthSettings.pageAction&&(e.modules.health.initProgressBar(!0),e.modules.journeyProgressBar.setComplete(),e.modules.journeyProgressBar.disable(),"OK"!=result.data.status||""===result.data.product?e.modules.errorHandling.error({message:result.data.message,page:"healthConfirmation.js module",description:"Trying to load the confirmation page failed",data:null,errorLevel:"warning"}):(g=_.extend({},result.data),g.mode="lhcInc",g.product?(g.pending=!1,g.product=a.parseJSON(g.product),g.product.price&&_.isArray(g.product.price)&&(g.product=g.product.price[0]),_.extend(g,g.product),delete g.product):"object"==typeof sessionProduct?(sessionProduct.price&&_.isArray(sessionProduct.price)&&(sessionProduct=sessionProduct.price[0]),g.transID===sessionProduct.transactionId?_.extend(g,sessionProduct):sessionProduct=b,g.pending=!0):g.pending=!0,e.modules.healthMoreInfo.setProduct(g),e.modules.healthMoreInfo.prepareCover(),1==g.frequency.length&&(g.frequency=e.modules.healthResults.getFrequencyInWords(g.frequency)),g._selectedFrequency=g.frequency,d(),e.modules.healthMoreInfo.applyEventListeners(),e.messaging.publish(f.tracking.EXTERNAL,{method:"completedApplication",object:{productID:g.productId}})))})}function d(){var b=a("#confirmation-template").html(),c=_.template(b),d=c(g);a("#confirmation").html(d),e.messaging.subscribe(f.healthPriceComponent.INIT,function(){e.modules.healthPriceComponent.updateProductSummaryHeader(g,g.frequency,!0),e.modules.healthPriceComponent.updateProductSummaryDetails(g,g.startDate,!1)}),""===g.about&&e.modules.healthMoreInfo.prepareExternalCopy(function(){a(".aboutFund").append(g.aboutFund).parents(".displayNone").first().removeClass("displayNone")})}var e=window.meerkat,f=e.modules.events,g=(e.logging.info,null);e.modules.register("healthConfirmation",{init:c})}(jQuery),function(a){function b(){c("value")}function c(b,c){var d=b||"value";l.find("[data-filter-type]").each(function(){var b=a(this),e=b.attr("data-filter-type"),f=b.attr("id"),g="";if("undefined"!=typeof f){if("slider"===e&&(b.find(".slider-control").trigger("UPDATE"),g=b.find(".slider").val()),"radio"===e&&(g=b.find(":checked").val()||"",c!==!0))if("filter-frequency"===f){try{g=Results.getFrequency()}catch(h){}switch(g){case"fortnightly":g="F";break;case"monthly":g="M";break;default:g="A"}b.find('input[value="'+g+'"]').prop("checked",!0).change()}else if("filter-sort"===f){try{g=Results.getSortBy()}catch(h){}g=g.indexOf("price")>-1?"L":"B",b.find('input[value="'+g+'"]').prop("checked",!0).change()}if("select"===e&&(g=b.find(":selected").val()||"",c!==!0&&("filter-tierHospital"===f?(g=a("#health_filter_tierHospital").val(),b.val(g)):"filter-tierExtras"===f&&(g=a("#health_filter_tierExtras").val(),b.val(g)))),"checkbox"===e){var i=[];i="filter-provider"===f?b.find(":not(:checked)").map(function(){return this.value}):b.find(":checked").map(function(){return this.value}),g=i.get().join(p),c!==!0&&"filter-provider"===f&&(g=a("#health_filter_providerExclude").val(),i=g.split(p),b.find(":checkbox").each(function(){var b=a(this);a.inArray(b.attr("value"),i)<0?b.prop("checked",!0).change():b.prop("checked",!1).change()}))}o.hasOwnProperty(f)||(o[f]={}),o[f].type=e,o[f][d]=g}})}function d(){var a,b;for(b in o)if(o.hasOwnProperty(b))switch(a=o[b].value,o[b].type){case"slider":l.find("#"+b+" .slider").val(a);break;case"radio":""===a?l.find("#"+b+" input").prop("checked",!1).change():l.find("#"+b+' input[value="'+a+'"]').prop("checked",!0).change();break;case"select":l.find("#"+b+" select").val(a)}}function e(){l.addClass("is-saved"),h(),"xs"===m.modules.deviceMediaState.get()?m.modules.navbar.close():k.closest(".navbar-collapse").removeClass("in"),_.defer(function(){var b,d,e,f=!1;c("valueNew",!0);for(e in o)if(o.hasOwnProperty(e)&&o[e].value!==o[e].valueNew&&a("#"+e).attr("data-filter-serverside")){f=!0;break}for(e in o)if(o.hasOwnProperty(e)&&(b=o[e].value,d=o[e].valueNew,b!==d))if("filter-frequency"===e)d=m.modules.healthResults.getFrequencyInWords(d)||"monthly",f||(refreshView=!0,o.hasOwnProperty("filter-sort")&&"L"===o["filter-sort"].value&&o["filter-sort"].value===o["filter-sort"].valueNew&&(refreshSort=!0)),Results.setFrequency(d,!1);else if("filter-sort"===e){var g="asc";switch(d){case"L":if(o.hasOwnProperty("filter-frequency")){d=m.modules.healthResults.getFrequencyInWords(o["filter-frequency"].valueNew)||"monthly",d="price."+d;break}d="price.monthly";break;default:d="benefitsSort"}Results.setSortBy(d),Results.setSortDir(g)}else"filter-tierHospital"===e?a("#health_filter_tierHospital").val(d):"filter-tierExtras"===e?a("#health_filter_tierExtras").val(d):"filter-provider"===e&&a("#health_filter_providerExclude").val(d);m.messaging.publish(r.CHANGED),f?_.defer(function(){m.modules.journeyEngine.loadingShow("...updating your quotes...",!0),_.delay(function(){m.modules.healthResults.get()},100)}):Results.applyFiltersAndSorts()})}function f(){k.hasClass("open")===!1&&k.find(".activator").dropdown("toggle")}function g(){l.find(".btn-save").on("click.filters",e),l.find(".btn-cancel").on("click.filters",h)}function h(){k.hasClass("open")&&k.find(".activator").dropdown("toggle")}function i(){l.hasClass("is-saved")?l.removeClass("is-saved"):d(),l.find(".btn-save").off("click.filters"),l.find(".btn-cancel").off("click.filters")}function j(){a(document).ready(function(){return"health"!==m.site.vertical||"confirmation"===HealthSettings.pageAction?!1:(k=a("#filters-dropdown"),l=a(".filters-component"),k.on("show.bs.dropdown",function(){g(),b()}),k.on("hidden.bs.dropdown",function(){i()}),m.messaging.subscribe(n.WEBAPP_LOCK,function(){h(),k.children(".activator").addClass("inactive").addClass("disabled")}),void m.messaging.subscribe(n.WEBAPP_UNLOCK,function(){k.children(".activator").removeClass("inactive").removeClass("disabled")}))})}var k,l,m=window.meerkat,n=m.modules.events,o=(m.logging.info,{}),p=",",q={healthFilters:{CHANGED:"HEALTH_FILTERS_CHANGED"}},r=q.healthFilters;m.modules.register("healthFilters",{init:j,events:q,open:f,close:h})}(jQuery),function(a){function b(){w=-a("#pageContent").offset().top+a(".featuresList").offset().top+H}function c(){v=a(".moreInfoDropdown"),jQuery(document).ready(function(a){return"health"!=x.site.vertical||"confirmation"==HealthSettings.pageAction?!1:(B=a("#more-info-template").html(),void("undefined"!=typeof B&&(C=_.template(B),d(),f())))})}function d(){"undefined"!=typeof Results.settings&&("xs"!=x.modules.deviceMediaState.get()?a(Results.settings.elements.page).on("click",".btn-more-info",m):a(Results.settings.elements.page).on("click",".btn-more-info",j),a(Results.settings.elements.page).on("click",".btn-close-more-info",n)),a(document).on("resultsFetchStart",function(){x.modules.healthMoreInfo.close()}),a(document.body).on("click",".btn-more-info-apply",function(){var b=a(this);b.addClass("inactive").addClass("disabled"),x.modules.loadingAnimation.showInside(b,!0),_.defer(function(){Results.getSelectedProduct()!==!1&&Results.getSelectedProduct().productId!=b.attr("data-productId")&&a("#health_declaration:checked").prop("checked",!1).change(),Results.setSelectedProduct(b.attr("data-productId"));var c=Results.getSelectedProduct();if(c){x.modules.healthResults.setSelectedProduct(c),healthFunds.load(c.info.provider,e);var d=x.modules.transactionId.get();x.messaging.publish(y.tracking.EXTERNAL,{method:"trackHandoverType",object:{type:"Online_R",quoteReferenceNumber:d,transactionID:d,productID:"productID"}})}else e(!1)})}),a(document.body).on("click",".dialogPop",function(){x.modules.dialogs.show({title:a(this).attr("title"),htmlContent:a(this).attr("data-content")})}),a(document.body).on("click",".more-info",function(){o(x.modules.healthResults.getSelectedProduct()),k()})}function e(b){_.delay(function(){a(".btn-more-info-apply").removeClass("inactive").removeClass("disabled"),x.modules.loadingAnimation.hide(a(".btn-more-info-apply"))},1e3),b===!0&&x.modules.address.setHash("apply")}function f(){x.messaging.subscribe(y.device.STATE_CHANGE,function(){b()}),a(document).on("resultPageChange",function(){G&&n()}),x.messaging.subscribe(y.device.STATE_ENTER_XS,function(){G&&n(),a(Results.settings.elements.page).off("click",".btn-more-info"),a(Results.settings.elements.page).on("click",".btn-more-info",j)}),x.messaging.subscribe(y.device.STATE_LEAVE_XS,function(){F&&l(),a(Results.settings.elements.page).off("click",".btn-more-info"),a(Results.settings.elements.page).on("click",".btn-more-info",m)}),x.messaging.subscribe(A.BRIDGINGPAGE_SHOW,function(a){h(a.isOpen)}),x.messaging.subscribe(A.BRIDGINGPAGE_HIDE,function(a){h(a.isOpen)})}function g(c){b(),c.html(x.modules.loadingAnimation.getTemplate()).show(),q(function(){var b=C(D);c.find(".spinner").fadeOut(),c.html(b),a(".more-info-content .next-info-all").html(a(".more-info-content .next-steps-all-funds-source").html()),c.css({top:w});var d=400;G?c.find(".more-info-content").fadeIn(d):c.find(".more-info-content").slideDown(d,function(){x.messaging.publish(A.BRIDGINGPAGE_STATE,{isOpen:!0})}),G=!0,_.delay(function(){x.messaging.publish(A.BRIDGINGPAGE_SHOW,{isOpen:G})},d),x.messaging.publish(y.tracking.EXTERNAL,{method:"trackProductView",object:{productID:D.productId}})})}function h(b){b?a(Results.settings.elements.page).css("overflow","hidden").height(v.outerHeight()):a(Results.settings.elements.page).css("overflow","visible").height("")}function i(b){a(Results.settings.elements.page).find(".result").removeClass("faded"),a(".btn-close-more-info").removeClass("btn-close-more-info").addClass("btn-more-info"),b.slideUp(400,function(){b.html("").hide(),G=!1,x.messaging.publish(A.BRIDGINGPAGE_STATE,{isOpen:G}),x.messaging.publish(A.BRIDGINGPAGE_HIDE,{isOpen:G})})}function j(){var b=a(this),c=b.attr("data-productId"),d=b.hasClass("more-info-showapply");o(Results.getResult("productId",c),d),k()}function k(){q(function(){E=x.modules.dialogs.show({htmlContent:C(D),className:"modal-breakpoint-wide modal-tight"}),a(".more-info-content .next-info .next-info-all").html(a(".more-info-content .next-steps-all-funds-source").html()),a(".more-info-content .moreInfoRightColumn > .dualPricing").insertAfter(a(".more-info-content .moreInfoMainDetails")),F=!0,a(".more-info-content").show()})}function l(){a("#"+E).modal("hide"),F=!1}function m(){var b=a(this);a(Results.settings.elements.page).find(".result").addClass("faded"),a(".btn-close-more-info").removeClass("btn-close-more-info").addClass("btn-more-info"),b.parents(".result").removeClass("faded"),b.removeClass("btn-more-info").addClass("btn-close-more-info");var c=b.attr("data-productId"),d=b.hasClass("more-info-showapply");o(Results.getResult("productId",c),d),g(v)}function n(){i(v),F&&l()}function o(a,b){return D=a,D!==!1&&(D.showApply=b===!0?!0:!1),D}function p(){return G===!1?null:D}function q(a){r(),s(a)}function r(){"undefined"==typeof D.hospitalCover&&"undefined"!=typeof D.hospital&&"undefined"!=typeof D.hospital.benefits&&(t("hospital.benefits","hospitalCover"),u(D.hospital.inclusions.publicHospital,"hospitalCover","Public Hospital"),u(D.hospital.inclusions.privateHospital,"hospitalCover","Private Hospital")),"undefined"==typeof D.extrasCover&&"undefined"!=typeof D.extras&&"object"==typeof D.extras&&t("extras","extrasCover")}function s(b){D.aboutFund="<p>Apologies. This information did not download successfully.</p>",D.whatHappensNext="<p>Apologies. This information did not download successfully.</p>",a.when(x.modules.comms.get({url:"health_fund_info/"+D.info.provider+"/about.html",cache:!0,errorLevel:"silent",onSuccess:function(a){D.aboutFund=a}}),x.modules.comms.get({url:"health_fund_info/"+D.info.provider+"/next_info.html",cache:!0,errorLevel:"silent",onSuccess:function(a){D.whatHappensNext=a}})).then(b,b)}function t(a,b){D[b]={inclusions:[],restrictions:[],exclusions:[]};var c,d;_.each(Object.byString(D,a),function(e,f){c=a+"."+f+".covered",foundObject=_.findWhere(resultLabels,{p:c}),"undefined"!=typeof foundObject&&(d=foundObject.n,u(e.covered,b,d))})}function u(a,b,c){switch(a){case"Y":D[b].inclusions.push(c);break;case"R":D[b].restrictions.push(c);break;case"N":D[b].exclusions.push(c)}}var v,w,x=window.meerkat,y=x.modules.events,z={healthMoreInfo:{BRIDGINGPAGE_STATE:"BRIDGINGPAGE_STATE"}},A=z.healthMoreInfo,B=null,C=null,D=null,E=null,F=!1,G=!1,H=-2;x.modules.register("healthMoreInfo",{initMoreInfo:c,events:z,setProduct:o,prepareProduct:q,prepareCover:r,prepareExternalCopy:s,getOpenProduct:p,close:n,applyEventListeners:d})}(jQuery),function(a){function b(){a(document).ready(function(){a('[data-provide="payment-ipp"]').each(function(){var b=a(this);r=b.find(".payment-ipp-tokenisation"),s=a("#health_payment_credit_type"),q=b.find(".payment-ipp-maskedNumber"),q.prop("readonly",!0),q.css("cursor","pointer"),q.on("click",function(){e()})})})}function c(){a('[data-provide="payment-ipp"]').removeClass("hidden")}function d(){a('[data-provide="payment-ipp"]').addClass("hidden")}function e(){q.is(":visible")&&i()&&(h(t),k()||f())}function f(){return u===!0||k()?!1:(u=!0,q.val("Loading..."),l(),void p.modules.comms.post({url:"ajax/json/ipp/ipp_payment.jsp?ts="+(new Date).getTime(),dataType:"json",cache:!1,errorLevel:"silent",data:{transactionId:p.modules.transactionId.get()},onSuccess:g,onError:function(){j()},onComplete:function(){u=!1}}))}function g(a){if(k())return!1;if(!a||!a.result||a.result.success!==!0)return void j();var b=a.result.url+"?SessionId="+a.result.refId+"&sst="+a.result.sst+"&cardType="+m()+"&registerError=false&resultPage=0",c='<p class="message"></p>';htmlContent=c+'<iframe width="100%" height="110" frameBorder="0" src="'+b+'" tabindex="" id="cc-frame"></iframe>',p.modules.dialogs.changeContent(o,htmlContent)}function h(a){("undefined"==typeof a||0===a.length)&&(a=p.modules.loadingAnimation.getTemplate()),o=p.modules.dialogs.show({htmlContent:a,title:"Credit Card Number",onOpen:function(){p.modules.tracking.recordSupertag("trackCustomPage","Payment gateway popup")},onClose:function(){j()}})}function i(){return s.valid()}function j(){""===r.val()&&(p.modules.dialogs.changeContent(o,"<p>We're sorry but our system is down and we are unable to process your credit card details right now.</p><p>Continue with your application and we can collect your details after you join.</p>"),r.val("fail"),q.val("Try again or continue"),t="")}function k(){return""===t?!1:!0}function l(){r.val(""),q.val(""),t=""}function m(){switch(s.find("option:selected").val()){case"v":return"Visa";case"a":return"Amex";case"m":return"Mastercard";case"d":return"Diners";default:return"Unknown"}}function n(a){a.transactionId=p.modules.transactionId.get(),p.modules.comms.post({url:"ajax/json/ipp/ipp_log.jsp?ts="+(new Date).getTime(),data:a,dataType:"json",cache:!1,errorLevel:"silent",onSuccess:function(b){return b&&b.result&&b.result.success===!0?(r.val(a.sessionid),q.val(a.maskedcardno),t="",void p.modules.dialogs.destroyDialog(o)):void j()},onError:function(){j()}})}var o,p=window.meerkat,q=[],r=[],s=[],t="",u=!1;p.modules.register("healthPaymentIPP",{init:b,show:c,hide:d,fail:j,register:n})}(jQuery),function(a){function b(){a(document).ready(function(){return"health"!==z.site.vertical||"confirmation"===HealthSettings.pageAction?!1:($coverStateDate=a("#health_payment_details_start"),$coverStateDateCalendar=a("#health_payment_details_start_calendar"),r=a("#health_payment_details_type"),v=a("#health_payment_details_frequency"),$bankAccountDetailsRadioGroup=a("#health_payment_details_claims"),$sameBankAccountRadioGroup=a("#health_payment_bank_claims"),t=a(".health-payment-details_update"),u=a("#update-content"),s=a(".health-payment-details_premium"),w=s.find(".amount"),x=s.find(".frequencyText"),y=s.find(".lhcText"),z.messaging.subscribe(A.WEBAPP_LOCK,function(a){var b="undefined"!=typeof a&&a.source&&"healthPaymentStep"===a.source,c="undefined"!=typeof a&&a.disableFields&&a.disableFields===!0;l(b,c)}),z.messaging.subscribe(A.WEBAPP_UNLOCK,function(){k()}),z.messaging.subscribe(A.health.CHANGE_MAY_AFFECT_PREMIUM,c),z.messaging.subscribe(A.healthResults.SELECTED_PRODUCT_RESET,function(){c(),d()}),r.find("input").on("change",j),a("#update-premium").on("click",m),a("#health_payment_credit_type").on("change",creditCardDetails.set),creditCardDetails.set(),a('[data-provide="paymentGateway"]').on("click",'[data-gateway="launcher"]',paymentGateway.launch),$bankAccountDetailsRadioGroup.find("input").on("click",n),$sameBankAccountRadioGroup.find("input").on("click",n),d(),s.hide(),t.show(),void u.hide())})}function c(){s.hide(),t.show(),u.hide(),a("#health_declaration-selection").hide(),a("#confirm-step").hide(),a("#update-premium").removeClass("hasAltPremium")}function d(){C.bank={weekly:!1,fortnightly:!0,monthly:!0,quarterly:!1,halfyearly:!1,annually:!0},C.credit={weekly:!1,fortnightly:!1,monthly:!0,quarterly:!1,halfyearly:!1,annually:!0},C.frequency={weekly:27,fortnightly:31,monthly:27,quarterly:27,halfyearly:27,annually:27},C.creditBankSupply=!1,C.creditBankQuestions=!1,creditCardDetails.resetConfig(),a("#health_payment_details_start").val(""),r.find("input").prop("checked",!1).change(),r.find("label").removeClass("active"),v.val(""),a("#health_payment_details_claims input").prop("checked",!1).change(),a("#health_payment_details_claims input").find("label").removeClass("active"),i(0,90)}function e(a,b){C[a]=b}function f(a){return C[a]}function g(){return r.find("input:checked").val()}function h(){return v.val()}function i(a,b){C.minStartDateOffset=a,C.maxStartDateOffset=b;var c=z.modules.utilities.getUTCToday(),d=0,e=0,f=36e5;c+=10*f,d=c,a>0&&(d+=24*a*f),e=c+24*b*f,c=new Date(d),C.minStartDate=c.getUTCDate()+"/"+(c.getUTCMonth()+1)+"/"+c.getUTCFullYear(),c=new Date(e),C.maxStartDate=c.getUTCDate()+"/"+(c.getUTCMonth()+1)+"/"+c.getUTCFullYear()}function j(){var a=g(),b=h(),c=z.modules.healthResults.getSelectedProduct(),d='<option id="health_payment_details_frequency_" value="">Please choose...</option>';if(""===a||null===c)return!1;var e;if("cc"===a)e=C.credit;else{if("ba"!==a)return!1;e=C.bank}var f=c.premium;e.weekly===!0&&f.weekly.value>0&&(d+='<option id="health_payment_details_frequency_W" value="weekly">Weekly</option>'),e.fortnightly===!0&&f.fortnightly.value>0&&(d+='<option id="health_payment_details_frequency_F" value="fortnightly">Fortnightly</option>'),e.monthly===!0&&f.monthly.value>0&&(d+='<option id="health_payment_details_frequency_M" value="monthly">Monthly</option>'),e.quarterly===!0&&f.quarterly.value>0&&(d+='<option id="health_payment_details_frequency_Q" value="quarterly">Quarterly</option>'),e.halfyearly===!0&&f.halfyearly.value>0&&(d+='<option id="health_payment_details_frequency_H" value="halfyearly">Half-yearly</option>'),e.annually===!0&&f.annually.value>0&&(d+='<option id="health_payment_details_frequency_A" value="annually">Annually</option>'),v.html(d).find("option[value="+b+"]").attr("selected","SELECTED")
}function k(){var b=a("#update-premium");b.removeClass("disabled");var c=a("#health_payment_details-selection");c.find(":input").not(".disabled-by-fund").prop("disabled",!1),c.find(".select").not(".disabled-by-fund").removeClass("disabled"),c.find(".btn-group label").not(".disabled-by-fund").removeClass("disabled"),a("#health_payment_details_start").parent().find(".datepicker").children().css("visibility","visible"),z.modules.loadingAnimation.hide(b)}function l(b,c){var d=a("#update-premium");if(d.addClass("disabled"),c===!0){var e=a("#health_payment_details-selection");e.find(":input").prop("disabled",!0),e.find(".select").addClass("disabled"),e.find(".btn-group label").addClass("disabled"),a("#health_payment_details_start").parent().find(".datepicker").children().css("visibility","hidden")}b===!0&&z.modules.loadingAnimation.showAfter(d)}function m(){return z.modules.journeyEngine.isCurrentStepValid()===!1?!1:(z.messaging.publish(B.WEBAPP_LOCK,{source:"healthPaymentStep",disableFields:!0}),void _.defer(function(){z.modules.healthResults.getProductData(function(b){null===b?z.modules.dialogs.show({title:"Policy not available",htmlContent:"Unfortunately, no pricing is available for this fund. Click the button below to return to your application and try again or alternatively save your quote and call us on 1800 77 77 12."}):(z.modules.healthResults.setSelectedProduct(b,!0),s.slideDown(),t.hide(),u.show(),"cc"===g()?(a("#health_payment_credit-selection").slideDown(),a("#health_payment_bank-selection").hide()):(a("#health_payment_bank-selection").slideDown(),a("#health_payment_credit-selection").hide()),a("#health_declaration-selection").slideDown(),n(),o(),a("#confirm-step").show()),z.messaging.publish(B.WEBAPP_UNLOCK,{source:"healthPaymentStep"})})}))}function n(){var a=g();"ba"==a?(p("Y"==$bankAccountDetailsRadioGroup.find("input:checked").val()||C.creditBankQuestions===!0&&$bankAccountDetailsRadioGroup.is(":visible")===!1?!0:!1),q("N"==$sameBankAccountRadioGroup.find("input:checked").val()?!0:!1)):"cc"==a&&(p(!1),q("Y"==$bankAccountDetailsRadioGroup.find("input:checked").val()||C.creditBankQuestions===!0&&$bankAccountDetailsRadioGroup.is(":visible")===!1?!0:!1))}function o(){var b=a("#health_payment_bank_day").val(),c=a("#health_payment_credit_day").val();a("#health_payment_bank_day").empty().append("<option id='health_payment_bank_day_' value='' >Please choose...</option>"),a("#health_payment_credit_day").empty().append("<option id='health_payment_credit_day_' value='' >Please choose...</option>");var d,e=h();d=""!==e?C.frequency[h()]:27;for(var f=1;d>=f;f++)a("#health_payment_bank_day").append("<option id='health_payment_bank_day_"+f+"' value='"+f+"'>"+f+"</option>"),a("#health_payment_credit_day").append("<option id='health_payment_credit_day_"+f+"' value='"+f+"'>"+f+"</option>");b&&a("#health_payment_bank_day").val(b),c&&a("#health_payment_credit_day").val(c)}function p(b){b?a(".health_bank-details_claims_group").slideDown():a(".health_bank-details_claims_group").slideUp()}function q(b){b?a(".health-bank_claim_details").slideDown():a(".health-bank_claim_details").slideUp()}var r,s,t,u,v,w,x,y,z=window.meerkat,A=z.modules.events,B={WEBAPP_LOCK:"WEBAPP_LOCK",WEBAPP_UNLOCK:"WEBAPP_UNLOCK"},C={bank:[],credit:[],frequency:[],creditBankSupply:!1,creditBankQuestions:!1,minStartDateOffset:0,maxStartDateOffset:90,minStartDate:"",maxStartDate:""};z.modules.register("healthPaymentStep",{init:b,events:B,getSetting:f,overrideSettings:e,setCoverStartRange:i,getSelectedFrequency:h,getSelectedPaymentMethod:g})}(jQuery),function(){function a(){jQuery(document).ready(function(a){return"health"!==k.site.vertical?!1:(e=a("#logo-price-template").html(),f=a(".policySummaryContainer"),g=a(".policySummaryTemplateHolder"),h=a(".productSummaryDetails"),o=a(".policySummary.dualPricing .productSummary"),"confirmation"!=HealthSettings.pageAction&&(i=a("#health_payment_details_frequency"),j=a("#health_payment_details_start"),k.messaging.subscribe(l.healthResults.SELECTED_PRODUCT_CHANGED,function(a){b(a,!1)}),k.messaging.subscribe(l.healthResults.PREMIUM_UPDATED,function(a){b(a,!0)}),k.messaging.subscribe(l.health.CHANGE_MAY_AFFECT_PREMIUM,function(){f.find(".policyPriceWarning").show()})),void k.messaging.publish(n.INIT))})}function b(a,b){var e=i.val();""===e&&(e=Results.getFrequency()),c(a,e,b);var f="Please confirm";""!==j.val()&&(f=j.val()),d(a,f)}function c(a,b,c){a._selectedFrequency=b,a.mode=c?"lhcInc":"",a.showAltPremium=!1;var d=_.template(e),h=d(a);g.html(h),f.find(".policyPriceWarning").hide(),o.length>0&&(a.showAltPremium=!0,h=d(a),o.html(h))}function d(a,b,c){h.find(".name").text(a.info.providerName+" "+a.info.name),h.find(".startDate").text(b),"undefined"!=typeof a.hospital.inclusions&&(h.find(".excess").html(a.hospital.inclusions.excess),h.find(".excessWaivers").html(a.hospital.inclusions.waivers),h.find(".copayment").html(a.hospital.inclusions.copayment)),h.find(".footer").removeClass("hidden"),h.find(".excess").parent().removeClass("hidden"),h.find(".excessWaivers").parent().removeClass("hidden"),h.find(".copayment").parent().removeClass("hidden"),"undefined"!=typeof c&&c===!1&&h.find(".footer").addClass("hidden"),("undefined"==typeof a.hospital.inclusions||""===a.hospital.inclusions.excess)&&h.find(".excess").parent().addClass("hidden"),("undefined"==typeof a.hospital.inclusions||""===a.hospital.inclusions.waivers)&&h.find(".excessWaivers").parent().addClass("hidden"),("undefined"==typeof a.hospital.inclusions||""===a.hospital.inclusions.copayment)&&h.find(".copayment").parent().addClass("hidden")}var e,f,g,h,i,j,k=window.meerkat,l=k.modules.events,m=(k.logging.info,{healthPriceComponent:{INIT:"PRICE_COMPONENT_INITED"}}),n=m.healthPriceComponent,o=[];k.modules.register("healthPriceComponent",{init:a,events:m,updateProductSummaryHeader:c,updateProductSummaryDetails:d})}(jQuery),function(a){function b(){d(),e(),Features.init(),i(),j()}function c(){j(),D!==E.modules.deviceMediaState.get()&&(Results.view.calculateResultsContainerWidth(),Features.clearSetHeights(),Features.balanceVisibleRowsHeight()),Results.pagination.refresh()}function d(){try{Results.init({url:"ajax/json/health_quote_results.jsp",runShowResultsPage:!1,paths:{results:{list:"results.price"},brand:"info.Name",productId:"productId",price:{annually:"premium.annually.lhcfreevalue",monthly:"premium.monthly.lhcfreevalue",fortnightly:"premium.fortnightly.lhcfreevalue"},availability:{price:{annually:"premium.annual.lhcfreevalue",monthly:"premium.monthly.lhcfreevalue",fortnightly:"premium.fortnightly.lhcfreevalue"}},benefitsSort:"info.rank"},show:{nonAvailablePrices:!1},availability:{price:["notEquals",0]},render:{templateEngine:"_",features:{mode:"populate",headers:!1},dockCompareBar:!1},displayMode:"features",paginationMode:"page",sort:{sortBy:"benefitsSort"},frequency:"monthly",animation:{results:{individual:{active:!1},delay:500,options:{easing:"swing",duration:1e3}},shuffle:{active:!1,options:{easing:"swing"}},filter:{reposition:{options:{easing:"swing"}}}},elements:{features:{values:".content",extras:".children"}},dictionary:{valueMap:[{key:"Y",value:"<span class='icon-tick'></span>"},{key:"N",value:"<span class='icon-cross'></span>"},{key:"R",value:"Restricted"},{key:"-",value:"&nbsp;"}]}})}catch(a){Results.onError("Sorry, an error occurred initialising page","results.tag","meerkat.modules.healthResults.init(); "+a.message,a)}}function e(){var b={compareBarRenderer:ListModeCompareBarRenderer,elements:{button:".compareBtn",bar:".compareBar",boxes:".compareBox"},dictionary:{compareLabel:'Compare <span class="icon icon-arrow-right"></span>',clearBasketLabel:'Clear Shortlist <span class="icon icon-arrow-right"></span>'}};Compare.init(b),$compareBasket=a(Compare.settings.elements.bar),$compareBasket.on("compareAdded",function(b,c){null!==E.modules.healthMoreInfo.getOpenProduct()&&E.modules.healthMoreInfo.getOpenProduct().productId!==c&&E.modules.healthMoreInfo.close(),$compareBasket.addClass("active"),a(Results.settings.elements.resultsContainer+" "+Results.settings.elements.rows+"[data-productId="+c+"]").addClass("compared"),Compare.view.resultsFiltered===!1&&Compare.model.products.length===Compare.settings.maximum&&(a(".compareBtn").addClass("compareInActive"),_.delay(function(){g()},250))}),$compareBasket.on("compareRemoved",function(b,c){Compare.view.resultsFiltered&&Compare.model.products.length>=Compare.settings.minimum&&g(),$element=a(Results.settings.elements.resultsContainer+" "+Results.settings.elements.rows+"[data-productId="+c+"]"),$element.removeClass("compared"),$element.find(".compareCheckbox input").prop("checked",!1),0===Compare.model.products.length&&(a(".compareBar").removeClass("active"),z(!1))}),$compareBasket.on("compareNonAvailable",function(){Compare.view.resultsFiltered&&f()}),$compareBasket.on("compareBucketFull",function(){a(".result .compareCheckbox :input").not(":checked").prop("disabled",!0)}),$compareBasket.on("compareBucketAvailable",function(){a(".result .compareCheckbox :input").prop("disabled",!1)}),$compareBasket.on("compareClick",function(){Compare.view.resultsFiltered?f():g()}),E.messaging.subscribe(F.healthFilters.CHANGED,function(){f()})}function f(){$container=a(Results.settings.elements.container),Results.settings.animation.filter.active?$container.find(".compared").removeClass("compared"):$container.find(".compared").removeClass("compared notfiltered").addClass("filtered"),$container.find(".compareCheckbox input").prop("checked",!1),a(".compareBtn").addClass("compareInActive"),_.defer(function(){Compare.unfilterResults(),Compare.reset()})}function g(){_.defer(function(){Compare.filterResults(),_.defer(function(){z(!0,5-Results.getFilteredResults().length),_.delay(function(){Results.settings.render.features.expandRowsOnComparison&&(a(".featuresHeaders .featuresList > .section.expandable.collapsed > .content").trigger("click"),a(".featuresHeaders .featuresList > .selectionHolder > .children > .category.expandable.collapsed > .content").trigger("click")),null!==E.modules.healthMoreInfo.getOpenProduct()&&E.modules.healthMoreInfo.close(),E.messaging.publish(F.tracking.TOUCH,{touchType:"H",touchComment:"ResCompare"});for(var b=[],c=Results.getFilteredResults(),d=0;d<c.length;d++){var e=c[d];b.push({productID:e.productId})}E.messaging.publish(F.tracking.EXTERNAL,{method:"trackQuoteComparison",object:{products:b}})},Results.settings.animation.features.scroll.duration+100)})})}function h(){var b=Results.getFilteredResults().length,c=b+" product";1!=b&&(c+="s"),a(".compareBar .productCount").text(c)}function i(){a(Results.settings.elements.resultsContainer).on("featuresDisplayMode",function(){Features.buildHtml()}),a(document).on("resultsLoaded",x),a(document).on("resultsReturned",function(){Compare.reset(),E.modules.utilities.scrollPageTo(a("header")),a(".featuresHeaders .expandable.expanded").removeClass("expanded").addClass("collapsed")}),a(document).on("resultsDataReady",function(){A(),h(),E.site.isCallCentreUser&&y()}),a(document).on("resultsFetchStart",function(){E.messaging.publish(I.WEBAPP_LOCK,{source:"healthResults"}),z(!1),E.modules.journeyEngine.loadingShow("...getting your quotes..."),a("header .slide-feature-pagination, header a[data-results-pagination-control]").addClass("hidden")}),a(document).on("resultsFetchFinish",function(){if(_.defer(function(){E.messaging.publish(I.WEBAPP_UNLOCK,{source:"healthResults"}),a("header .slide-feature-pagination, header a[data-results-pagination-control]").removeClass("hidden")}),E.modules.journeyEngine.loadingHide(),!HealthSettings.isNewQuote&&!Results.getSelectedProduct()&&E.site.isCallCentreUser){Results.setSelectedProduct(a(".health_application_details_productId").val());var b=Results.getSelectedProduct();b&&E.modules.healthResults.setSelectedProduct(b)}a(Results.settings.elements.page).show()}),a(document).on("populateFeaturesStart",function(){E.modules.performanceProfiling.startTest("results")}),a(Results.settings.elements.resultsContainer).on("populateFeaturesEnd",function(){var a,b=E.modules.performanceProfiling.endTest("results");a=800>b?E.modules.performanceProfiling.PERFORMANCE.HIGH:8e3>b&&E.modules.performanceProfiling.isIE8()===!1?E.modules.performanceProfiling.PERFORMANCE.MEDIUM:E.modules.performanceProfiling.PERFORMANCE.LOW,Results.setPerformanceMode(a)}),a(document).on("resultPageChange",function(a){if(Compare.view.resultsFiltered===!1){var b=a.pageData;if(null===b.measurements)return!1;if(b.pageNumber===b.measurements.numberOfPages){var c=b.measurements.columnsPerPage*b.measurements.numberOfPages-Results.getFilteredResults().length;if(c>2)return z(!0,c),!0}z(!1)}}),a(document).on("FeaturesRendered",function(){a(Features.target+" .expandable > "+Results.settings.elements.features.values).on("mouseenter",function(){var b=a(this).attr("data-featureId"),c=a(Features.target+' [data-featureId="'+b+'"]');c.addClass(Results.settings.elements.features.expandableHover.replace(/[#\.]/g,""))}).on("mouseleave",function(){var b=a(this).attr("data-featureId"),c=a(Features.target+' [data-featureId="'+b+'"]');c.removeClass(Results.settings.elements.features.expandableHover.replace(/[#\.]/g,""))})})}function j(){"xs"==E.modules.deviceMediaState.get()&&k(),E.messaging.subscribe(F.device.STATE_ENTER_XS,function(){"results"===E.modules.journeyEngine.getCurrentStep().navigationId&&k()}),E.messaging.subscribe(F.device.STATE_LEAVE_XS,function(){l()})}function k(){Results.view.startColumnWidthTracking(a(window),2,!1)}function l(){Results.view.stopColumnWidthTracking()}function m(){D=E.modules.deviceMediaState.get()}function n(){E.modules.health.loadRates(function(){Results.get()})}function o(){return J}function p(a){var b=o();return b.premium[a]}function q(a){switch(a){case"weekly":return"W";case"fortnightly":return"F";case"monthly":return"M";case"quarterly":return"Q";case"halfyearly":return"H";case"annually":return"A";default:return!1}}function r(a){switch(a){case"W":return"weekly";case"F":return"fortnightly";case"M":return"monthly";case"Q":return"quarterly";case"H":return"halfyearly";case"A":return"annually";default:return!1}}function s(a){switch(a){case"weekly":return 52;case"fortnightly":return 26;case"quarterly":return 4;case"halfyearly":return 2;case"annually":return 1;default:return 12}}function t(b,c){J=b;var d=a("#mainform");null===b?(d.find(".health_application_details_provider").val(""),d.find(".health_application_details_productId").val(""),d.find(".health_application_details_productNumber").val(""),d.find(".health_application_details_productTitle").val("")):(d.find(".health_application_details_provider").val(J.info.provider),d.find(".health_application_details_productId").val(J.productId),d.find(".health_application_details_productNumber").val(J.info.productCode),d.find(".health_application_details_productTitle").val(J.info.productTitle),c===!0?E.messaging.publish(I.healthResults.PREMIUM_UPDATED,J):(E.messaging.publish(I.healthResults.SELECTED_PRODUCT_CHANGED,J),a(Results.settings.elements.rows).removeClass("active"),a(Results.settings.elements.rows+"[data-productid="+J.productId+"]").addClass("active")))}function u(){healthFunds.unload(),t(null),E.messaging.publish(I.healthResults.SELECTED_PRODUCT_RESET)}function v(b){E.modules.health.loadRates(function(c){if(null===c)b(null);else{var d=E.modules.journeyEngine.getFormData();_.findWhere(d,{name:"health_showAll"}).value="N",_.findWhere(d,{name:"health_onResultsPage"}).value="N",_.findWhere(d,{name:"health_incrementTransactionId"}).value="N",d.push({name:"health_payment_details_start",value:a("#health_payment_details_start").val()}),d.push({name:"health_payment_details_type",value:E.modules.healthPaymentStep.getSelectedPaymentMethod()}),d.push({name:"health_payment_details_frequency",value:E.modules.healthPaymentStep.getSelectedFrequency()}),E.modules.comms.post({url:"ajax/json/health_quote_results.jsp",data:d,cache:!1,errorLevel:"warning",onSuccess:function(a){Results.model.updateTransactionIdFromResult(a),b(a.results&&a.results.price&&"N"!==a.results.price.available?a.results.price:null)},onError:function(){b(null)}})}})}function w(b,c){C.find(".featuresTemplateComponent .selectionHolder [data-skey]").each(function(b,c){var d=a(c),e=d.attr("data-skey"),f=d.attr("data-par-skey"),g=Number(d.attr("data-index"));if($parentFeatureList=d.parents(".featuresTemplateComponent").first(),0===g){var h=$parentFeatureList.find('div[data-skey="'+f+'"].hasShortlistableChildren .children').first();h.attr("data-skey")===e?h.after(d):h.prepend(d)}else{var i=g-1;$parentFeatureList.find('.hasShortlistableChildren div[data-par-skey="'+f+'"][data-index="'+i+'"]').first().after(d)}});for(var d=0;d<b.length;d++){var e=b[d];C.find('.featuresTemplateComponent div[data-skey="'+e+'"]').each(function(b,c){var d=a(c),e=d.attr("data-par-skey");null!=e&&($parentFeatureList=d.parents(".featuresTemplateComponent").first(),$parentFeatureList.find(".selection_"+e+" .children").first().append(d))})}C.find(".featuresTemplateComponent > .section.hasShortlistableChildren").each(function(c,d){var e=a(d),f=e.attr("data-skey"),g=C.find(".cell.selection_"+f);if(-1===b.indexOf(f))e.hide(),g.hide();else{e.show();var h=C.find(".featuresHeaders .selection_"+f+"> .children > .cell").length;if(0===h)g.hide();else{g.show();var i=C.find('.featuresHeaders div[data-skey="'+f+'"]'),j=h+i.find("> .children > .cell").length;g.find(".content .extraText .selectedCount").text(h),g.find(".content .extraText .availableCount").text(j)}}}),"undefined"==typeof c?3===E.modules.journeyEngine.getCurrentStepIndex()&&n():c()}function x(){"xs"==E.modules.deviceMediaState.get()&&k(),h();try{a("#resultsPage .compare").unbind().on("click",function(){var b=a(this),c=b.parents(Results.settings.elements.rows).attr("data-productId"),d=Results.getResult("productId",c),e={id:c,object:d};b.is(":checked")?Compare.add(e):Compare.remove(c)})}catch(b){Results.onError("Sorry, an error occurred processing results","results.tag","FeaturesResults.setResultsActions(); "+b.message,b)}E.site.isCallCentreUser&&y()}function y(){a("#resultsPage .price").each(function(){var b=a(this),c=b.parents(Results.settings.elements.rows).attr("data-productId"),d=Results.getResultByProductId(c),e=_.template(H.premiumsPopOver),f=e({product:d,frequency:Results.getFrequency()});E.modules.popovers.create({element:b,contentValue:f,contentType:"content",showEvent:"mouseenter click",position:{my:"bottom center",at:"top center"},style:{classes:"priceTooltips"}})})}function z(b,c){b?(a(".resultsMarketingMessage").addClass("show"),a(".resultsMarketingMessage").attr("data-columns",c)):a(".resultsMarketingMessage").removeClass("show")}function A(){for(var b=Results.getFrequency(),c=Results.getSortBy(),d=Results.getSortDir(),e=Results.getFilteredResults(),f={rootPath:"health",rankBy:c+"-"+d,rank_count:e.length},g=[],h=0;h<e.length;h++){var i=e[h],j=i.productId.replace("PHIO-HEALTH-","");f["rank_productId"+h]=j,f["rank_price_actual"+h]=i.premium[b].value.toFixed(2),f["rank_price_shown"+h]=i.premium[b].lhcfreevalue.toFixed(2),f["rank_frequency"+h]=b,f["rank_lhc"+h]=i.premium[b].lhc,f["rank_rebate"+h]=i.premium[b].rebate,f["rank_discounted"+h]=i.premium[b].discounted;var k=h+1;g.push({productID:i.productId,ranking:k})}E.modules.comms.post({url:"ajax/write/quote_ranking.jsp",data:f,errorLevel:"silent"}),E.messaging.publish(F.tracking.EXTERNAL,{method:"trackQuoteProductList",object:{products:g}});var l="ALL";switch(a("#health_excess").val()){case 1:l="0";break;case 2:l="1-250";break;case 3:l="251-500";break;default:l="ALL"}var m="benefitsSort"===Results.getSortBy()?"Benefits":"Lowest Price";E.messaging.publish(F.tracking.EXTERNAL,{method:"trackQuoteList",object:{preferredExcess:l,sortPaymentFrequency:b,sortHealthRanking:m,event:G}}),G="Refresh"}function B(){C=a("#resultsPage"),E.messaging.subscribe(F.healthBenefits.CHANGED,w)}var C,D,E=window.meerkat,F=E.modules.events,G=(E.logging.info,"Load"),H={premiumsPopOver:"<strong>Total Price including rebate and LHC: </strong>{{= product.premium[frequency].text }}<br/> <strong>Price including rebate but no LHC: </strong>{{=product.premium[frequency].lhcfreetext}}<br/> <strong>Price including LHC but no rebate: </strong>{{= product.premium[frequency].baseAndLHC }}<br/> <strong>Base price:</strong>{{= product.premium[frequency].base }}<br/> <hr/> <strong>Fortnightly (ex LHC): </strong>{{=product.premium.fortnightly.lhcfreetext}}<br/> <strong>Monthly (ex LHC): </strong>{{=product.premium.monthly.lhcfreetext}}<br/> <strong>Annually (ex LHC): </strong>{{= product.premium.annually.lhcfreetext}}<br/> <hr/> <strong>Name: </strong>{{=product.info.productTitle}}<br/> <strong>Product Code: </strong>{{=product.info.productCode}}<br/> <strong>Product ID: </strong>{{=product.productId}}"},I={healthResults:{SELECTED_PRODUCT_CHANGED:"SELECTED_PRODUCT_CHANGED",SELECTED_PRODUCT_RESET:"SELECTED_PRODUCT_RESET",PREMIUM_UPDATED:"PREMIUM_UPDATED"},WEBAPP_LOCK:"WEBAPP_LOCK",WEBAPP_UNLOCK:"WEBAPP_UNLOCK"},J=null;E.modules.register("healthResults",{init:B,events:I,initPage:b,onReturnToPage:c,get:n,getSelectedProduct:o,setSelectedProduct:t,resetSelectedProduct:u,getProductData:v,getSelectedProductPremium:p,getNumberOfPeriodsForFrequency:s,getFrequencyInLetters:q,getFrequencyInWords:r,stopColumnWidthTracking:l,toggleMarketingMessage:z,onBenefitsSelectionChange:w,recordPreviousBreakpoint:m})}(jQuery);
//# sourceMappingURL=health.modules.ctm.min.map