/*!
 * CTM-Platform v0.8.3
 * Copyright 2015 Compare The Market Pty Ltd
 * http://www.comparethemarket.com.au/
 */


!function(a){function b(){a(document).ready(function(){return"creditcard"!==k.site.vertical?!1:(j=k.site.product,null===typeof j?!1:"2"==k.modules.tracking.getCurrentJourney()?(f(),void setTimeout(function(){c(j,"justRedirect")},200)):(i=a("#mainform"),setupDefaultValidationOnForm(i),a(".cc-just-continue").on("click",function(b){b.preventDefault();var e=a(this);d(e).done(function(){c(j,"justContinueToPartner")}).fail(function(){k.modules.loadingAnimation.hide(e),a(".cc-just-continue, .cc-submit-details").removeClass("disabled")})}),a(".cc-submit-details").on("click",function(b){b.preventDefault();var f=a(this);e()?d(f).done(function(){c(j,"submitDetails")}):(k.modules.loadingAnimation.hide(f),a(".cc-just-continue, .cc-submit-details").removeClass("disabled"))}),a("#creditcard_privacyoptin").on("change",function(){a("#creditcard_optIn").val(a(this).prop("checked")?"Y":"N")}),void a("#creditcard_location").on("blur",function(){g(a(this).val())})))})}function c(a,b){return"string"==typeof a.handoverUrl&&a.handoverUrl.length>1?void window.location.replace(a.handoverUrl):(k.modules.errorHandling.error({errorLevel:"warning",message:"An error occurred. Sorry about that!<br /><br />Please go back and try again.",page:"creditcard.js:"+b,description:"No handoverUrl in results object.",data:a}),!1)}function d(b){a(".cc-just-continue, .cc-submit-details").addClass("disabled"),k.modules.loadingAnimation.showInside(b,!0),f();var c=k.modules.journeyEngine.getSerializedFormData(a("#mainform"));return c+="&quoteType="+k.site.vertical,k.modules.comms.post({url:"ajax/write/creditcard_submit.jsp",data:c,errorLevel:"silent"})}function e(){var b=!0;return i.each(function(c,d){$element=a(d);var e=$element.valid();e===!1&&(b=!1)}),b}function f(){k.messaging.publish(l.tracking.EXTERNAL,{method:"trackQuoteTransfer",object:{productID:j.code,productBrandCode:j.provider.code,productName:j.shortDescription}})}function g(b){if(h(b)){var c=a.trim(String(b)),d=c.split(" "),e=d.pop(),f=d.pop(),g=d.join(" ");a("#creditcard_state").val(e),a("#creditcard_postcode").val(f),a("#creditcard_suburb").val(g)}}function h(b){var c=new RegExp(/^((\s)*([^~,])+\s+)+\d{4}((\s)+(ACT|NSW|QLD|TAS|SA|NT|VIC|WA)(\s)*)$/);return value=a.trim(String(b)),""!==value&&value.match(c)?!0:!1}var i,j,k=window.meerkat,l=k.modules.events,m=(k.logging.info,{creditcard:{}});k.modules.register("creditcard",{init:b,events:m})}(jQuery);
//# sourceMappingURL=creditcard.modules.ctm.min.map