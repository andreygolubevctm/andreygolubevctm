/*!
 * CTM-Platform v0.8.3
 * Copyright 2015 Compare The Market Pty Ltd
 * http://www.comparethemarket.com.au/
 */


!function(a,b){function c(){a(document).ready(function(){return"creditcard"!==m.site.vertical?!1:(l=m.site.product,null===l?!1:(m.messaging.publish(n.tracking.EXTERNAL,{method:"trackQuoteForms",object:{actionStep:"creditcard transfer ONLINE",productID:l.code,productBrandCode:l.provider.code,productName:l.shortDescription,type:"ONLINE"}}),"2"==m.modules.tracking.getCurrentJourney()?(h(),void setTimeout(function(){e(l,"justRedirect")},200)):(k=a("#mainform"),setupDefaultValidationOnForm(k),void d())))})}function d(){a("#creditcard_location").on("blur",function(){i(a(this).val())}),a(".cc-just-continue").on("click",function(b){b.preventDefault();var c=a(this);f(c).done(function(){e(l,"justContinueToPartner")}).fail(function(){m.modules.loadingAnimation.hide(c),a(".cc-just-continue, .cc-submit-details").removeClass("disabled")})}),a(".cc-submit-details").on("click",function(b){b.preventDefault();var c=a(this);g()?f(c).done(function(){e(l,"submitDetails")}):(m.modules.loadingAnimation.hide(c),a(".cc-just-continue, .cc-submit-details").removeClass("disabled"))}),a("#creditcard_privacyoptin").on("change",function(){var b=a(this).prop("checked");a("#creditcard_terms").val(b?"Y":"N"),a("#creditcard_marketing").val(b?"Y":"N")}),a("#creditcard_competition_optIn").on("change",function(){var b=a("#creditcard_name"),c=a("#creditcard_email"),d=a("#creditcard_location");a(this).prop("checked")?(b.rules("add",{required:!0,messages:{required:"Please enter your name to be eligible for the promotion"}}),c.rules("add",{required:!0,messages:{required:"Please enter your email address to be eligible for the promotion"}}),d.rules("add",{required:!0,messages:{required:"Please enter your post code and choose a location to be eligible for the promotion"}})):(b.rules("remove","required"),b.rules("add",{required:!0,messages:{required:"Please enter your full name"}}),c.rules("remove","required"),c.rules("add",{required:!0,messages:{required:"Please enter your email address"}}),d.rules("remove","required"),d.rules("add",{required:!0,messages:{required:"Please enter your Postcode/Suburb"}}),b.valid(),c.valid(),d.valid())})}function e(a,b){return"string"==typeof a.handoverUrl&&a.handoverUrl.length>1?void window.location.replace(a.handoverUrl):(m.modules.errorHandling.error({errorLevel:"warning",message:"An error occurred. Sorry about that!<br /><br />Please go back and try again.",page:"creditcard.js:"+b,description:"No handoverUrl in results object.",data:a}),!1)}function f(b){a(".cc-just-continue, .cc-submit-details").addClass("disabled"),m.modules.loadingAnimation.showInside(b,!0),h();var c=m.modules.journeyEngine.getSerializedFormData(a("#mainform"));return c+="&quoteType="+m.site.vertical,m.modules.comms.post({url:"ajax/write/creditcard_submit.jsp",data:c,errorLevel:"silent"})}function g(){var b=!0;return k.each(function(c,d){$element=a(d);var e=$element.valid();e===!1&&(b=!1)}),b}function h(){m.messaging.publish(n.tracking.EXTERNAL,{method:"trackQuoteHandoverClick",object:{actionStep:"creditcard transfer ONLINE",productID:l.code,productBrandCode:l.provider.code,productName:l.shortDescription,type:"ONLINE"}})}function i(b){if(j(b)){var c=a.trim(String(b)),d=c.split(" "),e=d.pop(),f=d.pop(),g=d.join(" ");a("#creditcard_state").val(e),a("#creditcard_postcode").val(f),a("#creditcard_suburb").val(g)}}function j(b){var c=new RegExp(/^((\s)*([^~,])+\s+)+\d{4}((\s)+(ACT|NSW|QLD|TAS|SA|NT|VIC|WA)(\s)*)$/);return value=a.trim(String(b)),""!==value&&value.match(c)?!0:!1}var k,l,m=window.meerkat,n=m.modules.events,o=(m.logging.info,{creditcard:{}});m.modules.register("creditcard",{init:c,events:o})}(jQuery);
//# sourceMappingURL=creditcard.modules.ctm.min.map