/*!
 * CTM-Platform v0.8.3
 * Copyright 2015 Compare The Market Pty Ltd
 * http://www.comparethemarket.com.au/
 */


!function(a){function b(){a(document).ready(function(){return"creditcard"!==l.site.vertical?!1:(k=l.site.product,null===k?!1:(l.messaging.publish(m.tracking.EXTERNAL,{method:"trackQuoteForms",object:{actionStep:"creditcard transfer ONLINE",productID:k.code,productBrandCode:k.provider.code,productName:k.shortDescription,type:"ONLINE"}}),"2"==l.modules.tracking.getCurrentJourney()?(g(),void setTimeout(function(){d(k,"justRedirect")},200)):(j=a("#mainform"),setupDefaultValidationOnForm(j),void c())))})}function c(){a("#creditcard_location").on("blur",function(){h(a(this).val())}),a(".cc-just-continue").on("click",function(b){b.preventDefault();var c=a(this);e(c).done(function(){d(k,"justContinueToPartner")}).fail(function(){l.modules.loadingAnimation.hide(c),a(".cc-just-continue, .cc-submit-details").removeClass("disabled")})}),a(".cc-submit-details").on("click",function(b){b.preventDefault();var c=a(this);f()?e(c).done(function(){d(k,"submitDetails")}):(l.modules.loadingAnimation.hide(c),a(".cc-just-continue, .cc-submit-details").removeClass("disabled"))}),a("#creditcard_privacyoptin").on("change",function(){var b=a(this).prop("checked");a("#creditcard_terms").val(b?"Y":"N"),a("#creditcard_marketing").val(b?"Y":"N")}),a("#creditcard_competition_optIn").on("change",function(){var b=a("#creditcard_name"),c=a("#creditcard_email"),d=a("#creditcard_location");a(this).prop("checked")?(b.rules("add",{required:!0,messages:{required:"Please enter your name to be eligible for the promotion"}}),c.rules("add",{required:!0,messages:{required:"Please enter your email address to be eligible for the promotion"}}),d.rules("add",{required:!0,messages:{required:"Please enter your post code and choose a location to be eligible for the promotion"}})):(b.rules("remove","required"),b.rules("add",{required:!0,messages:{required:"Please enter your full name"}}),c.rules("remove","required"),c.rules("add",{required:!0,messages:{required:"Please enter your email address"}}),d.rules("remove","required"),d.rules("add",{required:!0,messages:{required:"Please enter your Postcode/Suburb"}}),b.valid(),c.valid(),d.valid())})}function d(a,b){return"string"==typeof a.handoverUrl&&a.handoverUrl.length>1?void window.location.replace(a.handoverUrl):(l.modules.errorHandling.error({errorLevel:"warning",message:"An error occurred. Sorry about that!<br /><br />Please go back and try again.",page:"creditcard.js:"+b,description:"No handoverUrl in results object.",data:a}),!1)}function e(b){a(".cc-just-continue, .cc-submit-details").addClass("disabled"),l.modules.loadingAnimation.showInside(b,!0),g();var c=l.modules.journeyEngine.getSerializedFormData(a("#mainform"));return c+="&quoteType="+l.site.vertical,l.modules.comms.post({url:"ajax/write/creditcard_submit.jsp",data:c,errorLevel:"silent"})}function f(){var b=!0;return j.each(function(c,d){$element=a(d);var e=$element.valid();e===!1&&(b=!1)}),b}function g(){l.messaging.publish(m.tracking.EXTERNAL,{method:"trackQuoteHandoverClick",object:{actionStep:"creditcard transfer ONLINE",productID:k.code,productBrandCode:k.provider.code,productName:k.shortDescription,type:"ONLINE"}})}function h(b){if(i(b)){var c=a.trim(String(b)),d=c.split(" "),e=d.pop(),f=d.pop(),g=d.join(" ");a("#creditcard_state").val(e),a("#creditcard_postcode").val(f),a("#creditcard_suburb").val(g)}}function i(b){var c=new RegExp(/^((\s)*([^~,])+\s+)+\d{4}((\s)+(ACT|NSW|QLD|TAS|SA|NT|VIC|WA)(\s)*)$/);return value=a.trim(String(b)),""!==value&&value.match(c)?!0:!1}var j,k,l=window.meerkat,m=l.modules.events,n=(l.logging.info,{creditcard:{}});l.modules.register("creditcard",{init:b,events:n})}(jQuery);
//# sourceMappingURL=creditcard.modules.ctm.min.map