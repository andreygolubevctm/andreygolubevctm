package com.ctm.web.health.email.services;

import com.ctm.web.core.email.services.EmailDetailsService;
import com.ctm.web.core.model.EmailMaster;
import com.ctm.web.core.model.settings.PageSettings;
import com.ctm.web.core.security.IPAddressHandler;
import com.ctm.web.core.services.SessionDataServiceBean;
import com.ctm.web.email.EmailEventRequest;
import com.ctm.web.email.EmailResponse;
import com.ctm.web.email.MarketingAutomationEmailService;
import com.ctm.web.health.model.form.HealthQuote;
import com.ctm.web.health.model.form.HealthRequest;
import com.ctm.web.health.model.form.Payment;
import com.ctm.web.health.model.form.PaymentDetails;
import com.ctm.web.health.services.HealthSelectedProductService;
import org.junit.Before;
import org.junit.Test;
import org.junit.runner.RunWith;
import org.mockito.InjectMocks;
import org.mockito.Matchers;
import org.mockito.Mock;
import org.mockito.runners.MockitoJUnitRunner;

import javax.servlet.http.HttpServletRequest;

import static org.junit.Assert.assertEquals;
import static org.mockito.Matchers.*;
import static org.mockito.Mockito.when;

@RunWith(MockitoJUnitRunner.class)
public class HealthEmailServiceTest {

    @Mock
    private MarketingAutomationEmailService marketingAutomationEmailService;

    @Mock
    private PageSettings pageSettings;

    @Mock
    private EmailDetailsService emailDetailsService;

    @Mock
    private HttpServletRequest request;

    @Mock
    private EmailMaster emailDetails;

    @Mock
    private HealthSelectedProductService healthSelectedProductService;

    @Mock
    private HealthRequest healthRequest;

    @Mock
    private HealthQuote healthQuote;

    @Mock
    private Payment payment;

    @Mock
    private PaymentDetails paymentDetails;

    @Mock
    private EmailResponse emailResponse;

    @Mock
    private SessionDataServiceBean sessionDataService;

    @Mock
    private IPAddressHandler ipAddressHandler;

    @InjectMocks
    private HealthEmailService healthEmailService;

    @Before
    public void setup() throws Exception {
        when(pageSettings.getSetting(Matchers.anyString())).thenReturn("testPageSettings");
        when(emailDetailsService.handleReadAndWriteEmailDetails(anyLong(), anyObject(), anyString(), anyString())).thenReturn(emailDetails);
        when(healthSelectedProductService.getProductXML(anyLong(), anyString())).thenReturn("{\"info\":{\"trackingKey\":\"8d758d1074e41de68e67c1174bb6c95bd81e9ed8\",\"transactionId\":2717010,\"pricesHaveChanged\":false},\"price\":[{\"available\":\"Y\",\"serviceName\":\"PHIO\",\"productId\":\"PHIO-HEALTH-8469549\",\"promo\":{\"promoText\":\"Get $1,000,000 and a broken leg&nbsp;<p><a class=\\\"dialogPop\\\" data-content=\\\"Get $1,000,000 and a broken leg, when buy health insurance and dont cancel in 2 months\\\" title=\\\"Find out more\\\" data-class=\\\"results-promo-modal\\\">Find out more</a></p>\",\"hospitalPDF\":\"health_brochure.jsp?pdf=/MYO/bronzehospital750andmin50extras.pdf&brandCode=ctm\",\"providerPhoneNumber\":\"\",\"extrasPDF\":\"health_brochure.jsp?pdf=/MYO/bronzehospital750andmin50extras.pdf&brandCode=ctm\",\"discountText\":\"\"},\"awardScheme\":{\"text\":\"\"},\"paymentTypePremiums\":{\"BankAccount\":{\"weekly\":{\"discounted\":\"N\",\"lhcPercentage\":8,\"lhcfreetext\":\"$59.76\",\"rebateValue\":\"$0.00\",\"rebate\":0.0,\"lhc\":\"$3.86\",\"discountAmount\":\"$0.00\",\"baseAndLHC\":\"$61.98\",\"discountPercentage\":0,\"lhcfreepricing\":\"The premium may be affected by LHC <br> inc $0.00 Govt Rebate.\",\"lhcfreevalue\":59.76,\"grossPremium\":\"$58.12\",\"text\":\"$63.62\",\"value\":63.62,\"hospitalValue\":48.25,\"pricing\":\"Includes rebate of $0.00 & LHC loading of $3.86.\",\"base\":\"$58.12\",\"abd\":0,\"abdValue\":0},\"fortnightly\":{\"discounted\":\"N\",\"lhcPercentage\":8,\"lhcfreetext\":\"$119.52\",\"rebateValue\":\"$0.00\",\"rebate\":0.0,\"lhc\":\"$7.72\",\"discountAmount\":\"$0.00\",\"baseAndLHC\":\"$123.96\",\"discountPercentage\":0,\"lhcfreepricing\":\"The premium may be affected by LHC <br> inc $0.00 Govt Rebate.\",\"lhcfreevalue\":119.52,\"grossPremium\":\"$116.24\",\"text\":\"$127.24\",\"value\":127.24,\"hospitalValue\":96.5,\"pricing\":\"Includes rebate of $0.00 & LHC loading of $7.72.\",\"base\":\"$116.24\",\"abd\":0,\"abdValue\":0},\"monthly\":{\"discounted\":\"N\",\"lhcPercentage\":8,\"lhcfreetext\":\"$258.98\",\"rebateValue\":\"$0.00\",\"rebate\":0.0,\"lhc\":\"$16.73\",\"discountAmount\":\"$0.00\",\"baseAndLHC\":\"$268.59\",\"discountPercentage\":0,\"lhcfreepricing\":\"The premium may be affected by LHC <br> inc $0.00 Govt Rebate.\",\"lhcfreevalue\":258.98,\"grossPremium\":\"$251.86\",\"text\":\"$275.71\",\"value\":275.71,\"hospitalValue\":209.07,\"pricing\":\"Includes rebate of $0.00 & LHC loading of $16.73.\",\"base\":\"$251.86\",\"abd\":0,\"abdValue\":0},\"quarterly\":{\"discounted\":\"N\",\"lhcPercentage\":8,\"lhcfreetext\":\"$0.00\",\"rebateValue\":\"$0.00\",\"rebate\":0.0,\"lhc\":\"$0.00\",\"discountAmount\":\"$0.00\",\"baseAndLHC\":\"$0.00\",\"discountPercentage\":0,\"lhcfreepricing\":\"The premium may be affected by LHC <br> inc $0.00 Govt Rebate.\",\"lhcfreevalue\":0.00,\"grossPremium\":\"$0.00\",\"text\":\"$0.00\",\"value\":0.00,\"hospitalValue\":0,\"pricing\":\"Includes rebate of $0.00 & LHC loading of $0.00.\",\"base\":\"$0.00\",\"abd\":0,\"abdValue\":0},\"halfyearly\":{\"discounted\":\"N\",\"lhcPercentage\":8,\"lhcfreetext\":\"$0.00\",\"rebateValue\":\"$0.00\",\"rebate\":0.0,\"lhc\":\"$0.00\",\"discountAmount\":\"$0.00\",\"baseAndLHC\":\"$0.00\",\"discountPercentage\":0,\"lhcfreepricing\":\"The premium may be affected by LHC <br> inc $0.00 Govt Rebate.\",\"lhcfreevalue\":0.00,\"grossPremium\":\"$0.00\",\"text\":\"$0.00\",\"value\":0.00,\"hospitalValue\":0,\"pricing\":\"Includes rebate of $0.00 & LHC loading of $0.00.\",\"base\":\"$0.00\",\"abd\":0,\"abdValue\":0},\"annually\":{\"discounted\":\"N\",\"lhcPercentage\":8,\"lhcfreetext\":\"$3,107.82\",\"rebateValue\":\"$0.00\",\"rebate\":0.0,\"lhc\":\"$200.70\",\"discountAmount\":\"$0.00\",\"baseAndLHC\":\"$3,223.02\",\"discountPercentage\":0,\"lhcfreepricing\":\"The premium may be affected by LHC <br> inc $0.00 Govt Rebate.\",\"lhcfreevalue\":3107.82,\"grossPremium\":\"$3,022.32\",\"text\":\"$3,308.52\",\"value\":3308.52,\"hospitalValue\":2508.79,\"pricing\":\"Includes rebate of $0.00 & LHC loading of $200.70.\",\"base\":\"$3,022.32\",\"abd\":0,\"abdValue\":0}},\"CreditCard\":{\"weekly\":{\"discounted\":\"N\",\"lhcPercentage\":8,\"lhcfreetext\":\"$59.76\",\"rebateValue\":\"$0.00\",\"rebate\":0.0,\"lhc\":\"$3.86\",\"discountAmount\":\"$0.00\",\"baseAndLHC\":\"$61.98\",\"discountPercentage\":0,\"lhcfreepricing\":\"The premium may be affected by LHC <br> inc $0.00 Govt Rebate.\",\"lhcfreevalue\":59.76,\"grossPremium\":\"$58.12\",\"text\":\"$63.62\",\"value\":63.62,\"hospitalValue\":48.25,\"pricing\":\"Includes rebate of $0.00 & LHC loading of $3.86.\",\"base\":\"$58.12\",\"abd\":0,\"abdValue\":0},\"fortnightly\":{\"discounted\":\"N\",\"lhcPercentage\":8,\"lhcfreetext\":\"$119.52\",\"rebateValue\":\"$0.00\",\"rebate\":0.0,\"lhc\":\"$7.72\",\"discountAmount\":\"$0.00\",\"baseAndLHC\":\"$123.96\",\"discountPercentage\":0,\"lhcfreepricing\":\"The premium may be affected by LHC <br> inc $0.00 Govt Rebate.\",\"lhcfreevalue\":119.52,\"grossPremium\":\"$116.24\",\"text\":\"$127.24\",\"value\":127.24,\"hospitalValue\":96.5,\"pricing\":\"Includes rebate of $0.00 & LHC loading of $7.72.\",\"base\":\"$116.24\",\"abd\":0,\"abdValue\":0},\"monthly\":{\"discounted\":\"N\",\"lhcPercentage\":8,\"lhcfreetext\":\"$258.98\",\"rebateValue\":\"$0.00\",\"rebate\":0.0,\"lhc\":\"$16.73\",\"discountAmount\":\"$0.00\",\"baseAndLHC\":\"$268.59\",\"discountPercentage\":0,\"lhcfreepricing\":\"The premium may be affected by LHC <br> inc $0.00 Govt Rebate.\",\"lhcfreevalue\":258.98,\"grossPremium\":\"$251.86\",\"text\":\"$275.71\",\"value\":275.71,\"hospitalValue\":209.07,\"pricing\":\"Includes rebate of $0.00 & LHC loading of $16.73.\",\"base\":\"$251.86\",\"abd\":0,\"abdValue\":0},\"quarterly\":{\"discounted\":\"N\",\"lhcPercentage\":8,\"lhcfreetext\":\"$0.00\",\"rebateValue\":\"$0.00\",\"rebate\":0.0,\"lhc\":\"$0.00\",\"discountAmount\":\"$0.00\",\"baseAndLHC\":\"$0.00\",\"discountPercentage\":0,\"lhcfreepricing\":\"The premium may be affected by LHC <br> inc $0.00 Govt Rebate.\",\"lhcfreevalue\":0.00,\"grossPremium\":\"$0.00\",\"text\":\"$0.00\",\"value\":0.00,\"hospitalValue\":0,\"pricing\":\"Includes rebate of $0.00 & LHC loading of $0.00.\",\"base\":\"$0.00\",\"abd\":0,\"abdValue\":0},\"halfyearly\":{\"discounted\":\"N\",\"lhcPercentage\":8,\"lhcfreetext\":\"$0.00\",\"rebateValue\":\"$0.00\",\"rebate\":0.0,\"lhc\":\"$0.00\",\"discountAmount\":\"$0.00\",\"baseAndLHC\":\"$0.00\",\"discountPercentage\":0,\"lhcfreepricing\":\"The premium may be affected by LHC <br> inc $0.00 Govt Rebate.\",\"lhcfreevalue\":0.00,\"grossPremium\":\"$0.00\",\"text\":\"$0.00\",\"value\":0.00,\"hospitalValue\":0,\"pricing\":\"Includes rebate of $0.00 & LHC loading of $0.00.\",\"base\":\"$0.00\",\"abd\":0,\"abdValue\":0},\"annually\":{\"discounted\":\"N\",\"lhcPercentage\":8,\"lhcfreetext\":\"$3,107.82\",\"rebateValue\":\"$0.00\",\"rebate\":0.0,\"lhc\":\"$200.70\",\"discountAmount\":\"$0.00\",\"baseAndLHC\":\"$3,223.02\",\"discountPercentage\":0,\"lhcfreepricing\":\"The premium may be affected by LHC <br> inc $0.00 Govt Rebate.\",\"lhcfreevalue\":3107.82,\"grossPremium\":\"$3,022.32\",\"text\":\"$3,308.52\",\"value\":3308.52,\"hospitalValue\":2508.79,\"pricing\":\"Includes rebate of $0.00 & LHC loading of $200.70.\",\"base\":\"$3,022.32\",\"abd\":0,\"abdValue\":0}}},\"custom\":{\"reform\":{\"tier\":\"Bronze\",\"tab2\":{\"benefits\":null,\"limited\":null,\"excess\":null},\"changeDate\":\"1st April 2019\",\"yad\":\"N\",\"tab1\":{\"excess\":\"You will have to pay an excess of $750 on admission. This is limited to a maximum of $750 per person and $1500 per policy per year.\",\"limited\":null,\"benefits\":[{\"category\":\"Rehabilitation\",\"covered\":\"R\",\"waitingperiod\":\"2 months\",\"isclinicalcategory\":\"true\",\"helpid\":\"596\",\"scopeofcover\":\"Hospital treatment for physical rehabilitation for a patient related to surgery or illness. For example: inpatient and admitted day patient rehabilitation, stroke recovery, cardiac rehabilitation\"},{\"category\":\"Hospital psychiatric services\",\"covered\":\"R\",\"waitingperiod\":\"2 months\",\"isclinicalcategory\":\"true\",\"helpid\":\"597\",\"scopeofcover\":\"Hospital treatment for the treatment and care of patients with psychiatric, mental, addiction or behavioural disorders. For example: psychoses such as schizophrenia, mood disorders such as depression, eating disorders and addiction therapy.\"},{\"category\":\"Palliative care\",\"covered\":\"R\",\"waitingperiod\":\"2 months\",\"isclinicalcategory\":\"true\",\"helpid\":\"598\",\"scopeofcover\":\"Hospital treatment for care where the intent is primarily providing quality of life for a patient with a terminal illness, including treatment to alleviate and manage pain.\"},{\"category\":\"Brain and Nervous system\",\"covered\":\"Y\",\"waitingperiod\":\"2 months (12 if pre-existing)\",\"isclinicalcategory\":\"true\",\"helpid\":\"599\",\"scopeofcover\":\"Hospital treatment for the investigation and treatment of the brain, brain-related conditions, spinal cord and peripheral nervous system. For example: stroke, brain or spinal cord tumours, head injuries, epilepsy and Parkinson’s disease. Treatment of spinal column (back bone) conditions is listed separately under Back, neck and spine. Chemotherapy and radiotherapy for cancer is listed separately under Chemotherapy, radiotherapy and immunotherapy for cancer.\"},{\"category\":\"Eye (not cataracts)\",\"covered\":\"Y\",\"waitingperiod\":\"2 months (12 if pre-existing)\",\"isclinicalcategory\":\"true\",\"helpid\":\"600\",\"scopeofcover\":\"Hospital treatment for the investigation and treatment of the eye and the contents of the eye socket. For example: retinal detachment, tear duct conditions, eye infections and medically managed trauma to the eye. Cataract procedures are listed separately under Cataracts. Eyelid procedures are listed separately under Plastic and reconstructive surgery. Chemotherapy and radiotherapy for cancer is listed separately under Chemotherapy, radiotherapy and immunotherapy for cancer.\"},{\"category\":\"Ear, nose and throat\",\"covered\":\"Y\",\"waitingperiod\":\"2 months (12 if pre-existing)\",\"isclinicalcategory\":\"true\",\"helpid\":\"601\",\"scopeofcover\":\"Hospital treatment for the investigation and treatment of the ear, nose, throat, middle ear, thyroid, parathyroid, larynx, lymph nodes and related areas of the head and neck. For example: damaged ear drum, sinus surgery, removal of foreign bodies, stapedectomy and throat cancer. Tonsils, adenoids and grommets are listed separately under Tonsils, adenoids and grommets. The implantation of a hearing device is listed separately under Implantation of hearing devices. Orthopaedic neck conditions are listed separately under Back, neck and spine. Sleep studies are listed separately under Sleep studies Chemotherapy and radiotherapy for cancer is listed separately under Chemotherapy, radiotherapy and immunotherapy for cancer.\"},{\"category\":\"Tonsils, adenoids and grommets\",\"covered\":\"Y\",\"waitingperiod\":\"2 months (12 if pre-existing)\",\"isclinicalcategory\":\"true\",\"helpid\":\"602\",\"scopeofcover\":\"Hospital treatment of the tonsils, adenoids and insertion or removal of grommets.\"},{\"category\":\"Bone, joint and muscle\",\"covered\":\"Y\",\"waitingperiod\":\"2 months (12 if pre-existing)\",\"isclinicalcategory\":\"true\",\"helpid\":\"603\",\"scopeofcover\":\"Hospital treatment for the investigation and treatment of diseases, disorders and injuries of the musculoskeletal system. For example: carpal tunnel, fractures, hand surgery, joint fusion, bone spurs, osteomyelitis and bone cancer. Chest surgery is listed separately under Lung and chest. Spinal cord conditions are listed separately under Brain and nervous system. Spinal column conditions are listed separately under Back, neck and spine. Joint reconstructions are listed separately under Joint reconstructions. Joint replacements are listed separately under Joint replacements. Podiatric surgery performed by a registered podiatric surgeon is listed separately under Podiatric surgery (provided by a registered podiatric surgeon). Management of back pain is listed separately under Pain management. Pain management that requires a device is listed separately under Pain management with device. Chemotherapy and radiotherapy for cancer is listed separately under Chemotherapy, radiotherapy and immunotherapy for cancer.\"},{\"category\":\"Joint reconstructions\",\"covered\":\"Y\",\"waitingperiod\":\"2 months (12 if pre-existing)\",\"isclinicalcategory\":\"true\",\"helpid\":\"604\",\"scopeofcover\":\"Hospital treatment for surgery for joint reconstructions. For example: torn tendons, rotator cuff tears and damaged ligaments. Joint replacements are listed separately under Joint replacements. Bone fractures are listed separately under Bone, joint and muscle. Procedures to the spinal column are listed separately under Back, neck and spine. Podiatric surgery performed by a registered podiatric surgeon is listed separately under Podiatric surgery (provided by a registered podiatric surgeon).\"},{\"category\":\"Kidney and bladder\",\"covered\":\"Y\",\"waitingperiod\":\"2 months (12 if pre-existing)\",\"isclinicalcategory\":\"true\",\"helpid\":\"605\",\"scopeofcover\":\"Hospital treatment for the investigation and treatment of the kidney, adrenal gland and bladder. For example: kidney stones, adrenal gland tumour and incontinence. Dialysis is listed separately under Dialysis for chronic kidney failure. Chemotherapy and radiotherapy for cancer is listed separately under Chemotherapy, radiotherapy and immunotherapy for cancer.\"},{\"category\":\"Male reproductive system\",\"covered\":\"Y\",\"waitingperiod\":\"2 months (12 if pre-existing)\",\"isclinicalcategory\":\"true\",\"helpid\":\"606\",\"scopeofcover\":\"Hospital treatment for the investigation and treatment of the male reproductive system including the prostate. For example: male sterilisation, circumcision and prostate cancer. Chemotherapy and radiotherapy for cancer is listed separately under Chemotherapy, radiotherapy and immunotherapy for cancer.\"},{\"category\":\"Digestive system\",\"covered\":\"Y\",\"waitingperiod\":\"2 months (12 if pre-existing)\",\"isclinicalcategory\":\"true\",\"helpid\":\"607\",\"scopeofcover\":\"Hospital treatment for the investigation and treatment of the digestive system, including the oesophagus, stomach, gall bladder, pancreas, spleen, liver and bowel. For example: oesophageal cancer, irritable bowel syndrome, gall stones and haemorrhoids. Endoscopy is listed separately under Gastrointestinal endoscopy. Hernia and appendicectomy procedures are listed separately under Hernia and appendix. Bariatric surgery is listed separately under Weight loss surgery. Chemotherapy and radiotherapy for cancer is listed separately under Chemotherapy, radiotherapy and immunotherapy for cancer.\"},{\"category\":\"Hernia and appendix\",\"covered\":\"Y\",\"waitingperiod\":\"2 months (12 if pre-existing)\",\"isclinicalcategory\":\"true\",\"helpid\":\"608\",\"scopeofcover\":\"Hospital treatment for the investigation and treatment of a hernia or appendicitis. Digestive conditions are listed separately under Digestive system.\"},{\"category\":\"Gastrointestinal endoscopy\",\"covered\":\"Y\",\"waitingperiod\":\"2 months (12 if pre-existing)\",\"isclinicalcategory\":\"true\",\"helpid\":\"609\",\"scopeofcover\":\"Hospital treatment for the diagnosis, investigation and treatment of the internal parts of the gastrointestinal system using an endoscope. For example: colonoscopy, gastroscopy, endoscopic retrograde cholangiopancreatography (ERCP). Non-endoscopic procedures for the digestive system are listed separately under Digestive system.\"},{\"category\":\"Gynaecology\",\"covered\":\"Y\",\"waitingperiod\":\"2 months (12 if pre-existing)\",\"isclinicalcategory\":\"true\",\"helpid\":\"610\",\"scopeofcover\":\"Hospital treatment for the investigation and treatment of the female reproductive system. For example: endometriosis, polycystic ovaries, female sterilisation and cervical cancer. Fertility treatments are listed separately under Assisted reproductive services. Pregnancy and birth-related conditions are listed separately under Pregnancy and birth. Miscarriage or termination of pregnancy is listed separately under Miscarriage and termination of pregnancy. Chemotherapy and radiotherapy for cancer is listed separately under Chemotherapy, radiotherapy and immunotherapy for cancer.\"},{\"category\":\"Miscarriage and termination of pregnancy\",\"covered\":\"Y\",\"waitingperiod\":\"2 months (12 if pre-existing)\",\"isclinicalcategory\":\"true\",\"helpid\":\"611\",\"scopeofcover\":\"Hospital treatment for the investigation and treatment of a miscarriage or for termination of pregnancy.\"},{\"category\":\"Chemotherapy, radiotherapy and immunotherapy for cancer\",\"covered\":\"Y\",\"waitingperiod\":\"2 months (12 if pre-existing)\",\"isclinicalcategory\":\"true\",\"helpid\":\"612\",\"scopeofcover\":\"Hospital treatment for chemotherapy, radiotherapy and immunotherapy for the treatment of cancer or benign tumours. Surgical treatment of cancer is listed separately under each body system.\"},{\"category\":\"Pain management\",\"covered\":\"Y\",\"waitingperiod\":\"2 months (12 if pre-existing)\",\"isclinicalcategory\":\"true\",\"helpid\":\"613\",\"scopeofcover\":\"Hospital treatment for pain management that does not require the insertion or surgical management of a device. For example: treatment of nerve pain and chest pain due to cancer by injection of a nerve block. Pain management using a device (for example an infusion pump or neurostimulator) is listed separately under Pain management with device.\"},{\"category\":\"Skin\",\"covered\":\"Y\",\"waitingperiod\":\"2 months (12 if pre-existing)\",\"isclinicalcategory\":\"true\",\"helpid\":\"614\",\"scopeofcover\":\"Hospital treatment for the investigation and treatment of skin, skin-related conditions and nails. The removal of foreign bodies is also included. Plastic surgery that is medically necessary and relating to the treatment of a skin-related condition is also included. For example: melanoma, minor wound repair and abscesses. Removal of excess skin due to weight loss is listed separately under Weight loss surgery. Chemotherapy and radiotherapy for cancer is listed separately under Chemotherapy, radiotherapy and immunotherapy for cancer.\"},{\"category\":\"Breast surgery (medically necessary)\",\"covered\":\"Y\",\"waitingperiod\":\"2 months (12 if pre-existing)\",\"isclinicalcategory\":\"true\",\"helpid\":\"615\",\"scopeofcover\":\"Hospital treatment for the investigation and treatment of breast disorders and associated lymph nodes, and reconstruction and/or reduction following breast surgery or a preventative mastectomy. For example: breast lesions, breast tumours, asymmetry due to breast cancer surgery, and gynecomastia. This clinical category does not require benefits to be paid for cosmetic breast surgery that is not medically necessary. Chemotherapy and radiotherapy for cancer is listed separately under Chemotherapy, radiotherapy and immunotherapy for cancer.\"},{\"category\":\"Diabetes Management (excluding insulin pumps)\",\"covered\":\"Y\",\"waitingperiod\":\"2 months (12 if pre-existing)\",\"isclinicalcategory\":\"true\",\"helpid\":\"616\",\"scopeofcover\":\"Hospital treatment for the investigation and management of diabetes. For example: stabilisation of hypo- or hyper- glycaemia, contour problems due to insulin injections. Treatment for diabetes-related conditions is listed separately under each body system affected. For example, treatment for diabetes-related eye conditions is listed separately under Eye. Treatment for ulcers is listed separately under Skin. Provision and replacement of insulin pumps is listed separately under Insulin pumps\"},{\"category\":\"Heart and vascular system\",\"covered\":\"N\",\"waitingperiod\":\"2 months (12 if pre-existing)\",\"isclinicalcategory\":\"true\",\"helpid\":\"617\",\"scopeofcover\":\"Hospital treatment for the investigation and treatment of the heart, heart-related conditions and vascular system. For example: heart failure and heart attack, monitoring of heart conditions, varicose veins and removal of plaque from arterial walls. Chemotherapy and radiotherapy for cancer is listed separately under Chemotherapy, radiotherapy and immunotherapy for cancer.\"},{\"category\":\"Lung and chest\",\"covered\":\"N\",\"waitingperiod\":\"2 months (12 if pre-existing)\",\"isclinicalcategory\":\"true\",\"helpid\":\"618\",\"scopeofcover\":\"Hospital treatment for the investigation and treatment of the lungs, lung-related conditions, mediastinum and chest. For example: lung cancer, respiratory disorders such as asthma, pneumonia, and treatment of trauma to the chest. Chemotherapy and radiotherapy for cancer is listed separately under Chemotherapy, radiotherapy and immunotherapy for cancer.\"},{\"category\":\"Blood\",\"covered\":\"N\",\"waitingperiod\":\"2 months (12 if pre-existing)\",\"isclinicalcategory\":\"true\",\"helpid\":\"619\",\"scopeofcover\":\"Hospital treatment for the investigation and treatment of blood and blood-related conditions. For example: blood clotting disorders and bone marrow transplants. Treatment for cancers of the blood is listed separately under Chemotherapy, radiotherapy and immunotherapy for cancer.\"},{\"category\":\"Back, neck and spine\",\"covered\":\"N\",\"waitingperiod\":\"2 months (12 if pre-existing)\",\"isclinicalcategory\":\"true\",\"helpid\":\"620\",\"scopeofcover\":\"Hospital treatment for the investigation and treatment of the back, neck and spinal column, including spinal fusion. For example: sciatica, prolapsed or herniated disc, spinal disc replacement, and spine curvature disorders such as scoliosis, kyphosis and lordosis. Joint replacements are listed separately under Joint replacements. Joint fusions are listed separately under Bone, joint and muscle. Spinal cord conditions are listed separately under Brain and nervous system. Management of back pain is listed separately under Pain management. Pain management that requires a device is listed separately under Pain management with device. Chemotherapy and radiotherapy for cancer is listed separately under Chemotherapy, radiotherapy and immunotherapy for cancer.\"},{\"category\":\"Plastic and reconstructive surgery (medically necessary)\",\"covered\":\"N\",\"waitingperiod\":\"2 months (12 if pre-existing)\",\"isclinicalcategory\":\"true\",\"helpid\":\"621\",\"scopeofcover\":\"Hospital treatment which is medically necessary for the investigation and treatment of any physical deformity, whether acquired as a result of illness or accident or congenital. For example: burns requiring a graft, cleft palate, club foot and angioma. Plastic surgery that is medically necessary relating to the treatment of a skin-related condition is listed separately under Skin. Chemotherapy and radiotherapy for cancer is listed separately under Chemotherapy, radiotherapy and immunotherapy for cancer.\"},{\"category\":\"Dental surgery\",\"covered\":\"N\",\"waitingperiod\":\"2 months (12 if pre-existing)\",\"isclinicalcategory\":\"true\",\"helpid\":\"622\",\"scopeofcover\":\"Hospital treatment for surgery to the teeth and gums. For example: surgery to remove wisdom teeth, and dental implant surgery.\"},{\"category\":\"Podiatric surgery (provided by a registered podiatric surgeon)\",\"covered\":\"N\",\"waitingperiod\":\"2 months (12 if pre-existing)\",\"isclinicalcategory\":\"true\",\"helpid\":\"623\",\"scopeofcover\":\"Hospital treatment for the investigation and treatment of conditions affecting the foot and/or ankle, provided by a registered podiatric surgeon, but limited to cover for: accommodation; and the cost of a prosthesis as listed in the prostheses list set out in the Private Health Insurance (Prostheses) Rules, as in force from time to time. Note: Insurers are not required to pay for any other benefits for hospital treatment for this clinical category but may choose to do so.\"},{\"category\":\"Implantation of hearing devices\",\"covered\":\"N\",\"waitingperiod\":\"2 months (12 if pre-existing)\",\"isclinicalcategory\":\"true\",\"helpid\":\"624\",\"scopeofcover\":\"Hospital treatment to correct hearing loss, including implantation of a prosthetic hearing device. Stapedectomy is listed separately under Ear, nose and throat.\"},{\"category\":\"Cataracts\",\"covered\":\"N\",\"waitingperiod\":\"2 months (12 if pre-existing)\",\"isclinicalcategory\":\"true\",\"helpid\":\"625\",\"scopeofcover\":\"Hospital treatment for surgery to remove a cataract and replace with an artificial lens.\"},{\"category\":\"Joint replacements\",\"covered\":\"N\",\"waitingperiod\":\"2 months (12 if pre-existing)\",\"isclinicalcategory\":\"true\",\"helpid\":\"626\",\"scopeofcover\":\"Hospital treatment for surgery for joint replacements, including revisions, resurfacing, partial replacements and removal of prostheses. For example: replacement of shoulder, wrist, finger, hip, knee, ankle, or toe joint. Joint fusions are listed separately under Bone, joint and muscle. Spinal fusions are listed separately under Back, neck and spine. Joint reconstructions are listed separately under Joint reconstructions. Podiatric surgery performed by a registered podiatric surgeon is listed separately under Podiatric surgery (provided by a registered podiatric surgeon).\"},{\"category\":\"Dialysis for chronic kidney failure\",\"covered\":\"N\",\"waitingperiod\":\"2 months (12 if pre-existing)\",\"isclinicalcategory\":\"true\",\"helpid\":\"627\",\"scopeofcover\":\"Hospital treatment for dialysis treatment for chronic kidney failure. For example: peritoneal dialysis and haemodialysis.\"},{\"category\":\"Pregnancy and birth\",\"covered\":\"N\",\"waitingperiod\":\"2 months (12 if pre-existing)\",\"isclinicalcategory\":\"true\",\"helpid\":\"628\",\"scopeofcover\":\"Hospital treatment for investigation and treatment of conditions associated with pregnancy and child birth. Treatment for the baby is covered under the clinical category relevant to their condition. For example, respiratory conditions are covered under Lung and chest. Female reproductive conditions are listed separately under Gynaecology. Fertility treatments are listed separately under Assisted reproductive services. Miscarriage and termination of pregnancy is listed separately under Miscarriage and termination of pregnancy.\"},{\"category\":\"Assisted reproductive services\",\"covered\":\"N\",\"waitingperiod\":\"2 months (12 if pre-existing)\",\"isclinicalcategory\":\"true\",\"helpid\":\"629\",\"scopeofcover\":\"Hospital treatment for fertility treatments or procedures. For example: retrieval of eggs or sperm, In vitro Fertilisation (IVF), and Gamete Intra-fallopian Transfer (GIFT). Treatment of the female reproductive system is listed separately under Gynaecology. Pregnancy and birth-related services are listed separately under Pregnancy and birth.\"},{\"category\":\"Weight loss surgery\",\"covered\":\"N\",\"waitingperiod\":\"2 months (12 if pre-existing)\",\"isclinicalcategory\":\"true\",\"helpid\":\"630\",\"scopeofcover\":\"Hospital treatment for surgery that is designed to reduce a person’s weight, remove excess skin due to weight loss and reversal of a bariatric procedure. For example: gastric banding, gastric bypass, sleeve gastrectomy.\"},{\"category\":\"Insulin pumps\",\"covered\":\"N\",\"waitingperiod\":\"2 months (12 if pre-existing)\",\"isclinicalcategory\":\"true\",\"helpid\":\"631\",\"scopeofcover\":\"Hospital treatment for the provision and replacement of insulin pumps for treatment of diabetes.\"},{\"category\":\"Pain Management with device\",\"covered\":\"N\",\"waitingperiod\":\"2 months (12 if pre-existing)\",\"isclinicalcategory\":\"true\",\"helpid\":\"632\",\"scopeofcover\":\"Hospital treatment for the implantation, replacement or other surgical management of a device required for the treatment of pain. For example: treatment of nerve pain, back pain, and pain caused by coronary heart disease with a device (for example an infusion pump or neurostimulator). Treatment of pain that does not require a device is listed separately under Pain management.\"},{\"category\":\"Sleep Studies\",\"covered\":\"N\",\"waitingperiod\":\"2 months (12 if pre-existing)\",\"isclinicalcategory\":\"true\",\"helpid\":\"633\",\"scopeofcover\":\"Hospital treatment for the investigation of sleep patterns and anomalies. For example: sleep apnoea and snoring.\"}]},\"scripting\":\"A\",\"name\":null},\"info\":{\"exclusions\":{\"cover\":null}}},\"extras\":{\"DentalGeneral\":{\"covered\":\"Y\",\"hasSpecialFeatures\":\"No annual limit on Preventative Dental.\",\"waitingPeriod\":\"2 Months\",\"benefits\":{\"DentalGeneral012PeriodicExam\":\"50%\",\"DentalGeneral114ScaleClean\":\"50%\",\"DentalGeneral121Fluoride\":\"50%\"},\"benefitLimits\":{\"perPerson\":\"$600\",\"perPolicy\":\"No limit\",\"annualLimit\":\"TBA\",\"lifetime\":null,\"combinedLimit\":\"No group limit.<br />See policy brochure\",\"subLimit\":null,\"serviceLimit\":\"<p>1 comprehensive oral examination per member per calendar year</p> <p>2 periodic dental examinations per member per calendar year</p> <p>3 consultations per member per calendar year </p>\"}},\"DentalMajor\":{\"covered\":\"N\",\"hasSpecialFeatures\":\"-\",\"waitingPeriod\":\"-\",\"benefits\":null,\"benefitLimits\":{\"perPerson\":\"-\",\"perPolicy\":\"-\",\"annualLimit\":\"-\",\"lifetime\":\"-\",\"combinedLimit\":\"-\",\"subLimit\":\"-\",\"serviceLimit\":\"-\"}},\"Endodontic\":{\"covered\":\"N\",\"hasSpecialFeatures\":\"-\",\"waitingPeriod\":\"-\",\"benefits\":null,\"benefitLimits\":{\"perPerson\":\"-\",\"perPolicy\":\"-\",\"annualLimit\":\"-\",\"lifetime\":\"-\",\"combinedLimit\":\"-\",\"subLimit\":\"-\",\"serviceLimit\":\"-\"}},\"Orthodontic\":{\"covered\":\"N\",\"hasSpecialFeatures\":\"-\",\"waitingPeriod\":\"-\",\"benefits\":null,\"benefitLimits\":{\"perPerson\":\"-\",\"perPolicy\":\"-\",\"annualLimit\":\"-\",\"lifetime\":\"-\",\"combinedLimit\":\"-\",\"subLimit\":\"-\",\"serviceLimit\":\"-\"}},\"Optical\":{\"covered\":\"Y\",\"hasSpecialFeatures\":\"None\",\"waitingPeriod\":\"6 Months\",\"benefits\":{\"OpticalSingleVisionLenses\":\"100%\",\"OpticalMultiFocalLenses\":\"100%\"},\"benefitLimits\":{\"perPerson\":\"$200\",\"perPolicy\":\"No limit\",\"annualLimit\":\"TBA\",\"lifetime\":null,\"combinedLimit\":\"No group limit.<br />See policy brochure\",\"subLimit\":null,\"serviceLimit\":\"No service limit\"}},\"NonPBS\":{\"covered\":\"N\",\"hasSpecialFeatures\":\"-\",\"waitingPeriod\":\"-\",\"benefits\":null,\"benefitLimits\":{\"perPerson\":\"-\",\"perPolicy\":\"-\",\"annualLimit\":\"-\",\"lifetime\":\"-\",\"combinedLimit\":\"-\",\"subLimit\":\"-\",\"serviceLimit\":\"-\"}},\"Physiotherapy\":{\"covered\":\"Y\",\"hasSpecialFeatures\":\"None\",\"waitingPeriod\":\"2 Months\",\"benefits\":{\"PhysiotherapyInitial\":\"50%\",\"PhysiotherapySubsequent\":\"50%\"},\"benefitLimits\":{\"perPerson\":\"$300\",\"perPolicy\":\"No limit\",\"annualLimit\":\"TBA\",\"lifetime\":null,\"combinedLimit\":\"Group Limit: Physiotherapy &amp; other services\",\"subLimit\":null,\"serviceLimit\":\"No service limit\"}},\"Chiropractic\":{\"covered\":\"Y\",\"hasSpecialFeatures\":\"None\",\"waitingPeriod\":\"2 Months\",\"benefits\":{\"ChiropracticInitial\":\"50%\",\"ChiropracticSubsequent\":\"50%\"},\"benefitLimits\":{\"perPerson\":\"$200\",\"perPolicy\":\"No limit\",\"annualLimit\":\"TBA\",\"lifetime\":null,\"combinedLimit\":\"Group Limit: Chiropractic, Osteopathy.\",\"subLimit\":null,\"serviceLimit\":\"No service limit\"}},\"Podiatry\":{\"covered\":\"N\",\"hasSpecialFeatures\":\"-\",\"waitingPeriod\":\"-\",\"benefits\":null,\"benefitLimits\":{\"perPerson\":\"-\",\"perPolicy\":\"-\",\"annualLimit\":\"-\",\"lifetime\":\"-\",\"combinedLimit\":\"-\",\"subLimit\":\"-\",\"serviceLimit\":\"-\"}},\"Psychology\":{\"covered\":\"N\",\"hasSpecialFeatures\":\"-\",\"waitingPeriod\":\"-\",\"benefits\":null,\"benefitLimits\":{\"perPerson\":\"-\",\"perPolicy\":\"-\",\"annualLimit\":\"-\",\"lifetime\":\"-\",\"combinedLimit\":\"-\",\"subLimit\":\"-\",\"serviceLimit\":\"-\"}},\"Acupuncture\":{\"covered\":\"Y\",\"hasSpecialFeatures\":\"None\",\"waitingPeriod\":\"2 Months\",\"benefits\":{\"AcupunctureInitial\":\"50%\"},\"benefitLimits\":{\"perPerson\":\"$200\",\"perPolicy\":\"No limit\",\"annualLimit\":\"TBA\",\"lifetime\":null,\"combinedLimit\":\"Group Limit: Acupuncture and Remedial Massage.\",\"subLimit\":null,\"serviceLimit\":\"No service limit\"}},\"Massage\":{\"covered\":\"Y\",\"hasSpecialFeatures\":\"None\",\"waitingPeriod\":\"2 Months\",\"benefits\":{\"MassageInitial\":\"50%\",\"MassageSubsequent\":\"50%\"},\"benefitLimits\":{\"perPerson\":\"$200\",\"perPolicy\":\"No limit\",\"annualLimit\":\"TBA\",\"lifetime\":null,\"combinedLimit\":\"Group Limit: Acupuncture and Remedial Massage.\",\"subLimit\":null,\"serviceLimit\":\"No service limit\"}},\"HearingAids\":{\"covered\":\"N\",\"hasSpecialFeatures\":\"-\",\"waitingPeriod\":\"-\",\"benefits\":null,\"benefitLimits\":{\"perPerson\":\"-\",\"perPolicy\":\"-\",\"annualLimit\":\"-\",\"lifetime\":\"-\",\"combinedLimit\":\"-\",\"subLimit\":\"-\",\"serviceLimit\":\"-\"}},\"GlucoseMonitor\":{\"covered\":\"N\",\"hasSpecialFeatures\":\"-\",\"waitingPeriod\":\"-\",\"benefits\":null,\"benefitLimits\":{\"perPerson\":\"-\",\"perPolicy\":\"-\",\"annualLimit\":\"-\",\"lifetime\":\"-\",\"combinedLimit\":\"-\",\"subLimit\":\"-\",\"serviceLimit\":\"-\"}},\"Dietetics\":{\"groupLimit\":{\"codes\":null,\"subLimit\":null,\"serviceLimit\":null},\"benefitpayableSubsequent\":null,\"benefitLimits\":{\"perPolicy\":\"-\",\"perPerson\":\"-\"},\"benefitPayableInitial\":null,\"waitingPeriod\":\"-\",\"covered\":\"N\"},\"OccupationalTherapy\":{\"benefitPayableInitial\":null,\"benefitLimits\":{\"perPerson\":\"-\",\"perPolicy\":\"-\"},\"covered\":\"N\",\"groupLimit\":{\"codes\":null,\"serviceLimit\":null,\"subLimit\":null},\"benefitpayableSubsequent\":null,\"waitingPeriod\":\"-\"},\"Orthotics\":{\"benefitLimits\":{\"perPerson\":\"-\",\"perPolicy\":\"-\"},\"covered\":\"N\",\"groupLimit\":{\"codes\":null,\"subLimit\":null,\"serviceLimit\":null},\"waitingPeriod\":\"-\",\"listBenefitExample\":\"-\"},\"SpeechTherapy\":{\"benefitLimits\":{\"perPerson\":\"-\",\"perPolicy\":\"-\"},\"groupLimit\":{\"codes\":null,\"subLimit\":null,\"serviceLimit\":null},\"benefitpayableSubsequent\":null,\"waitingPeriod\":\"-\",\"benefitPayableInitial\":null,\"covered\":\"N\"},\"hasSpecialFeatures\":\"Y\",\"SpecialFeatures\":\"Optical cover pays back 100% up to annual limit. Physiotherapy, Hydrotherapy and Myotherapy covered under combined annual limit. Chiropractic & Osteopathy covered under combined annual limit. This policy also provides access to AIA Vitality where you can earn rewards for leading a healthy lifestyle! https://www.aiavitality.com.au\",\"LifestyleProducts\":{\"covered\":\"N\",\"benefitLimits\":{\"perPerson\":\"-\",\"perPolicy\":\"-\"},\"waitingPeriod\":\"-\",\"listBenefitExample\":\"-\",\"groupLimit\":{\"serviceLimit\":null,\"subLimit\":null,\"codes\":null}},\"EyeTherapy\":{\"benefitLimits\":{\"perPerson\":\"-\",\"perPolicy\":\"-\"},\"waitingPeriod\":\"-\",\"benefitPayableInitial\":null,\"groupLimit\":{\"subLimit\":null,\"serviceLimit\":null,\"codes\":null},\"benefitpayableSubsequent\":null,\"covered\":\"N\"}},\"ambulance\":{\"otherInformation\":\"Ambulance cover provided through State Scheme, not myOwn.\",\"waitingPeriod\":\"N/A\",\"covered\":\"Y\"},\"accident\":{\"overrideDetails\":\"YES with <strong>1 day</strong> waiting period. Treatment must be sought from a doctor or an emergency department within 48 hours of sustaining the injury. <strong>Accident Defintion:</strong> MyOwn define an accident as an unforeseen, co-incidental event caused by an external source that results in a physical injury that requires immediate treatment. This does not included unforeseen conditions attributable to medical cause.\",\"covered\":\"Y\"},\"hospital\":{\"inclusions\":{\"GapCoverProvided\":true,\"LimitedProduct\":false,\"OtherBLP\":false,\"OtherExclusions\":false,\"OtherRestrictions\":false,\"privateHospital\":\"Y\",\"publicHospital\":\"Y\",\"waitingPeriods\":{\"SubAcute\":\"2 Months\",\"PreExisting\":\"12 Months\",\"Other\":\"2 Months\"},\"excess\":\"You will have to pay an excess of $750 on admission.<br /> This is limited to a maximum of $750 per person and $750 per policy per year.\",\"excesses\":{\"type\":\"LimitedPerPersonPerPolicy\",\"perAdmission\":\"$750\",\"perPerson\":\"750\",\"perPolicy\":\"750\"},\"waivers\":\"Dependant Children PLUS 100% excess refund once a policyholder reaches 6 months tenure and Silver AIA Vitality status. See policy brochure for full TandCs\",\"copayment\":\"No Co-Payment\",\"copayments\":{\"type\":\"None\",\"shared\":null,\"sharedMax\":null,\"private\":null,\"privateMax\":null,\"daySurgery\":null,\"annualMax\":null}},\"ClassificationHospital\":\"Top\",\"HospitalAmbulance\":\"Full\",\"benefits\":{\"Cardiac\":{\"covered\":\"NN\",\"benefitLimitationPeriod\":\"-\",\"WaitingPeriodType\":\"Other\",\"WaitingPeriod\":\"-\",\"ExistingWaitingPeriod\":\"12 Months\"},\"CataractEyeLens\":{\"covered\":\"NN\",\"benefitLimitationPeriod\":\"-\",\"WaitingPeriodType\":\"Other\",\"WaitingPeriod\":\"-\",\"ExistingWaitingPeriod\":\"12 Months\"},\"Obstetric\":{\"covered\":\"NN\",\"benefitLimitationPeriod\":\"-\",\"WaitingPeriodType\":\"Obstetric\",\"WaitingPeriod\":\"-\",\"ExistingWaitingPeriod\":\"12 Months\"},\"AssistedReproductive\":{\"covered\":\"NN\",\"benefitLimitationPeriod\":\"-\",\"WaitingPeriodType\":\"Obstetric\",\"WaitingPeriod\":\"-\",\"ExistingWaitingPeriod\":\"12 Months\"},\"JointReplacement\":{\"covered\":\"NN\",\"benefitLimitationPeriod\":\"-\",\"WaitingPeriodType\":\"Other\",\"WaitingPeriod\":\"-\",\"ExistingWaitingPeriod\":\"12 Months\"},\"RenalDialysis\":{\"covered\":\"NN\",\"benefitLimitationPeriod\":\"-\",\"WaitingPeriodType\":\"Other\",\"WaitingPeriod\":\"-\",\"ExistingWaitingPeriod\":\"12 Months\"},\"GastricBanding\":{\"covered\":\"NN\",\"benefitLimitationPeriod\":\"-\",\"WaitingPeriodType\":\"Other\",\"WaitingPeriod\":\"-\",\"ExistingWaitingPeriod\":\"12 Months\"},\"Sterilisation\":{\"covered\":\"N\",\"benefitLimitationPeriod\":\"-\",\"WaitingPeriodType\":\"Other\",\"WaitingPeriod\":\"-\"},\"PlasticNonCosmetic\":{\"covered\":\"NN\",\"benefitLimitationPeriod\":\"-\",\"WaitingPeriodType\":\"Other\",\"WaitingPeriod\":\"-\",\"ExistingWaitingPeriod\":\"12 Months\"},\"Rehabilitation\":{\"covered\":\"RR\",\"benefitLimitationPeriod\":\"-\",\"WaitingPeriodType\":\"SubAcute\",\"WaitingPeriod\":\"-\",\"ExistingWaitingPeriod\":\"2 Months\"},\"Psychiatric\":{\"covered\":\"RR\",\"benefitLimitationPeriod\":\"-\",\"WaitingPeriodType\":\"SubAcute\",\"WaitingPeriod\":\"-\",\"ExistingWaitingPeriod\":\"2 Months\"},\"Palliative\":{\"covered\":\"RR\",\"benefitLimitationPeriod\":\"-\",\"WaitingPeriodType\":\"SubAcute\",\"WaitingPeriod\":\"-\",\"ExistingWaitingPeriod\":\"2 Months\"},\"NonMedicare\":{\"covered\":\"N\",\"benefitLimitationPeriod\":\"-\",\"WaitingPeriodType\":\"Other\",\"WaitingPeriod\":\"-\"},\"Podiatric\":{\"covered\":\"N\",\"benefitLimitationPeriod\":\"-\",\"WaitingPeriodType\":\"Other\",\"WaitingPeriod\":\"-\"},\"ENT\":{\"covered\":\"YY\",\"benefitLimitationPeriod\":\"-\",\"WaitingPeriodType\":\"Other\",\"WaitingPeriod\":\"-\",\"ExistingWaitingPeriod\":\"12 Months\"},\"BoneMuscleJointRecon\":{\"covered\":\"YY\",\"benefitLimitationPeriod\":\"-\",\"WaitingPeriodType\":\"Other\",\"WaitingPeriod\":\"-\",\"ExistingWaitingPeriod\":\"12 Months\"},\"BackSurgery\":{\"covered\":\"NN\",\"benefitLimitationPeriod\":\"-\",\"WaitingPeriodType\":\"Other\",\"WaitingPeriod\":\"-\",\"ExistingWaitingPeriod\":\"12 Months\"},\"DentalSurgery\":{\"covered\":\"NN\",\"benefitLimitationPeriod\":\"-\",\"WaitingPeriodType\":\"Other\",\"WaitingPeriod\":\"-\",\"ExistingWaitingPeriod\":\"12 Months\"},\"Cancer\":{\"covered\":\"NN\",\"benefitLimitationPeriod\":\"-\",\"WaitingPeriodType\":\"Other\",\"WaitingPeriod\":\"-\",\"ExistingWaitingPeriod\":\"12 Months\"},\"HerniaAppendix\":{\"covered\":\"YY\",\"benefitLimitationPeriod\":\"-\",\"WaitingPeriodType\":\"Other\",\"WaitingPeriod\":\"-\",\"ExistingWaitingPeriod\":\"12 Months\"},\"PainManagementNoDevice\":{\"covered\":\"YY\",\"benefitLimitationPeriod\":\"-\",\"WaitingPeriodType\":\"Other\",\"WaitingPeriod\":\"-\",\"ExistingWaitingPeriod\":\"12 Months\"}}},\"transactionId\":2717010,\"info\":{\"trackCode\":\"UNKNOWN\",\"restrictedFund\":\"N\",\"productTitle\":\"Bronze Hospital 750 and Minimum 50 Extras\",\"productCode\":\"J43/QFSI1D\",\"hospitalName\":null,\"extrasName\":null,\"fundProductCode\":null,\"des\":\"Bronze Hospital 750 and Minimum 50 Extras\",\"provider\":\"MYO\",\"providerId\":20,\"name\":\"Bronze Hospital 750 and Minimum 50 Extras\",\"rank\":1,\"popularProductsRank\":null,\"providerName\":\"myOwn\",\"situationFilter\":\"N\",\"popularProduct\":false,\"abdRequestFlag\":null,\"Category\":\"SingleParentFamily\",\"ProductType\":\"Combined\",\"FundCode\":\"MYO\",\"State\":\"QLD\",\"OtherProductFeatures\":\"Also provides access to AIA Vitality, where you can earn rewards for leading a healthy lifestyle! https://www.aiavitality.com.au\"},\"dropDeadDate\":\"2019-03-31\",\"pricingDate\":\"2019-04-01\"}]}");
        when(request.getAttribute("requestData")).thenReturn(healthRequest);
        when(healthRequest.getQuote()).thenReturn(healthQuote);
        when(healthQuote.getPayment()).thenReturn(payment);
        when(payment.getDetails()).thenReturn(paymentDetails);
        when(paymentDetails.getType()).thenReturn("cc");
        when(paymentDetails.getFrequency()).thenReturn("weekly");
        when(marketingAutomationEmailService.sendEventEmail(any(EmailEventRequest.class))).thenReturn(emailResponse);
        when(emailResponse.getSuccess()).thenReturn(Boolean.TRUE);
    }

    @Test
    public void testPromoAndCouponForOnlineJourney() {
        when(request.getParameter("health_voucher_available")).thenReturn("N");
        when(request.getParameter("couponValue")).thenReturn("200");
        when(request.getParameter("couponTerms")).thenReturn("Test Coupon terms");
        when(request.getParameter("promoTerms")).thenReturn("Test promotional terms");
        when(request.getParameter("promoDescription")).thenReturn("testing promotion");
        EmailEventRequest emailEventRequest = new EmailEventRequest();
        healthEmailService.setPromoAndCoupon(request, emailEventRequest);
        assertEquals(null, emailEventRequest.getCouponCode());
        assertEquals("200", emailEventRequest.getCouponValue());
        assertEquals("Test Coupon terms", emailEventRequest.getCouponTerms());
        assertEquals("Test promotional terms", emailEventRequest.getPromoTerms());
    }

    @Test
    public void testPromoAndCouponForOnlineJourney2() {
        when(request.getParameter("health_voucher_available")).thenReturn(null);
        when(request.getParameter("couponValue")).thenReturn("200");
        when(request.getParameter("couponTerms")).thenReturn("Test Coupon terms");
        when(request.getParameter("promoTerms")).thenReturn("Test promotional terms");
        when(request.getParameter("promoDescription")).thenReturn("testing promotion");
        EmailEventRequest emailEventRequest = new EmailEventRequest();
        healthEmailService.setPromoAndCoupon(request, emailEventRequest);
        assertEquals(null, emailEventRequest.getCouponCode());
        assertEquals("200", emailEventRequest.getCouponValue());
        assertEquals("Test Coupon terms", emailEventRequest.getCouponTerms());
        assertEquals("Test promotional terms", emailEventRequest.getPromoTerms());
    }

    @Test
    public void testPromoAndCouponForSimplesJourneyOther() {
        when(request.getParameter("health_voucher_available")).thenReturn("Y");
        when(request.getParameter("health_voucher_reason")).thenReturn("mobile-offer");
        when(request.getParameter("health_voucher_value")).thenReturn("200");
        when(request.getParameter("promoTerms")).thenReturn("Test promotional terms");
        when(request.getParameter("promoDescription")).thenReturn("testing promotion");
        EmailEventRequest emailEventRequest = new EmailEventRequest();
        healthEmailService.setPromoAndCoupon(request, emailEventRequest);
        assertEquals("mobile-offer", emailEventRequest.getCouponCode());
        assertEquals("200", emailEventRequest.getCouponValue());
        assertEquals("Test promotional terms", emailEventRequest.getPromoTerms());
        assertEquals("testing promotion", emailEventRequest.getPromoDescription());
    }

    @Test
    public void testPromoAndCouponForSimplesJourneyMandoEdgeLoyalty() {
        when(request.getParameter("health_voucher_available")).thenReturn("Y");
        when(request.getParameter("health_coupon_code")).thenReturn("manual-coupon");
        when(request.getParameter("promoTerms")).thenReturn("Test promotional terms");
        when(request.getParameter("promoDescription")).thenReturn("testing promotion");
        EmailEventRequest emailEventRequest = new EmailEventRequest();
        healthEmailService.setPromoAndCoupon(request, emailEventRequest);
        assertEquals("manual-coupon", emailEventRequest.getCouponCode());
        assertEquals("Test promotional terms", emailEventRequest.getPromoTerms());
        assertEquals("testing promotion", emailEventRequest.getPromoDescription());
    }

    @Test
    public void testPromoAndCouponForSimplesJourneyMandoEdgeLoyaltyWithNoCouponCode() {
        when(request.getParameter("health_voucher_available")).thenReturn("Y");
        when(request.getParameter("health_coupon_code")).thenReturn(null);
        when(request.getParameter("promoTerms")).thenReturn("Test promotional terms");
        when(request.getParameter("promoDescription")).thenReturn("testing promotion");
        EmailEventRequest emailEventRequest = new EmailEventRequest();
        healthEmailService.setPromoAndCoupon(request, emailEventRequest);
        assertEquals(null, emailEventRequest.getCouponCode());
        assertEquals("Test promotional terms", emailEventRequest.getPromoTerms());
        assertEquals("testing promotion", emailEventRequest.getPromoDescription());
    }

    @Test(expected = NullPointerException.class)
    public void testPromoAndCouponInvokeCall() throws Exception {
        when(request.getParameter("health_voucher_available")).thenReturn("Y");
        when(request.getParameter("health_coupon_code")).thenReturn(null);
        when(request.getParameter("promoTerms")).thenReturn("Test promotional terms");
        when(request.getParameter("promoDescription")).thenReturn("testing promotion");
        healthEmailService.sendApplicationEmail(request, "", 101, "123");

    }

}
